<html>
<head>
<title>Playing with Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">玩弄逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/playing-with-logistic-regression-edcfc953c174?source=collection_archive---------8-----------------------#2021-06-14">https://medium.com/nerd-for-tech/playing-with-logistic-regression-edcfc953c174?source=collection_archive---------8-----------------------#2021-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7b8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归是机器学习中使用的一个关键工具。它用于预测二元事件的概率，如谁将通过考试或谁将从疾病中幸存。在这两个例子中，只有两种可能的结果。这不同于正常的线性回归，后者用于模拟连续变量，如房价。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/92f709a85a1773a515ffbefe2b7ac3ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRrhx7U0W8T856X4n5jXSg.jpeg"/></div></div></figure><p id="329d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了说明这一过程，我从Kaggle下载了一个数据集，它观察了两所葡萄牙中学Gabriel Pereira (GP)和Mousinho da Silveira (MS ),以及那里的学生是否通过了期末考试。数据集关注学生在两个科目上的表现:数学和葡萄牙语。它也包含了关于学生的背景、学校和社会生活的信息。出于此模型的目的，我省略了最终分数，它可以在G3列中找到，因为目标属性G3与属性G2和G1有很强的相关性。并非所有模型都对多重共线性敏感，但逻辑回归对多重共线性敏感。有关数据集特征的其他信息可在下面找到。</p><p id="da35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">属性信息:</p><ul class=""><li id="7952" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj">学校</strong> —学生的学校(二进制:' GP' — Gabriel Pereira或' MS' — Mousinho da Silveira)</li><li id="5fa3" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">性别</strong> —学生的性别(二进制:' F' —女性或' M' —男性)</li><li id="9205" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">年龄</strong> —学生年龄(数字:15-22)</li><li id="052c" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">地址</strong> —学生的家庭地址类型(二进制:' U' —城市或' R' —农村)</li><li id="9563" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> famsize </strong> —家庭规模(二进制:' LE3' —小于或等于3或' GT3' —大于3)</li><li id="a880" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Pstatus </strong> —父母的同居状态(二进制:' T' —同居或' A' —分居)</li><li id="fd55" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Medu </strong> —母亲的教育程度(数字:0 —无，1 —初等教育(四年级)，2“五至九年级，3—中等教育或4—高等教育)</li><li id="f766" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Fedu </strong> —父亲的教育程度(数字:0 —无，1 —初等教育(四年级)，2—五至九年级，3—中等教育或4—高等教育)</li><li id="180c" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Mjob </strong> —母亲的工作(名义上:“教师”、“保健”相关、民事“服务”(如行政或警察)、“在家”或“其他”)</li><li id="2460" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Fjob </strong> —父亲的工作(名义上:“教师”、“健康”护理相关、民事“服务”(例如行政或警察)、“在家”或“其他”)</li><li id="ecda" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">理由</strong> —选择这所学校的理由(名义上:靠近'家'、学校'声誉'、'课程'偏好或'其他')</li><li id="2f2a" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">监护人</strong> —学生的监护人(名义上:“母亲”、“父亲”或“其他”)</li><li id="cdf5" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">行程时间</strong> —从家到学校的行程时间(数字:1-1小时)</li><li id="0620" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">学习时间</strong> —每周学习时间(数字:1-10小时)</li><li id="465d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">故障</strong> —过去类故障的数量(数字:n如果1 &lt; =n❤，否则4)</li><li id="c7b1" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">学校支持</strong> —额外教育支持(二进制:是或否)</li><li id="b433" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> famsup </strong> —家庭教育支持(二元:是或否)</li><li id="4c2b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">付费</strong> —课程科目(数学或葡萄牙语)内的额外付费课程(二进制:是或否)</li><li id="77da" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">活动</strong> —课外活动(二元:是或否)</li><li id="db90" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">托儿所</strong> —上过托儿所(二进制:是或否)</li><li id="5266" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">高等</strong> —想接受高等教育(二进制:是或否)</li><li id="5897" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">互联网</strong> —在家上网(二进制:是或否)</li><li id="6bd1" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">浪漫</strong>——有浪漫的关系(二元:是或否)</li><li id="9b23" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> famrel </strong> —家庭关系的质量(数值:从1 —很差到5 —极好)</li><li id="5701" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">自由时间</strong> —放学后的自由时间(数字:从1 —很低到5 —很高)</li><li id="07b5" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">goout</strong>——和朋友出去(数值:从1——很低到5——很高)</li><li id="6fec" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Dalc </strong> —工作日酒精消耗量(数值:从1 —非常低到5 —非常高)</li><li id="48bd" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> Walc </strong> —周末饮酒量(数字:从1 —非常低到5 —非常高)</li><li id="cdab" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">健康状况</strong> —当前健康状况(数字:从1 —非常差到5 —非常好)</li><li id="643b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj">缺勤</strong> —学校缺勤的次数(数字:从0到93)</li></ul><p id="1cf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些成绩与课程科目有关，数学或葡萄牙语:</p><ul class=""><li id="d04b" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj"> G1 </strong> —第一期成绩(数字:从0到20)</li><li id="469a" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> G2 </strong> —第二周期等级(数字:从0到20)</li><li id="4b0a" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> G3 </strong> —最终等级(数值:从0到20，输出目标)</li></ul><p id="8ea0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在导入相关的库并读取数据集后，我做了一些快速EDA，发现总共有30列，395个条目。数据集中包含的所有信息都是浮点形式的，没有丢失的值，这意味着我不需要做太多的工作来清理数据。总共有265名学生及格，130名学生不及格。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/88a3086a9386b1b8aa41ec63ccc99175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*89RhkWU2xgiipfkAoPlQDg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">原始数据集</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/5052438e2cbb4f7199ed2dacd3c90444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vMOe6nIeg1a_Sh49HDYuXg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">通过(1)和未通过(0)的学生百分比</figcaption></figure><p id="0a53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的模型的第一步是为我的目标(y)和特征(X)创建变量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/8024c883390813197502774c5f713abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lF7gDeoHCHWMb5x7GwZIJw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">创建特征变量和目标变量</figcaption></figure><p id="7e7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我将数据分成训练集和测试集。在缩放之前拆分数据以避免数据泄漏是非常重要的，数据泄漏是指在模型训练过程中使用在您进行预测时不可获得的信息。如果在拆分数据之前先对其进行缩放，将会破坏您的预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/9119cd1421b89f6fc7cb14040a2860e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*11iL9F8Mhab1QJK4cdLFZA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">执行列车测试分离</figcaption></figure><p id="630b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归会自动进行正则化，因此缩放数据非常重要，否则某些要素的系数可能会受到不公平的惩罚。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/c5882692367a20885a77cd58fc94f9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3N-ACl9V2fF6SpstPZ9Pmw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">缩放数据</figcaption></figure><p id="2455" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里，我拟合了一个逻辑回归模型，并检查了系数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/f0127d58aa48580f9a26f43ebe898e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zi9M05dVXAxg4q2LwtvObA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">拟合逻辑回归模型</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/6204ce796345cf0c64bbe0df9994e0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0TS7byBlG6RoUQDF6_ATw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">检查系数</figcaption></figure><p id="69b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我拟合了模型，我就能够在测试集上进行预测，并生成一个分类报告来评估我的预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kl"><img src="../Images/f677f9848343e8a4af2bf6db0686b2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QVhKK_FQztJAfJOZa24F0w.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">创建类别预测(不是预测的概率)</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es km"><img src="../Images/22803fb4f68f5d746c017d645e30941d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qDVUX1OKQLB4CdeqmATXg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">这些类的精确度、召回率、f1分数、支持度和准确度的摘要。</figcaption></figure><p id="ac37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类报告为我们提供了几条重要的信息，第一条是精度，即真阳性除以真阳性加上假阳性。第二个重要的信息是回忆，它是真阳性除以真阳性加上假阴性。f-1分数允许我们将精确性和回忆性结合在一起。数学上，这是调和平均值。在这种情况下，f1分数非常高。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kn"><img src="../Images/20515002a047cbe569a3ccc13addd5cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fhRJuxbsuCf9si6gPEkqrg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">计算f-1分数</figcaption></figure><p id="0ea4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重要的是要注意，准确性分数并不是特别有用，因为我们的数据中存在类别不平衡。</p><p id="651a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在下面画了一个混淆矩阵来帮助可视化结果。该模型成功预测了87%的0班学生和93%的1班学生。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/a1cbbc17a509a9086125fb75659726dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYTIGExSLeJSG6HcW-THng.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">混淆矩阵</figcaption></figure><p id="2ffa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面，我进一步详细介绍了上面分类报告中的分数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/684b29249f26b9d5287fef7c4b999f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCbIw9ET8Tvo2-uqk_9j1g.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">保存混淆矩阵并将其分成四份</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kl"><img src="../Images/72858cf64cad85c62b45ca82ecc873ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAKOYbQuDmbElyMGXLYhQA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">真阳性、真阴性、假阳性、假阴性的结果</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/96d5944c2adbd7d4277c86f6c77812cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ylMlFSBzJg2l-B2-qUy6mA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">计算1类(通过)的召回</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/4990a6ea92f3ce62fde27d9de66406e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IjTDQXxKT1fDkMpsx3CzMw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">计算特异性/真阴性率。这是对0级(不合格)的召回</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kn"><img src="../Images/75c86d49828f0cce29ae0d2ad10bb60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nSe90XEb55fmCbwRB7UJHA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">存储预测的概率</figcaption></figure><p id="d6ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我制作了预测概率的直方图以及ROC(受试者操作特征)曲线。ROC曲线告诉我们，随着假阳性率的增加，真阳性率也增加。基线AUC(曲线下面积)为0.5。这个模型的AUC是0.97，非常好。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/f3d2bc60fcfc35c1fa657ef0a17c7097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oxS0cTUWyiBUxrf0PZBYrg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">预测概率直方图</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/91fea26bd2d981410dd8e30d49a77ea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5g_GBTpxJUk-8C5E4F5XQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">受试者工作特征曲线</figcaption></figure><p id="a95b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是你如何执行一个简单的逻辑回归！</p></div></div>    
</body>
</html>