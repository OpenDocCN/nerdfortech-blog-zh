<html>
<head>
<title>Automate Facebook Posts with Python and Facebook Graph API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和脸书图形API自动化脸书帖子</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/automate-facebook-posts-with-python-and-facebook-graph-api-858a03d2b142?source=collection_archive---------0-----------------------#2021-03-15">https://medium.com/nerd-for-tech/automate-facebook-posts-with-python-and-facebook-graph-api-858a03d2b142?source=collection_archive---------0-----------------------#2021-03-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="22e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将讨论如何通过使用python和facebook graph API自动化facebook页面帖子来简化您的facebook页面参与。</p><p id="200c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在本文中讨论以下主题:</p><ul class=""><li id="e822" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">脸书图形API简介</li><li id="b993" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">获取您的facebook页面访问令牌</li><li id="d6c3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">使用Graph API和python向您的facebook页面发送帖子</li><li id="9887" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">使用Graph API和python将照片发送到您的facebook页面</li><li id="dbef" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何将短期访问令牌换成长期访问令牌</li><li id="9961" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">按计划向脸书发送邮件</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/66d43eb6b560dc56ebc46b26d2848196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kcy2AWb9Tb9tqA7dKQTpcA.png"/></div></div></figure><h1 id="0ade" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">脸书图形API简介</h1><p id="655a" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">你可以通过这个链接访问脸书图形应用编程接口:<a class="ae lg" href="https://developers.facebook.com/docs/graph-api/" rel="noopener ugc nofollow" target="_blank">https://developers.facebook.com/docs/graph-api/</a>——该文档包含了从获取访问令牌到向Facebook发送帖子等与应用编程接口交互的代码片段。</p><p id="6d68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">脸书图形API提供了url端点，您可以向其发送GET和POST请求，以便与您的facebook页面进行交互或向您的Facebook帐户发送信息和帖子。你可以使用API来:(1)阅读时间线上的消息，(2)发送消息，(3)阅读帖子，(4)创建帖子，编辑帖子，甚至删除帖子。该API是一个强大的工具，可以通过编程方式与你的facebook帐户或页面进行交互，因此提供了一个工具来自动化你的facebook。</p><p id="8636" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将重点关注如何使用API来自动化帖子，特别是在脸书页面上。</p><p id="a006" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在访问graph API之前，您需要访问令牌。这些就像数字钥匙，可以解锁你的账户，让你以编程的方式与之互动。</p><h1 id="9789" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">获取您的脸书页面访问令牌</h1><p id="6493" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">我们将从获得短期访问令牌开始，这些令牌可以从facebook开发人员前端获得。转到网址:【https://developers.facebook.com/ T2】</p><p id="3445" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个facebook开发人员帐户并登录仪表板。在左上角，点击“创建应用程序”绿色按钮:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lh"><img src="../Images/be5ff83e9c9a38dad6b440f7f3d23e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j32by0iJXTnw1aiGeLHEZw.png"/></div></div></figure><p id="7728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一页中，选择一个应用程序名称，然后按enter。</p><p id="3b17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后转到工具，点击下拉列表中的第一个按钮——Graph API Explorer。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es li"><img src="../Images/4a2c52c26fd2d06634b56ec9b5c554ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LK-dKMjHZ3TcTnEWu29o0g.png"/></div></div></figure><p id="7a98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此页面中，您将能够选择您的访问令牌。按照以下步骤获取您的脸书页面图形API访问令牌:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/b44dc8f1dcd816b04ba293e8d595ed18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_08zIa1dd5ZWNeKj_YRZ2w.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">获取facebook graph API页面访问令牌的步骤</figcaption></figure><h1 id="924f" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">通过Python使用脸书图形API访问令牌将帖子发送到脸书页面</h1><p id="a2b3" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">你还需要一个页面ID——你想发布的facebook页面的页面ID。你可以直接从你的facebook页面的“关于”标签下获得你的页面ID。复制这个ID并将其粘贴到您的代码中。</p><p id="b7c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用请求库，请在下面安装它:</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="3b37" class="ls ke hi lo b fi lt lu l lv lw">pip install requests</span></pre><p id="e561" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是创建帖子的代码:</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="ef2c" class="ls ke hi lo b fi lt lu l lv lw">import requests</span><span id="dd4f" class="ls ke hi lo b fi lx lu l lv lw">#Your Access Keys<br/>page_id_1 = 123456789<br/>facebook_access_token_1 = 'paste-your-page-access-token-here'</span><span id="df95" class="ls ke hi lo b fi lx lu l lv lw">msg = 'Purple Ombre Bob Lace Wig Natural Human Hair now available on <a class="ae lg" href="https://lace-wigs.co.za/'" rel="noopener ugc nofollow" target="_blank">https://lace-wigs.co.za/'</a><br/>post_url = '<a class="ae lg" href="https://graph.facebook.com/{}/feed'.format(page_id_1)" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/{}/feed'.format(page_id_1)</a><br/>payload = {<br/>'message': msg,<br/>'access_token': facebook_access_token_1<br/>}</span><span id="029a" class="ls ke hi lo b fi lx lu l lv lw">r = requests.post(post_url, data=payload)<br/>print(r.text)</span></pre><p id="551f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您在这个阶段得到一个错误，可能是:(1)您的页面ID有问题，或者(2)您的访问令牌有问题。查看上面访问tokes的步骤，确保:您选择了一个具有正确权限的页面访问tokes。您需要的权限是:</p><ul class=""><li id="ff23" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">页面_显示_列表</li><li id="11c6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">pages _ read _ engagement</li><li id="dc9d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">页面_管理_帖子</li><li id="b3d6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">公共_个人资料</li></ul><h1 id="f996" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">使用Python向脸书页面发送图像</h1><p id="ad29" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">要将图像发送到您的facebook页面，您可以使用以下代码:</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="d295" class="ls ke hi lo b fi lt lu l lv lw">import requests</span><span id="cbdb" class="ls ke hi lo b fi lx lu l lv lw">page_id_1 = 123456789<br/>facebook_access_token_1 = 'paste-your-page-access-token-here'</span><span id="ff11" class="ls ke hi lo b fi lx lu l lv lw">image_url = '<a class="ae lg" href="https://graph.facebook.com/{}/photos'.format(page_id_1)" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/{}/photos'.format(page_id_1)</a><br/>image_location = '<a class="ae lg" href="http://image.careers-portal.co.za/f_output.jpg'" rel="noopener ugc nofollow" target="_blank">http://image.careers-portal.co.za/f_output.jpg'</a><br/>img_payload = {<br/>'url': image_location,<br/>'access_token': facebook_access_token_1<br/>}<br/>#Send the POST request<br/>r = requests.post(image_url, data=img_payload)<br/>print(r.text)</span></pre><p id="d1c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们发送的图像位于互联网上的以下位置:<a class="ae lg" href="http://image.careers-portal.co.za/f_output.jpg'" rel="noopener ugc nofollow" target="_blank">http://image.careers-portal.co.za/f_output.jpg</a></p><h1 id="11a6" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">如何将短暂的令牌换成长久的令牌</h1><p id="81f8" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">我们上面讨论的从Graph API仪表板获取访问令牌的过程—仅提供短期令牌，从发布之日起一小时内有效。这意味着你可以用它写任何有意义的代码，因为代码一小时后就过期了。</p><p id="d191" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">返回Graph API仪表板，获取一个短期用户访问令牌。这与我们以前在页面上发布的令牌不同。在下拉列表中—选择用户令牌，而不是页面令牌。</p><p id="e143" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦您获得了这个令牌，您就可以通过发送一个CURL请求将它交换为一个长期用户访问令牌，如下所示:</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="9b8f" class="ls ke hi lo b fi lt lu l lv lw">curl -i -X GET "https://graph.facebook.com/oauth/access_token?grant_type=fb_exchange_token&amp;<br/>  client_id={app-id}&amp;<br/>  client_secret={app-secret}&amp;<br/>  fb_exchange_token={short-lived-user-access-token}"</span></pre><p id="1c2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个长期用户访问令牌现在将在60天内有效，而短期令牌的有效期为1小时。</p><p id="5453" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我们需要一个页面访问令牌，所以使用下面的CURL请求将您的用户访问令牌换成页面访问令牌:</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="cb19" class="ls ke hi lo b fi lt lu l lv lw">curl -i -X GET "https://graph.facebook.com/{page-id}?<br/>  fields=access_token&amp;<br/>  access_token={user-access-token}"</span></pre><p id="61ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个请求中最好使用一个长期用户令牌，因为它返回一个没有截止日期的页面令牌——根据脸书的说法，还没有经过测试。</p><p id="6c5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后您将获得一个页面访问令牌，现在您可以在代码中使用它。</p><h1 id="3b38" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">用脸书图形API发送帖子到脸书网页，用Python编写时间表</h1><p id="b6a7" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">在这个阶段，我们将使用Python时间表库来安排每天的文章。您可以创建一个连续或随机安排的帖子列表。</p><p id="b08c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从安装时间表开始</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="472a" class="ls ke hi lo b fi lt lu l lv lw">pip install schedule</span></pre><p id="9447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码将类似于:</p><pre class="js jt ju jv fd ln lo lp lq aw lr bi"><span id="c5c8" class="ls ke hi lo b fi lt lu l lv lw">import requests<br/>import schedule</span><span id="ccd2" class="ls ke hi lo b fi lx lu l lv lw">def sendPost1():<br/>        sending the post . . . . . </span><span id="c5ce" class="ls ke hi lo b fi lx lu l lv lw">def sendPost2():<br/>        sending the post . . . . .</span><span id="0c83" class="ls ke hi lo b fi lx lu l lv lw">schedule.every().day.at("08:30").do(sendPost1)<br/>schedule.every().day.at("09:15").do(sendPost2)</span><span id="b7a6" class="ls ke hi lo b fi lx lu l lv lw">while True:<br/>    schedule.run_pending()<br/>    time.sleep(1)</span></pre><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="ly lz l"/></div></figure></div></div>    
</body>
</html>