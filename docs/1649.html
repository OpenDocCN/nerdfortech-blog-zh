<html>
<head>
<title>Writing better conditional expressions in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 JavaScript 编写更好的条件表达式</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/writing-better-conditional-expressions-in-javascript-2c07d32666f0?source=collection_archive---------7-----------------------#2021-03-30">https://medium.com/nerd-for-tech/writing-better-conditional-expressions-in-javascript-2c07d32666f0?source=collection_archive---------7-----------------------#2021-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6e2e7c8e7c4eb73fb5d19aabab60b991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NIMhkYXaWs_HyITE.png"/></div></div></figure><p id="036b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">编写条件表达式非常容易。但是，我们的做法还有改进的余地。利用 JavaScript 提供的灵活性，我们可以通过使用一些好的实践，用干净的代码替换条件。并且它可以产生更易维护的代码。在这篇文章中，让我们来看看如何写出更好的条件表达式。</p><h1 id="8111" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">1.早期回报</h1><p id="dee2" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">当我们开始学习编程时，我们被教导应该只有一个 return 语句。虽然这个建议没有错，但是如果代码库很大，阅读代码就会变得很有挑战性。尽管我们在编写代码时应该遵循单一责任和其他坚实的原则，但早期返回使代码更具可读性，并给出代码流的清晰概念。</p><p id="cef4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">早期返回提供了一种编写更好的条件表达式的方法，并使代码更具可读性。虽然有些人会不同意这一点，但我的偏好是，如果有一个无效的条件早期返回。</p><p id="a171" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">而不是拥有:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5715" class="la jp hi kw b fi lb lc l ld le">if (model &amp;&amp; model.isValid) {<br/>  if(model.properties.isValid) {<br/>    // valid logic<br/>  }<br/>  else {<br/>    throw new Error('invalid model');<br/>  }<br/>}<br/>else {<br/>    throw new Error('invalid model');<br/>}</span></pre><p id="d35e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以做到:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f82b" class="la jp hi kw b fi lb lc l ld le">if (!model || !model.isValid || !model.properties.isValid) {<br/>  throw new Error('invalid model');<br/>}<br/><br/>// valid logic</span></pre><p id="3e02" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它肯定会归结为偏好，有时还会归结为正在编写的代码，但是早期的回报肯定有助于更快的浏览，更少的代码块和更容易的调试。</p><h1 id="a48f" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">2.避免多重条件</h1><p id="c535" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">可以用 switch 语句替换多个 if else 块，以提高可读性。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c6a8" class="la jp hi kw b fi lb lc l ld le">function onKeyPress(key) {<br/>  if (key === 'a') {<br/>    moveLeft();<br/>  } else if (key === 'w') {<br/>    moveTop( );<br/>  } else if (key === 's') {<br/>    moveDown( );<br/>  } else if (key === 'd') {<br/>    moveRight( );<br/>  } else if (key === 'h') {<br/>    showHelp( );<br/>  } else if (key === 'f') {<br/>    toggleFullScreen( );<br/>  }<br/>}</span></pre><p id="d4d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以更好地写成:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d9d1" class="la jp hi kw b fi lb lc l ld le">function onKeyPress(key) {<br/>  switch (key) {<br/>    case ‘a':<br/>      moveLeft();<br/>      break;<br/>    case ‘w':<br/>      movelTop();<br/>      break;<br/>    case 'S':<br/>      moveDown():<br/>      break;<br/>    case ‘d':<br/>      moveRight();<br/>      break;<br/>    case ‘h':<br/>      showHelp();<br/>      break;<br/>    case 'f':<br/>      toggleFullScreen();<br/>    break;<br/>  }<br/>}</span></pre><p id="33c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是有一个更好的方法。我们可以使用对象文字/映射以简洁的方式重写它:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9135" class="la jp hi kw b fi lb lc l ld le">function onKeyPress(key) {<br/>  const mapping = {<br/>    a: moveLeft,<br/>    w: movelTop,<br/>    s: moveDown,<br/>    d: moveRight,<br/>    h: showHelp,<br/>    f: toggleFullScreen,<br/>  };<br/>  mapping[key] &amp;&amp; mapping[key]();<br/>}</span></pre><p id="addc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">object literal/dictionary 是最干净的实现形式，并且通过向它添加键值，增加了可扩展的好处。</p><h1 id="2e66" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">3.使用内置数组方法</h1><p id="5c6d" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">为了匹配多个条件，我们通常将代码编写为:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="dce8" class="la jp hi kw b fi lb lc l ld le">const isAnimal = animal =&gt; {<br/>  if (animal === ‘cat’ || animal === ‘dog’<br/>    || animal === 'lion' || animal === 'bird') {<br/>    return true;<br/>  }<br/>  <br/>  return false;<br/>};</span></pre><p id="6cfa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是我们可以使用内置的 Array.includes()方法来这样做，而不必担心添加这么多“或”条件。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f372" class="la jp hi kw b fi lb lc l ld le">const isAnimal = animal =&gt; {<br/>  const animals = [‘cat’, ‘dog’, ‘lion’, 'bird'];<br/>  return animals.includes(animal);<br/>};</span></pre><p id="5d38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者，如果我们正在处理对象的数组，并且想要检查属性，我们可以利用 Array.some()方法来检查是否满足某个条件:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8c98" class="la jp hi kw b fi lb lc l ld le">const isAnimal = name =&gt; {<br/>  const animals = [<br/>    { name: 'cat', legs: 4 },<br/>    { name: 'dog', legs: 4 },<br/>    { name: 'lion', legs: 4},<br/>    { name: 'bird', legs: 2}<br/>  ];<br/>  return animals.some(animal =&gt; animal.name === name);<br/>};</span></pre><p id="5e3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们同样可以使用 Array.every 来检查所有对象是否都有属性，或者使用 Array.find()来执行一些逻辑。</p><h1 id="f15f" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">4.使用默认值和析构</h1><p id="2bab" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">利用最新的 ECMAScript 特性总是一件好事。提供默认值消除了初始化变量时对一些条件的需要。利用对象析构也是如此。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="a5a6" class="la jp hi kw b fi lb lc l ld le">const test = (animal, legs) =&gt; {<br/>  if (!animal) return;<br/>  const num_legs = legs || 0; // if legs not provided, default to zero<br/>  console.log(`${animal} has ${num_legs} legs!`);<br/>}</span></pre><p id="88d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用缺省函数值来消除值初始化的条件。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="b5be" class="la jp hi kw b fi lb lc l ld le">const test = (animal, legs = 0) =&gt; {<br/>  if (!animal) return;<br/>  console.log(`${animal} has ${num_legs} legs!`);<br/>}</span></pre><p id="dd06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们在处理对象，我们可以利用析构操作符。出发地:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4588" class="la jp hi kw b fi lb lc l ld le">const test = (animal) =&gt; { <br/>  // printing animal name if value provided<br/>  if (animal &amp;&amp; animal.name)  {<br/>    console.log (animal.name);<br/>  } else {<br/>    console.log('unknown');<br/>  }<br/>}</span></pre><p id="8bd2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以改写为:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5181" class="la jp hi kw b fi lb lc l ld le">function test({name} = {}) { <br/>    console.log (name || 'unknown');<br/>}</span></pre><p id="6711" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想了解更多关于析构操作符的知识，你可以阅读我们关于<a class="ae lf" href="https://www.wisdomgeek.com/development/web-development/rest-and-spread-operator-three-dots-that-changed-javascript/" rel="noopener ugc nofollow" target="_blank">析构和传播操作符</a>的帖子。</p><p id="80b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于类似的初始化相关条件，我们也可以使用<a class="ae lf" href="https://www.wisdomgeek.com/development/web-development/javascript/using-the-optional-chaining-operator-in-javascript/" rel="noopener ugc nofollow" target="_blank">可选的链接和无效合并操作符</a>。</p><p id="777a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是写更好的条件表达式的全部内容。使用这些技术来编写更好的条件表达式，我们可以使我们的代码更干净，可读性更好。如果您对如何编写更好的条件表达式有任何其他建议，请随时在下面留言，我们会将它添加到我们的列表中！</p></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><p id="6027" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ln">原载于 2021 年 3 月 30 日</em><a class="ae lf" href="https://www.wisdomgeek.com/development/web-development/javascript/writing-better-conditional-expressions-in-javascript/" rel="noopener ugc nofollow" target="_blank"><em class="ln"/></a><em class="ln">。</em></p></div></div>    
</body>
</html>