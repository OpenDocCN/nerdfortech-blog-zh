<html>
<head>
<title>Using Sphinx for Python Documentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Sphinx用于Python文档</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/using-sphinx-for-python-documentation-28ed52f1d5a7?source=collection_archive---------0-----------------------#2019-09-20">https://medium.com/nerd-for-tech/using-sphinx-for-python-documentation-28ed52f1d5a7?source=collection_archive---------0-----------------------#2019-09-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b362" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">【更新时间:2021年1月14日】</em></p><p id="1ba9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为开发人员，我们都知道代码文档化的重要性:好的代码不仅不言自明，而且文档化良好。然而，我们也很难保持文档最新，特别是当我们分开维护源代码和它的文档时。如果我们能够基于源代码或者基于代码注释来生成文档，我们就有更好的机会来更新文档。</p><p id="0782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://www.sphinx-doc.org" rel="noopener ugc nofollow" target="_blank"> Sphinx </a>是一个从代码中构建文档的工具。它支持多种编程语言，在Python项目中被广泛使用，包括Python官方网站。斯芬克斯的官方网站提供了许多有用的信息和参考。但是，对于第一次使用Sphinx的人来说，官网可能会铺天盖地。至少，这是我第一次尝试使用Sphinx时的体验。因此，我写了这篇文章，希望这篇文章能够为Sphinx新手提供一个简单明了的教程。</p><h1 id="c575" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">情节</h1><p id="600d" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">本教程使用一个简单的Python项目(示例项目)来演示如何使用Sphinx生成基于HTML的文档。这个示例项目是一些类型的二分搜索法树和二叉树遍历的集合。按照<a class="ae je" href="https://numpydoc.readthedocs.io/en/latest/format.html" rel="noopener ugc nofollow" target="_blank"> NumPy docstring风格</a>有据可查。示例项目的主要目的是作为Sphinx教程的示例代码，并演示NumPy样式的文档字符串如何通过Sphinx转换成真实的文档。</p><p id="5332" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">示例项目可以从<a class="ae je" href="https://github.com/shunsvineyard/python-sample-code" rel="noopener ugc nofollow" target="_blank"> Github </a>下载。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="0c93" class="kr jg hi kn b fi ks kt l ku kv">$ git clone <a class="ae je" href="https://github.com/shunsvineyard/python-sample-code.git" rel="noopener ugc nofollow" target="_blank">https://github.com/shunsvineyard/python-sample-code.git</a></span></pre><p id="042a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成的文档如下图所示。也可通过<a class="ae je" href="https://python-sample-code.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">阅读文档</a>获得。</p><figure class="ki kj kk kl fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kw"><img src="../Images/744daaedb1bb11006ef0bfd5875003c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UfK7pp-xIm9AdtpF.png"/></div></div></figure><h1 id="fec4" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">假设和要求</h1><p id="a95a" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">本教程假设以下环境:</p><ul class=""><li id="046d" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">Python 3.9</li><li id="2f5e" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">狮身人面像</li><li id="992d" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">Ubuntu 20.04</li></ul><p id="43a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:Sphinx可以在Linux和Windows上运行。虽然本教程使用的是Ubuntu，但是在Windows环境下的步骤是一样的。</p><h1 id="369b" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">斯芬克斯怎么用？</h1><p id="2c1f" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">Sphinx使用<a class="ae je" href="https://docutils.readthedocs.io/en/sphinx-docs/user/rst/quickstart.html" rel="noopener ugc nofollow" target="_blank"> reStructuredText </a>作为它的标记语言。Sphinx生成文档的过程是这样的:</p><p id="ed89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">项目源代码(Python或其他支持的语言)——&gt;restructured text文件——&gt;文档(HTML或其他支持的格式)</em> </strong></p><p id="d389" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Sphinx提供了两个命令行工具:<strong class="ih hj"> sphinx-quickstart </strong>和<strong class="ih hj"> sphinx-apidoc </strong>。</p><ul class=""><li id="6a12" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><strong class="ih hj"> sphinx-quickstart </strong>设置一个源目录，并创建一个默认配置<code class="du ls lt lu kn b">conf.py</code>和一个主文档<code class="du ls lt lu kn b">index.rst</code>，作为文档的欢迎页面。</li><li id="851c" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><strong class="ih hj"> sphinx-apidoc </strong>从所有找到的模块生成重构的文本文件。</li></ul><p id="7aa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，我们使用这两个工具来生成Sphinx源代码，即reStructuredText文件，并且我们修改这些reStructuredText文件，最终使用Sphinx来构建优秀的文档。</p><h1 id="978f" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">工作流程</h1><p id="7411" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">正如软件需要开发人员的维护一样，编写软件文档也不是一蹴而就的。当软件改变时，它需要被更新。下图演示了基本的Sphinx工作流程。</p><figure class="ki kj kk kl fd kx er es paragraph-image"><div class="er es lv"><img src="../Images/63db3b28ac4f3842b0f760dde4a0fb86.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/0*_zg2oamMObhYzhcm.png"/></div></figure><p id="39f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下部分详细介绍了工作流程的每个步骤。</p><h1 id="4452" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">准备</h1><p id="9a31" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">在开始使用Sphinx之前，我们需要设置我们的工作环境。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="1c8c" class="kr jg hi kn b fi ks kt l ku kv">user@ubuntu:~$ python3.9 -m venv sphinxvenv<br/>user@ubuntu:~$ source sphinxvenv/bin/activate<br/>(sphinxvenv) user@ubuntu:~$ git clone https://github.com/shunsvineyard/python-sample-code.git<br/>(sphinxvenv) user@ubuntu:~$ cd python-sample-code/<br/>(sphinxvenv) user@ubuntu:~/python-sample-code$ python -m pip install -r requirements.txt</span></pre><p id="0b74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们有了Sphinx演示的样例项目和工作环境。因为示例项目已经包含docs文件夹，所以我们需要删除它。</p><p id="8376" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">删除docs文件夹后，示例项目的布局如下所示:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="fb1e" class="kr jg hi kn b fi ks kt l ku kv">├── LICENSE<br/>├── README.rst<br/>├── requirements.txt<br/>├── setup.py<br/>├── tests<br/>└── trees<br/>    ├── __init__.py<br/>    ├── __main__.py<br/>    ├── bin<br/>    │   ├── __init__.py<br/>    │   └── tree_cli.py<br/>    ├── binary_trees<br/>    │   ├── __init__.py<br/>    │   ├── avl_tree.py<br/>    │   ├── binary_search_tree.py<br/>    │   ├── binary_tree.py<br/>    │   ├── red_black_tree.py<br/>    │   ├── threaded_binary_tree.py<br/>    │   └── traversal.py<br/>    └── tree_exceptions.py</span></pre><h1 id="e6d4" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">步骤1:使用sphinx-quickstart生成包含conf.py和index.rst的sphinx源目录</h1><p id="124b" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">假设我们想把所有与文档相关的文件放在<code class="du ls lt lu kn b">docs</code>目录中。因此，我们首先创建一个Sphinx文档目录，<code class="du ls lt lu kn b">docs</code>。然后，我们转到<code class="du ls lt lu kn b">docs</code>目录并运行<code class="du ls lt lu kn b">sphinx-quickstart</code>。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="9e8b" class="kr jg hi kn b fi ks kt l ku kv">(sphinxvenv) user@ubuntu:~/python-sample-code$ mkdir docs<br/>(sphinxvenv) user@ubuntu:~/python-sample-code$ cd docs/<br/>(sphinxvenv) user@ubuntu:~/python-sample-code/docs$ sphinx-quickstart</span></pre><p id="9ae2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们运行<code class="du ls lt lu kn b">sphinx-quickstart</code>，它会询问一些关于这个项目的问题。以下是这些问题的示例答案。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="e461" class="kr jg hi kn b fi ks kt l ku kv">Welcome to the Sphinx 3.4.3 quickstart utility.<br/><br/>Please enter values for the following settings (just press Enter to<br/>accept a default value, if one is given in brackets).<br/><br/>Selected root path: .<br/><br/>You have two options for placing the build directory for Sphinx output.<br/>Either, you use a directory "_build" within the root path, or you separate<br/>"source" and "build" directories within the root path.<br/>&gt; Separate source and build directories (y/n) [n]: y<br/><br/>The project name will occur in several places in the built documentation.<br/>&gt; Project name: Sample Project<br/>&gt; Author name(s): Author<br/>&gt; Project release []: 0.0.1<br/><br/>If the documents are to be written in a language other than English,<br/>you can select a language here by its language code. Sphinx will then<br/>translate text that it generates into that language.<br/><br/>For a list of supported codes, see<br/>https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-language.<br/>&gt; Project language [en]: <br/><br/>Creating file /home/shunsvineyard/workspace/python-sample-code/docs/source/conf.py.<br/>Creating file /home/shunsvineyard/workspace/python-sample-code/docs/source/index.rst.<br/>Creating file /home/shunsvineyard/workspace/python-sample-code/docs/Makefile.<br/>Creating file /home/shunsvineyard/workspace/python-sample-code/docs/make.bat.<br/><br/>Finished: An initial directory structure has been created.<br/><br/>You should now populate your master file /home/shunsvineyard/workspace/python-sample-code/docs/source/index.rst and create other documentation<br/>source files. Use the Makefile to build the docs, like so:<br/>   make builder<br/>where "builder" is one of the supported builders, e.g. html, latex or linkcheck.</span></pre><p id="b6d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<code class="du ls lt lu kn b">sphinx-quickstart</code>的结尾，它展示了如何构建文档。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="b5ad" class="kr jg hi kn b fi ks kt l ku kv">You should now populate your master file ./source/index.rst and create other documentation<br/>source files. Use the Makefile to build the docs, like so:<br/>   make builder<br/>where "builder" is one of the supported builders, e.g. html, latex or linkcheck.</span></pre><p id="7c83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们在这里做<code class="du ls lt lu kn b">make html</code>，Sphinx将生成默认文档，其中不包含任何关于样本项目的内容。</p><figure class="ki kj kk kl fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kw"><img src="../Images/50cb002cfacfd97319b91337f26a2edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zQn6gUbLWpGlxxBW.png"/></div></div></figure><p id="3bb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:Sphinx不是一个像Doxygen一样提供全自动文档生成的工具。<code class="du ls lt lu kn b">sphinx-quickstart</code>只生成一些默认文件，如<code class="du ls lt lu kn b">index.rst</code>、<code class="du ls lt lu kn b">conf.py</code>等用户回答的基本信息。因此，我们需要做一些工作来使文件真实。</p><p id="3661" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行<code class="du ls lt lu kn b">sphinx-quickstart</code>后，文件夹的布局如下所示:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="afc1" class="kr jg hi kn b fi ks kt l ku kv">docs<br/>├── Makefile<br/>├── build<br/>├── make.bat<br/>└── source<br/>    ├── _static<br/>    ├── _templates<br/>    ├── conf.py<br/>    └── index.rst</span></pre><p id="b257" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意<code class="du ls lt lu kn b">Makefile</code>是针对Linux的，<code class="du ls lt lu kn b">make.bat</code>是针对Windows的。</p><h1 id="b26e" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">步骤2:配置conf.py</h1><p id="989f" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated"><code class="du ls lt lu kn b">sphinx-quickstart</code>生成几个文件，最重要的是<code class="du ls lt lu kn b">conf.py</code>，是文档的配置。虽然<code class="du ls lt lu kn b">conf.py</code>是一个配置文件，但它是一个真正的Python文件。<code class="du ls lt lu kn b">conf.py</code>的内容是Python语法。</p><p id="312a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Sphinx生成文档是高度可配置的。本节演示了最基本的配置:项目源代码的路径、文档的主题和扩展。</p><h2 id="f6ec" class="kr jg hi bd jh lw lx ly jl lz ma mb jp iq mc md jt iu me mf jx iy mg mh kb mi bi translated">设置项目的路径</h2><p id="552e" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">为了让Sphinx能够找到项目，我们需要取消对这三行的注释。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="95eb" class="kr jg hi kn b fi ks kt l ku kv"># import os<br/># import sys<br/># sys.path.insert(0, os.path.abspath('.'))</span></pre><p id="4099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并更新项目的路径。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="850e" class="kr jg hi kn b fi ks kt l ku kv">import os<br/>import sys<br/>sys.path.insert(0, os.path.abspath('../..'))</span></pre><h2 id="9ed4" class="kr jg hi bd jh lw lx ly jl lz ma mb jp iq mc md jt iu me mf jx iy mg mh kb mi bi translated">选择主题</h2><p id="74c2" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">Sphinx提供了许多内置主题。默认是<code class="du ls lt lu kn b">alabaster</code>。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="81cc" class="kr jg hi kn b fi ks kt l ku kv">html_theme = 'alabaster'</span></pre><p id="762a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将其改为<code class="du ls lt lu kn b">bizstyle</code>。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="be9c" class="kr jg hi kn b fi ks kt l ku kv">html_theme = 'bizstyle'</span></pre><p id="672c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多主题及其配置可以在https://www.sphinx-doc.org/en/master/usage/theming.html<a class="ae je" href="https://www.sphinx-doc.org/en/master/usage/theming.html" rel="noopener ugc nofollow" target="_blank">找到</a></p><h2 id="714c" class="kr jg hi bd jh lw lx ly jl lz ma mb jp iq mc md jt iu me mf jx iy mg mh kb mi bi translated">添加NumPy样式的扩展</h2><p id="92c8" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">示例项目对文档字符串使用NumPy样式。因此，我们需要添加扩展(napoleon)来解析NumPy样式的文档字符串。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="8af5" class="kr jg hi kn b fi ks kt l ku kv">extensions = [<br/>    'sphinx.ext.napoleon'<br/>]</span></pre><p id="621d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个扩展(napoleon)支持NumPy和Google风格的文档字符串，并提供了几个可配置的特性。对于示例项目，由于我们使用NumPy风格的文档字符串，我们应该禁用Google风格。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="fd71" class="kr jg hi kn b fi ks kt l ku kv">napoleon_google_docstring = False</span></pre><p id="bfee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">napoleon的其他设置可以在<a class="ae je" href="https://www.sphinx-doc.org/en/master/usage/extensions/napoleon.html#module-sphinx.ext.napoleon" rel="noopener ugc nofollow" target="_blank">https://www . sphinx-doc . org/en/master/usage/extensions/Napoleon . html # module-sphinx . ext . Napoleon</a>找到</p><p id="3373" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的conf.py示例可以在<a class="ae je" href="https://github.com/shunsvineyard/python-sample-code/blob/master/docs/source/conf.py" rel="noopener ugc nofollow" target="_blank">https://github . com/shunsvineyard/python-sample-code/blob/master/docs/source/conf . py</a>中找到。</p><p id="fb91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，Sphinx有许多内置扩展，也支持自定义扩展。要了解更多信息，请访问<a class="ae je" href="https://www.sphinx-doc.org/en/master/usage/extensions/index.html" rel="noopener ugc nofollow" target="_blank">https://www . sphinx-doc . org/en/master/usage/extensions/index . html</a></p><p id="4cda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们有了项目的基本配置。接下来，我们使用<code class="du ls lt lu kn b">sphinx-apidoc</code>从示例项目源代码中生成reStructuredText文件。</p><h1 id="61b6" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">步骤3:使用sphinx-apidoc从源代码生成reStructuredText文件</h1><p id="46ef" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated"><code class="du ls lt lu kn b">sphinx-apidoc</code>是一个从源代码自动生成reStructuredText文件的工具，例如Python模块。要使用它，请运行</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="0a1f" class="kr jg hi kn b fi ks kt l ku kv">$ sphinx-apidoc -f -o &lt;path-to-output&gt; &lt;path-to-module&gt;</span></pre><p id="2901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ls lt lu kn b">-f</code>表示强制覆盖任何现有的生成文件。</p><p id="04a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ls lt lu kn b">-o</code>表示放置输出文件的路径。</p><p id="84e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于示例项目，我们运行以下命令。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="b8d5" class="kr jg hi kn b fi ks kt l ku kv">(sphinxvenv) user@ubuntu:~/python-sample-code/docs$ sphinx-apidoc -f -o source/ ../trees/</span></pre><p id="c753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">狮身人面像-apidoc的完整用法在<a class="ae je" href="https://www.sphinx-doc.org/en/master/man/sphinx-apidoc.html" rel="noopener ugc nofollow" target="_blank">https://www.sphinx-doc.org/en/master/man/sphinx-apidoc.html</a>。</p><p id="caf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在示例项目中，<code class="du ls lt lu kn b">sphinx-apidoc</code>生成了几个文件，<code class="du ls lt lu kn b">modules.rst</code>、<code class="du ls lt lu kn b">trees.bin.rst</code>、<code class="du ls lt lu kn b">trees.binary_trees.rst</code>和<code class="du ls lt lu kn b">trees.rst</code>。项目的布局如下所示:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="36df" class="kr jg hi kn b fi ks kt l ku kv">docs<br/>├── Makefile<br/>├── build<br/>│   └── doctrees<br/>│       ├── environment.pickle<br/>│       └── index.doctree<br/>├── make.bat<br/>└── source<br/>    ├── _static<br/>    ├── _templates<br/>    ├── conf.py<br/>    ├── index.rst<br/>    ├── modules.rst<br/>    ├── trees.bin.rst<br/>    ├── trees.binary_trees.rst<br/>    └── trees.rst</span></pre><h1 id="b6a5" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">步骤4:编辑index.rst和生成的reStructuredText文件</h1><p id="b244" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated"><code class="du ls lt lu kn b">sphinx-quickstart</code>生成的另一个重要文件是<code class="du ls lt lu kn b">index.rst</code>。<code class="du ls lt lu kn b">index.rst</code>是作为欢迎页面的主控文档，包含“目录树”的根。当sphinx-quickstart创建index.rst时，toctree最初是空的。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="5bfb" class="kr jg hi kn b fi ks kt l ku kv">.. toctree::<br/>   :maxdepth: 2<br/>   :caption: Contents:</span></pre><p id="0658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">将模块添加到index.rst </strong></p><p id="b119" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成的<code class="du ls lt lu kn b">modules.rst</code>包含了所有的模块。所以我们需要将<code class="du ls lt lu kn b">modules.rst</code>添加到<code class="du ls lt lu kn b">index.rst</code>中。</p><p id="3507" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要添加要在欢迎页面上列出的文档(<code class="du ls lt lu kn b">index.rst</code>，请执行以下操作</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="840f" class="kr jg hi kn b fi ks kt l ku kv">.. toctree::<br/>   :maxdepth: 2<br/>   :caption: Contents:<br/><br/>   modules</span></pre><p id="78eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:当添加另一个reStructuredText文件时，请使用不带扩展名的文件名。如果文件有层次结构，请使用正斜杠“/”作为目录分隔符。</p><p id="5377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">将README.rst添加到index.rst </strong></p><p id="f991" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于示例项目已经有了一个readme文件<code class="du ls lt lu kn b">README.rst</code>，在项目的顶层，我们可以将它添加到文档的欢迎页面。</p><ol class=""><li id="2ea3" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc mj lk ll lm bi translated">在<code class="du ls lt lu kn b">docs/source</code>下创建一个readme.rst文件，并添加行<code class="du ls lt lu kn b">.. include:: ../../README.rst</code>。(参见<a class="ae je" href="https://github.com/shunsvineyard/python-sample-code/blob/master/docs/source/readme.rst" rel="noopener ugc nofollow" target="_blank">https://github . com/shunsvineyard/python-sample-code/blob/master/docs/source/readme . rst</a>)</li><li id="b84c" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc mj lk ll lm bi translated">将自述文件添加到<code class="du ls lt lu kn b">index.rst</code>，这样欢迎页面就会包含它。</li></ol><p id="5443" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这两个步骤之后，<code class="du ls lt lu kn b">index.rst</code>看起来像是:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="de02" class="kr jg hi kn b fi ks kt l ku kv">.. Sample Project documentation master file, created by<br/>   sphinx-quickstart on Wed Jan 13 23:24:14 2021.<br/>   You can adapt this file completely to your liking, but it should at least<br/>   contain the root `toctree` directive.<br/><br/>Welcome to Sample Project's documentation!<br/>==========================================<br/><br/>.. toctree::<br/>   :maxdepth: 2<br/>   :caption: Contents:<br/><br/>   readme<br/>   modules<br/><br/>Indices and tables<br/>==================<br/><br/>* :ref:`genindex`<br/>* :ref:`modindex`<br/>* :ref:`search`</span></pre><p id="473e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整示例见<a class="ae je" href="https://raw.githubusercontent.com/shunsvineyard/python-sample-code/master/docs/source/index.rst" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/shunsvineyard/python-sample-code/master/docs/source/index . rst</a>。</p><p id="a556" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:当我们添加一个新的模块、类、API或者任何影响文档的代码变更时，我们需要重复步骤3和步骤4来更新文档。</p><h1 id="fd4d" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">步骤5:构建文档</h1><p id="217c" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">生成文档的最后一步是发出<code class="du ls lt lu kn b"><strong class="ih hj">make html</strong></code>(如果我们想生成基于HTML的文档)。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="1cc1" class="kr jg hi kn b fi ks kt l ku kv">(sphinxvenv) user@ubuntu:~/python-sample-code/docs$ make html</span></pre><p id="f96f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们运行了<code class="du ls lt lu kn b">make html</code>命令之后，在docs下创建了一个构建文件夹。另外，基于HTML的文档位于<code class="du ls lt lu kn b">build/html</code>。生成的文档如下所示:</p><figure class="ki kj kk kl fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kw"><img src="../Images/20ef6bc6ef50c793aacac70d672cc86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uuOA3k1NxPGBuRiE.png"/></div></div></figure><h1 id="e6c8" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">结论</h1><p id="87c4" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">尽管我们仍然需要手动编辑生成的reStructuredText文件，但是Sphinx提供了一种更简单的方法来构建一个好的文档。它还具有通过<code class="du ls lt lu kn b">conf.py</code>和扩展进行配置和扩展的能力。要了解关于Sphinx的更多信息，请查看以下在线资源:</p><ul class=""><li id="1b03" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><a class="ae je" href="https://www.sphinx-doc.org" rel="noopener ugc nofollow" target="_blank">斯芬克斯官网</a></li><li id="a83b" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" href="https://github.com/yoloseem/awesome-sphinxdoc" rel="noopener ugc nofollow" target="_blank">令人敬畏的狮身人面像</a></li><li id="d25b" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" href="http://docutils.sourceforge.net/rst.html" rel="noopener ugc nofollow" target="_blank"> reStructuredText官网</a></li><li id="82d3" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" href="http://docutils.sourceforge.net/docs/user/rst/quickref.html" rel="noopener ugc nofollow" target="_blank">重组文本快速启动</a></li></ul></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><p id="72d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">原载于2019年9月20日</em><a class="ae je" href="https://shunsvineyard.info/2019/09/19/use-sphinx-for-python-documentation/" rel="noopener ugc nofollow" target="_blank"><em class="jd">https://shunsvineyard . info</em></a><em class="jd">。</em></p></div></div>    
</body>
</html>