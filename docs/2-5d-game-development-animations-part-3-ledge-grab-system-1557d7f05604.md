# 2.5D 游戏开发:动画:第 3 部分——壁架抓取系统

> 原文：<https://medium.com/nerd-for-tech/2-5d-game-development-animations-part-3-ledge-grab-system-1557d7f05604?source=collection_archive---------14----------------------->

在这篇文章中，我将介绍如何设置一个壁架抓取系统。

首先，我需要一个简单的悬挂在壁架上的动画。

![](img/319036568e0fb5cb07ca7242defe245b.png)

当我把这些都设置好之后，我需要决定我最有可能从哪部动画开始过渡。跑跳是最有可能的地方，所以我在从跑跳过渡到悬空的时候设置了一些条件。

![](img/1213a5bbd135157bd12e04b574149355.png)

正如您在这里看到的，我将名为“LedgeGrab”的条件设置为 true，以启动转换。所以现在的问题是:我什么时候在代码中将它设置为 true？

我实际上设置了几个触发碰撞器。一个在实际的壁架上，另一个就在玩家的头顶上方。我实际上是把它放在玩家的上方，这样玩家的手就能碰到它。

![](img/935eccf8871b5c0a8ab88554b7a9e958.png)

玩家及其属性上的碰撞器

![](img/8558035ee18c7320708ac958e0d27dfa.png)

壁架对撞机及其特性

正如你所看到的，我做了一个新的脚本，并把它附加到壁架碰撞器上。我们去看看。

![](img/ed09a811de5a9dc3a9d56746ffc13a5f.png)

我一会儿会谈到手的位置和站立的位置变量。现在我想检查与 Ledge_Grab_Checker 的冲突，并调用播放器脚本中的辅助方法 create。

![](img/c4e1fa60e4bd0a20f12f1664822936ff.png)

该方法将 onLedge 设置为 true，禁用控制器，并将我们在 animator 中创建的 bool 设置为 true，从而触发动画。我想把位置更新为手的位置。因此，我需要在动画触发后暂停游戏，然后将玩家移动到靠近壁架的边缘，以便玩家的位置与壁架对齐。

我给出了 handPosition 和 standPosition serializefield 属性，这样我可以在检查器中调整它们。

![](img/22df40812d30d0b816ad9cedb7f6acbe.png)![](img/8719a7d16dbeac14e020e92756e3e228.png)

然后我需要让玩家能够通过按 e 键把自己拉上来，这相当简单直接。

找到一个向上爬的动画，添加到动画师。显然，您只需要在退出悬挂空闲动画时使用向上攀爬动画，因此从那里创建一个过渡。

我为此设置了一个触发条件。

![](img/659594a80b31381a4324fdd73b6b566e.png)

很简单。但是当玩家向上爬时，角色控制器仍然从悬挂设置为真时起被禁用。所以我需要在玩家站起来的时候在他们的位置重新激活它。

我在播放器脚本中设置了一个 ClimbComplete 函数。

![](img/0c213122170a62f3eb7ea10e1f262b59.png)

这将使用 GetStandPos() helper 方法将玩家的位置设置为我们在 LedgeGrab 脚本中确定的 standPosition，该方法只返回 standPosition。

![](img/0ccadb44bc5042a810b13190d87cda3d.png)

在攀爬动画上，我添加了一个行为脚本。这个脚本在动画的特定部分处理特定的事情。我想让角色控制器保持停用状态，但移动到玩家的新位置，所以下面的脚本对此有所帮助。

![](img/4b6c82935f8e73737bcccc96dd6209b2.png)

因此，一旦动画完成，它将调用播放器脚本中的 ClimbUpComplete()方法。

然后我从那过渡到站立的动画。一旦它完成，角色控制器通过玩家脚本中的 StandUpComplete()方法被重新激活。

![](img/2cb559b13babf425e3c6f5b09cfd247c.png)![](img/b6913ff8a913b2b5911e47761e1309dc.png)

所以现在我可以跑，跳，抓住窗台，按 E，爬上来，站起来，然后再开始移动！

在下一篇文章中，我将介绍如何设置当你按下左 Shift 键时的滚动动画。

![](img/d3ba3b877acd2592af90255c51e3e574.png)