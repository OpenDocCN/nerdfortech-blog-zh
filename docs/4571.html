<html>
<head>
<title>Implementing a game manager using the Singleton pattern | Unity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用单例模式实现游戏管理器</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/implementing-a-game-manager-using-the-singleton-pattern-unity-eb614b9b1a74?source=collection_archive---------1-----------------------#2021-07-27">https://medium.com/nerd-for-tech/implementing-a-game-manager-using-the-singleton-pattern-unity-eb614b9b1a74?source=collection_archive---------1-----------------------#2021-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="1125" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">统一指南</h2><div class=""/><div class=""><h2 id="e124" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">关于如何使用Unity的单例模式实现游戏管理器的快速指南</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/db8a087bfc3462c593059312846678a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YRypOF4-ZdlqMBfqnBar7A.gif"/></div></div></figure><p id="3040" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated"><strong class="ju hs">目标</strong>:通过在Unity中应用Singleton模式来管理一个简单的游戏机制，实现一个游戏管理器实例。</p><p id="0ad0" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">在上一篇文章中，我介绍了<a class="ae ko" rel="noopener" href="/nerd-for-tech/triggering-a-finished-cutscene-unity-42007f1b4ce4">如何触发一个完成的过场动画，然后用Unity </a>返回游戏。现在，是时候实现一个游戏管理器来处理一个简单的情况了。</p><h1 id="63cc" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">创建游戏管理器</h1><p id="515b" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">为了实现游戏管理器，让我们首先创建一个新的脚本:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es lm"><img src="../Images/633d29a9c7c4d8d64ce1731236172b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/1*y5d43Ud_2uQlZA1av8v5DA.gif"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">因为<strong class="bd kr"> <em class="lr"> GameManager </em> </strong>名称是Unity中的保留关键字，所以脚本显示为齿轮图标。</figcaption></figure><p id="afa1" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">现在，让我们为游戏管理器创建一个新的空游戏对象，并通过检查器附加相应的脚本:</p><div class="jh ji jj jk fd ab cb"><figure class="ls jl lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/324cbe7cc6c1a3edd5651e04825723a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/1*ffZXjm1MNkUO589lmwWUEw.gif"/></div></figure><figure class="ls jl ly lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/a90923dfefa8558c4f6529c4b4a5405f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/1*GzWquP4tgjpfGwRWOXqFIA.gif"/></div></figure></div><h1 id="dfcb" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">应用单例模式</h1><p id="846c" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">单例模式意味着场景中只存在一个类单元(应用了该模式)。在这种情况下，单例模式有助于确保每种类型只有一个管理器(游戏管理器、音频管理器、UI管理器、AI管理器等)。)，所以我们可以用它来处理我们游戏的游戏管理器。</p><p id="7730" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">所以，为了应用单例模式，让我们打开<strong class="ju hs">游戏管理器</strong>脚本。让我们首先创建一个新的<strong class="ju hs">私有</strong>(以确保只有该类可以修改它)和<strong class="ju hs">静态</strong>(以确保它被该类的所有实例共享)类型的<strong class="ju hs"> GameManager </strong>变量，它们将保存该类各自的唯一实例:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lz"><img src="../Images/4b7bd887b93042b0cd9c614446abb1c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ubHDmz5YQoh8BVXbZiaypw.png"/></div></div></figure><p id="7f42" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">然后，为了能够从其他类访问这个惟一的实例，让我们用一个<strong class="ju hs"> get </strong>选项创建一个新的公共<strong class="ju hs">属性</strong>。在get选项中，我们将检查上面的私有静态实例是否为空，以表明游戏管理器为空(如果是这种情况)，然后，我们将返回要读取的相应实例:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ma"><img src="../Images/9984f717976c36f03363377aa687030c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEHk07I4SJvHNOeYaF4nbQ.png"/></div></div></figure><p id="680a" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">现在，为了初始化私有实例，我们需要使用<strong class="ju hs">唤醒/启动</strong>方法:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mb"><img src="../Images/556ffe4c9872bdfce5db818be00a782a.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*pHLwFNGlmVNb6GV_a-5Z7Q.png"/></div></figure><blockquote class="mc md me"><p id="961b" class="js jt mf ju b jv jw is jx jy jz iv ka mg kc kd ke mh kg kh ki mi kk kl km kn hb bi translated">注意:当我们需要在游戏中使用它并提高性能时，我们也可以使用惰性实例化来创建相应的管理器。</p></blockquote><p id="3999" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">最后，为了展示游戏管理器singleton的可能用途，让我们创建一个新的<strong class="ju hs"> auto public bool属性</strong>，可以分别用<strong class="ju hs"> get </strong>和<strong class="ju hs"> set </strong>来访问或修改。该属性将定义玩家是否已经从沉睡的守卫那里获得了卡来完成关卡:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mj"><img src="../Images/25f3948d51f98b4aae5a9b2e8e65db1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*eGHEDkrSMVP-VJbdHXYQyw.png"/></div></figure><h2 id="f165" class="mk kq hi bd kr ml mm mn kv mo mp mq kz kb mr ms lb kf mt mu ld kj mv mw lf ho bi translated">修改实例的属性</h2><p id="b598" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">如果你读了<a class="ae ko" rel="noopener" href="/nerd-for-tech/triggering-a-finished-cutscene-unity-42007f1b4ce4">上一篇文章</a>，你会记得我们触发了过场动画，玩家使用<strong class="ju hs"> OnTriggerEnter </strong>方法从一个睡着的警卫手里抢走了一张钥匙卡。因此，为了定义钥匙卡被抓取，我们可以选择通过从触发过场动画的类中调用游戏管理器实例及其属性来修改属性:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mx"><img src="../Images/4a84d2cd4e4d124da914de787945c083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2nOfetcW1r_QAWqTL39o1w.gif"/></div></div></figure><p id="abbf" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">这样，我们将能够根据玩家是否有钥匙卡来检查最后一个过场动画是否应该被触发。</p><h2 id="1f70" class="mk kq hi bd kr ml mm mn kv mo mp mq kz kb mr ms lb kf mt mu ld kj mv mw lf ho bi translated">检查实例的属性</h2><p id="6263" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">所以，让我们把同样的机制(就像在<a class="ae ko" rel="noopener" href="/nerd-for-tech/triggering-a-finished-cutscene-unity-42007f1b4ce4">的最后一个帖子</a>)应用到最后一个过场动画。我们有一个带有碰撞器和刚体的游戏对象，当玩家接近门时触发最后一个过场动画:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/e8e51a1efc10908f98faaedb8adefd7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1LQbXoBmbNfpS1AsGmlkw.png"/></div></div></figure><p id="bdca" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">然后，使用<strong class="ju hs"> OnTriggerEnter </strong>方法，我们将能够通过访问游戏管理器实例及其属性来检查是否已经抓取了钥匙卡:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es my"><img src="../Images/525b4a6c4ab3e9037f668dee971e367a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jEAgIOI6w_WfznWbMpn99g.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">如果来自<strong class="bd kr">游戏管理器</strong>实例的<strong class="bd kr"> GotKeyCard </strong>属性为真，将触发最后一个过场动画。</figcaption></figure><p id="4b7c" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">如果我们获取相应的钥匙卡并尝试触发最后一个过场动画，我们会注意到游戏管理器实例的属性按预期工作:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/7bce4668529afe3cf4ccbbe1e1af6e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QgqIO7R1iRvYhmQu9NkjvQ.gif"/></div></div></figure><p id="731d" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">就这样，我们通过应用Unity的单例模式实现了一个游戏管理器！:d .下一篇文章再见，我将展示如何用Unity创建一个装载场景。</p></div><div class="ab cl mz na gp nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="hb hc hd he hf"><blockquote class="mc md me"><p id="696c" class="js jt mf ju b jv jw is jx jy jz iv ka mg kc kd ke mh kg kh ki mi kk kl km kn hb bi translated"><em class="hi">如果你想了解我更多，欢迎登陆</em><a class="ae ko" href="https://www.linkedin.com/in/fas444/" rel="noopener ugc nofollow" target="_blank"><strong class="ju hs"><em class="hi">LinkedIn</em></strong></a><strong class="ju hs"><em class="hi"/></strong><em class="hi">或访问我的</em> <a class="ae ko" href="http://fernandoalcasan.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hs"> <em class="hi">网站</em> </strong> </a> <em class="hi"> :D </em></p></blockquote></div></div>    
</body>
</html>