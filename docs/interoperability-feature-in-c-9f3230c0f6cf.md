# C#中的互操作性特性

> 原文：<https://medium.com/nerd-for-tech/interoperability-feature-in-c-9f3230c0f6cf?source=collection_archive---------15----------------------->

![](img/1b45d2bab99a2fbe602a1d5865f8aab5.png)

互操作性是指一个系统与另一个系统的组件进行通信的能力。为了详细理解它，让我们考虑一个电子商务系统的后端，其中有两个核心功能

*   维护不同订单的历史数据
*   根据包裹的位置和运送地点自动包装和隔离物品。

现在让我们假设订单信息的维护是使用 C#语言完成的。另一方面，打包和分离工具是用 C++开发的。

每当订单准备发货时，物品被放置在流经包装系统的传送带上。随后根据位置数据的需要对其进行分离。为了跟踪传送带中的包裹，一旦包裹通过传送带，包装系统必须更新状态。因此，打包系统是一个独立的系统，它需要向运行在服务器上的基于 C#的主代码发送更新。

此外，当包裹到达隔离系统时，隔离系统需要包裹需要移动到的位置。所以，现在，打包系统需要从 C++系统到 C#系统的通信。类似地，隔离系统需要将数据从 C++系统发送到 C#系统。这意味着我们需要用一种支持多个系统的编程语言来开发我们的应用程序，并为公司完成工作。幸运的是，C#的互操作性使得实现这一点变得很容易。让我们详细看看 C#中的互操作性特性是什么，以及它是如何有用的。

**目录**

1.  C#中的互操作性是什么？
2.  C#中的互操作性可能性
3.  结论

# C#中的互操作性是什么？

互操作性是使不同的编程语言能够在同一系统中交互的属性。这有助于实现一个共同的目标，并利用已有的代码。在 C#中，当涉及到互操作性时，使用 C#语言编写的代码将由 IDE 附带的编译器进行验证，并且代码的内存管理也将得到关注。

此外，如果 DLL 被称为外部引用，并且外部包是用可以自我管理的编程语言编写的，则它被视为托管代码。如果不是这样，C#编译器会将它视为非托管代码。C#允许以 DLL 的形式包含托管和非托管代码作为外部引用。

# C#中的互操作性可能性

## 使用托管代码

托管代码是指互相使用用 VB.Net 或 C#编写的代码。例如，正在用 C#开发一个功能，而在 VB 中也需要同样的功能。Net 项目。尽管它们来自不同的编程语言。Net 通过 DLL(动态链接库)的概念交换它们被开发的位置，提供了引用它们的选项。

。Net 提供了创建类库的选项，方法是添加类库项目并在其中编写代码逻辑。一旦构建完成，C#或 built 代码就会生成该功能的 DLL。这个 DLL 可以很容易地作为引用添加到这两个地方，从而达到代码重用的目的。它提供了用原始语言完成功能的额外成本优势。

## 使用非托管代码

为了理解 C#中非托管代码可用的互操作性选项，我们需要了解关于 COM 的一切。组件对象模型，通常称为 COM，是最早发明的允许组件二进制重用的技术之一。它使得为用不同编程语言编写的程序提供接口成为可能。COM 使用 GUID 来标识捆绑在一起的唯一成员。它允许为每个 GUID 注册一个 DLL。

从使用 COM 组件。Net 项目:正如我们在上面看到的，COM 公开接口来进行通信。但是，基于. Net 的客户端无法直接使用 COM 公开的接口，因为它无法理解该接口。因此，必须围绕 COM 组件定义一个包装器，以使代码对于。Net 客户端。这里，包装器被称为运行时可调用包装器(RCW)。可以通过 VS.NET 生成 RCW，当客户端调用 COM 中的功能时，调用将通过 RCW，并转换为本机 COM 调用过程。此外，当涉及到 COM 组件时，继承、参数化构造函数等功能。不能被利用。

**吞噬。来自 COM 客户端的. Net 组件**:让我们考虑相反的场景。就像运行时可调用包装器一样。Net 客户端来识别。在这种情况下，必须创建 COM 可调用包装(CCW)。它可以使用作为的一部分提供的 RegAsm.exe 来创建。净效用。当从 COM 组件发出调用时，该调用通过 CCW 进行路由，CCW 又将本机 COM 调用转换为。Net 可理解的格式，并以类似方式转换响应。

# 结论

。Net 提供了在托管代码和非托管代码之间进行通信的选项。托管代码中的通信是通过直接引用 dll 实现的，而在非托管代码中，它是通过 RCW 和 CCW 的概念实现的。

*原载于*[*https://www . partech . nl*](https://www.partech.nl/nl/publicaties/2021/03/interoperability-feature-in-c-sharp)*。*