<html>
<head>
<title>A step by step guide to create a containerized spring boot application in order to secure application-level data transport by using a self signed certificate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建容器化spring boot应用程序的分步指南，通过使用自签名证书来保护应用程序级数据传输</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/a-step-by-step-guide-to-create-a-containerized-spring-boot-application-in-order-to-secure-8ecbc8defc36?source=collection_archive---------0-----------------------#2020-11-04">https://medium.com/nerd-for-tech/a-step-by-step-guide-to-create-a-containerized-spring-boot-application-in-order-to-secure-8ecbc8defc36?source=collection_archive---------0-----------------------#2020-11-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e28359653eead1944f1a85fd54ef12c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*saeLMixfCvsUcfXK"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@jordanharrison?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔丹·哈里森</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="7afd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大家好，让我分享一下我的经验，如何在开发环境中从头开始为Spring Boot应用程序启用安全的应用程序级数据传输支持。</p><h2 id="36b6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">我们所说的SSL和TLS是什么意思？</h2><p id="1456" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">SSL(安全套接字层)和TLS(传输层安全性)都是加密协议，SSL是TLS的前身，现在已被弃用。这两种协议都用于在web服务器和web浏览器之间创建加密连接。</p><h2 id="54db" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">我们所说的自签名SSL证书和证书颁发机构(CA)签名SSL证书是什么意思？</h2><p id="1b25" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">自签名SSL证书是一种安全证书，用于非生产环境，以便测试SSL端点功能，因为它易于创建且不需要成本。但是，不建议在生产环境中使用，因为它不提供所有的安全证书。</p><p id="cf79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">证书颁发机构(CA)签署的SSL证书也是安全证书，但它由证书颁发机构(CA)签署并提供所有安全证书，是生产环境的标准，并且涉及成本。</p><h2 id="4d8a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">让我们考虑一个支持SSL或HTTPs的spring boot应用程序。</h2><p id="83b6" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">作为一个示例，我不会使用CA签名的SSL证书，而是使用自签名的SSL证书。</p><h2 id="ed07" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">如何创建自签名证书？</strong></h2><p id="4273" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">在这个例子中，我将使用JDK的keytool来生成一个PKCS 12格式的自签名证书。我使用的是windows机器，我已经使用这个命令打开了一个终端来生成keytool。</p><p id="1bc1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">keytool-genkey pair-keyalg RSA-keysize 2048-storetype PKCS12-keystore key-cert-mousumi . p12-validity 365</strong></p><ul class=""><li id="a4b2" class="kt ku hi ix b iy iz jc jd jg kv jk kw jo kx js ky kz la lb bi translated">genkeypair(生成密钥对)</li><li id="978f" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">密钥大小(密钥的大小)</li><li id="f678" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">storetype(密钥库格式)</li><li id="de2c" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">密钥库(是存储私钥、证书和对称密钥的存储库)</li></ul><p id="47f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦你输入这个命令，你会得到一系列的指示，如下图所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/f556c4446bd2ef5b25987fd9bf2cb99d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Kk70EK0NhyfSU7TrkQ3ig.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">键盘工具命令</figcaption></figure><p id="87a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于PKCS 12格式的更多信息，你可以参考这个链接-<a class="ae iu" href="https://en.wikipedia.org/wiki/PKCS_12" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/PKCS_12</a></p><p id="7255" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦命令被执行，你将在这个文件夹下得到一个证书，如下图所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/82709ad610408f315b09980d7c86a204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VqZF66-CpPPADuPZqYNQFg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">自签名SSL证书</figcaption></figure><p id="c25f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我将使用gradle创建一个简单的spring boot应用程序。</p><p id="8d5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我已经创建了一个spring boot应用程序，并用最少的spring-boot jar配置了build.gradle文件。</p><h2 id="037c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">下面是我的build.gradle文件。</h2><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/747ea730e5458b0efee5e78a4a8ae8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iDMFsvtVrb7HwrLGAvLBzA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">build.gradle</figcaption></figure><p id="f56d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我将创建一个主spring-boot类，如下所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/3cd63e3c14997df569ce32fa4b00a6d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rybg6VgkrPLa5NilNeNZjw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Application.java</figcaption></figure><p id="317b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们需要在resources文件夹下添加自签名SSL证书，如下图所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/09d1e6df9ac44cfa718435123f83efce.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*bsCejKPd-Qrm966FFQbgnA.png"/></div></figure><p id="aa5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们需要将SSL细节添加到application.properties文件中。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/76e968ab3ac77bcadaf7b4089c0884c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTBd1deLO-Pzxxac4AKGKA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">应用程序.属性</figcaption></figure><p id="1554" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们创建了一个安全的spring boot应用程序。</p><p id="43c4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了测试这个应用程序，我们可以启动spring boot应用程序并点击这个URL<a class="ae iu" href="https://localhost:8443/" rel="noopener ugc nofollow" target="_blank">https://localhost:8443/</a>。下面是屏幕。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/c7aed28c2a9d66d1d7da4f68bebd245e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHmYDguEcYQsMmiBOjxOsQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">安全spring boot应用程序的网页</figcaption></figure><p id="cdaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如我们看到的，spring boot应用程序运行在一个安全的网络上，我们可以创建spring boot应用程序的容器化映像。</p><blockquote class="ls lt lu"><p id="00cc" class="iv iw lv ix b iy iz ja jb jc jd je jf lw jh ji jj lx jl jm jn ly jp jq jr js hb bi translated"><strong class="ix hj">注意:如果你用命令手动创建一个图像，那么总是构建最新的代码，这样所有的改变都会反映在docker容器中。</strong></p></blockquote><p id="b284" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，我们将创建一个docker文件，如下图所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/9617b60d9d5bd5bfb7580d1ba13fcfb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S615wQrJYFV73g6wLzM0nQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Dockerfile文件</figcaption></figure><p id="fa1f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">之后，我们将使用docker build命令构建docker映像，如下图所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/d04af5829a75b46d6ca9d1de5453a62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4M7k1XoJb2zF-pYm-S1JEA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">docker构建命令</figcaption></figure><p id="a855" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将使用如下屏幕所示的命令检查docker图像。</p><blockquote class="ls lt lu"><p id="6866" class="iv iw lv ix b iy iz ja jb jc jd je jf lw jh ji jj lx jl jm jn ly jp jq jr js hb bi translated"><strong class="ix hj">忽略安全警告</strong></p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/de11ba91b3d353e0375e63c370112978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-WSifnxSrLCbMX2M1ys5Rg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">docker图像命令</figcaption></figure><p id="a209" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将使用下面屏幕所示的命令运行docker映像。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/3b7d20284cfb7f280e377e3abc494605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AF7cb2bRhRqpEd7FB_BH5w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">docker运行命令</figcaption></figure><p id="c4d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将使用下面屏幕中显示的命令检查容器是否启动并运行。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/ecbe56ac414041892df682be6e0ddff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8c7vkIK_VMiD2231Lhsbg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">docker ps命令</figcaption></figure><p id="95e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们将检查docker日志，以确保spring boot应用程序启动并运行，方法是使用下面屏幕中所示的docker命令。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/eda7e3a6349a2e318ce1954b201cde63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNPc99zmkyjnZ8_iTRTvUA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">docker日志命令</figcaption></figure><p id="1f41" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面屏幕中的最后一行清楚地表明应用程序已经启动并正在运行。</p><p id="d340" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="lv">关于docker形象创作的详细信息，可以查看我的其他故事。</em>T9】</strong></p><p id="2f04" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" rel="noopener" href="/@hazarika.mousumi.ghy/a-step-by-step-guide-on-how-to-create-and-build-a-docker-image-for-a-java-application-1531ee2d6ae6"><strong class="ix hj"><em class="lv">https://medium . com/@ hazarika . mousumi . ghy/a-step-by-step-guide-on-how-to-create-and-build-a-docker-image-for-a-Java-application-1531 eed 6 AE 6</em></strong></a></p><p id="7596" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们确定应用程序正在运行，我们将尝试在web浏览器中点击相同的url，即<a class="ae iu" href="https://localhost:8443/" rel="noopener ugc nofollow" target="_blank">https://localhost:8443/</a>。</p><p id="3e93" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是网络浏览器的屏幕，这表明给定图像的容器正在成功运行。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/6634b079ed0ac21a20bf8a4ffaab574f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKw0Z-pVZtsH1ieGPIilVA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">网页浏览器</figcaption></figure><p id="4cf2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是如何使用自签名SSL证书创建安全的spring boot应用程序。</p><blockquote class="ls lt lu"><p id="0df2" class="iv iw lv ix b iy iz ja jb jc jd je jf lw jh ji jj lx jl jm jn ly jp jq jr js hb bi translated"><strong class="ix hj">虽然自签名SSL证书不是生产环境的标准，但如果您想在本地开发环境中测试应用程序，它们是很好的选择。</strong></p></blockquote><p id="e62d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望这对我的开发伙伴有所帮助。</p><p id="7d8e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我个人认为，在开发环境中创建一个安全的应用程序本身对你很有帮助，如果你正在构建一个尚未准备好投入生产的应用程序，需要与其他安全的应用程序集成并处理CORS。请分享你的反馈，无论谁读了这篇文章，这将在某种程度上鼓励我。T3】</p><p id="d04a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">【https://github.com/mousumi8/spring-boot/tree/master】GitHub链接:<a class="ae iu" href="https://github.com/mousumi8/spring-boot/tree/master" rel="noopener ugc nofollow" target="_blank"/></p><p id="f79e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">参考资料:</strong><a class="ae iu" href="https://docs.oracle.com/javase/9/tools/keytool.htm" rel="noopener ugc nofollow" target="_blank">https://docs.oracle.com/javase/9/tools/keytool.htm</a>，<a class="ae iu" href="https://en.wikipedia.org/wiki/PKCS_12" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/PKCS_12</a>，<a class="ae iu" href="https://spring.io/" rel="noopener ugc nofollow" target="_blank">https://spring.io/</a>，<a class="ae iu" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">https://www.docker.com/</a></p></div></div>    
</body>
</html>