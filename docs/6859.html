<html>
<head>
<title>The Wonders of GNU and OCI (docker) Containers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GNU 和 OCI 集装箱的奇迹</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/the-wonders-of-gnu-and-oci-docker-containers-7fd2bc906fb3?source=collection_archive---------2-----------------------#2022-05-30">https://medium.com/nerd-for-tech/the-wonders-of-gnu-and-oci-docker-containers-7fd2bc906fb3?source=collection_archive---------2-----------------------#2022-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="b976" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">创建下载、编译和创建 OCI 兼容容器的管道。</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/c483d12c2b74d59db4ea0aecdf1280e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kO4WWWdnGgqpchOynAa5g.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">照片由<a class="ae jx" href="https://unsplash.com/@timelabpro?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Timelab Pro </a>在<a class="ae jx" href="https://unsplash.com/s/photos/containers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="385e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">我偶然发现了一些旧的奇怪的文件格式，扩展名为<code class="du kb kc kd ke b">.ccd</code>属于现在已经不存在的<em class="ik">克隆 CD </em>应用程序，那是在 21 世纪初风靡一时的。该程序最初是由一家名为*Slysoft*的公司创建的，当被各种实体针对时，该程序被替换为<a class="ae jx" href="https://en.wikipedia.org/wiki/RedFox" rel="noopener ugc nofollow" target="_blank"> <em class="ik"> Redfox </em> </a>，这些实体反对在拷贝或一般 CD 拷贝时绕过数字版权管理(DRM)。</p><p id="8bcb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">大多数转换<code class="du kb kc kd ke b">.ccd</code>格式的工具都是为 Windows 设计的，但是也有一些 GNU/Linux 环境的开源工具，比如<code class="du kb kc kd ke b"><a class="ae jx" href="https://github.com/jkmartindale/ccd2iso" rel="noopener ugc nofollow" target="_blank">ccd2iso</a></code>和<code class="du kb kc kd ke b"><a class="ae jx" href="https://www.gnu.org/software/ccd2cue/" rel="noopener ugc nofollow" target="_blank">ccd2cu</a>e</code>。后者没有用于<em class="ik"> Ubuntu </em>的软件包，因此这是一个展示容器和开源软件奇迹的机会！</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es kf"><img src="../Images/51a8cf9af3ca20646fa7cddc7b5f2f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ykCbB5L2E7D3udCCfYpUiw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">数据科学指南作者:<a class="ae jx" href="https://aero-data-science.medium.com/" rel="noopener"> Ashraf Miah </a> |图片作者</figcaption></figure><h2 id="ee3e" class="kg kh hi bd ki kj kk kl km kn ko kp kq jy kr ks kt jz ku kv kw ka kx ky kz la bi translated">手动编译</h2><p id="2e29" class="pw-post-body-paragraph ii ij hi il b im lb io ip iq lc is it jy ld iw ix jz le ja jb ka lf je jf jg hb bi translated">在使用<code class="du kb kc kd ke b">x86_64</code>架构的 Ubuntu 20.04 主机上，下载源文件，安装典型的构建工具和 C 编译器，比如<code class="du kb kc kd ke b">gcc:</code></p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="66e7" class="kg kh hi ke b fi lk ll l lm ln"># Create suitable directory<br/>mkdir -p source/ccd2cue</span><span id="30dc" class="kg kh hi ke b fi lo ll l lm ln"># Change into directory<br/>cd source/ccd2cue</span><span id="1b95" class="kg kh hi ke b fi lo ll l lm ln"># Download source files<br/>wget <a class="ae jx" href="https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz" rel="noopener ugc nofollow" target="_blank">https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz</a></span><span id="1dd1" class="kg kh hi ke b fi lo ll l lm ln"># Untar<br/>tar xvzf ccd2cue-0.5.tar.gz</span><span id="64ac" class="kg kh hi ke b fi lo ll l lm ln"># Change into source directory<br/>cd ccd2cue-0.5</span></pre><p id="12d4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">安装说明可以概括为:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="18f5" class="kg kh hi ke b fi lk ll l lm ln"># Check configuration<br/>./configure</span><span id="7423" class="kg kh hi ke b fi lo ll l lm ln"># Make artifacts<br/>make</span><span id="5a3c" class="kg kh hi ke b fi lo ll l lm ln"># Install (using privileged account)<br/># if installing in default or secure<br/># path.  On Ubuntu can use sudo:<br/>sudo make install</span></pre><p id="9802" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">运行<code class="du kb kc kd ke b">./configure</code>将显示缺少 C 编译器，像<code class="du kb kc kd ke b">make</code>这样的基本构建工具也是如此。这可以通过以下方法来纠正:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="ecfa" class="kg kh hi ke b fi lk ll l lm ln"># Install dependencies<br/>sudo apt install build-essential gcc</span></pre><p id="a715" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">检查配置:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="6f57" class="kg kh hi ke b fi lk ll l lm ln"># Check configuration<br/>./configure</span><span id="b55b" class="kg kh hi ke b fi lo ll l lm ln">checking for a BSD-compatible install... /usr/bin/install -c<br/>checking whether build environment is sane... yes<br/>checking for a thread-safe mkdir -p... /usr/bin/mkdir -p<br/>checking for gawk... gawk<br/>checking whether make sets $(MAKE)... yes<br/>checking whether make supports nested variables... yes<br/>checking whether make supports nested variables... (cached) yes<br/>checking whether NLS is requested... yes<br/>checking for msgfmt... no<br/>checking for gmsgfmt... :<br/>checking for xgettext... no<br/>checking for msgmerge... no<br/>checking for style of include used by make... GNU<br/>checking for gcc... gcc<br/>checking whether the C compiler works... yes<br/>checking for C compiler default output file name... a.out<br/>checking for suffix of executables... <br/>checking whether we are cross compiling... no<br/>checking for suffix of object files... o<br/>checking whether we are using the GNU C compiler... yes<br/>checking whether gcc accepts -g... yes<br/>checking for gcc option to accept ISO C89... none needed<br/>checking whether gcc understands -c and -o together... yes<br/>checking dependency style of gcc... gcc3<br/>checking build system type... x86_64-unknown-linux-gnu<br/>checking host system type... x86_64-unknown-linux-gnu<br/>checking for ld used by GCC... /usr/bin/ld<br/>checking if the linker (/usr/bin/ld) is GNU ld... yes<br/>checking for shared library run path origin... done<br/>checking how to run the C preprocessor... gcc -E<br/>checking for grep that handles long lines and -e... /usr/bin/grep<br/>checking for egrep... /usr/bin/grep -E<br/>checking for CFPreferencesCopyAppValue... no<br/>checking for CFLocaleCopyCurrent... no<br/>checking for GNU gettext in libc... yes<br/>checking whether to use NLS... yes<br/>checking where the gettext function comes from... libc<br/>checking whether ln -s works... yes<br/>checking for grep that handles long lines and -e... (cached) /usr/bin/grep<br/>checking for a sed that does not truncate output... /usr/bin/sed<br/>checking for gcc... (cached) gcc<br/>checking whether we are using the GNU C compiler... (cached) yes<br/>checking whether gcc accepts -g... (cached) yes<br/>checking for gcc option to accept ISO C89... (cached) none needed<br/>checking whether gcc understands -c and -o together... (cached) yes<br/>checking dependency style of gcc... (cached) gcc3<br/>configure: checking programs needed in order to build documentation<br/>checking for makeinfo... no<br/>configure: WARNING: GNU Texinfo not found.  It is required at least version 5.1.<br/>You can find it at <a class="ae jx" href="https://gnu.org/software/texinfo/" rel="noopener ugc nofollow" target="_blank">https://gnu.org/software/texinfo/</a>.<br/>It will not be possible to rebuild the Info documentation<br/>nor generate any other documentation format.<br/>checking for help2man... no<br/>checking for doxygen... no<br/>configure: WARNING: doxygen not found - will not generate any doxygen documentation<br/>checking for perl... /usr/bin/perl<br/>configure: Checking meta-information<br/>checking available translations... da de uk vi<br/>checking that generated files are newer than configure... done<br/>configure: creating ./config.status<br/>config.status: creating Makefile<br/>config.status: creating po/Makefile.in<br/>config.status: creating po/LINGUAS<br/>config.status: creating src/Makefile<br/>config.status: creating doc/Makefile<br/>config.status: creating doc/Doxyfile<br/>config.status: creating doc/man/Makefile<br/>config.status: creating doc/release/release.texi<br/>config.status: creating config.h<br/>config.status: config.h is unchanged<br/>config.status: executing po-directories commands<br/>config.status: creating po/POTFILES<br/>config.status: creating po/Makefile<br/>config.status: executing depfiles commands</span><span id="5a4a" class="kg kh hi ke b fi lo ll l lm ln">## ---------------------- ##<br/>## GNU Make Targets Table ##<br/>## ---------------------- ##</span><span id="9183" class="kg kh hi ke b fi lo ll l lm ln">Build:</span><span id="d144" class="kg kh hi ke b fi lo ll l lm ln">all            Compile entire program.</span><span id="04db" class="kg kh hi ke b fi lo ll l lm ln">info, html, pdf, ps, dvi<br/>                Build documentation in the respective format.</span><span id="0786" class="kg kh hi ke b fi lo ll l lm ln">doxygen-doc    Build source-code documentation.<br/> check          Run test suite.</span><span id="ee4f" class="kg kh hi ke b fi lo ll l lm ln">tags, ctags<br/>                Build respective tags table file.</span><span id="4fa7" class="kg kh hi ke b fi lo ll l lm ln">Installation:</span><span id="3f0b" class="kg kh hi ke b fi lo ll l lm ln">install-exec     Install architecture-dependent files.<br/> install-data     Install architecture-independent files.<br/> install          Same as `install-exec' followed by `install-data'.<br/> install-strip    Same as `install' but strip executables.</span><span id="47b5" class="kg kh hi ke b fi lo ll l lm ln">install-{info,html,pdf,ps,dvi}<br/>                  Install documentation in the respective format.</span><span id="24b7" class="kg kh hi ke b fi lo ll l lm ln">install-man      Install man pages.<br/> installdirs      Create the installation directory tree.<br/> installcheck     Perform installation tests.<br/> uninstall        Delete installed files.</span><span id="2a72" class="kg kh hi ke b fi lo ll l lm ln">Cleaning:</span><span id="9a6b" class="kg kh hi ke b fi lo ll l lm ln">mostlyclean         Delete files that `make' built and usually<br/>                      one would like to rebuild.<br/> clean               Same as `mostlyclean' but delete also<br/>                      any file `make' built but was ignored by<br/>                      `mostlyclean'.<br/> distclean           Same as `clean' but delete also files<br/>                      generated by the configuration script.<br/> maintainer-clean    Same as `distclean' but delete also<br/>                      files maintainers built.</span><span id="ac36" class="kg kh hi ke b fi lo ll l lm ln">Distribution:</span><span id="843f" class="kg kh hi ke b fi lo ll l lm ln">distdir      Create distribution directory.<br/> dist         Same as `distdir' but package the distribution<br/>               directory into a tarball.<br/> distcheck    Same as `dist' but also check generated<br/>               tarball for correctness.</span><span id="d880" class="kg kh hi ke b fi lo ll l lm ln">Maintenance:</span><span id="b570" class="kg kh hi ke b fi lo ll l lm ln">These can only be made from VCS checkouts.</span><span id="f0a9" class="kg kh hi ke b fi lo ll l lm ln">homepage     Generate package's homepage.<br/> distgnu      Same as `distcheck' but also sign and upload the<br/>               resulting tarball to the GNU ftp site.<br/> announcegnu  Send release announcement to '<a class="ae jx" href="mailto:info-gnu@gnu.org" rel="noopener ugc nofollow" target="_blank">info-gnu@gnu.org</a>',<br/>               '<a class="ae jx" href="mailto:ccd2cue@gnu.org" rel="noopener ugc nofollow" target="_blank">ccd2cue@gnu.org</a>' and<br/>               '<a class="ae jx" href="mailto:coordinator@translationproject.org" rel="noopener ugc nofollow" target="_blank">coordinator@translationproject.org</a>'<br/> fetchpo      Fetch the latest PO translation files from the<br/>               Translation Project.</span></pre><p id="c2a9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">制作神器:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="6595" class="kg kh hi ke b fi lk ll l lm ln"># Build<br/>make</span><span id="7627" class="kg kh hi ke b fi lo ll l lm ln">make  all-recursive<br/>make[1]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5'<br/>Making all in po<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/po'<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/po'<br/>Making all in src<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/src'<br/>  CC       ccd2cue.o<br/>  CC       memory.o<br/>  CC       io.o<br/>  CC       file.o<br/>  CC       array.o<br/>  CC       errors.o<br/>  CC       crc.o<br/>  CC       ccd.o<br/>ccd.c: In function ‘stream2ccd’:<br/>ccd.c:362:33: warning: format ‘%a’ expects argument of type ‘float *’, but argument 3 has type ‘char **’ [-Wformat=]<br/>  362 |    if (sscanf (line, " FLAGS = %a[a-zA-Z0-9 ] ", &amp;ccd-&gt;TRACK[TRACK].FLAGS) == 1)<br/>      |                                ~^                ~~~~~~~~~~~~~~~~~~~~~~~~<br/>      |                                 |                |<br/>      |                                 float *          char **<br/>  CC       cue.o<br/>  CC       cdt.o<br/>  CC       convert.o<br/>  CCLD     ccd2cue<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/src'<br/>Making all in doc<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>Making all in man<br/>make[3]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc/man'<br/>make[3]: Nothing to be done for 'all'.<br/>make[3]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc/man'<br/>make[3]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[3]: Nothing to be done for 'all-am'.<br/>make[3]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5'<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5'<br/>make[1]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5'</span></pre><p id="2d4b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">最后一步是在系统上安装:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="aa7b" class="kg kh hi ke b fi lk ll l lm ln"># Install into default location<br/>sudo make install</span><span id="83f1" class="kg kh hi ke b fi lo ll l lm ln">Making install in po<br/>make[1]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/po'<br/>installing da.gmo as /usr/local/share/locale/da/LC_MESSAGES/ccd2cue.mo<br/>installing de.gmo as /usr/local/share/locale/de/LC_MESSAGES/ccd2cue.mo<br/>installing uk.gmo as /usr/local/share/locale/uk/LC_MESSAGES/ccd2cue.mo<br/>installing vi.gmo as /usr/local/share/locale/vi/LC_MESSAGES/ccd2cue.mo<br/>if test "ccd2cue" = "gettext-tools"; then \<br/>  /usr/bin/mkdir -p /usr/local/share/gettext/po; \<br/>  for file in Makefile.in.in remove-potcdate.sin quot.sed boldquot.sed en@quot.header en@boldquot.header insert-header.sin Rules-quot   Makevars.template; do \<br/>    /usr/bin/install -c -m 644 ./$file \<br/>     /usr/local/share/gettext/po/$file; \<br/>  done; \<br/>  for file in Makevars; do \<br/>    rm -f /usr/local/share/gettext/po/$file; \<br/>  done; \<br/>else \<br/>  : ; \<br/>fi<br/>make[1]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/po'<br/>Making install in src<br/>make[1]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/src'<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/src'<br/> /usr/bin/mkdir -p '/usr/local/bin'<br/>  /usr/bin/install -c ccd2cue '/usr/local/bin'<br/>make[2]: Nothing to be done for 'install-data-am'.<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/src'<br/>make[1]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/src'<br/>Making install in doc<br/>make[1]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>Making install in man<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc/man'<br/>make[3]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc/man'<br/>make[3]: Nothing to be done for 'install-exec-am'.<br/> /usr/bin/mkdir -p '/usr/local/share/man/man1'<br/> /usr/bin/install -c -m 644 ccd2cue.1 '/usr/local/share/man/man1'<br/>make[3]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc/man'<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc/man'<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[3]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[3]: Nothing to be done for 'install-exec-am'.<br/> /usr/bin/mkdir -p '/usr/local/share/info'<br/> /usr/bin/install -c -m 644 ./ccd2cue.info '/usr/local/share/info'<br/>make[3]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[1]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5/doc'<br/>make[1]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5'<br/>make[2]: Entering directory '/home/helix/source/ccd2cue/ccd2cue-0.5'<br/>make[2]: Nothing to be done for 'install-exec-am'.<br/>make[2]: Nothing to be done for 'install-data-am'.<br/>make[2]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5'<br/>make[1]: Leaving directory '/home/helix/source/ccd2cue/ccd2cue-0.5'</span></pre><p id="03e8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">测试应用程序:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="d35b" class="kg kh hi ke b fi lk ll l lm ln"># Test application<br/>ccd2cue --version</span><span id="dc92" class="kg kh hi ke b fi lo ll l lm ln">ccd2cue (GNU ccd2cue) 0.5</span><span id="47d1" class="kg kh hi ke b fi lo ll l lm ln">Copyright (C) 2010, 2013, 2014, 2015 Bruno Fe'lix Rezende Ribeiro &lt;<a class="ae jx" href="mailto:oitofelix@gnu.org" rel="noopener ugc nofollow" target="_blank">oitofelix@gnu.org</a>&gt;</span><span id="bbd6" class="kg kh hi ke b fi lo ll l lm ln">License GPLv3+: GNU GPL version 3 or later &lt;<a class="ae jx" href="http://gnu.org/licenses/gpl.html" rel="noopener ugc nofollow" target="_blank">http://gnu.org/licenses/gpl.html</a>&gt;<br/>This is free software: you are free to change and redistribute it.<br/>There is NO WARRANTY, to the extent permitted by law.</span><span id="657d" class="kg kh hi ke b fi lo ll l lm ln">Written by Bruno Fe'lix Rezende Ribeiro.</span></pre><h2 id="b123" class="kg kh hi bd ki kj kk kl km kn ko kp kq jy kr ks kt jz ku kv kw ka kx ky kz la bi translated"><code class="du kb kc kd ke b">OCI or Docker Container</code></h2><p id="325a" class="pw-post-body-paragraph ii ij hi il b im lb io ip iq lc is it jy ld iw ix jz le ja jb ka lf je jf jg hb bi translated">另一种方法是使用下面的<code class="du kb kc kd ke b">ContainerFile</code>(类似于<code class="du kb kc kd ke b">DockerFile</code>)构建、编译并安装在一个容器中。</p><blockquote class="if ig ih"><p id="d450" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><a class="ae jx" href="https://opencontainers.org/" rel="noopener ugc nofollow" target="_blank">开放容器倡议</a> (OCI)是一个旨在用一致的标准取代<code class="du kb kc kd ke b">docker</code>容器格式的标准。</p></blockquote><p id="6afb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">虽然<code class="du kb kc kd ke b">docker</code>应用程序可以用来构建和管理容器，但是像<code class="du kb kc kd ke b">buildah</code>和<code class="du kb kc kd ke b">podman</code>这样的工具越来越轻便、灵活和符合标准。以下文件总结了手动步骤:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="6a9d" class="kg kh hi ke b fi lk ll l lm ln">FROM ubuntu:20.04</span><span id="3a77" class="kg kh hi ke b fi lo ll l lm ln">LABEL "org.opencontainers.image.authors"="miah0x41"</span><span id="ea13" class="kg kh hi ke b fi lo ll l lm ln"># Install dependencies<br/>RUN apt update &amp;&amp; apt install -y \<br/>      build-essential \<br/>      gcc \<br/>      wget \<br/>      &amp;&amp; rm -rf /var/lib/apt/lists/*</span><span id="50ea" class="kg kh hi ke b fi lo ll l lm ln"># Create folder<br/>RUN mkdir -p /source/ccd2cue</span><span id="5f0d" class="kg kh hi ke b fi lo ll l lm ln"># Change working directory<br/>WORKDIR /source/ccd2cue</span><span id="6b35" class="kg kh hi ke b fi lo ll l lm ln"># Download source code<br/>RUN wget <a class="ae jx" href="https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz" rel="noopener ugc nofollow" target="_blank">https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz</a> \<br/>  &amp;&amp; tar xvzf ccd2cue-0.5.tar.gz \<br/>  &amp;&amp; rm ccd2cue-0.5.tar.gz</span><span id="2dd9" class="kg kh hi ke b fi lo ll l lm ln"># Change into source directory<br/>WORKDIR /source/ccd2cue/ccd2cue-0.5</span><span id="4265" class="kg kh hi ke b fi lo ll l lm ln"># Configure, make and install<br/>RUN ./configure \<br/>  &amp;&amp; make \<br/>  &amp;&amp; make install</span><span id="4ebc" class="kg kh hi ke b fi lo ll l lm ln"># Set default command<br/>ENTRYPOINT ["/usr/local/bin/ccd2cue"]</span></pre><p id="fea8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">通过以下命令使用<code class="du kb kc kd ke b">buildah</code>创建<code class="du kb kc kd ke b">image</code>:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="fe57" class="kg kh hi ke b fi lk ll l lm ln"># Build image<br/>buildah bud -f ContainerFile -t miah0x41/ccd2cue:0.5-0</span><span id="cf92" class="kg kh hi ke b fi lo ll l lm ln">WARN[0000] Failed to decode the keys ["machine"] from "/usr/share/containers/containers.conf". <br/>WARN[0000] Failed to decode the keys ["machine"] from "/usr/share/containers/containers.conf". <br/>STEP 1/9: FROM ubuntu:20.04<br/>STEP 2/9: LABEL "org.opencontainers.image.authors"="miah0x41"<br/>STEP 3/9: RUN apt update &amp;&amp; apt install -y       build-essential       gcc       wget       &amp;&amp; rm -rf /var/lib/apt/lists/*<br/>WARN[0000] Failed to decode the keys ["machine"] from "/usr/share/containers/containers.conf".</span><span id="7072" class="kg kh hi ke b fi lo ll l lm ln">WARNING: apt does not have a stable CLI interface. Use with caution in scripts.</span><span id="2a9d" class="kg kh hi ke b fi lo ll l lm ln">Get:1 <a class="ae jx" href="http://archive.ubuntu.com/ubuntu" rel="noopener ugc nofollow" target="_blank">http://archive.ubuntu.com/ubuntu</a> focal InRelease [265 kB]<br/>Get:2 <a class="ae jx" href="http://security.ubuntu.com/ubuntu" rel="noopener ugc nofollow" target="_blank">http://security.ubuntu.com/ubuntu</a> focal-security InRelease [114 kB]<br/>Get:3 <a class="ae jx" href="http://archive.ubuntu.com/ubuntu" rel="noopener ugc nofollow" target="_blank">http://archive.ubuntu.com/ubuntu</a> focal-updates InRelease [114 kB]<br/>Get:4 <a class="ae jx" href="http://security.ubuntu.com/ubuntu" rel="noopener ugc nofollow" target="_blank">http://security.ubuntu.com/ubuntu</a> focal-security/restricted amd64 Packages [1205 kB]<br/>Get:5 <a class="ae jx" href="http://archive.ubuntu.com/ubuntu" rel="noopener ugc nofollow" target="_blank">http://archive.ubuntu.com/ubuntu</a> focal-backports InRelease [108 kB]<br/>&lt;snip&gt;<br/>0 added, 0 removed; done.<br/>Running hooks in /etc/ca-certificates/update.d...<br/>done.<br/>STEP 4/9: RUN mkdir -p /source/ccd2cue<br/>WARN[0000] Failed to decode the keys ["machine"] from "/usr/share/containers/containers.conf". <br/>STEP 5/9: WORKDIR /source/ccd2cue<br/>STEP 6/9: RUN wget <a class="ae jx" href="https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz" rel="noopener ugc nofollow" target="_blank">https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz</a>   &amp;&amp; tar xvzf ccd2cue-0.5.tar.gz   &amp;&amp; rm ccd2cue-0.5.tar.gz<br/>WARN[0000] Failed to decode the keys ["machine"] from "/usr/share/containers/containers.conf". <br/>--2022-05-30 21:24:37--  <a class="ae jx" href="https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz" rel="noopener ugc nofollow" target="_blank">https://ftp.gnu.org/gnu/ccd2cue/ccd2cue-0.5.tar.gz</a><br/>Resolving ftp.gnu.org (ftp.gnu.org)... 2001:470:142:3::b, 209.51.188.20<br/>Connecting to ftp.gnu.org (ftp.gnu.org)|2001:470:142:3::b|:443... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 626071 (611K) [application/x-gzip]<br/>Saving to: 'ccd2cue-0.5.tar.gz'</span><span id="d766" class="kg kh hi ke b fi lo ll l lm ln">0K .......... .......... .......... .......... ..........  8%  257K 2s<br/>    50K .......... .......... .......... .......... .......... 16%  516K 1s<br/>   100K .......... .......... .......... .......... .......... 24% 94.9M 1s<br/>   150K .......... .......... .......... .......... .......... 32%  518K 1s<br/>   200K .......... .......... .......... .......... .......... 40% 77.5M 1s<br/>   250K .......... .......... .......... .......... .......... 49% 94.8M 0s<br/>   300K .......... .......... .......... .......... .......... 57%  111M 0s<br/>   350K .......... .......... .......... .......... .......... 65%  523K 0s<br/>   400K .......... .......... .......... .......... .......... 73% 39.1M 0s<br/>   450K .......... .......... .......... .......... .......... 81%  118M 0s<br/>   500K .......... .......... .......... .......... .......... 89%  110M 0s<br/>   550K .......... .......... .......... .......... .......... 98%  115M 0s<br/>   600K .......... .                                          100% 65.0M=0.5s</span><span id="cee8" class="kg kh hi ke b fi lo ll l lm ln">2022-05-30 21:24:38 (1.22 MB/s) - 'ccd2cue-0.5.tar.gz' saved [626071/626071]</span><span id="ab7a" class="kg kh hi ke b fi lo ll l lm ln">&lt;snip&gt;<br/>ccd2cue-0.5/INSTALL<br/>ccd2cue-0.5/TODO<br/>STEP 7/9: WORKDIR /source/ccd2cue/ccd2cue-0.5<br/>STEP 8/9: RUN ./configure   &amp;&amp; make   &amp;&amp; make install<br/>WARN[0000] Failed to decode the keys ["machine"] from "/usr/share/containers/containers.conf". <br/>checking for a BSD-compatible install... /usr/bin/install -c<br/>checking whether build environment is sane... yes<br/>checking for a thread-safe mkdir -p... /usr/bin/mkdir -p<br/>checking for gawk... no<br/>checking for mawk... mawk<br/>checking whether make sets $(MAKE)... yes<br/>checking whether make supports nested variables... yes<br/>&lt;snip&gt;<br/>STEP 9/9: ENTRYPOINT ["/usr/local/bin/ccd2cue"]<br/>COMMIT miah0x41/ccd2cue:0.5<br/>Getting image source signatures<br/>Copying blob bf8cedc62fb3 skipped: already exists  <br/>Copying blob 3bd397d87e45 done  <br/>Copying config 9b3c5ca6c6 done  <br/>Writing manifest to image destination<br/>Storing signatures<br/>--&gt; 9b3c5ca6c6c<br/>Successfully tagged localhost/miah0x41/ccd2cue:0.5<br/>9b3c5ca6c6c4b8518c4259cf73baeb468a6d72f8f4dd74ba52239f5b5b8265a3</span></pre><p id="90b0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">用<code class="du kb kc kd ke b">--version</code>命令测试容器:</p><pre class="ji jj jk jl fd lg ke lh li aw lj bi"><span id="4258" class="kg kh hi ke b fi lk ll l lm ln"># Check version<br/>podman run --rm -it miah0x41/ccd2cue --version</span><span id="b7b4" class="kg kh hi ke b fi lo ll l lm ln">ccd2cue (GNU ccd2cue) 0.5</span><span id="1828" class="kg kh hi ke b fi lo ll l lm ln">Copyright (C) 2010, 2013, 2014, 2015 Bruno Fe'lix Rezende Ribeiro &lt;<a class="ae jx" href="mailto:oitofelix@gnu.org" rel="noopener ugc nofollow" target="_blank">oitofelix@gnu.org</a>&gt;</span><span id="7a99" class="kg kh hi ke b fi lo ll l lm ln">License GPLv3+: GNU GPL version 3 or later &lt;<a class="ae jx" href="http://gnu.org/licenses/gpl.html" rel="noopener ugc nofollow" target="_blank">http://gnu.org/licenses/gpl.html</a>&gt;<br/>This is free software: you are free to change and redistribute it.<br/>There is NO WARRANTY, to the extent permitted by law.</span><span id="8350" class="kg kh hi ke b fi lo ll l lm ln">Written by Bruno Fe'lix Rezende Ribeiro.</span></pre><p id="b762" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">虽然这为<code class="du kb kc kd ke b">ccd2cue</code>程序创建了一个可移植的容器，但它并不是广泛可访问的。这当然可以通过手动上传到<em class="ik"> Docker Hub </em>来解决，但是对于透明度和更广泛的社区来说，使用公共回购更好。</p><h2 id="c1ab" class="kg kh hi bd ki kj kk kl km kn ko kp kq jy kr ks kt jz ku kv kw ka kx ky kz la bi translated">GitHub 操作</h2><p id="01f7" class="pw-post-body-paragraph ii ij hi il b im lb io ip iq lc is it jy ld iw ix jz le ja jb ka lf je jf jg hb bi translated">我们可以使用预定义的模板来利用 GitHub 动作，而不是在本地机器上手动运行<code class="du kb kc kd ke b">buildah</code>。第一步是将<code class="du kb kc kd ke b">ContainerFile</code>托管在诸如<code class="du kb kc kd ke b"><a class="ae jx" href="https://github.com/miah0x41/ccd2cue" rel="noopener ugc nofollow" target="_blank">miah0x41/ccd2cue</a></code>的存储库中。顶栏包含可用的操作:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lp"><img src="../Images/7c8d49b1fed6d8a9221e5bc6f093501d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oELeORlbpjRPLfnI4kJ5mw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">GitHub 菜单作者<a class="ae jx" href="https://aero-data-science.medium.com/" rel="noopener"> Ashraf Miah </a> |图片作者</figcaption></figure><p id="6267" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">在“动作”下，点击“新工作流”，在“持续集成”下可以使用“Docker 图像”模板。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lq"><img src="../Images/9bbef3892dc25379e3ec3918265e7586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYJzht7PCbrBmARhzDQ6hQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated"><a class="ae jx" href="https://aero-data-science.medium.com/" rel="noopener">阿什拉夫·米亚</a>的 CI 行为|图片由作者提供</figcaption></figure><p id="826c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">然而，文档中有一个<code class="du kb kc kd ke b">build-and-push</code>动作，它更适合。本例中使用了以下操作文件:</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="c9b3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">这一行动有许多部分；基本上，<code class="du kb kc kd ke b">on:</code>键定义了自动和手动运行动作的时间。环境变量用于定义注册表(作为 Github 自己的)以及 GitHub 令牌的权限(用于向注册表认证)。在这种情况下，注册表的名称<code class="du kb kc kd ke b">ccd2cue</code>也是图像的名称。</p><p id="bdc9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du kb kc kd ke b">job</code>中的键<code class="du kb kc kd ke b">steps</code>是检查存储库，然后登录到注册中心，注册中心使用 Github 变量(如<code class="du kb kc kd ke b">actor</code>)、环境变量和 Github 秘密的组合。下一步是从图像中提取元数据(老实说，我不确定这一步到底是做什么的！).</p><p id="f5f7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">为了利用秒格式的日期作为<code class="du kb kc kd ke b">tag</code>的一部分，<code class="du kb kc kd ke b">bash</code>命令存储在一个名为<code class="du kb kc kd ke b">TAG</code>的环境变量中。这用于为构建过程设置<code class="du kb kc kd ke b">context</code>的最后一步。<code class="du kb kc kd ke b">path</code>被标识为 repo 的根(即<code class="du kb kc kd ke b">.</code>),而<code class="du kb kc kd ke b">tag</code>由代表注册表、图像名称和标签的环境变量组合而成。</p><p id="f30b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">提交更改将触发构建过程:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lt"><img src="../Images/cc848c4c7a72cd5413bd51e0d747da38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37ngh3v6dNAdNOND87Vkaw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">构建过程由<a class="ae jx" href="https://aero-data-science.medium.com/" rel="noopener"> Ashraf Miah </a> |图片由作者提供</figcaption></figure><p id="b94d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">在回购主页的“packages”下，提供了该图片的链接:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lu"><img src="../Images/35dac5ff250e1e350fbe64c7b7f8311d.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*V8G7m9iUhH5bJJpIjUaGKw.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">包装说明由<a class="ae jx" href="https://aero-data-science.medium.com/" rel="noopener"> Ashraf Miah </a> |图片由作者提供</figcaption></figure><p id="85da" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">点击它会显示图像细节:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lv"><img src="../Images/c3c37dfa0fcde4f1f2099bbadac688d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qe9WViF2GlQSEgwszwZS2g.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">包装细节由<a class="ae jx" href="https://aero-data-science.medium.com/" rel="noopener"> Ashraf Miah </a> |图片由作者提供</figcaption></figure><p id="8172" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">虽然还需要更多的步骤，但是 GitHub 动作一旦生成，就可以复制到其他项目中。</p><h2 id="8b8d" class="kg kh hi bd ki kj kk kl km kn ko kp kq jy kr ks kt jz ku kv kw ka kx ky kz la bi translated">结论</h2><p id="d640" class="pw-post-body-paragraph ii ij hi il b im lb io ip iq lc is it jy ld iw ix jz le ja jb ka lf je jf jg hb bi translated">从 Ubuntu 20.04 中不可用的一个晦涩的包开始，本指南展示了如何在容器内迁移之前在本地编译它，然后自动完成这个过程。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><h1 id="2c8c" class="md kh hi bd ki me mf mg km mh mi mj kq mk ml mm kt mn mo mp kw mq mr ms kz mt bi translated">属性</h1><p id="e28e" class="pw-post-body-paragraph ii ij hi il b im lb io ip iq lc is it jy ld iw ix jz le ja jb ka lf je jf jg hb bi translated">所有<code class="du kb kc kd ke b">gists</code>，笔记本，终端演员表均为作者。所有的作品都是基于明确的<a class="ae jx" href="https://creativecommons.org/share-your-work/public-domain/cc0/" rel="noopener ugc nofollow" target="_blank"> CC0、公共领域</a>许可或<a class="ae jx" href="https://scripts.sil.org/cms/scripts/page.php?item_id=OFL_web" rel="noopener ugc nofollow" target="_blank">SIL of</a>的资产，因此不侵权。主题灵感来自并基于我最喜欢的<code class="du kb kc kd ke b">vim</code>主题:<a class="ae jx" href="https://github.com/morhetz/gruvbox" rel="noopener ugc nofollow" target="_blank">grubbox</a>。</p></div></div>    
</body>
</html>