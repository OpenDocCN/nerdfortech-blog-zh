<html>
<head>
<title>Introduction to Deep Learning with R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R介绍深度学习</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/introduction-to-deep-learning-with-r-cc5bdb9629f?source=collection_archive---------6-----------------------#2021-02-16">https://medium.com/nerd-for-tech/introduction-to-deep-learning-with-r-cc5bdb9629f?source=collection_archive---------6-----------------------#2021-02-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="04bb" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在R编程中使用TensorFlow和Keras对初学者进行图像分类。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/8c85ff1a2846ba386fdea4caedc5d2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6N1dW8c8Wje5B50m"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@craftedbygc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">绿色变色龙</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="e90c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">深度学习是基于人工神经网络架构的机器学习的一个子领域。深度学习被用于许多领域，如自然语言处理、计算机视觉和生物信息学。</p><p id="1640" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">简而言之，我将涵盖以下主题:</p><ul class=""><li id="87f5" class="kk kl hi jq b jr js ju jv jx km kb kn kf ko kj kp kq kr ks bi translated">什么是深度学习？</li><li id="df8a" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated">Keras是什么？</li><li id="56a0" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated">如何安装TensorFlow？</li><li id="5884" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated">如何用Keras做深度学习分析？</li></ul><p id="733c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请不要忘记关注我的youtube频道，在那里我创建了关于人工智能、数据科学、机器学习和深度学习的内容。👇</p><div class="ky kz ez fb la lb"><a href="https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hj fi z dy lg ea eb lh ed ef hh bi translated">蒂伦达兹学院</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">嗨，欢迎来到提伦达兹学院。Tirendaz学院是一个在线教育平台，制作视频和写博客…</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">www.youtube.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp jh lb"/></div></div></a></div><p id="4ac7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们开始吧。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="21cf" class="lx ly hi bd lz ma mb mc md me mf mg mh io mi ip mj ir mk is ml iu mm iv mn mo bi translated">什么是深度学习？</h1><p id="f972" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">深度学习是受人脑结构启发的机器学习的一个子领域。深度学习处理复杂的任务，如分类数十亿张图像，推荐最佳视频，或学习在围棋比赛中击败世界冠军。</p><p id="563b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现代深度学习通常涉及数十甚至数百个连续的表示层，它们都是通过暴露于训练数据来自动学习的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mu"><img src="../Images/f005f12a93a6aab9d6a47dccfc4ebec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NvdapqrOLGRn4NQLmv3x5w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">人工神经网络</figcaption></figure><h2 id="b7ae" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">如何运作深度学习网络</h2><p id="51e7" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">深度学习模型由一个输入层、两个或多个隐藏层和一个最终层组成。输入层接收输入数据并将输入传递给第一个隐藏层。隐藏层对输入执行数学计算。</p><p id="8d65" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">深度学习中的“深”是指有不止一个隐藏层。输出层返回输出数据。神经元之间的每个连接都与一个权重相关联。这个权重显示了输入值的重要性。初始权重随机设置。每个神经元都有激活功能。一旦一批输入数据通过了神经网络的所有层，它就通过输出层返回输出数据。</p><p id="3994" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">损失或成本函数衡量实际结果和预测结果之间的差异。为了建立一个好的模型，你希望你的损失函数接近于零。要找到最小成本函数，可以使用梯度下降技术。梯度下降的工作原理是在每次数据集迭代后以小增量改变权重。</p><p id="9615" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">好了，我们看到了如何进行深度学习。我们来看看Keras API实现深度学习模型。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="8a4c" class="lx ly hi bd lz ma mb mc md me mf mg mh io mi ip mj ir mk is ml iu mm iv mn mo bi translated">Keras是什么？</h1><p id="2891" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">Keras是一种高级深度学习API，允许您轻松构建、训练、评估和执行各种神经网络。</p><p id="e072" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Keras于2015年3月作为开源项目发布。由于其易用性、灵活性和漂亮的设计，它很快就流行起来。可以在TensorFlow、Theano、Mxnet上使用Keras。注意TensorFlow有Keras API。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="96d3" class="lx ly hi bd lz ma mb mc md me mf mg mh io mi ip mj ir mk is ml iu mm iv mn mo bi translated">如何安装Keras？</h1><p id="03b5" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">安装TensorFlow时，Keras会自动来到您的电脑前。让我们在RStudio中安装TensorFlow。安装TensorFlow太容易了。让我们安装TensorFlow:</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="90a6" class="mv ly hi nk b fi no np l nq nr">install.packages(“tensorflow”)</span></pre><p id="8aa0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来我们加载TensorFlow包。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="9e90" class="mv ly hi nk b fi no np l nq nr">library(tensorflow)</span></pre><p id="dae4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，在Windows上，您需要Anaconda的有效安装。现在我们可以使用install_tensorflow方法</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="6d27" class="mv ly hi nk b fi no np l nq nr">install_tensorflow()</span></pre><p id="5df6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">几分钟后，TensorFlow和Keras都安装好了。为了验证这一点，让我们使用TensorFlow打印hello world。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="a952" class="mv ly hi nk b fi no np l nq nr">tf$constant(“Hello TensorFlow”)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ns"><img src="../Images/8dd6636cfc2cab54c41126599911a271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*R99Vt5vSBtvq0JfzuVMR7A.png"/></div></figure><p id="9aa8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果代码运行没有错误，TensorFlow安装没有任何问题。如果您希望安装GPU版本，可以使用如下所示的gpu=TRUE参数。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="5468" class="mv ly hi nk b fi no np l nq nr">install_tensorflow(gpu=TRUE)</span></pre><p id="354e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们来看看使用MNIST数据集的分类问题。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="99ea" class="lx ly hi bd lz ma mb mc md me mf mg mh io mi ip mj ir mk is ml iu mm iv mn mo bi translated">分类问题</h1><p id="460c" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">为了说明分类问题，我将使用经典的MNIST数据集。MNIST数据集包含手写数字，由70，000幅28*28像素的灰度图像组成，每幅图像分为10类。MNIST数据集有一组60，000个训练图像和10，000个测试图像。MNIST数据集预装在Keras中。首先，我要导入Keras。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="eb46" class="mv ly hi nk b fi no np l nq nr">library(keras)</span></pre><p id="3bfc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在让我们加载MNIST数据集。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="1480" class="mv ly hi nk b fi no np l nq nr">mnist &lt;- dataset_mnist()</span></pre><p id="4869" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来，让我们看看数据集的结构。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="abbd" class="mv ly hi nk b fi no np l nq nr">str(mnist)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nt"><img src="../Images/ceaf660d9728e773ca9b2b67bcb493ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*tHzsFlr4KRegVt24OdJ3Iw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">我们数据集的结构</figcaption></figure><p id="f9b9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，MNIST数据集由训练集和测试集组成。使用训练集拟合模型，并使用测试集评估模型。像素值是0到255之间的整数。让我把它们转换成0到1之间的浮点数。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="498e" class="mv ly hi nk b fi no np l nq nr">mnist$train$x &lt;- mnist$train$x/255<br/>mnist$test$x &lt;- mnist$test$x/255</span></pre><p id="f8bf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">是时候建立模型了。</p><h2 id="ee2f" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">建立模型</h2><p id="0ff8" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">使用训练数据输入神经网络，然后使用测试集进行预测。之后，您将验证这些预测是否与测试集标签中的标签相匹配。</p><p id="3fdd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">要定义模型，可以使用顺序API或函数API。由于它易于使用，我将使用顺序API。</p><h2 id="8d4c" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">设置图层</h2><p id="684e" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">在顺序API中，层是线性排序的。让我们使用顺序API构建一个Keras模型。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="9142" class="mv ly hi nk b fi no np l nq nr">model &lt;­ keras_model_sequential() %&gt;%               (1)<br/>layer_flatten(input_shape = c(28, 28)) %&gt;%         (2)<br/>layer_dense(units = 128, activation = “relu”) %&gt;%  (3)<br/>layer_dropout(0.2) %&gt;%                             (4)<br/>layer_dense(10, activation = “softmax”)            (5)</span></pre><p id="1135" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(1)管道(%&gt;%)运算符用于向网络添加图层。这个操作符来自于magrittr包。使用管道操作符使代码更具可读性。可以使用Ctrl+ Shift +M键盘快捷键插入管道运算符。</p><p id="3042" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(2)我已经使用layer_flatten方法指定了输入数据。在我们的例子中，我们有28*28尺寸的图像。这里我把输入转换成一维。</p><p id="9aaf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(3)我给我们的网络增加了一层。</p><p id="5297" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(4)您可以根据您的分析指定层中神经元的数量。深度学习模型往往会过度适应。如果模型存在过度拟合的问题，它就很难准确预测新数据。为了解决这个问题，你可以使用辍学技术。Dropout是神经网络最有效和最常用的正则化技术之一。应用于图层的丢弃包括在训练过程中随机丢弃(设置为零)图层的多个输出要素。在这里，我使用了辍学率的辍学方法。</p><p id="fe38" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(5)最后，我添加了一个输出层。因为我们有10个类，所以我们可以使用10个神经元。对于激活功能，我设置了softmax功能。不要忘记，您的网络应该以softmax激活功能结束。在我们的例子中，softmax函数返回10个概率分数的数组。每个分数将是当前数字图像属于我们的10个数字类之一的概率。</p><p id="0c89" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">定义模型后，您可以使用summary函数查看有关层、参数数量等信息。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="a933" class="mv ly hi nk b fi no np l nq nr">summary(model)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nu"><img src="../Images/00d510a6148ce86cac444c085681cab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BeElkBMkrSp3riVo_t6kqQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">我们模型的总结</figcaption></figure><h2 id="06e3" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">编译模型</h2><p id="f0fd" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">建立模型后，您必须编译它。当您编译模型时，您需要定义损失、优化器和度量参数。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="597d" class="mv ly hi nk b fi no np l nq nr">network %&gt;% compile(<br/>    loss = “sparse_categorical_crossentropy”,  (1)<br/>    optimizer = “rmsprop”,                     (2)<br/>    metrics = “accuracy”                       (3)<br/>    )</span></pre><p id="3f80" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(1)为了在多类分类中处理标签，我使用了category _ cross entropy或sparse _ categorical _ crossentropy。为了通过一键编码来编码标签，使用分类交叉熵，并且使用稀疏分类交叉熵来将标签编码为整数。</p><p id="3c03" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(2)在这里，我将指定一个优化器。优化器决定学习如何进行。优化器使用损失值来更新网络的权重。优化器有各种各样的功能。无论您的问题是什么，rmsprop优化器通常都是一个足够好的选择。</p><p id="6e02" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(3)评估指标用于衡量我们的模型有多好。当我们处理分类问题时，我使用了准确性度量。</p><p id="e09c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，用于回归的评估指标不同于用于分类的评估指标。一个常见的回归度量是平均绝对误差(MAE)。</p><h2 id="082a" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">训练模型</h2><p id="7e2e" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">现在我们准备训练网络。让我们调用fit()方法，并根据训练数据拟合模型:</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="3bdb" class="mv ly hi nk b fi no np l nq nr">model %&gt;% fit(<br/>    x = mnist$train$x, y = mnist$train$y,     <br/>    epochs = 5,                               (1)<br/>    validation_split = 0.3                    (2)</span></pre><p id="fede" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(1)所有训练数据的每次迭代称为一个时期。我设定了5个纪元。</p><p id="3cdb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(2)利用模型验证集调整超参数。为此，可以使用validation_split参数将数据拆分为定型集和验证集。我设定了0.3。所以我把我们的数据分成30%的验证和70%的训练。</p><p id="fef5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们执行这些代码。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nv"><img src="../Images/7182d652f3141fd94fd617e45d9612a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TG3_XGi4E4E4mV5B7B0Llg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">我们的模特培训</figcaption></figure><p id="4008" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如您所见，训练损失随着每个时期而减少，并且训练精度随着每个时期而增加。这就是你在运行梯度下降优化时所期望的。</p><h2 id="89f4" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">做预测</h2><p id="b97e" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">建立模型后，可以使用predict函数对模型进行预测。训练图是自动绘制的。</p><p id="8d7e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">predict方法返回所有10个类的概率分布。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="8f7b" class="mv ly hi nk b fi no np l nq nr">predictions &lt;- predict(model, mnist$test$x)</span></pre><p id="f068" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">默认情况下，预测将返回最后一个Keras图层的输出。让我们看看预测变量的前两个值。要做到这一点，让我用头的方法。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="d0dd" class="mv ly hi nk b fi no np l nq nr">head(predictions, 2)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nw"><img src="../Images/320c319e5ad1e17a989522ca731df01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-jDHQqp63QPopJoA1RCZEQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">预言</figcaption></figure><p id="0d9b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">此外，您可以使用predict_classes方法来生成该类。</p><h2 id="731c" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">评估准确性</h2><p id="3830" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">您可以使用evaluate函数访问不同数据集上的模型性能。让我们在测试集上评估我们的模型。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="56d5" class="mv ly hi nk b fi no np l nq nr">model %&gt;% evaluate(mnist$test$x, mnist$test$y)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nx"><img src="../Images/cd8ac499b471373e470fb9ef473a93a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hbyJzkOv3b1CdYENDRqD8A.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">测试集上的模型评估</figcaption></figure><p id="e3eb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们的模型在测试集上有大约90 %的准确率。</p><h2 id="b9b2" class="mv ly hi bd lz mw mx my md mz na nb mh jx nc nd mj kb ne nf ml kf ng nh mn ni bi translated">保存并重新加载模型</h2><p id="dce9" class="pw-post-body-paragraph jo jp hi jq b jr mp ij jt ju mq im jw jx mr jz ka kb ms kd ke kf mt kh ki kj hb bi translated">如果您愿意，可以保存您的模型。为此，可以使用save_model_tf方法。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="f648" class="mv ly hi nk b fi no np l nq nr">save_model_tf(object = model, filepath = “model”)</span></pre><p id="8338" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">要重新加载模型，可以使用load_model_tf方法。</p><pre class="iy iz ja jb fd nj nk nl nm aw nn bi"><span id="c63f" class="mv ly hi nk b fi no np l nq nr">reloaded_model &lt;- load_model_tf(“model”)</span></pre><p id="ec7f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在你可以使用上传的模型了。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><p id="eb83" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">就是这样。我希望你喜欢这篇文章。感谢阅读。</p><p id="3d74" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请鼓掌👏如果你喜欢这篇博文。另外，别忘了关注我们的<a class="ae jn" href="https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw" rel="noopener ugc nofollow" target="_blank"> <em class="ny">蒂伦达兹学院YouTube </em> </a> <em class="ny"> </em>📺，<a class="ae jn" href="https://twitter.com/TirendazAcademy" rel="noopener ugc nofollow" target="_blank"> <em class="ny">碎碎念</em> </a> <em class="ny"> </em>😎<em class="ny">、</em>、<a class="ae jn" href="https://tirendazacademy.medium.com/" rel="noopener">、<em class="ny">中等</em>、</a>📚，<a class="ae jn" href="https://www.linkedin.com/in/tirendaz-academy" rel="noopener ugc nofollow" target="_blank"><em class="ny">LinkedIn</em></a><em class="ny"/>👍</p><p id="b5c0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下一篇文章再见…</p></div></div>    
</body>
</html>