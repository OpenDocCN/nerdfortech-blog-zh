# 以下是比特币交易的运作方式。

> 原文：<https://medium.com/nerd-for-tech/heres-how-a-transaction-in-bitcoin-really-works-3e5dac8ffb0b?source=collection_archive---------16----------------------->

理解区块链的工作原理只是理解比特币核心的第一步。交易是比特币的基础，围绕它的一切都是为了支持它。

在简化和分解复杂主题的同时，本文旨在让您深入了解比特币网络上的交易是如何进行的。

**什么是交易？**

简单来说，交易就是一个价值转移的过程。在比特币的背景下，它是在转移比特币的价值。一旦交易完成，它就会被广播到 MEM 池中。MEM 池可以被认为是未批准交易的等候名单。所以下一次你想知道为什么你的交易花了这么长时间时，它可能在 MEM 池中变冷了。交易一旦被批准，就被打包成一个块，成为区块链的一部分。

批准交易意味着什么？

批准一项交易是整个混乱的关键所在。我们知道 PoW 共识机制有助于交易的验证。但是矿工如何知道交易是有效的呢？

为了理解这一点，我们需要深入研究事务是由什么组成的。

1.  数量

2.接受者

3.用户和认证

**用户和认证**

我们如何验证 Alice 是唯一一个试图向 bob 发送 5 美元的人？如果是别人冒充爱丽丝呢？为了解决这个问题，让我们再问自己一个问题。可以用来检查爱丽丝的权威和身份的唯一东西是什么？你猜对了！爱丽丝的私人钥匙。

私钥是加密元素，它使用算法来加密和解密代码。每个用户都有自己的私钥，可以把它看作密码。

![](img/09a24bd8f80aa6b88170e8d225ab7c35.png)

交易的草图

上面的草图大致代表了一个交易。当发送者签署除授权之外的整个交易的散列时，交易被授权。签署交易可以被认为是用私钥盖章。如果这听起来有点不直观，这里有另一个草图

![](img/4fe37b8efdf20227ecbe869a1ca2327b.png)

散列事务带来压缩事务。哈希的所有黄金部分，如冲突和前像阻力，使哈希在这里充当标识符。

未用交易输出(UTXO)

进入交易的实际情况，比特币使用 UTXO 模型来促进交易。理解 UTXO 模型的旅程带来了一些令人惊讶的事实，这些事实可能会改变你对比特币的看法。

在 UTXO 模型中，比特币是不可替代的，即所有的硬币都不相同。原因是，每当一枚硬币被送出，它首先被消费，然后被创造。换句话说，当鲍勃向爱丽丝发送硬币时，硬币被销毁，然后为爱丽丝创建新的硬币。

为了理解这一点，让我们来看看事务到底是什么样子的

![](img/6c5a8c1339d27669a79c4adb0d6261f9.png)

输入和输出是事务的主要组成部分。一个输入简单地指向另一个事务的输出，从而形成一个链。

![](img/7a57092ea063ac4277920512876892ce.png)

在上面的草图中，一个输入指向另一个事务的输出以指定

输入

一个输入引用另一个事务的输出。让我们假设爱丽丝收到 2 个比特币。要花掉这些硬币，她需要指出她收到这些硬币的交易输出。

输入由先前输出的事务 ID、输出的索引和 scriptSig 组成。ScriptSig 是用户使用该输出的授权。它作为谓词工作，用于满足 ScriptPubKey 的条件。本质上，这是输出的关键。

**输出**

输出包含花费比特币的指令。一个输出中的【值】指定要花费的数量，单位是 Satoshis ( 1 比特币= 108 satoshis，就像以太中的魏)。并且一个 **ScriptPubKey** 定义了要满足的规则，以赎回输出。一个输出当然只能兑换一次。

![](img/ea26d4e4da87a487b74d7085ee27e741.png)

来源:掌握比特币

我们的问题的答案是，什么使交易有效。投入的总和应该大于或等于产出的总和，它们之间的差额可以是支付给矿工的交易费，也可以是销毁后退还给你的“零钱”。产出应该全部花掉，而变化让你花掉所有的产出，并把“变化”拿回来。scriptSig 充当 scriptPubKey 的谓词，然后对其进行求值。此外，网络中的节点还需要确保输出没有被消耗掉。

所有这些事务都存储在 UTXO 集合中，该集合充当未用事务的全局数据库。

在比特币中，有钱意味着拥有一些满足某个输出的 scriptPubKey 的信息。跟踪你的余额不是比特币的工作，而是你或钱包提供商的工作。本文应该已经让您对事务如何工作有了初步的了解。仍然有多个概念需要深入研究。

我推荐麻省理工学院的加密货币和设计讲座，关于交易和 UTXO，作者是 Neha Narula

[https://www.youtube.com/watch?v=VT2o4KCEbes&LC = ugxt 7 uxowyj-g 17 biv P4 AAA bag](https://www.youtube.com/watch?v=VT2o4KCEbes&lc=UgxT7uXoWyj-g17BIvp4AaABAg)