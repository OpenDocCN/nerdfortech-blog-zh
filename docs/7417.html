<html>
<head>
<title>DefaultValues- Create Default Values Out of Thin Air — Exploring-purescript-modules #4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DefaultValues-凭空创建默认值-Exploring-pure script-modules # 4</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/defaultvalues-create-default-values-out-of-thin-air-exploring-purescript-modules-4-a80f1210d06b?source=collection_archive---------7-----------------------#2022-10-23">https://medium.com/nerd-for-tech/defaultvalues-create-default-values-out-of-thin-air-exploring-purescript-modules-4-a80f1210d06b?source=collection_archive---------7-----------------------#2022-10-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fc8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您是否曾经想要创建占位符值，比如一个大记录，因此您创建了一个保存虚拟值的变量，并将其用于<code class="du jd je jf jg b">fromMaybe</code>或解码失败等？</p><p id="c322" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，让我们假设您有一个记录，其中包含一个人的信息，</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="5b7e" class="jp jq hi jg b fi jr js l jt ju">type Person = <br/>      { name :: String<br/>      , age :: Int <br/>      , height :: Number <br/>      , ....<br/>      }</span></pre><p id="8465" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您想为您的表单组件创建一个初始状态，上面的所有细节都将被填充，那么初始状态会是什么呢？</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="016e" class="jp jq hi jg b fi jr js l jt ju">initialState :: Person<br/>initialState = <br/>      { name : ""<br/>      , age : 0<br/>      , height : 0.0<br/>      , ....<br/>      }</span></pre><blockquote class="jv jw jx"><p id="4c11" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated">注意:理想情况下，它们应该用 Maybe 类型包装，但出于解释目的，请原谅我。</p></blockquote><p id="9c18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以创建一个包含大约 5-10 个字段的虚拟/占位符值的记录，但是如果字段的数量超过 10 或 20 或更多呢？我们必须编写这些样板代码来创建虚拟值吗？如果某个包只给我们用默认值填充的值不是更好吗？这难道不会节省开发人员大量时间吗？</p><p id="d73e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有没有什么包可以做到这一点？是的，有一个名为<a class="ae kc" href="https://pursuit.purescript.org/packages/purescript-default-values/1.0.1" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">pure script-default-values</strong></a>的包，它就是用来创建默认值的。我们将在本文中探讨如何使用这个包。</p><figure class="jh ji jj jk fd ke er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kd"><img src="../Images/8a25fd26e571b1aa882dd04584f73a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Co1l-6P_kyTdRC3ybiJ2Q.jpeg"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated"><a class="ae kc" href="https://unsplash.com/@jhaland?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">约根·哈兰</a>在<a class="ae kc" href="https://unsplash.com/s/photos/twins?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="d951" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个非常简单的模块，它有一个名为<code class="du jd je jf jg b">DefaultValue</code>的类型类，该类型类有一个名为<code class="du jd je jf jg b">defaultValue</code>的方法，调用这个特定的方法将为我们提供该特定类型的默认值。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="9499" class="jp jq hi jg b fi jr js l jt ju">myDefaultInt :: Int<br/>myDefaultInt = defaultValue </span><span id="6721" class="jp jq hi jg b fi kw js l jt ju">myDefaultString :: String<br/>myDefaultString = defaultValue</span><span id="1b33" class="jp jq hi jg b fi kw js l jt ju">&gt;&gt;&gt; myDefaultInt<br/>&gt;&gt;&gt; 0</span><span id="15ba" class="jp jq hi jg b fi kw js l jt ju">&gt;&gt;&gt; myDefaultString<br/>&gt;&gt;&gt; ""</span></pre><p id="061c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们假设您有一个<code class="du jd je jf jg b">Maybe Int</code>值，并且您正在使用 fromMaybe 从 Maybe 包装器中获取实际的整数。最有可能的是，我们会给 0 作为万一什么都没有发生时的后备，而不是硬编码<code class="du jd je jf jg b">0</code>我们可以这样做，</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="44a4" class="jp jq hi jg b fi jr js l jt ju">&gt;&gt;&gt; fromMaybe defaultValue (Just 100)<br/>&gt;&gt;&gt; 100</span><span id="0228" class="jp jq hi jg b fi kw js l jt ju">&gt;&gt;&gt; fromMaybe defaultValue (Nothing :: Maybe Int)<br/>&gt;&gt;&gt; 0</span></pre><p id="f9eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jy">注意:如果使用的是 repl，则需要类型注释</em> <code class="du jd je jf jg b"><em class="jy">Nothing</em></code> <em class="jy">，否则编译器无法推断类型。</em></p><p id="6a94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当涉及到 Int、String、Number 等基本类型时，提供默认值并不麻烦。但是这个包在处理大量嵌套的记录时非常出色。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="2d82" class="jp jq hi jg b fi jr js l jt ju">type PersonInfo = <br/>      { name :: String<br/>      , age :: Int <br/>      , height :: Number<br/>      , father :: Person <br/>      , mother :: Person<br/>      , degrees :: Array String<br/>      , address : <br/>            { city :: String<br/>            , pincode :: Int<br/>            , street : <br/>                 { line1 :: String  <br/>                 , line2 :: String<br/>                 , ....<br/>                 }<br/>            }<br/>      , ..... <br/>      }</span></pre><p id="2a1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你试图将一个<code class="du jd je jf jg b">foreign</code>解码成上述类型，你很可能会使用<code class="du jd je jf jg b"><a class="ae kc" href="https://pursuit.purescript.org/packages/purescript-foreign-generic/10.0.0/docs/Foreign.Generic.Class#v:decode" rel="noopener ugc nofollow" target="_blank">decode</a></code>。如果您无论如何都要返回上述类型的值，那么在失败的情况下，您是否必须创建一个所有字段都用空值填充的虚拟记录？绝对不用，你可以直接用<code class="du jd je jf jg b">defaultValue</code></p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="7cbe" class="jp jq hi jg b fi jr js l jt ju">decodePerson :: Foreign -&gt; PersonInfo<br/>decodePerson fgn = case decode fgn of <br/>               Right person -&gt; person <br/>               Left _ -&gt; defaultValue</span></pre><p id="f678" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当解码失败时，<code class="du jd je jf jg b">defaultValue</code>将为您提供所有字段都填充有虚拟值的记录。</p><p id="a54d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果您想为自定义创建的类型提供默认值，该怎么办呢？</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="b252" class="jp jq hi jg b fi jr js l jt ju">data Color = RED <br/>           | YELLOW<br/>           | GREEN</span></pre><p id="c9e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要在这个类型上使用<code class="du jd je jf jg b">defaultValue</code>，您只需为这个特定类型创建一个<code class="du jd je jf jg b">DefaultValue</code>实例。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="c9e5" class="jp jq hi jg b fi jr js l jt ju">instance defaultColor :: DefaultValue Color where <br/>    defaultValue = GREEN</span><span id="764e" class="jp jq hi jg b fi kw js l jt ju">&gt;&gt;&gt; defaultValue :: Color<br/>&gt;&gt;&gt; GREEN</span></pre></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="efc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">奖励提示</strong></p><p id="e4f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有些情况下，我们希望为已经在此模块中定义的类型提供不同的默认值。</p><p id="f41d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，我们希望我们的<code class="du jd je jf jg b">age</code>字段的默认值为 18，因为它是一个 Int defaultValue，将产生<code class="du jd je jf jg b">0</code>。因此，我们可以将 Int 封装在 newtype 中，并为它提供我们自己的 DefaultValue 实现。</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="fd6e" class="jp jq hi jg b fi jr js l jt ju">newtype Age = Age Int<br/>instance defaultAge :: DefaultValue Age where <br/>    defaultValue = 18</span><span id="afa8" class="jp jq hi jg b fi kw js l jt ju">&gt;&gt;&gt; defaultValue :: Age<br/>&gt;&gt;&gt; 18</span></pre></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="5c83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这篇文章，并发现这是有帮助的，让我知道它鼓掌👏还是通过评论。</p></div></div>    
</body>
</html>