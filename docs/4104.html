<html>
<head>
<title>K-Means: Choosing the right number of clusters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">K-Means:选择正确的聚类数</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/k-means-algorithm-in-4-parts-7540d0f33339?source=collection_archive---------8-----------------------#2021-07-07">https://medium.com/nerd-for-tech/k-means-algorithm-in-4-parts-7540d0f33339?source=collection_archive---------8-----------------------#2021-07-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex if ig ih ii"><div class="bz dy l di"><div class="ij ik l"/></div><figcaption class="il im et er es in io bd b be z dx translated">图片来源:吉菲(<a class="ae ip" href="https://giphy.com/gifs/l41YtZOb9EUABnuqA" rel="noopener ugc nofollow" target="_blank">https://giphy.com/gifs/l41YtZOb9EUABnuqA</a>)</figcaption></figure><p id="9ec4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有两种流行的方法:</p><ol class=""><li id="5c55" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">肘法</li><li id="d549" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">剪影法</li></ol><p id="a82c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将重点讨论剪影方法。剪影方法如下进行:</p><p id="16cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于数据集中的每个数据点 I，我们计算:</p><p id="d837" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">a(i) =从该点到其簇中所有其他点的平均距离</p><p id="0780" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">b(i) =离最近簇中所有点的平均距离</p><p id="cdc1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该点的轮廓值为:</p><p id="ca01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(b(i)-a(i))/max{a(i)，b(i)}</p><p id="10f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，可以将这些轮廓值绘制在数据集中每个点的轮廓图中，并按聚类分组:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="f0ee" class="kl km hi kh b fi kn ko l kp kq">sample_silhouette_values=silhouette_samples(X, clusters,metric='euclidean')<br/>y_lower=0<br/>for i in range(0,k):<br/>    ith_cluster_silhouette_values = sample_silhouette_values[labels == i]<br/>    ith_cluster_silhouette_values.sort()<br/>    y_upper = y_lower+ith_cluster_silhouette_values.shape[0]</span><span id="607c" class="kl km hi kh b fi kr ko l kp kq">plt.fill_betweenx(np.arange(y_lower, y_upper),0, ith_cluster_silhouette_values)<br/>    y_lower=y_upper<br/>plt.show()</span></pre><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/40da0e34a33c5007b03af7a6ca0e2a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThijyeeX0HV_1GSTesZFTQ.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">红色表示每个点的轮廓值和平均值</figcaption></figure><p id="b470" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">轮廓分数就是所有点的轮廓值的平均值。</p><p id="fc5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有一个<a class="ae ip" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html" rel="noopener ugc nofollow" target="_blank"> sklearn 实现</a>用于剪影评分，非常好用。</p><h1 id="972d" class="kz km hi bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">选择最大化轮廓分数的聚类数</strong></h1><p id="34e4" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm jn hb bi translated">现在，我们只需循环 k 的一系列值，并选择一个给出最高轮廓分数的值。我们使用 sklearn 中的 KMeans 方法来简化事情。</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="f09d" class="kl km hi kh b fi kn ko l kp kq">from sklearn.metrics import silhouette_score</span><span id="c94b" class="kl km hi kh b fi kr ko l kp kq">silhouettes = []<br/>kmin = 2<br/>kmax = 10</span><span id="0bae" class="kl km hi kh b fi kr ko l kp kq">for k in range(kmin, kmax+1):<br/># We fit the KMeans algo with k clusters</span><span id="4cf9" class="kl km hi kh b fi kr ko l kp kq">    kmeans = KMeans(n_clusters = k).fit(X)<br/>    labels = kmeans.labels_</span><span id="919e" class="kl km hi kh b fi kr ko l kp kq"># We calculate the silhouette score and append it to the silhouette list<br/>    silhouettes.append(silhouette_score(X, labels, metric = 'euclidean'))</span><span id="a248" class="kl km hi kh b fi kr ko l kp kq">plt.plot(range(kmin,kmax+1),silhouettes)<br/>plt.show()</span></pre><p id="a8eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以画出结果:</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mb"><img src="../Images/db5402d1cb76193ae483651b349694f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Op05rQvgWZWZEF2QxnMWjw.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">4 似乎是集群的最佳数量</figcaption></figure><p id="3b1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第 3 部分中，我们将了解如何设置集群大小的上限和下限。</p><p id="3cc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献:</strong></p><p id="26af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ip" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html#sphx-glr-auto-examples-cluster-plot-kmeans-silhouette-analysis-py" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/auto _ examples/cluster/plot _ k means _ silhouette _ analysis . html # sphx-glr-auto-examples-cluster-plot-k means-silhouette-analysis-py</a></p></div></div>    
</body>
</html>