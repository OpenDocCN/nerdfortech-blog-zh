<html>
<head>
<title>Customer Segmentation using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行客户细分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/customer-segmentation-using-python-e56c2b1a4c73?source=collection_archive---------1-----------------------#2021-07-03">https://medium.com/nerd-for-tech/customer-segmentation-using-python-e56c2b1a4c73?source=collection_archive---------1-----------------------#2021-07-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="992a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解如何在Python中逐步部署用于客户细分的K均值聚类算法。</p><blockquote class="jd je jf"><p id="55b3" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">“我们被数据包围，但却渴望洞察。”-市场营销和客户体验专家Jay Baer</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/312f399548c1375761927cbbfee619ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ojDBnChT35x6GdiVNGA9A.jpeg"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">布莱克·维斯兹在<a class="ae ka" href="https://unsplash.com/@blakewisz?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="20e3" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">简介</strong></h1><p id="70a0" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我们知道，机器学习主要分为监督学习、非监督学习和强化学习。</p><p id="b45e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天，我们将学习一种最广泛使用的无监督学习技术，K表示聚类。</p><blockquote class="le"><p id="8407" class="lf lg hi bd lh li lj lk ll lm ln jc dx translated">“聚类分析或聚类是一种多变量统计技术，它根据描述观测值的一些特征或变量对观测值进行分组。”</p></blockquote><p id="09ca" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">现在，你可能会问分类(监督学习)和聚类(非监督学习)之间的区别是什么。前者围绕给定输入数据预测输出类别，或者换句话说，我们根据训练数据训练模型，然后用它来预测未来的结果。然而，聚类是基于根据数据点之间的相似性和不同点将数据点分组在一起。我们得到的输出是我们必须给自己命名的东西，不像监督学习的情况，我们已经标记了数据。</p><p id="9613" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个过程的目标是最大化一个聚类内的观察值的相似性和最大化聚类之间的不相似性。基本上是将所有可用的数据分组或“群集”到彼此不同的不重叠的子组中。</p><p id="b912" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">聚类的主要应用是客户细分、图像细分等。</p><p id="91ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">客户细分是根据需求、购买特征等将公司的潜在客户群划分为不同群体的过程。通过这样做，企业可以更好地瞄准个人，并通过为客户提供更定制的购物体验来增加销售额。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lt"><img src="../Images/63af5f5c9a01d1339e4946917fc2785d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HSJltwYeLcfE_33maGoG1w.png"/></div></div></figure><p id="b031" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将重点讨论如何在Python中使用K均值聚类进行客户细分。</p><p id="8f79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将讨论以下主题:</p><ul class=""><li id="2821" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated">K均值聚类的数据预处理。</li><li id="1869" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">EDA和数据集的可视化。</li><li id="780e" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">从头开始构建K均值聚类模型。</li><li id="d8ed" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">对构建的集群进行可视化、解释和分析。</li></ul><p id="3f5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始编码吧！</p><h1 id="fc09" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">导入所需的库</strong></h1><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="1e79" class="mn kc hi mj b fi mo mp l mq mr">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline  <br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.cluster import KMeans<br/>from sklearn.metrics import silhouette_score</span></pre><p id="b900" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用下面的代码将所需的数据集加载到Python环境中。这里，我们将“CustomerID”指定为索引，因为它是每个客户的唯一标识符。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="6726" class="mn kc hi mj b fi mo mp l mq mr">data = pd.read_csv (‘Mall_Customers.csv’, index_col=’CustomerID’)</span></pre><p id="57e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要检查我们加载的数据集中有什么:</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="3328" class="mn kc hi mj b fi mo mp l mq mr">data.head()</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ms"><img src="../Images/98857a5855bdad55437de8935a9a0b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*rQKT4gmEGJyZwEVDriOhVw.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">给定数据集的前5个条目</figcaption></figure><p id="c89d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集最初由5列组成；“客户ID”、“性别”、“年龄”、“年收入(千美元)”和“支出分数(1-100)”。“CustomerID”对我们的聚类分析没有任何帮助，可以被删除，或者在这种情况下被指定为索引或标识符。</p><p id="f6cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于其他4个功能的信息如下:</p><ul class=""><li id="5116" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated"><strong class="ih hj">性别:</strong>这是一种分类数据类型，在将其部署到模型中之前，必须对其进行预处理并转换为数值。它有两个类别，即“男性”和“女性”</li><li id="9598" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><strong class="ih hj">年龄:</strong>数值型数据类型，包含客户的年龄(年)</li><li id="89af" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><strong class="ih hj">年收入:</strong>数字数据类型，包含客户年收入1000美元。</li><li id="2243" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><strong class="ih hj">消费评分:</strong>它也是一个数字数据类型，包含一个基于客户消费行为的1-100分。</li></ul><h1 id="93bf" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">检测和处理异常值</strong></h1><p id="2818" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">异常值是不同于样本数据集整体模式的观察值。维基百科将其定义为“远离其他观察点的观察点。”最大似然算法在存在异常值的情况下效果不佳。</p><p id="9173" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们用箱线图来看看我们给定的数据集是否包含任何异常值。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="3539" class="mn kc hi mj b fi mo mp l mq mr">plt.boxplot(data[‘Annual Income’])<br/>plt.title(‘Boxplot of Annual Income’)</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es mt"><img src="../Images/6e2c7785acf34fe3a73ce5101c869e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*J4OT36Qn1XN5EvLw4cGw-g.png"/></div></figure><p id="ae87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该图显示“年收入”一栏中有一些异常值。我们将使用IQR或四分位间距方法来处理这些异常值。</p><p id="ed92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在此了解更多关于异常值检测和移除的信息<a class="ae ka" href="https://youtu.be/A3gClkblXK8" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="08ea" class="mn kc hi mj b fi mo mp l mq mr">Q1=np.percentile(data[‘Annual Income’],25,interpolation=’midpoint’)<br/>Q2=np.percentile(data[‘Annual Income’],50,interpolation=’midpoint’)<br/>Q3=np.percentile(data[‘Annual Income’],75,interpolation=’midpoint’)</span><span id="0454" class="mn kc hi mj b fi mu mp l mq mr">IQR=Q3-Q1<br/>lower_limit=Q1–1.5*IQR<br/>upper_limit=Q3+1.5*IQR</span><span id="b610" class="mn kc hi mj b fi mu mp l mq mr">outlier=[]<br/>for x in data['Annual Income']:<br/>    if((x&gt;upper_limit)or(x&lt;lower_limit)):<br/>        outlier.append(x)</span></pre><p id="69d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发现异常值为[137，137]，均在上限以上。我们现在将找到各自的索引，并从分析中删除整个两行。</p><p id="051e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jg"> PSA:如果异常值数量很少，可以保留在分析中。</em></p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="c6bc" class="mn kc hi mj b fi mo mp l mq mr">outlier_index=data[‘Annual Income’]&gt;up_limit<br/>data.loc[outlier_index].index</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es mv"><img src="../Images/6d15535cfa60a3f20a7a9857ef3a54aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*7khekBEsoJ4AMw4cTEw3QQ.png"/></div></figure><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="fd3f" class="mn kc hi mj b fi mo mp l mq mr">data.drop([199, 200],inplace=True)</span></pre><h1 id="cbe7" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="5e47" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在我们跳到机器学习或聚类之前，执行一些EDA和可视化是很重要的。这有助于我们识别数据中的模式，并找到变量之间有趣的关系。</p><p id="5a2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里了解更多关于EDA <a class="ae ka" href="https://towardsdatascience.com/an-extensive-guide-to-exploratory-data-analysis-ddd99a03199e" rel="noopener" target="_blank">的信息。</a></p><h2 id="9402" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated"><strong class="ak"> 1。单变量分析</strong></h2><p id="2ab4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">单变量是对单个变量的分析。这有助于我们描述数据并找到其中存在的模式。</p><p id="d197" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，我们使用<strong class="ih hj"> countplot() </strong>找到特征“性别”的每个类别中的观察次数</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="1e8d" class="mn kc hi mj b fi mo mp l mq mr">sns.countplot(data['Gender'])</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nj"><img src="../Images/0e60d2dd8a59f5bd182c2d848536150c.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*Plfkaw-0ynnJD4z9TvRQ5g.png"/></div></figure><p id="06fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与男性相比，数据集中的女性更多。</p><p id="a4ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们使用<strong class="ih hj"> distplot()来看看特征‘年龄’的单变量分布。</strong>这让我们可以查看数据的参数分布。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="bc66" class="mn kc hi mj b fi mo mp l mq mr">sns.distplot(data['Age'], bins=30)</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nk"><img src="../Images/ab284d55723eedfa16ea8cb6153f4f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*tpU1PVst2ehW6KQ-jvxr3w.png"/></div></figure><p id="7ef7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以看到，年龄列包含几乎正态分布的值。距离图上的KDE看起来像一条钟形曲线，这意味着“年龄”列的大多数数据点相对相似。</p><p id="0a05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里了解更多关于distplot和KDE <a class="ae ka" href="https://seaborn.pydata.org/tutorial/distributions.html" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h2 id="3a62" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated"><strong class="ak"> 2。双变量分析</strong></h2><p id="9291" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">顾名思义，双变量分析是将两个变量放在一起分析，以检查两者之间的任何并发关系。</p><p id="f43f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将检查我们每个功能之间的任何关联。但是，必须注意的一点是，使用散点图的双变量分析只能在数字数据类型上执行，因此我们必须将分类特征“性别”转换为数字数据类型。</p><p id="ef92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">处理分类特征:</strong>我们可以分配或映射给定数据集中“男性”和“女性”条目的值，如下所示。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="2205" class="mn kc hi mj b fi mo mp l mq mr">gender= {'Male':0, 'Female':1}<br/>data['Gender']= data['Gender'].map(gender)</span></pre><p id="8592" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们回到我们的双变量分析！</p><p id="a476" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">散点图是一种重要的可视化方法，用于观察变量之间的关系。它使用点来表示两个不同数值变量的值。</p><p id="8b7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.1.“年龄”和“支出分数”之间的散点图</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="a823" class="mn kc hi mj b fi mo mp l mq mr">plt.figure(figsize=(10,6))<br/>plt.scatter(data['Age'],data['Spending Score'], marker='o');<br/>plt.xlabel('Age')<br/>plt.ylabel('Spending Score')<br/>plt.title('Scatter plot between Age and Spending Score')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nl"><img src="../Images/4bd48859596e700d3e0824add4b8b956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*I_nf1l3QQpcttJH2UY3RUw.png"/></div></figure><p id="5938" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，年龄越低，消费得分越高。</p><p id="4f91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.2.“年龄”和“年收入”之间的散点图</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="3fe9" class="mn kc hi mj b fi mo mp l mq mr">plt.figure(figsize=(10,6))<br/>plt.scatter(data['Age'],data['Annual Income'], marker='o');<br/>plt.xlabel('Age')<br/>plt.ylabel('Annual Income')<br/>plt.title('Scatter plot between Age and Annual Income')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nm"><img src="../Images/a5672e7bd6b4bcab0625113771394d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*Da2-XHL7nGdhMJBDS-TEvw.png"/></div></figure><p id="59e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">30-50岁年龄组的人年收入最高。</p><p id="8e9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.3.“年收入”和“支出分数”之间的散点图</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="83dd" class="mn kc hi mj b fi mo mp l mq mr">plt.figure(figsize=(10,6))<br/>plt.scatter(data['Annual Income'],data['Spending Score'], marker='o');<br/>plt.xlabel('Annual Income')<br/>plt.ylabel('Spending Score')<br/>plt.title('Scatter plot between Annual Income and Spending Score')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nn"><img src="../Images/45f1875a89679c30f6bebd3c607b4753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*B9qlCDLtTfmwXDFlwhFbng.png"/></div></figure><p id="b8aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，大约4-7万美元的年收入对应着40-60的支出分数。</p><p id="5d6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.4.“性别”和“支出分数”之间的散点图</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="d657" class="mn kc hi mj b fi mo mp l mq mr">plt.figure(figsize=(6,6))<br/>plt.scatter(data['Gender'],data['Spending Score'], marker='o');<br/>plt.xlabel('Gender')<br/>plt.ylabel('Spending Score')<br/>plt.title('Scatter plot between Gender and Spending Score')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es no"><img src="../Images/4b7480e1f6a4f08a8227177695fd4af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*WsNis29IlJZ2HO9ksX2Pvg.png"/></div></figure><p id="854a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对应于女性的支出分数(映射到1)略高于男性的支出分数。女性更有可能花更多的钱。</p><p id="1e3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.5.“性别”和“年收入”之间的散点图</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="df82" class="mn kc hi mj b fi mo mp l mq mr">plt.figure(figsize=(6,6))<br/>plt.scatter(data['Gender'],data['Annual Income'], marker='o');<br/>plt.xlabel('Gender')<br/>plt.ylabel('Annual Income')<br/>plt.title('Scatter plot between Gender and Annual Income')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es np"><img src="../Images/54366719f9a667dedb2a113a3bcac621.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*oJH7SjbRPZw-FYTgh499dQ.png"/></div></figure><p id="17e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">剔除异常值后，年收入在性别方面几乎没有任何差异。</p><p id="efb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.6.“性别”和“年龄”之间的散点图</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nq"><img src="../Images/d8e23b917d846cd920e98124655c0605.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*EH0Zaqn8ox_rB8AKT1zz_g.png"/></div></figure><p id="241b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集中很少有男性比女性稍大。</p><h2 id="e394" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated"><strong class="ak"> 3。多元分析</strong></h2><p id="96a5" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">探索性数据分析的一个关键部分是寻找变量之间的相关性，可视化相关性矩阵最广泛使用的方法是热图。</p><p id="ac73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">热图是数据的图形表示，其中的值用颜色表示。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="bde6" class="mn kc hi mj b fi mo mp l mq mr">fig_dims = (7, 7)<br/>fig, ax = plt.subplots(figsize=fig_dims)<br/>sns.heatmap(data.corr(), annot=True, cmap='viridis')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nr"><img src="../Images/cf593c1d0a41af90246720b56c9a0dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*jDOTN6uRbalVAsUZjJAPQg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">数据集的关联热图</figcaption></figure><ul class=""><li id="bf54" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated">我们看到‘年龄’与‘消费得分’负相关。</li><li id="97ca" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">“年收入”与“年龄”的相关性很小</li><li id="2764" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">“年收入”和“支出分数”的相关性也很小。</li><li id="44bd" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">与“年收入”相比，“性别”与“支出分数”的相关性更小，但相关性更大。</li></ul><h1 id="77e1" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">标准化变量</h1><p id="9674" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在我们部署模型之前，我们必须将数据集中的所有变量标准化，以使它们的规模大致相同。预处理中的这一重要步骤称为标准化。</p><p id="f244" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要了解更多关于标准化的内容，你可以阅读这篇<a class="ae ka" href="https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/" rel="noopener ugc nofollow" target="_blank">链接文章</a>。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="a0e9" class="mn kc hi mj b fi mo mp l mq mr">scaler = StandardScaler()<br/>scaled_data = scaler.fit_transform(data[['Age', 'Annual Income', 'Spending Score']])</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ns"><img src="../Images/6a5ede821120e2ace4ada80e4b61ff8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*z34MqsC1YcOsp1DIQlGAVw.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">标准化后数据集的头</figcaption></figure><h1 id="d710" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">构建聚类模型</h1><p id="1b6d" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj">使用的算法:K均值聚类</strong></p><p id="b417" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">k均值算法是一种无监督学习技术，用于解决机器学习中的聚类问题。它将未标记的数据分成K个不同的簇。</p><blockquote class="le"><p id="1c45" class="lf lg hi bd lh li lj lk ll lm ln jc dx translated">“这是一种迭代的<strong class="ak">算法</strong>，它试图将数据集划分为K个预先<strong class="ak">定义的</strong>不同的非重叠子组(<strong class="ak">聚类</strong>)，其中每个数据点仅属于一个组。”</p></blockquote><ul class=""><li id="b570" class="lu lv hi ih b ii lo im lp iq nt iu nu iy nv jc lz ma mb mc bi translated">在k均值聚类中，我们必须指定我们希望将数据分组到的聚类数。最初，我们随机地给模型赋值，然后，我们使用“肘方法”来寻找最佳的聚类数。</li><li id="4d81" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">该算法将每个观察值随机分配给一个聚类，并找到每个聚类的质心。然后，算法迭代两个步骤:</li></ul><p id="fd4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.将数据点重新分配给质心最近的聚类。</p><p id="d4d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.计算每个聚类的新质心。</p><ul class=""><li id="e97f" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated">重复这两个步骤，直到组内平方和(WCSS)或误差平方和不能再减少为止。</li><li id="b4ac" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">WCSS计算为数据点与其各自聚类质心之间的欧氏距离之和。</li></ul><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="bdbb" class="mn kc hi mj b fi mo mp l mq mr">#create a copy of the data variable<br/>x = data.copy()<br/># The number in the brackets is K, or the number of clusters we are aiming for, here we take 3 randomly<br/>kmeans = KMeans(3)<br/># Fit the data<br/>kmeans.fit(x)</span><span id="56b8" class="mn kc hi mj b fi mu mp l mq mr"># Create a copy of the input data<br/>clusters = x.copy()<br/># Take note of the predicted clusters <br/>clusters['cluster_pred']=kmeans.fit_predict(x)</span><span id="38d2" class="mn kc hi mj b fi mu mp l mq mr"># Plot the data using the Annual Income and the Spending Score<br/>plt.scatter(clusters['Annual Income'],clusters['Spending Score'],c=clusters['cluster_pred'],cmap='rainbow')<br/>plt.xlabel('Annual Income')<br/>plt.ylabel('Spending Score')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nw"><img src="../Images/742e99df15d212270bbc34d4b72ff10d.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*4kLXZ0ggAJeNiCvpO9pa0w.png"/></div></figure><p id="1b44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的散点图给了我们一个最佳集群数量的粗略概念。但是为了找到最合适的‘K’，我们用肘法。</p><p id="cd2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以借助<a class="ae ka" href="https://youtu.be/EItlUEPCIzM" rel="noopener ugc nofollow" target="_blank">这段</a> YouTube视频，进一步了解K均值算法和肘法。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="b7c5" class="mn kc hi mj b fi mo mp l mq mr">wcss=[]</span><span id="451e" class="mn kc hi mj b fi mu mp l mq mr">for i in range(1, 11):<br/>    kmeans = KMeans(n_clusters = i, init = 'k-means++', <br/>                    max_iter = 300, n_init = 10, random_state = 42)<br/>    kmeans.fit(x)<br/>    wcss_iter=kmeans.inertia_<br/>    wcss.append(wcss_iter)</span><span id="5a84" class="mn kc hi mj b fi mu mp l mq mr"># Plotting the results onto a line graph to help us observe 'The Elbow'<br/>plt.figure(figsize=(10,5))<br/>no_clusters=range(1,11)<br/>plt.plot(no_clusters, wcss,marker = "o")<br/>plt.title('The elbow method', fontweight="bold")<br/>plt.xlabel('Number of clusters(K)')<br/>plt.ylabel('within Clusters Sum of Squares(WCSS)')</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es nx"><img src="../Images/d70f77786b24a646c1e65f0a844f2565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvcPfIsukNyzQeh3CIe7ag.png"/></div></div></figure><p id="510d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，最佳集群数是5，这是WCSS停止急剧下降的点。</p><p id="1a2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们来看看另一个要评估的聚类指标</p><p id="07cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">剪影评分</strong></p><p id="9ed4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">轮廓分数是一种度量标准，用于测量聚类的密集程度和分离程度。度量范围从-1到1。</p><p id="21be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">轮廓得分越高，模型越好，因为它测量数据点和最近聚类中的数据点之间的距离。</p><p id="2ae3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击了解更多关于剪影评分<a class="ae ka" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="c60b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们为我们的模型计算分数:</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="a1e8" class="mn kc hi mj b fi mo mp l mq mr">print(silhouette_score(clusters, kmeans.labels_, metric='euclidean'))</span></pre><p id="bcbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型的轮廓得分为0.37，这是一个相当不错的值。</p><p id="b106" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将聚类的最佳数量指定为5，并使用预测的聚类创建一个新的数据框。此外，我们将我们的分类特征“性别”映射回其初始类别。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="8dae" class="mn kc hi mj b fi mo mp l mq mr">kmeans_new = KMeans(5)<br/>#Fit the data<br/>kmeans_new.fit(x)</span><span id="a365" class="mn kc hi mj b fi mu mp l mq mr">#Create a new data frame with the predicted clusters<br/>clusters_new = x.copy()<br/>clusters_new['cluster_pred'] = kmeans_new.fit_predict(x)</span><span id="5a02" class="mn kc hi mj b fi mu mp l mq mr">#mapping the gender variable back to 'male' and 'female'<br/>gender= {0:'Male',1:'Female'}<br/>clusters_new['Gender']= clusters_new['Gender'].map(gender)</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ny"><img src="../Images/c9c5e0d02e413648f27c63847ad720fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*InlGnJw8BH0GFiHK063BjQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">带有预测聚类的数据集的头部</figcaption></figure><p id="2bdf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更好地理解预测的聚类，让我们来想象一下:</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="ab6c" class="mn kc hi mj b fi mo mp l mq mr">plt.figure(figsize=(6,6))<br/>plt.scatter(clusters_new['Annual Income'],clusters_new['Spending Score'],c=clusters_new['cluster_pred'],cmap='rainbow')<br/>plt.title("Clustering customers based on Annual Income and Spending score", fontsize=15,fontweight="bold")<br/>plt.xlabel("Annual Income")<br/>plt.ylabel("Spending Score")</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es nz"><img src="../Images/0e039e28d500dffb8de7c8146b4dad06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*jA1fvCAzT7CfE8uT3VyUCA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">最终聚类的散点图</figcaption></figure><h1 id="b86a" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">聚类分析</h1><p id="ddae" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">从最终的图中，我们可以看出，我们数据集中的客户可以根据他们的年收入和支出分数分为5个不同的组。</p><ul class=""><li id="042b" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated">红色:年收入低，支出分数低</li><li id="b1d0" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">橙色:年收入低，支出分数高</li><li id="35df" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">紫罗兰色:中等年收入，中等支出分数</li><li id="1d32" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">蓝色:年收入高，消费得分高</li><li id="4ddf" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">绿色:年收入高，支出分数低</li></ul><p id="3ecf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们更深入地研究这些集群，以便更好地理解。</p><p id="e342" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，为了研究每个分类的属性，让我们找出每个分类中所有特征的平均值。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="6f33" class="mn kc hi mj b fi mo mp l mq mr">avg_data = clusters_new.groupby(['cluster_pred'], as_index=False).mean()<br/>avg_data</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es oa"><img src="../Images/a5afc4d85dc67019e64faedc696f3944.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*ud1n1jq_29ut-mSyIH97SA.png"/></div></figure><p id="483a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一幅画确实胜过千言万语。所以，让我们用条形图来形象化上表。</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="a027" class="mn kc hi mj b fi mo mp l mq mr">sns.barplot(x='cluster_pred',y='Age',palette="plasma",data=avg_data)</span><span id="f334" class="mn kc hi mj b fi mu mp l mq mr">sns.barplot(x='cluster_pred',y='Annual Income',palette="plasma",data=avg_data)</span><span id="a3d9" class="mn kc hi mj b fi mu mp l mq mr">sns.barplot(x='cluster_pred',y='Spending Score',palette="plasma",data=avg_data)</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ob"><img src="../Images/0562f1e517737fdbf089d1bf7aa367ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkkqyb7mZOg5O5Nvco-wIg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">年龄对比年收入对比支出得分</figcaption></figure><p id="53b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">性别细分</strong></p><p id="e838" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还需要了解每个集群的性别差异</p><pre class="jl jm jn jo fd mi mj mk ml aw mm bi"><span id="218b" class="mn kc hi mj b fi mo mp l mq mr">data2 = pd.DataFrame(clusters_new.groupby(['cluster_pred','Gender'])['Gender'].count())<br/>data2</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es oc"><img src="../Images/036e9aead27f6eab82569f1be6af8ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*XGvQU5x9pOi3NHpdrecv1A.png"/></div></figure><p id="2e0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">群组0、1、2、3的女性比例高于男性，群组4的女性和男性比例几乎相等。</p><p id="1f88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jg">附注:值得注意的是，该数据集中女性人口占主导地位。</em></p><h2 id="ffb7" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated"><strong class="ak">每个预测聚类的主要属性</strong></h2><p id="97b6" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">关于已构建的集群，可以得出以下结论:</p><ol class=""><li id="1681" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc od ma mb mc bi translated"><strong class="ih hj">聚类0: </strong> <em class="jg">蓝色——年收入高，支出分数高</em></li></ol><p id="5d0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均年龄32岁；以女性为主；平均年收入8.5万美元；平均消费得分为82分</p><p id="1b9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。聚类1: </strong> <em class="jg">紫罗兰-中级年收入，中级支出得分</em></p><p id="e6ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均年龄43岁；以女性为主；平均年收入55k美元；平均消费得分是49</p><p id="1e8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。聚类2: </strong> <em class="jg">橙色——年收入低，支出分数高</em></p><p id="1b53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均年龄25岁；以女性为主；平均年收入26k美元；平均支出得分为78分</p><p id="0c20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。聚类3: </strong> <em class="jg">红色——年收入低，支出分数低</em></p><p id="7d48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均年龄45岁；以女性为主；平均年收入26k美元；平均消费得分是21</p><p id="c253" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。聚类4: </strong> <em class="jg">绿色——年收入高，支出分数低</em></p><p id="468a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平均年龄41岁；男性和女性的比例几乎相等；平均年收入86k美元；平均消费得分是17</p><h1 id="4fb2" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">围绕每个集群建立消费者角色</strong></h1><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es oe"><img src="../Images/03fd8ff7cd02a0ecacb8f6066eb0899f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gs-91OoxjBQicsatrYhpfw.jpeg"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">照片由<a class="ae ka" href="https://unsplash.com/@myleon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">莱昂</a>在<a class="ae ka" href="https://unsplash.com/s/photos/people-at-work?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="e0dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经创建了客户群，我们可以围绕他们构建人物角色，使客户体验愉快。</p><p id="2ea7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">能够围绕开发的分析讲述故事是一项关键技能，有助于客户或利益相关者更有效地理解我们的发现。</p><h2 id="e8a4" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated"><strong class="ak">第0类:非常富裕的客户</strong></h2><p id="b165" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这部分人是中年人，他们在最初几年积累了大量财富。</p><p id="81a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">他们也有很大的消费规模，因此过着非常富裕的生活。</p><p id="6278" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建议:这个年龄段的大多数人可能正处于组建家庭的初始阶段。因此，推销房地产、房产、汽车交易等最有可能吸引他们的注意力。由于他们的高消费能力，这些人被认为会对所有集群做出严肃的财务承诺。</p><h2 id="3085" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated"><strong class="ak">集群1:中产阶级客户</strong></h2><p id="9267" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这个群体由中年顾客组成，他们在中等水平上消费和赚钱。</p><p id="83f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于他们的收入水平不算过高，所以他们对自己的支出规模非常谨慎。</p><p id="6be3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些人也可能是财务责任较高的人。例如，他们孩子的高等教育。</p><p id="2936" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建议:折扣优惠、促销代码、积分卡等。</p><h2 id="8fbb" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated">集群2:冲动的买家</h2><p id="2563" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这部分人由不注意消费习惯的年轻人组成。</p><p id="cd40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个群体很可能是由第一次工作的人组成的，他们往往为了追求一种好的生活方式而超支。</p><p id="6a34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建议:由于许多年轻人喜欢度假的想法，为这部分人提供足够的酒店优惠券、机票可能是个好主意。与其他群体相比，这一群体还被认为在服装和相关配饰上花费最多。为此类商品提供适当的折扣也可能是一个有用的策略。</p><h2 id="c0b3" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated">第三组:几乎退休的人</h2><p id="81a1" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这部分人是收入和支出较少的老年人。他们可能在为退休存钱。</p><p id="04d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建议:医疗保健相关产品可以在这个集群中推广。使用足够的折扣券、促销代码等也可能有所帮助。</p><h2 id="0425" class="mn kc hi bd kd mw mx my kh mz na nb kl iq nc nd kp iu ne nf kt iy ng nh kx ni bi translated">第四组:谨慎的消费者</h2><p id="1fa0" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这个群体由在消费习惯上节俭的中年人组成。</p><p id="0750" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然收入水平很高，但是消费很少。这可能是他们财务责任的一个指标。</p><p id="0a37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建议:会员卡、折扣券、优惠等可能对该集群产生巨大影响。</p><h1 id="5ad8" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">结论</strong></h1><p id="2aec" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">总而言之，我们高效地创建了一个K均值聚类算法，根据客户的年收入和消费习惯对其进行细分。</p><p id="8e2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们对数据集执行探索性数据分析，对其进行预处理，并构建所需的模型。</p><p id="9b00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们分析了发展的集群，并给出了一些商业建议，可用于改善业务。</p><p id="8cbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述项目的全部代码可以在我的<a class="ae ka" href="https://github.com/Nehla1999/Customer-Segmentation/tree/main" rel="noopener ugc nofollow" target="_blank"> GitHub仓库中获得。</a></p></div></div>    
</body>
</html>