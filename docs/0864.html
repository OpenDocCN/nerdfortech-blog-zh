<html>
<head>
<title>Convert MySQL integer column into DateTime while preserving the data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将MySQL整数列转换为日期时间，同时保留数据</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/convert-mysql-integer-column-into-datetime-while-preserving-the-data-413040555061?source=collection_archive---------9-----------------------#2021-02-19">https://medium.com/nerd-for-tech/convert-mysql-integer-column-into-datetime-while-preserving-the-data-413040555061?source=collection_archive---------9-----------------------#2021-02-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="01f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最近遇到了一个问题，我从一个API中获取整数值时间戳数据，我只是将它保存到一个表的整数列中。</p><p id="657b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与我一起工作的客户当时决定，他们需要将时间戳的整数列转换为人类可读的日期时间。我需要在保存数据的同时进行这种转换。</p><p id="017b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在谷歌搜索了一段时间后，我终于找到了一个有效的答案，我认为值得分享。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7dda4a92c5071c9bdaffe23cd7f3ca53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WWMzBozeekaYWVHY"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">大喊到<a class="ae jt" href="https://unsplash.com/@ikukevk" rel="noopener ugc nofollow" target="_blank"> @ikukevk </a>供图</figcaption></figure><p id="e1c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是需要的5个步骤:</p><ol class=""><li id="3bcb" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">在同一个mysql表中创建一个类型为<strong class="ih hj">日期时间</strong>的<em class="kd">临时列</em></li></ol><p id="d502" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.在mysql表中，根据您的使用情况运行以下查询之一:</p><p id="074e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)您有一个10位数的时间戳值，例如1613759058</p><p id="5879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行以下命令:</p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="c98b" class="kj kk hi kf b fi kl km l kn ko"><strong class="kf hj">UPDATE</strong> table <br/><strong class="kf hj">SET</strong> <br/><em class="kd">temp_column</em> = <strong class="kf hj">FROM_UNIXTIME</strong>(<em class="kd">integer_timestamp_column</em>)</span></pre><p id="097f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将获取<em class="kd"> integer_timestamp_column </em>值，并使用<a class="ae jt" href="https://database.guide/from_unixtime-examples-mysql/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">FROM _ UNIXTIME</strong></a><strong class="ih hj">将它们转换成日期时间。</strong>然后将该值复制到<em class="kd"> temp_column中。</em></p><p id="b71b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)如果时间戳长于10位数(意味着它占毫秒或更多)，您需要转换它。我有一个13位的时间戳，所以我做了如下转换:</p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="69d3" class="kj kk hi kf b fi kl km l kn ko"><strong class="kf hj">FLOOR</strong>(<em class="kd">integer_timestamp</em><strong class="kf hj">/1000</strong>)</span></pre><p id="61ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，它除以1000，剩下3位小数。然后应用<strong class="ih hj">FLOOR</strong><strong class="ih hj"/>通过向下舍入将数字转换为整数(这是我们下一步需要的)。</p><p id="efd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后运行:</p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="d7cd" class="kj kk hi kf b fi kl km l kn ko"><strong class="kf hj">UPDATE</strong> table <br/><strong class="kf hj">SET</strong> <br/><em class="kd">temp_column</em> = <strong class="kf hj">FROM_UNIXTIME</strong>(<strong class="kf hj">FLOOR</strong>(<em class="kd">integer_timestamp_column</em><strong class="kf hj">/1000</strong>))</span></pre><p id="a939" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再次将转换后的值从<em class="kd">整数时间戳列</em>复制到<em class="kd">临时列。</em></p><p id="3765" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.删除<em class="kd">整数_时间戳_列</em></p><p id="5e7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.将<em class="kd">临时列</em>重命名为<em class="kd">整数时间戳列</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5b67f663d78b2e3327c9214a3ccbd0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kltAmPSpoRZxFXWx"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">大喊到<a class="ae jt" href="https://unsplash.com/@lidyanada" rel="noopener ugc nofollow" target="_blank"> @lidyanada </a>供图</figcaption></figure><h1 id="b84a" class="kp kk hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">瞧，您已经将表中的整数列转换为日期时间列，同时保留了数据！</h1></div></div>    
</body>
</html>