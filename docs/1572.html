<html>
<head>
<title>Request/GET files from Google API with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 从 Google API 请求/获取文件</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/request-get-files-from-google-api-with-python-f6dab75681ae?source=collection_archive---------9-----------------------#2021-03-26">https://medium.com/nerd-for-tech/request-get-files-from-google-api-with-python-f6dab75681ae?source=collection_archive---------9-----------------------#2021-03-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/75e85576ed1bcc6341114c0fb590a076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1kAin8rCrvbdy1WDfovKdA.png"/></div></figure><blockquote class="im in io"><p id="326f" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文介绍了如何首先设置 Google Drive API，然后创建一个 python 脚本来下载文件。</p></blockquote><p id="27b9" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">在<a class="ae jr" href="https://console.cloud.google.com/apis/library?folder=&amp;organizationId=&amp;project=drive-1605468482834" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>中提供了不同种类的 API 库。</p><p id="ad5c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">但是我们感兴趣的是<a class="ae jr" href="https://console.cloud.google.com/apis/library/drive.googleapis.com?id=e44a1596-da14-427c-9b36-5eb6acce3775&amp;project=drive-1605468482834" rel="noopener ugc nofollow" target="_blank"> Google Drive API </a>。</p><h1 id="29be" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">创建您的项目</h1><p id="90ff" class="pw-post-body-paragraph ip iq hi is b it kq iv iw ix kr iz ja jo ks jd je jp kt jh ji jq ku jl jm jn hb bi translated">首先，你应该在 Google 开发者控制台中创建一个项目。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9909" class="le jt hi la b fi lf lg l lh li"><a class="ae jr" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">https://accounts.google.com/o/oauth2/v2/auth</a></span></pre><p id="92e8" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">然后如下:</p><blockquote class="im in io"><p id="67a1" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击启用 API 和服务</p></blockquote><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lj"><img src="../Images/68a55969f303d85dda5c41c82218bb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnlLSNISXc8KQJaxxAc5Zg.png"/></div></div></figure><p id="42e5" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">当您启用它时，您可以使用 API 发出不同的请求(push、post、get ),并且您可以在这个<a class="ae jr" href="https://developers.google.com/drive/api/v3/reference?apix=true" rel="noopener ugc nofollow" target="_blank">链接</a>上检查它们。</p><p id="42c6" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">当所有设置和完成后，如下所示:</p><p id="84f8" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">创建凭据</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/b85ea850f28da441bcc5cd4d054e8d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*oj7SIfBn9_r5IDkvkBz62A.png"/></div></figure><p id="ea23" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">选择你需要的证书可能会让人不知所措，幸运的是谷歌已经做了很好的工作，创造了一些你可以很容易跟随❤的东西</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/82ac422d0892a3817d2120db950ae57c.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*GhjW4iSZ9CM0JfnX155qNw.png"/></div></figure><p id="e0a7" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">然后，在 Google 向您推荐<strong class="is hj"> OAuth 客户端 ID </strong>之后，在您可以设置它之前，您需要设置<strong class="is hj"> OAuth 同意屏幕</strong>。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><p id="5305" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">设置好 Creditentials 之后接下来要做的是确定<strong class="is hj">范围</strong>你希望你的应用程序在你的个人 Google Drive 中做什么<strong class="is hj">查看、下载、创建、编辑、删除</strong>。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/f3ea78c8762dba248512adb9572acc00.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*Wv19PjvKOyEdJz5FyHEukA.png"/></div></figure><p id="de4f" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">接下来还有几个步骤，但剩下的应该更容易完成。所有这些都完成后，你将拥有你的<strong class="is hj">客户端机密</strong>，你可以下载它，这样你的应用程序就可以用它来验证自己。继续点击<strong class="is hj">下载</strong>，这是向下箭头图标。</p><p id="ae90" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">你的客户秘密是一个<code class="du ly lz ma la b">JSON</code>文件。改名为<code class="du ly lz ma la b">client_secret.json</code>。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/2bd4f3969f9c25c00ad8090b9b0b80e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*z2ROAHwhKpWU7TWp3YfLRA.jpeg"/></div></figure><h1 id="84f0" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">连接并接收来自 Google Drive 的文件</h1><p id="7d2b" class="pw-post-body-paragraph ip iq hi is b it kq iv iw ix kr iz ja jo ks jd je jp kt jh ji jq ku jl jm jn hb bi translated">这里必须使用的包很少。</p><p id="71cf" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">在我的主要项目<a class="ae jr" href="https://github.com/Mozes721/IG_Tk_Gdrive" rel="noopener ugc nofollow" target="_blank"> IG_Tk_drive </a>中，我专注于下载图片，然后上传到 IG 上。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="b467" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">确保您的工作目录至少有<strong class="is hj"> storage.json </strong>或<strong class="is hj"> client_secret.json </strong>文件。</p><p id="a305" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">注意:</p><blockquote class="im in io"><p id="a31a" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个可以在没有另一个的情况下工作，我们从访问 storage.json 的 creds 变量开始，如果它不工作，那么它将使用 client_secret.json 访问它并覆盖 creds 变量</p></blockquote><p id="1285" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">所以用 creds 变量传递 OAuth 2.0 凭证。json 文件</p><p id="c449" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">此后，对于 drive 变量，我们将在 DRIVE 中使用<strong class="is hj">Google API client . discovery</strong>方法<strong class="is hj"> </strong>版本 3‘v3 ’, http 将使用使用存储或 client_secret json 文件的 creds 进行授权。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="bf1c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi me translated"><span class="l mf mg mh bm mi mj mk ml mm di">我们</span>首先创建 get_file 函数，该函数立即转到<em class="ir"> img_file() </em>函数，在那里创建一个访问存储的驱动器文件的变量,“mimeType”选择我们要查找的文件类型。</p><p id="855e" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">获取文件，遍历这些文件，并对该目录中列出的项目做一个返回语句。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/b0ece4dd2c8a891e41b6aa06261e04be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*xNAp-7BpNKwnO-dP95VSMA.jpeg"/></div></figure><p id="164a" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在我们回到 get_file 继续我们的旅程。</p><p id="69f0" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">因此，我们提示用户根据从 img_files 函数中分离出来的图像(我的意思是打印出来的)选择一个图像，然后将它附加到 image_input 中(就像这样，所以我的主项目可以工作，否则不需要创建 image_input 变量)。</p><p id="d750" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">因此，如果 choose_img 被找到作为文件['name']，那么创建具有正确文件['id']，['name']的 id 和 name 变量，文件将再次循环。</p><p id="3f82" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">现在，它将转到最后一个函数调用 download_file，并在它旁边的参数中添加属性。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="0516" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">所以“id”和“name”属性在 download_file 括号中传递。</p><p id="e231" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">创建一个请求变量 use DRIVE，它将使用 files()方法通过 id 名称获取文件。</p><p id="c037" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">正在创建 fh 变量。我们使用 io 包 FileIO 方法来管理文件相关的输入和输出操作(“wb”表示文件以二进制模式打开进行写入)。</p><p id="2214" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">我们传入使用 MediaIo…的下载变量，并传入 fh 和 request</p><p id="aa7e" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jo jc jd je jp jg jh ji jq jk jl jm jn hb bi translated">在 while 循环中，下载时传入状态和 done，将 done 更改为 True。</p><h1 id="675f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="b021" class="pw-post-body-paragraph ip iq hi is b it kq iv iw ix kr iz ja jo ks jd je jp kt jh ji jq ku jl jm jn hb bi translated">恭喜你！您现在已经启用了 Google Drive API，并从您选择的位置下载了图片。它不必就此停止，你还可以在你的 Gdrive 和其他一些操作中插入图像。还有其他谷歌应用编程接口，如谷歌日历，YouTube 数据应用编程接口，谷歌分析等。你可以创造一个你选择的项目，机会如此之快，我知道我会的！</p><h1 id="5404" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">相关故事</h1><div class="mo mp ez fb mq mr"><a rel="noopener follow" target="_blank" href="/codex/instagram-choose-img-from-gdrive-or-local-storage-629fa836dd4f"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">Instagram:从 GDrive 或本地存储中选择图像</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">这个项目分为三个部分:谷歌 API，目录搜索，Instabot/Tkinter</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">medium.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ik mr"/></div></div></a></div><div class="mo mp ez fb mq mr"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/find-files-folders-in-your-directory-with-python-2ff11081e373"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">使用 Python 查找目录中的文件和文件夹</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">摘要</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">medium.com</p></div></div><div class="na l"><div class="ng l nc nd ne na nf ik mr"/></div></div></a></div><div class="mo mp ez fb mq mr"><a href="https://python.plainenglish.io/dynamic-e-mail-automation-from-excel-file-103d35bd9225" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">从 Excel 文件实现动态电子邮件自动化</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">使用 Python 向整个 Excel 列表发送电子邮件，或者单独发送带有翻译文本选项的电子邮件！</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">python .平原英语. io</p></div></div><div class="na l"><div class="nh l nc nd ne na nf ik mr"/></div></div></a></div></div></div>    
</body>
</html>