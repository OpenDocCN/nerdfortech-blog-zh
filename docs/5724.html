<html>
<head>
<title>Understanding kerberos: The single sign on authentication system</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解kerberos:单点登录认证系统</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/understanding-kerberos-the-single-sign-on-authentication-system-3352dd6649af?source=collection_archive---------3-----------------------#2021-11-07">https://medium.com/nerd-for-tech/understanding-kerberos-the-single-sign-on-authentication-system-3352dd6649af?source=collection_archive---------3-----------------------#2021-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c82b6921d9b6c5a91e543c5f36a849d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l6ySX8-WyXj_Afn2aKkQyQ.jpeg"/></div></div></figure><p id="4727" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">kerberos的完整定义是一个<strong class="is hj">安全</strong>、<strong class="is hj">单点登录</strong>、<strong class="is hj">可信</strong>、<strong class="is hj">第三方、相互认证</strong>的服务。让我们打破这个定义，快速检查每一个。</p><ul class=""><li id="472d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><strong class="is hj">安全</strong> : Kerberos的独特之处在于它使用了<em class="jx">票证</em>，这是一种通过网络传输消息来提供用户身份的加密措施。而不是通过网络传递消息。</li><li id="e247" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><strong class="is hj">单点登录</strong>:这意味着用户只需要登录一次就可以访问所有支持kerberos的服务。</li><li id="1db2" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><strong class="is hj">可信第三方</strong>:这意味着所有认证请求都通过集中式kerberos服务器路由。</li><li id="7670" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><strong class="is hj">相互认证</strong>:确保不仅键盘后面的人证明他自称是谁，而且他正在与自称是谁的服务器通信。</li></ul><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/05a1d47b2834945820c6c865236be4ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*ve-IThhwQam74VQVZqL_yg.jpeg"/></div></figure><p id="4199" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Kerberos术语和概念</strong></p><p id="c9ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们来看看kerberos身份验证系统特有的术语。</p><p id="37b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">原则、领域和实例</p><p id="622f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">主体:</strong>Kerberos安装中包含的每个实体，包括个人用户、计算机和服务器上运行的服务，都有一个与之相关联的主体。每个相关联的主体都与一个长期密钥相关联。这可以是密码或通行短语。每个主体都以一个用户名开始，后跟一个可选的实例。</p><p id="60d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">实例:</strong>实例用于两种情况，一种是服务主体(用户需要访问的服务)，另一种是为管理使用创建特殊主体(当管理员需要提升权限时)</p><p id="ee4b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Realm </strong>:用户名和可选实例合在一起，在一个给定的领域中形成一个惟一的身份。每个kerberos安装都定义了一个不同于其他kerberos安装的管理控制领域。例如，kerberos领域的DNS名称是其域转换为大写，如果example.org是域名，领域名称将是示例。（同organic）有机</p><p id="de98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">服务和主机主体</strong></p><p id="b8b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用户不是唯一被分配到kerberos领域的人。主机和服务也有主体，因为在kerberos中，每个端点都可以请求相互身份验证，两个端点都需要一个身份和一个密钥。</p><p id="4386" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Kerberos主体名称</strong></p><p id="2a3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">kerberos 5主体名称的示例如下。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="456b" class="kn ko hi kj b fi kp kq l kr ks">username[/instance]@REALM <br/>service/fully-qualified-domain-name@REALM</span><span id="c958" class="kn ko hi kj b fi kt kq l kr ks">joedoe/admin@EXAMPLE.ORG</span></pre><p id="dc4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的例子表明joedoe在EXAMPLE.ORG领域拥有管理特权。</p><p id="e56c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">密钥、盐和密码</strong></p><p id="bee5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一种称为String2key的方法用于将字母数字密钥转换为加密密钥。Salt是添加到密码中的字符序列，使其更加独特。</p><p id="da33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">密钥分发中心</strong></p><p id="d59e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">密钥分发中心(KDC)是kerberos系统的一个组成部分。KDC由三部分组成。</p><p id="5907" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">认证服务器(AS): </strong>向希望登录到kerberos领域的客户端发布加密的票据授予票据(也称为TGT)。TGT是用用户的密码加密的，因为只有用户和KDC知道秘密密码。当用户试图登录时，只有正确的密码才能解密密钥，用错误的密码尝试登录将提示再次登录。</p><p id="8afd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">票务授权服务器(TGS): </strong>票务授权服务器基于来自客户端的两个数据发布个人服务票。</p><ul class=""><li id="74ff" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">代表客户端想要访问的服务的主体名称。</li><li id="104e" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">授权服务器颁发的TGT密钥</li></ul><p id="67bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">数据库:</strong>存储主成分和相关的关键字。</p><p id="9307" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">把所有的碎片放在一起</strong></p><p id="cc10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们把所有的部分放在一起，看看kerberos 5的工作情况。</p><p id="ec7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">认证流程</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/ecf948c907e41059b84f91653078c4e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2232CS9unMVsQbRpKhFM2Q.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">Kerberos身份验证流程</figcaption></figure><ul class=""><li id="0395" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">从客户端到认证服务器的请求，请求将包含用户主体名称和时间戳。使用用户密码加密。</li><li id="3bbe" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">尝试解密消息。如果成功解密，将返回TGT和TGS会话密钥。</li><li id="980a" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">用TGT密钥向TGS服务器发送请求。</li><li id="2bbe" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">TGS验证TGT，如果验证成功，将返回服务票(TGS)。</li><li id="64c8" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">用会话密钥加密TGS，并将消息发送到应用服务器进行验证。</li><li id="b95f" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">应用服务器尝试解密服务器并允许访问。</li></ul><p id="8175" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">预认证</strong></p><p id="beaf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">kerberos 5引入了基于身份的认证。要求用户在KDC为特定主体发行票据之前证明身份。</p><p id="fc4a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果用户尝试登录并要求预认证，KDC将发送<strong class="is hj">KRB _错误</strong>而不是<strong class="is hj"> AS_REP </strong>。该消息将告诉客户端需要预认证。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/6160219b8592f9207298fb6903eee6e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnvWt1Jw_s2QqNefouCiDg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">作为与预认证交换</figcaption></figure><p id="ccbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Kerberos票据类型</strong></p><p id="2ba3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">可转发票证:</strong>用户可以将票证转发到另一台主机，一个常见的用例是用户获取一个TGT，该票证可以转发到另一台主机。用户不需要在接收主机系统中输入密码。</p><p id="c29b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">可代理车票:</strong>您可以在车票上设置可代理标志。这类似于可转发票证，它可以发送到另一台主机，并可用于获取更多服务票证。</p><p id="f1a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">可更新的门票:</strong>门票的有效期只到一个标准的有效期，之后可以提交给KDC进行更新。</p><p id="f92f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">过期票:</strong>这些票在未来的某个特定日期才有效。对将来计划的作业很有用。</p></div></div>    
</body>
</html>