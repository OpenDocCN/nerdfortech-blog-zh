<html>
<head>
<title>Let’s Play Around With Playwright Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们来玩玩剧作家框架</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/lets-play-around-with-playwright-framework-f08d4f6ff2a?source=collection_archive---------2-----------------------#2021-11-23">https://medium.com/nerd-for-tech/lets-play-around-with-playwright-framework-f08d4f6ff2a?source=collection_archive---------2-----------------------#2021-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2f58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">剧作家测试主要是为了满足端到端测试的需求而设计的。它执行标准测试运行程序的所有功能，甚至更多。剧作家测试使您能够做到以下几点:</p><ul class=""><li id="3c99" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">在所有浏览器上运行测试。</li><li id="5fba" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">并行执行测试。</li><li id="f501" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">享受开箱即用的环境隔离。</li><li id="31b2" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">捕捉视频、截图和其他关于失败的人工制品。</li><li id="a90f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">将您的POM集成为可扩展的设备。</li></ul><h1 id="2d3f" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">装置</h1><p id="f947" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">创建一个名为“剧作家_框架”的空文件夹。然后键入<strong class="ih hj"> npm init -y </strong>来初始化项目。</p><p id="b0a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后安装下面的节点模块，开始我们的测试。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="f985" class="ld js hi kz b fi le lf l lg lh">#Playwright has its own end-to-end test runner, which we call Playwright Test.<br/>npm i -D <a class="ae li" href="http://twitter.com/playwright/test" rel="noopener ugc nofollow" target="_blank">@playwright/test</a><br/># install supported browsers<br/>npx playwright install</span></pre><p id="088a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装完成后，您可以看到如下所示的package.json文件:</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="183f" class="ld js hi kz b fi le lf l lg lh">{<br/>  "name": "playwright_framework",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "@playwright/test": "^1.16.3"<br/>  }<br/>}</span></pre><h1 id="2ae7" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">编写我们的第一个测试</h1><p id="97e6" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">创建<code class="du lj lk ll kz b">tests/demo.spec.js</code>来定义你的测试。请注意，我使用WebStrom作为我的IDE。然后创建第一个测试来验证图标附近的文本，如下所示:</p><figure class="ku kv kw kx fd ln er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lm"><img src="../Images/fd159d31fa336d49272b1b4e89c92824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcCGDVXuUiL1znoQkDcHPQ.png"/></div></div></figure><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="b5a9" class="ld js hi kz b fi le lf l lg lh"><em class="lu">const</em> { test, expect } = require('@playwright/test'); <br/>test('demo test', <em class="lu">async</em> ({ page }) =&gt; {  <br/><em class="lu">await</em> page.goto('https://playwright.dev/');  <br/><em class="lu">const</em> title = page.locator('.navbar__inner .navbar__title');  <br/><em class="lu">await</em> expect(title).toHaveText('Playwright');});</span></pre><p id="9b50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，使用下面的命令运行您的测试，假设测试文件在tests目录中。剧作家测试刚刚使用Chromium浏览器在无头模式下进行了一次测试。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="8c66" class="ld js hi kz b fi le lf l lg lh">npx playwright test</span><span id="5154" class="ld js hi kz b fi lv lf l lg lh">yaseen@342-MC-C02PPBQ5G8WN playwright_framework % npx playwright test</span><span id="dc22" class="ld js hi kz b fi lv lf l lg lh">Running 1 test using 1 worker</span><span id="2b71" class="ld js hi kz b fi lv lf l lg lh">✓  tests/demo.spec.js:3:1 › demo test (6s)</span><span id="a300" class="ld js hi kz b fi lv lf l lg lh">1 passed (7s)<br/>yaseen@342-MC-C02PPBQ5G8WN playwright_framework %</span></pre><p id="b579" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们指导它使用带标题的浏览器:</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="debd" class="ld js hi kz b fi le lf l lg lh">npx playwright test --headed</span></pre><h1 id="674e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">配置文件简介</h1><p id="4d98" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">为了享受剧作家测试提供的所有特性，您需要创建一个配置文件剧作家.配置. js</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="e162" class="ld js hi kz b fi le lf l lg lh">const { devices } = require('@playwright/test');<br/><br/>const config = {<br/>    forbidOnly: !!process.env.CI, <em class="lu">//Whether to exit with an error if any tests or groups are marked as test.only(title, testFunction) or test.describe.only(title, callback). Useful on CI.<br/>    </em>retries: process.env.CI ? 2 : 0, <em class="lu">//The maximum number of retry attempts given to failed tests.<br/>    </em>use: {<br/>        trace: 'retain-on-failure', <em class="lu">//Playwright Trace Viewer is a GUI tool that helps exploring recorded Playwright traces after the script ran. Record a trace for each test, but remove it from successful test runs.<br/>    </em>},<br/>    projects: [<br/>        {<br/>            name: 'chromium',<br/>            use: { ...devices['Desktop Chrome'] },<br/>        },<br/>        {<br/>            name: 'firefox',<br/>            use: { ...devices['Desktop Firefox'] },<br/>        },<br/>        {<br/>            name: 'webkit',<br/>            use: { ...devices['Desktop Safari'] },<br/>        },<br/>    ],<br/>};<br/><br/>module.exports = config;</span></pre><p id="ba17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，测试应该在不同的浏览器中进行。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="b403" class="ld js hi kz b fi le lf l lg lh">yaseen@342-MC-C02PPBQ5G8WN playwright_framework % npx playwright test<br/>Using config at /Users/yaseen/Desktop/Code Tutorials/playwright_framework/playwright.config.js</span><span id="fabc" class="ld js hi kz b fi lv lf l lg lh">Running 3 tests using 3 workers</span><span id="ef1c" class="ld js hi kz b fi lv lf l lg lh">✓  [chromium] › tests/demo.spec.js:3:1 › demo test (4s)<br/>  ✓  [firefox] › tests/demo.spec.js:3:1 › demo test (7s)<br/>  ✓  [webkit] › tests/demo.spec.js:3:1 › demo test (13s)</span><span id="1194" class="ld js hi kz b fi lv lf l lg lh">3 passed (15s)</span></pre><p id="f2b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du lj lk ll kz b">--project</code>命令行选项运行单个项目。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="4d7d" class="ld js hi kz b fi le lf l lg lh">yaseen@342-MC-C02PPBQ5G8WN playwright_framework % npx playwright test --project=firefox<br/>Using config at /Users/yaseen/Desktop/Code Tutorials/playwright_framework/playwright.config.js</span><span id="7a6d" class="ld js hi kz b fi lv lf l lg lh">Running 1 test using 1 worker</span><span id="1592" class="ld js hi kz b fi lv lf l lg lh">✓  [firefox] › tests/demo.spec.js:3:1 › demo test (4s)</span><span id="4176" class="ld js hi kz b fi lv lf l lg lh">1 passed (5s)</span></pre><h1 id="ffc0" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">玩弄断言</h1><p id="1fe2" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">对于测试断言，剧作家测试利用了expect库。它用特定于剧作家的匹配来增强它，以提高测试的便利性。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="0635" class="ld js hi kz b fi le lf l lg lh">const { test, expect } = require('@playwright/test');<br/><br/>test('demo test', async ({ page }) =&gt; {<br/>    await page.goto('https://playwright.dev/');<br/><br/>    <em class="lu">// Expect a title "to contain" a substring.<br/>    </em>await expect(page).toHaveTitle(/Playwright/);<br/><br/>    <em class="lu">// Expect an attribute "to be strictly equal" to the value.<br/>    </em>await expect(page.locator('text=Get Started').first()).toHaveAttribute('href', '/docs/intro');<br/><br/>    <em class="lu">// Expect an element "to be visible".<br/>    </em>await expect(page.locator('text=Learn more').first()).toBeVisible();<br/><br/>    await page.click('text=Get Started');<br/>    <em class="lu">// Expect some text to be visible on the page.<br/>    </em>await expect(page.locator('text=Introduction').first()).toBeVisible();<br/>});</span></pre><h1 id="6fa3" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">测试夹具介绍</h1><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="d190" class="ld js hi kz b fi le lf l lg lh">test('basic test', <em class="lu">async</em> ({ page }) =&gt; {<br/>// Here {page} is fixture</span></pre><p id="f950" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">装置是为每个测试运行产生的对象。剧作家测试预装了这些装置，您也可以添加自己的装置。当执行测试时，剧作家测试检查每个测试声明，分析测试所需的夹具集合，并准备这些夹具，特别是为测试。</p><figure class="ku kv kw kx fd ln er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lw"><img src="../Images/6801310abfcc4a15ad7e3963b12ad400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48r5d4jW0I7C6mLs-Ey7eA.png"/></div></div></figure><h1 id="f9cc" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">剧作家测试挂钩简介</h1><p id="47f8" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">要建立和分解测试之间共享的资源，使用“test.beforeAll”和“test.afterAll”钩子。您还可以使用“test.beforeEach”和“test.afterEach”挂钩来分别构建和分解每个测试的资源。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="0abe" class="ld js hi kz b fi le lf l lg lh">const { test, expect } = require('@playwright/test');<br/><br/>test.describe('demo feature', () =&gt; {<br/>    test.beforeEach(async ({ page }) =&gt; {<br/>        <em class="lu">// Go to the starting url before each test.<br/>        </em>await page.goto('https://playwright.dev/');<br/>    });<br/><br/>    test('demo test', async ({ page }) =&gt; {<br/>        <em class="lu">// Assertions use the expect API.<br/>        </em>await expect(page).toHaveURL('https://playwright.dev/');<br/>    });<br/>});</span></pre><h1 id="655b" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">配置NPM脚本</h1><p id="3f0d" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">剧作家测试将默认检测剧作家.配置. js。</p><p id="8785" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">修改package.json以配置</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="07ef" class="ld js hi kz b fi le lf l lg lh">{<br/>  "name": "playwright_framework",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "test": "playwright test"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "@playwright/test": "^1.16.3"<br/>  }<br/>}</span></pre><p id="65cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们跑吧</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="b986" class="ld js hi kz b fi le lf l lg lh">yaseen@342-MC-C02PPBQ5G8WN playwright_framework % npm test</span><span id="f2e5" class="ld js hi kz b fi lv lf l lg lh">&gt; playwright_framework@1.0.0 test /Users/yaseen/Desktop/Code Tutorials/playwright_framework<br/>&gt; playwright test</span><span id="8423" class="ld js hi kz b fi lv lf l lg lh">Using config at /Users/yaseen/Desktop/Code Tutorials/playwright_framework/playwright.config.js</span><span id="1b5a" class="ld js hi kz b fi lv lf l lg lh">Running 3 tests using 3 workers</span><span id="e363" class="ld js hi kz b fi lv lf l lg lh">✓  [chromium] › tests/demo.spec.js:9:5 › demo feature › demo test (4s)<br/>  ✓  [firefox] › tests/demo.spec.js:9:5 › demo feature › demo test (5s)<br/>  ✓  [webkit] › tests/demo.spec.js:9:5 › demo feature › demo test (3s)</span><span id="fd27" class="ld js hi kz b fi lv lf l lg lh">3 passed (7s)</span></pre><p id="251c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想将配置文件放在其他地方，请使用--config选项。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="0256" class="ld js hi kz b fi le lf l lg lh">{<br/>  "name": "playwright_framework",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "test": "playwright test --config=tests/example.config.js"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "@playwright/test": "^1.16.3"<br/>  }<br/>}</span></pre><p id="f57e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想使用npm在带标题的浏览器中运行，请使用以下命令:</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="7f69" class="ld js hi kz b fi le lf l lg lh">npm run test -- --headed<!-- -->.<br/>#To pass options through npm script, use double dashes:</span></pre></div></div>    
</body>
</html>