<html>
<head>
<title>Aadhaar/Pan info extraction using Python (OCR)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python (OCR)提取 Aadhaar/Pan 信息</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/aadhaar-pan-info-extraction-using-python-ocr-5df81b6c66e3?source=collection_archive---------0-----------------------#2021-02-01">https://medium.com/nerd-for-tech/aadhaar-pan-info-extraction-using-python-ocr-5df81b6c66e3?source=collection_archive---------0-----------------------#2021-02-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/52ee1fa18568a08cf9df5fe4bcb9b6e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*u2kvIiZtukYjPs72R-Sneg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图片来源-谷歌</figcaption></figure></div><div class="ab cl iq ir gp is" role="separator"><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv"/></div><div class="hb hc hd he hf"><h1 id="54f6" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">什么是 Aadhaar</h1><p id="0e89" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Aadhaar 是一个 12 位的唯一身份号码，可以由印度居民或护照持有人根据他们的生物特征和人口统计数据自愿获得。这些数据由印度唯一身份认证机构(UIDAI)收集，该机构是印度政府于 2009 年 1 月成立的一个法定机构。Aadhaar 是世界上最大的生物识别系统。</p><p id="be1e" class="pw-post-body-paragraph jv jw hi jx b jy kt ka kb kc ku ke kf kg kv ki kj kk kw km kn ko kx kq kr ks hb bi translated">Aadhaar 卡由个人的关键信息组成，如姓名、性别、出生日期、明文以及二维码。UIDAI 推出了一种新的安全二维码，其中包含居民的人口统计信息，如姓名、地址、出生日期、性别和隐藏的 Aadhaar 号码，以及 Aadhaar 号码持有者的照片。</p><h1 id="800a" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">潘是什么</h1><p id="4872" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">PAN 代表永久账号。PAN 号是一个由字母和数字组成的十位数字，或“字母数字”术语，由所得税部门分配给所有纳税人，并且对每个人都是唯一的。PAN 号有助于当局跟踪任何个人的金融活动，因为 PAN 是所有支付形式的组成部分。PAN 号通过层压卡分配，称为 PAN 卡。PAN 卡包含 PAN 编号、姓名、出生日期和地址等信息。</p><blockquote class="ld le lf"><p id="a4d5" class="jv jw lg jx b jy kt ka kb kc ku ke kf lh kv ki kj li kw km kn lj kx kq kr ks hb bi translated">如你所见，PAN 和 AADHAAR 是印度两种主要的身份识别方式。T3】</p></blockquote><h1 id="472a" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">如何构建 Aadhaar 卡/ PAN 读卡器</h1><p id="4f0b" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">有两种方法可以构建自动提取持卡人生物和地理信息的应用程序:</p><ul class=""><li id="c223" class="lk ll hi jx b jy kt kc ku kg lm kk ln ko lo ks lp lq lr ls bi translated">使用 OCR 技术来识别印在卡上的字符</li><li id="a25c" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated">使用条形码识别技术解码 QR 码，然后将其解析为人类可读的格式</li></ul><p id="1bc9" class="pw-post-body-paragraph jv jw hi jx b jy kt ka kb kc ku ke kf kg kv ki kj kk kw km kn ko kx kq kr ks hb bi translated">我将逐步介绍第一种方法，即使用 Python 进行 OCR</p><h1 id="3679" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">创建 aadhaar_read 和 pan_read 模块</h1><p id="787b" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这是至关重要的一步，因为它需要了解文档的设计和模式。这里我们为使用 tesseract 提取的文本定义不同的标签。</p><blockquote class="ld le lf"><p id="9347" class="jv jw lg jx b jy kt ka kb kc ku ke kf lh kv ki kj li kw km kn lj kx kq kr ks hb bi translated"><strong class="jx hj"> aadhaar_read.py </strong></p></blockquote><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="92e2" class="mh iy hi md b fi mi mj l mk ml">import re<br/>def adhaar_read_data(text):<br/>    res=text.split()<br/>    name = None<br/>    dob = None<br/>    adh = None<br/>    sex = None<br/>    nameline = []<br/>    dobline = []<br/>    text0 = []<br/>    text1 = []<br/>    text2 = []<br/>    lines = text.split('\n')<br/>    for lin in lines:<br/>        s = lin.strip()<br/>        s = lin.replace('\n','')<br/>        s = s.rstrip()<br/>        s = s.lstrip()<br/>        text1.append(s)<br/><br/>    if 'female' in text.lower():<br/>        sex = "FEMALE"<br/>    else:<br/>        sex = "MALE"<br/>    <br/>    text1 = list(filter(None, text1))<br/>    text0 = text1[:]<br/>    <br/>    try:<br/><br/>        # Cleaning first names<br/>        name = text0[0]<br/>        name = name.rstrip()<br/>        name = name.lstrip()<br/>        name = name.replace("8", "B")<br/>        name = name.replace("0", "D")<br/>        name = name.replace("6", "G")<br/>        name = name.replace("1", "I")<br/>        name = re.sub('[^a-zA-Z] +', ' ', name)<br/><br/>        # Cleaning DOB<br/>        dob = text0[1][-10:]<br/>        dob = dob.rstrip()<br/>        dob = dob.lstrip()<br/>        dob = dob.replace('l', '/')<br/>        dob = dob.replace('L', '/')<br/>        dob = dob.replace('I', '/')<br/>        dob = dob.replace('i', '/')<br/>        dob = dob.replace('|', '/')<br/>        dob = dob.replace('\"', '/1')<br/>        dob = dob.replace(":","")<br/>        dob = dob.replace(" ", "")<br/><br/>        # Cleaning Adhaar number details<br/>        aadhar_number=''<br/>        for word in res:<br/>            if len(word) == 4 and word.isdigit():<br/>                aadhar_number=aadhar_number  + word + ' '<br/>        if len(aadhar_number)&gt;=14:<br/>            print("Aadhar number is :"+ aadhar_number)<br/>        else:<br/>            print("Aadhar number not read")<br/>        adh=aadhar_number</span><span id="3ccc" class="mh iy hi md b fi mm mj l mk ml"><br/>        <br/><br/>    except:<br/>        pass<br/><br/>    data = {}<br/>    data['Name'] = name<br/>    data['Date of Birth'] = dob<br/>    data['Adhaar Number'] = adh<br/>    data['Sex'] = sex<br/>    data['ID Type'] = "Adhaar"<br/>    return data<br/></span><span id="b8dc" class="mh iy hi md b fi mm mj l mk ml">def findword(textlist, wordstring):<br/>    lineno = -1<br/>    for wordline in textlist:<br/>        xx = wordline.split( )<br/>        if ([w for w in xx if re.search(wordstring, w)]):<br/>            lineno = textlist.index(wordline)<br/>            textlist = textlist[lineno+1:]<br/>            return textlist<br/>    return textlist</span></pre><blockquote class="ld le lf"><p id="d8bd" class="jv jw lg jx b jy kt ka kb kc ku ke kf lh kv ki kj li kw km kn lj kx kq kr ks hb bi translated"><strong class="jx hj"> pan_read.py </strong></p></blockquote><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="0b55" class="mh iy hi md b fi mi mj l mk ml"><br/>import re<br/>def pan_read_data(text):<br/>    name = None<br/>    fname = None<br/>    dob = None<br/>    pan = None<br/>    nameline = []<br/>    dobline = []<br/>    panline = []<br/>    text0 = []<br/>    text1 = []<br/>    text2 = []<br/>    lines = text.split('\n')<br/>    for lin in lines:<br/>        s = lin.strip()<br/>        s = lin.replace('\n','')<br/>        s = s.rstrip()<br/>        s = s.lstrip()<br/>        text1.append(s)</span><span id="027c" class="mh iy hi md b fi mm mj l mk ml">text1 = list(filter(None, text1))<br/>    lineno = 0</span><span id="75f1" class="mh iy hi md b fi mm mj l mk ml">for wordline in text1:<br/>        xx = wordline.split('\n')<br/>        if ([w for w in xx if re.search('(INCOMETAXDEPARWENT|INCOME|TAX|GOW|GOVT|GOVERNMENT|OVERNMENT|VERNMENT|DEPARTMENT|EPARTMENT|PARTMENT|ARTMENT|INDIA|NDIA)$', w)]):<br/>            text1 = list(text1)<br/>            lineno = text1.index(wordline)<br/>            break</span><span id="7d8e" class="mh iy hi md b fi mm mj l mk ml">text0 = text1[lineno+1:]<br/>    try:</span><span id="173f" class="mh iy hi md b fi mm mj l mk ml"># Cleaning first names<br/>        name = text0[0]<br/>        name = name.rstrip()<br/>        name = name.lstrip()<br/>        name = name.replace("8", "B")<br/>        name = name.replace("0", "D")<br/>        name = name.replace("6", "G")<br/>        name = name.replace("1", "I")<br/>        name = re.sub('[^a-zA-Z] +', ' ', name)</span><span id="a978" class="mh iy hi md b fi mm mj l mk ml"># Cleaning Father's name<br/>        fname = text0[1]<br/>        fname = fname.rstrip()<br/>        fname = fname.lstrip()<br/>        fname = fname.replace("8", "S")<br/>        fname = fname.replace("0", "O")<br/>        fname = fname.replace("6", "G")<br/>        fname = fname.replace("1", "I")<br/>        fname = fname.replace("\"", "A")<br/>        fname = re.sub('[^a-zA-Z] +', ' ', fname)</span><span id="df75" class="mh iy hi md b fi mm mj l mk ml"># Cleaning DOB<br/>        dob = text0[2][:10]<br/>        dob = dob.rstrip()<br/>        dob = dob.lstrip()<br/>        dob = dob.replace('l', '/')<br/>        dob = dob.replace('L', '/')<br/>        dob = dob.replace('I', '/')<br/>        dob = dob.replace('i', '/')<br/>        dob = dob.replace('|', '/')<br/>        dob = dob.replace('\"', '/1')<br/>        dob = dob.replace(" ", "")</span><span id="efc2" class="mh iy hi md b fi mm mj l mk ml"># Cleaning PAN Card details<br/>        text0 = findword(text1, '(Pormanam|Number|umber|Account|ccount|count|Permanent|ermanent|manent|wumm)$')<br/>        panline = text0[0]<br/>        pan = panline.rstrip()<br/>        pan = pan.lstrip()<br/>        pan = pan.replace(" ", "")<br/>        pan = pan.replace("\"", "")<br/>        pan = pan.replace(";", "")<br/>        pan = pan.replace("%", "L")</span><span id="be37" class="mh iy hi md b fi mm mj l mk ml">except:<br/>        pass</span><span id="de11" class="mh iy hi md b fi mm mj l mk ml">data = {}<br/>    data['Name'] = name<br/>    data['Father Name'] = fname<br/>    data['Date of Birth'] = dob<br/>    data['PAN'] = pan<br/>    data['ID Type'] = "PAN"<br/>    return data</span><span id="4852" class="mh iy hi md b fi mm mj l mk ml"><br/>def findword(textlist, wordstring):<br/>    lineno = -1<br/>    for wordline in textlist:<br/>        xx = wordline.split( )<br/>        if ([w for w in xx if re.search(wordstring, w)]):<br/>            lineno = textlist.index(wordline)<br/>            textlist = textlist[lineno+1:]<br/>            return textlist<br/>    return textlist</span></pre><h1 id="3721" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated"><strong class="ak">所需库</strong></h1><ul class=""><li id="982c" class="lk ll hi jx b jy jz kc kd kg mn kk mo ko mp ks lp lq lr ls bi translated"><strong class="jx hj"> Pytesseract: </strong>这个库用于使用基于 tesseract 的 OCR 从图像中读取文本。</li><li id="7f7a" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated">cv2: 这是一个<a class="ae mq" href="https://analyticsindiamag.com/why-is-opencv-gaining-prominence/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>库</li><li id="0449" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated"><strong class="jx hj"> ftfy: </strong>为您修复文本</li><li id="aa53" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated"><strong class="jx hj"> NumPy: </strong>数组计算的基础包</li><li id="b861" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated"><strong class="jx hj"> os: </strong>提供与操作系统交互的功能</li><li id="de8c" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated"><strong class="jx hj"> re: </strong>用于处理正则表达式。</li><li id="eb22" class="lk ll hi jx b jy lt kc lu kg lv kk lw ko lx ks lp lq lr ls bi translated"><strong class="jx hj"> PIL: </strong>影像库</li></ul><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="85b7" class="mh iy hi md b fi mi mj l mk ml">import json<br/>import pytesseract<br/>import cv2<br/>import numpy as np<br/>import sys<br/>import re<br/>import os<br/>from PIL import Image<br/>import ftfy<br/>import pan_read           <br/>'''module which we made to read the text of the document'''<br/>import aadhaar_read<br/>import io</span></pre><h1 id="ad11" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">1|图像提取</h1><p id="66be" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">照片提取的预处理包括定义初始变量，将图像转换为灰度以提高可读性，然后定义从图像文件中提取照片的函数。</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="c164" class="mh iy hi md b fi mi mj l mk ml">img = cv2.imread("image.jpg")</span><span id="538e" class="mh iy hi md b fi mm mj l mk ml">img = cv2.resize(img, None, fx=2, fy=2,interpolation=cv2.INTER_CUBIC)</span><span id="2248" class="mh iy hi md b fi mm mj l mk ml">img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span><span id="65a2" class="mh iy hi md b fi mm mj l mk ml">var = cv2.Laplacian(img, cv2.CV_64F).var()</span><span id="b7aa" class="mh iy hi md b fi mm mj l mk ml">if var &lt; 50:<br/>    print("Image is Too Blurry....")<br/>    k= input('Press Enter to Exit.')<br/>    exit(1)</span></pre><h1 id="bfde" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated"><strong class="ak"> 2|使用宇宙魔方提取文本并固定文本</strong></h1><p id="15e9" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jx hj"> Python </strong> - <strong class="jx hj">宇宙魔方</strong>是<strong class="jx hj"> python </strong>的<strong class="jx hj">光学字符识别</strong> ( <strong class="jx hj"> OCR </strong>)工具。也就是说，它将识别并“读取”嵌入图像中的文本。此外，如果用作脚本，<strong class="jx hj">Python</strong>-<strong class="jx hj">tesse ract</strong>将打印识别的文本，而不是将其写入文件。</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="766c" class="mh iy hi md b fi mi mj l mk ml">filename = "image.jpg"<br/>text = pytesseract.image_to_string(Image.open(filename), lang = 'eng')<br/><br/>text_output = open('output.txt', 'w', encoding='utf-8')<br/>text_output.write(text)<br/>text_output.close()<br/><br/>file = open('output.txt', 'r', encoding='utf-8')<br/>text = file.read()<br/><br/>text = ftfy.fix_text(text)<br/>text = ftfy.fix_encoding(text)</span></pre><h1 id="bf09" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">3|检查 PAN 或 Aadhaar</h1><p id="a9fa" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这是至关重要的一步，需要你对文件/卡片、其设计和模板有一个概念。因为在这里您将区分文档</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="3954" class="mh iy hi md b fi mi mj l mk ml">if "income" in text.lower() or "tax" in text.lower() or "department" in text.lower():<br/>    data = pan_read.pan_read_data(text)<br/>elif "male" in text.lower():<br/>    data = aadhaar_read.adhaar_read_data(text)</span></pre><h1 id="0daf" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">4|为 JSON 编写</h1><p id="f561" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">将输出写入名为 info.json 的 JSON 文件</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="c268" class="mh iy hi md b fi mi mj l mk ml">try:<br/>    to_unicode = unicode<br/>except NameError:<br/>    to_unicode = str<br/>with io.open('info.json', 'w', encoding='utf-8') as outfile:<br/>    data = json.dumps(data, indent=4, sort_keys=True, separators=(',', ': '), ensure_ascii=False)<br/>    outfile.write(to_unicode(data))</span></pre><h1 id="3799" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">5|读取 JSON 数据</h1><p id="d6f4" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">读取 info.json 中存储的数据</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="1a0d" class="mh iy hi md b fi mi mj l mk ml">with open('info.json', encoding = 'utf-8') as data:<br/>    data_loaded = json.load(data)</span></pre><h1 id="e8a0" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated"><strong class="ak"> <em class="mr"> 6|打印数据</em> </strong></h1><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="8843" class="mh iy hi md b fi mi mj l mk ml">if data_loaded['ID Type'] == 'PAN':<br/>    print("\n---------- PAN Details ----------")<br/>    print("\nPAN Number: ",data_loaded['PAN'])<br/>    print("\nName: ",data_loaded['Name'])<br/>    print("\nFather's Name: ",data_loaded['Father Name'])<br/>    print("\nDate Of Birth: ",data_loaded['Date of Birth'])<br/>    print("\n---------------------------------")<br/>elif data_loaded['ID Type'] == 'ADHAAR':<br/>    print("\n---------- ADHAAR Details ----------")<br/>    print("\nADHAAR Number: ",data_loaded['Adhaar Number'])<br/>    print("\nName: ",data_loaded['Name'])<br/>    print("\nDate Of Birth: ",data_loaded['Date of Birth'])<br/>    print("\nSex: ",data_loaded['Sex'])<br/>    print("\n------------------------------------")<br/>k = input("\n\nPress Enter To EXIT")<br/>exit(0)</span></pre><h1 id="38ef" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated">结果</h1><p id="19de" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Aadhaar 和 Pan 信息已成功生成，由于 Aadhaar 的模板不通用，因此存在一些小冲突，但您可以根据您的卡或任何其他文档编辑模块。因为最终它只是使用宇宙魔方光学字符识别的文本识别</p><h1 id="ed7a" class="ix iy hi bd iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju bi translated"><strong class="ak">未来方面</strong></h1><p id="fd87" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">计划使用各种模板和 Aadhaar 卡的设计训练模型，然后它将能够通过使用机器学习来检测 Aadhaar 卡的任何设计。</p><blockquote class="ld le lf"><p id="d746" class="jv jw lg jx b jy kt ka kb kc ku ke kf lh kv ki kj li kw km kn lj kx kq kr ks hb bi translated">但是，我从哪里得到我的模型的数据呢？啊！好吧，让我们期待最好的结果。</p></blockquote></div></div>    
</body>
</html>