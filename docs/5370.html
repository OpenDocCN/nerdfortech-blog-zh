<html>
<head>
<title>Import Currency Rates Into Excel With Power Query — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用超级查询将汇率导入Excel第2部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/import-currency-rates-into-excel-with-power-query-part-2-4f256c725844?source=collection_archive---------6-----------------------#2021-09-23">https://medium.com/nerd-for-tech/import-currency-rates-into-excel-with-power-query-part-2-4f256c725844?source=collection_archive---------6-----------------------#2021-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4c7b9ffa760b0b952d41c645878ca0e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ShsHJhA1C6hyzRUg9Dw38A.png"/></div></div></figure><p id="1b19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在教程的第2部分，我们将展示如何使用power query动态地将实时和历史汇率导入excel。您将能够更改单元格中的值来获得更新的费率。如果你是第一次阅读本教程，我们建议你先阅读<a class="ae jo" href="https://tradermade.com/tutorials/import-currency-rates-into-excel/" rel="noopener ugc nofollow" target="_blank"> <em class="jp">“使用超级查询将汇率导入Excel第一部分”</em> </a>。</p><p id="400e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者，你也可以阅读我们的教程<a class="ae jo" href="https://tradermade.com/tutorials/how-to-import-live-forex-cfd-data-in-excel-using-our-add-in" rel="noopener ugc nofollow" target="_blank"> <em class="jp">如何使用我们的插件</em> </a>将汇率导入Microsoft Excel。文章还附有一段视频。</p><p id="6ce6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始吧！</p><h2 id="c041" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated">第一部分</h2><p id="9a91" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">第一步</p><p id="0a12" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://marketdata.tradermade.com/login" rel="noopener ugc nofollow" target="_blank">登录</a>您的账户，导航至<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#historical_rates" rel="noopener ugc nofollow" target="_blank">文档</a>页面，从历史利率端点复制URL，如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/9b0b99fa88e029008a18cb82ceb2cc06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3xd_E5-lV9_q6i40.png"/></div></div></figure><p id="6da0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二步</p><p id="d4f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在打开一个Excel工作簿，在电子表格中单击数据，然后单击从web(从Web导入数据),粘贴我们刚才复制的URL，如下所示，然后单击确定。我们刚刚复制的URL有三个参数，我们需要提供这些参数来获取历史数据——其中两个我们将在本教程的后面部分进行动态处理——第一个是货币:欧元兑美元和GBPUSD；第二个是日期:2019–10–09，第三个是api_key:您的api_key。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/da7431f6efc38f053d45f6c5a0e66359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*euZX3Sbhqk_knQ-p.png"/></div></div></figure><p id="0c4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三步</p><p id="812a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您按下ok，一个编辑器窗口将出现，只需双击报价旁边的“列表”,如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/caa67fc0b9dfd7707320dd5b29040209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lV887HA1eRMneoOH.png"/></div></div></figure><p id="affe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第四步</p><p id="885a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在转换窗口中，右键单击列表，单击“到表”，然后单击“确定”。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/44dea88cf8ce1534e98f1878ffaae2e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pUcbTG7GbEpZti7L.png"/></div></div></figure><p id="54a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第五步</p><p id="9507" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如下所示，单击第1列旁边的双箭头按钮，取消选中“使用原始列名作为前缀”，然后单击“确定”。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/d466453986a97242f3f9af85561eac8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*w2oaM7xtCL3dwRvG.png"/></div></div></figure><p id="a22c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第六步</p><p id="c8b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在按下左上角的“关闭并加载到”,如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/14ebe3b5d73441ad4aadc5221841f1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0epOdVn5F-3532cM.png"/></div></div></figure><p id="b291" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第七步</p><p id="4575" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在选择一个单元格，我们已经选择了单元格F1，如下所示，然后按ok。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/73bd79426c97924508e8dfc37cbbcd68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GqheC9plmNxP-oBI.png"/></div></div></figure><p id="4537" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第八步</p><p id="32a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您现在可以看到，我们在所需的单元格中获得了历史汇率。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/213ab48b840f9d8f835bce3e5ea826f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x5V2gC1sVTtfYsfx.png"/></div></div></figure><p id="e97b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们已经获得了我们所请求的数据，我们希望能够更改电子表格中的单元格，并更新上面的列。让我们看看如何做到这一点。</p><h2 id="1b07" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated">第二部分</h2><p id="5911" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">第九步</p><p id="a3cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将插入如下所示的新列，并用我们需要的货币名称更新单元格A2到A5。在单元格A1中，我们将使用函数TEXTJOIN("，"，False，A2:A5):该公式只是以我们要求的格式连接货币，以请求实时和历史外汇数据，无需担心随着我们的发展，它的使用方式将变得显而易见。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/00abc1d7bfa54f47fd1f5983e33b123c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1oF4Fo1sHgvKwEpQ.png"/></div></div></figure><p id="a62f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第十步</p><p id="5fe9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在只需点击单元格A1，并在方框中填写“货币”,如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/45aef28bf1546e2e6c32d15a176fcfa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rhtrayBLc1cPPHS6.png"/></div></div></figure><p id="1117" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤11</p><p id="0fef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，右键单击查询和连接下的实时查询，然后单击编辑。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/39db4cb48ea71f7fa585656c8aaf8b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SIzOemCJRC1w-poQ.png"/></div></div></figure><p id="a51c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤12</p><p id="f763" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在点击高级编辑器后面的视图选项卡。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/ca86e22e783ddbefe347dbe5383f2210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1Um0_kfJNgPtZprU.png"/></div></div></figure><p id="9a01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第十三步</p><p id="3806" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看下面的图片，修改代码看起来有点吓人(对非程序员来说),但是不要担心，这很简单。我们将通过以下代码定义一个货币列表:</p><p id="2cc4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">货币列表= Excel。current workbook(){[Name = " currences "]}[Content]{ 0 }[column 1]，</p><p id="05d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单地复制粘贴上面的行，如下所示。上面的代码只是从excel工作簿中获取数据，其中的列名为“货币”。现在，只需将货币名称更改为“&amp; currency_list &amp;”，并单击如下所示的完成，然后从文件标签中关闭并加载。现在，您将拥有可以在电子表格中更改的实时汇率。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/f0863b2b0afdf9ca1ad1190bbbe4575f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nZ8-P0T8zG1FbAya.png"/></div></div></figure><p id="cc92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤14</p><p id="68df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们还将更改历史数据查询，以获取与我们请求的实时汇率相同的货币的每日汇率。简单的点击编辑如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/fbaf9d62b1809b7c0c2ba0256ca9ede1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KY7S6gXRVlR3h95y.png"/></div></div></figure><p id="1db8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第十五步</p><p id="8bbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在中单击“视图”选项卡，然后单击“高级编辑器”,就像我们在步骤12中所做的一样。按照步骤13中所示的相同过程，单击“完成”,然后单击“文件”选项卡中的“关闭并加载”。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/96fba3896bc29d75b1495befa31f43e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MlNdqSmozgkDglMs.png"/></div></div></figure><p id="16d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第十六步</p><p id="95f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在可以看到美元兑日元、欧元兑美元、欧元兑日元和美元兑瑞郎的历史OHLC数据更新，就像实时数据的货币一样。然而，我们还没有确定我们希望看到历史利率的日期。如果您还记得我们在步骤2中最初的历史数据请求，我们请求的是2019年10月9日的数据。如果我们想获得今天所有货币的数据会怎么样？好吧，让我们看看如何做到这一点。</p><p id="19b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">插入另一列，将A1命名为date_time，并在单元格中键入=TEXT(TODAY()，“yyyy-mm-dd”)，如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/9c3bb148eeb60d6c356eacc01474be01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3DDfUWbnqB_fnk3u.png"/></div></div></figure><p id="1ca1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤17</p><p id="cc64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，按照步骤14和15打开高级编辑器，这次我们将通过以下代码定义一个“dt”:</p><p id="7bf1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">dt = Excel。current workbook(){[Name = " date _ time "]}[Content]{ 0 }[column 1]，</p><p id="34ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们在步骤13中所做的那样，只需如下所示复制粘贴上面的行，并将源中URL中的2019–10–09替换为“&amp; dt &amp;”，然后单击“完成”。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/fd7cbc3b738d6aece029a1d686806f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i3U7gzvUOYIdRg12.PNG"/></div></div></figure><p id="0d8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您现在可以看到，我们在单元格中有我们选择的货币和我们请求的日期的实时和历史汇率。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/4c00948f4fe070414effe71d88bcd83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Pl0ATNTaBM3YrqjH.png"/></div></div></figure><p id="5441" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您可以随时请求费率和刷新数据。您甚至可以将每个查询的刷新率设置为每分钟一次。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/def6f5a4d3a0ebe15c14a9e4e73a5249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hWdy77LK300pEoti.png"/></div></div></figure><p id="7ecb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">步骤18</p><p id="5b50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">只需右键单击上图，然后根据需要设置刷新率。我们每一分钟刷新一次，如下所示。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/e92a8df6969ec425d60a671e86cbc34e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NG8OqrcZ5uSAYUBT.png"/></div></div></figure><p id="5460" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以随意刷新。对于免费计划，我们建议在30天内使用12小时的基础上，每小时刷新一次。如果您需要更频繁的刷新率，您可以随时从您的<a class="ae jo" href="https://marketdata.tradermade.com/myAccount" rel="noopener ugc nofollow" target="_blank">仪表盘</a>升级您的计划。如果您有任何问题或需要任何帮助，请不要犹豫<a class="ae jo" href="https://tradermade.com/contact" rel="noopener ugc nofollow" target="_blank">联系我们</a>。我们总是对定制的要求持开放态度。</p></div></div>    
</body>
</html>