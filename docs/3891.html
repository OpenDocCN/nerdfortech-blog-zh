<html>
<head>
<title>How to add inline HTML in Webview Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Webview Flutter中添加内嵌HTML</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-add-inline-html-in-webview-flutter-fcc7e0f6a3a2?source=collection_archive---------1-----------------------#2021-06-28">https://medium.com/nerd-for-tech/how-to-add-inline-html-in-webview-flutter-fcc7e0f6a3a2?source=collection_archive---------1-----------------------#2021-06-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/53e9de0aa093bdf269bccc1c29e4e2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RjBBdZXy17FKr8lJ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@aoddeh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ahmad Odeh </a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a598" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我以为你看了上面的图片后也会跳舞，因为我现在就在跳舞！哈哈…</p><p id="4abc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好了，回到今天的正题……我不打算一一讲述“<em class="jt">创建一个颤动的应用程序，等等等等</em>”。我相信你已经可以或者已经创建了一个Flutter应用程序，我相信你！</p><p id="1dd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我有了dart文件，名为:<em class="jt"> Webview.dart. </em></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="f664" class="kd ke hi jz b fi kf kg l kh ki">import 'package:flutter/material.dart';<br/><br/>class Webview extends StatefulWidget {<br/>  @override<br/>  _WebviewState createState() =&gt; _WebviewState();<br/>}<br/><br/>class _WebviewState extends State&lt;Webview&gt; {<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return Container();<br/>  }<br/>}</span></pre><p id="dd76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我们所拥有的，我们需要将<a class="ae iu" href="https://pub.dev/packages/webview_flutter" rel="noopener ugc nofollow" target="_blank"> Flutter_Webview </a>包添加到我们的<em class="jt">中。yaml: </em></p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="fb36" class="kd ke hi jz b fi kf kg l kh ki">dependencies:<br/>  flutter:<br/>    sdk: flutter<br/><br/><br/>  <em class="jt"># The following adds the Cupertino Icons font to your application.<br/>  # Use with the CupertinoIcons class for iOS style icons.<br/>  </em>cupertino_icons: ^1.0.2<br/>  webview_flutter: ^2.0.9<br/><br/>dev_dependencies:<br/>  flutter_test:<br/>    sdk: flutter</span></pre><p id="970f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">记得更换你的<em class="jt">minSDKVersion:</em>Android&gt;app&gt;build . gradle</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="d937" class="kd ke hi jz b fi kf kg l kh ki">defaultConfig <strong class="jz hj">{<br/>    </strong>// <em class="jt">TODO: Specify your own unique Application ID (https://developer.android.com/studio/build/application-id.html).<br/>    </em>applicationId "connelblaze.cb.ranqz"<br/>    minSdkVersion 20<br/>    targetSdkVersion 30<br/>    versionCode flutterVersionCode.toInteger()<br/>    versionName flutterVersionName<br/><strong class="jz hj">}</strong></span></pre><p id="7434" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后将权限添加到您的清单文件中:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="bba6" class="kd ke hi jz b fi kf kg l kh ki">&lt;manifest...<br/>&gt;</span><span id="5389" class="kd ke hi jz b fi kj kg l kh ki">&lt;uses-permission android:name="android.permission.INTERNET" /&gt;<br/>...</span><span id="bc49" class="kd ke hi jz b fi kj kg l kh ki">&lt;application</span></pre><p id="0766" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在回到我们的dart文件main.dart:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="da48" class="kd ke hi jz b fi kf kg l kh ki">import 'package:flutter/material.dart';<br/>import 'package:ranqz/screen/Home.dart';<br/><br/>void main() {<br/>  runApp(MyApp());<br/>}<br/><br/>class MyApp extends StatelessWidget {<br/>  // This widget is the root of your application.<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return MaterialApp(<br/>      title: 'Flutter Demo',<br/>      theme: ThemeData(<br/><br/>        primarySwatch: Colors.<em class="jt">blue</em>,<br/>      ),<br/>      home: Home(),<br/>    );<br/>  }<br/>}</span></pre><p id="0d0a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Home.dart:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="144d" class="kd ke hi jz b fi kf kg l kh ki">import 'package:flutter/material.dart';<br/>import 'package:ranqz/screen/Webview.dart';<br/><br/>class Home extends StatelessWidget {<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return Scaffold(<br/>      appBar: AppBar(<br/>        title: Text('Home'),<br/>      ),<br/>      body: Container(<br/>        child: Center(<br/>          child: GestureDetector(<br/>            onTap: () {<br/>              Navigator.<em class="jt">push</em>(context, MaterialPageRoute(builder: (context) =&gt; Webview()));<br/><br/>            },<br/>            child: Text("Go to webview"),<br/>          ),<br/>        ),<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><p id="309f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Webview.dart:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="92fe" class="kd ke hi jz b fi kf kg l kh ki">import 'dart:async';<br/>import 'dart:convert';<br/><br/>import 'package:flutter/material.dart';<br/>import 'package:webview_flutter/webview_flutter.dart';<br/><br/>class Webview extends StatefulWidget {<br/>  @override<br/>  _WebviewState createState() =&gt; _WebviewState();<br/>}<br/><br/>class _WebviewState extends State&lt;Webview&gt; {<br/>  final Completer&lt;WebViewController&gt; _controller =<br/>  Completer&lt;WebViewController&gt;();<br/>  WebViewController _con;<br/><br/>  /*<br/>  *<br/>  * Webview<br/>  * */<br/><br/>  String setHTML(String email, String phone, String name) {<br/>    return ('''<br/>    &lt;html&gt;<br/>      &lt;head&gt;<br/>        &lt;!-- Required meta tags --&gt;<br/>        &lt;meta charset="utf-8"&gt;<br/>        &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;<br/>        &lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"&gt;<br/>        &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"&gt;&lt;/script&gt;<br/>        &lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"&gt;&lt;/script&gt;<br/>      &lt;/head&gt;<br/>      <br/>        &lt;body style="background-color:#fff;height:100vh "&gt;<br/><br/>          &lt;div style="width: 50%; margin: 0 auto;margin-top: 200px"&gt;<br/>            &lt;table class="table table-striped"&gt;<br/>              &lt;tbody&gt;<br/>                &lt;tr&gt;<br/>                  &lt;th&gt;Name&lt;/th&gt;<br/>                  &lt;th&gt;$name&lt;/th&gt;<br/>                &lt;/tr&gt;<br/>                &lt;tr&gt;<br/>                  &lt;th&gt;Email&lt;/th&gt;<br/>                  &lt;td&gt;$email&lt;/td&gt;<br/>                &lt;/tr&gt;<br/>                &lt;tr&gt;<br/>                  &lt;th&gt;Phone&lt;/th&gt;<br/>                  &lt;th&gt;$phone&lt;/th&gt;<br/>                &lt;/tr&gt;<br/>              &lt;/tbody&gt;<br/>            &lt;/table&gt;<br/>            &lt;a type="button" class="btn btn-success" style="width: 210px" href="https://connelevalsam.github.io/connelblaze/"&gt;<br/>              Submit<br/>            &lt;/a&gt;<br/>          &lt;/div&gt;<br/>        &lt;/body&gt;<br/>      &lt;/html&gt;<br/>      <br/><br/>    ''');<br/>  }<br/><br/>  _printz() =&gt; print("Hello");<br/><br/>  _loadHTML() async {<br/>    _con.loadUrl(Uri.dataFromString(<br/>        setHTML(<br/>          "connelblaze@gmil.com",<br/>          "+2347034857296",<br/>          "Connel Asikong"<br/>        ),<br/>        mimeType: 'text/html',<br/>        encoding: Encoding.<em class="jt">getByName</em>('utf-8')<br/>    ).toString());<br/>  }<br/><br/><br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return Scaffold(<br/>      appBar: AppBar(<br/>        title: Text('Webview'),<br/>      ),<br/>      body: Builder(builder: (BuildContext context) {<br/>        return WebView(<br/>          initialUrl: 'https://flutter.dev',<br/>          javascriptMode: JavascriptMode.unrestricted,<br/>          onWebViewCreated: (WebViewController webViewController) {<br/>            // _controller.complete(webViewController);<br/>            _con = webViewController;<br/>            _loadHTML();<br/>          },<br/>          onProgress: (int progress) {<br/>            print("WebView is loading (progress : $progress%)");<br/>          },<br/>          navigationDelegate: (NavigationRequest request) {<br/>            if (request.url.startsWith('https://www.youtube.com/')) {<br/>              print('blocking navigation to $request}');<br/>              return NavigationDecision.prevent;<br/>            }<br/>            print('allowing navigation to $request');<br/>            return NavigationDecision.navigate;<br/>          },<br/>          onPageStarted: (String url) {<br/>            print('Page started loading: $url');<br/>          },<br/>          onPageFinished: (String url) {<br/>            print('Page finished loading: $url');<br/>          },<br/>          gestureNavigationEnabled: true,<br/>        );<br/>      }),<br/>    );<br/>  }<br/><br/>}</span></pre><p id="ad18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">恭喜你！！！你现在可以说:“妈妈，我成功了！</p><p id="a844" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论如何，你有任何意见或要说的，打电话给我。<br/>或者你想捐赠给这位英俊潇洒的年轻男性……你仍然可以来找我！</p><p id="b39c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是第2部分，使用了<a class="ae iu" href="https://connelblaze.medium.com/working-with-javascript-in-webview-flutter-639ee09124af" rel="noopener"> Javascript </a></p><p id="0507" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">干杯，继续编码！</p><p id="20cb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">给我买杯咖啡</p></div></div>    
</body>
</html>