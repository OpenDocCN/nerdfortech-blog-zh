<html>
<head>
<title>Driver Sleep Detection Using Computer Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用计算机视觉的驾驶员睡眠检测</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/driver-sleep-detection-using-computer-vision-eaee33cb22c4?source=collection_archive---------1-----------------------#2022-11-19">https://medium.com/nerd-for-tech/driver-sleep-detection-using-computer-vision-eaee33cb22c4?source=collection_archive---------1-----------------------#2022-11-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="53ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个基于计算机视觉的项目，用于检查车辆驾驶员是否困倦</p><h1 id="4bd2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">关于项目</h1><p id="b4ca" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">该项目的主要思想是保护长途旅行的司机，特别是在夜间，容易感到困倦。</p><p id="78ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该项目可以部署在 Raspberry Pi 上，并可以与汽车仪表板上的摄像头一起安装。该系统将自动检查该人是否困倦，并在该人似乎困倦时发出警报。</p><p id="eeeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">项目检查两件事。第一部分在</strong>之前已经实施。<strong class="ih hj">我在这里尝试添加打哈欠检测器作为附加功能。</strong></p><ol class=""><li id="ae91" class="kg kh hi ih b ii ij im in iq ki iu kj iy kk jc kl km kn ko bi translated">如果这个人的眼睛一直闭着，那么这个人已经睡着了(或者非常困)，并且发出警报，因为这很关键。</li><li id="4017" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">如果这个人在特定时间内打哈欠的次数超过一定次数，这意味着他非常困倦，就会发出警告。</li></ol><p id="d565" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">项目的第一部分灵感来自这里的<a class="ae ku" href="https://pyimagesearch.com/2017/05/08/drowsiness-detection-opencv/" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="9eac" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">项目的运作</h1><h2 id="b2df" class="kv je hi bd jf kw kx ky jj kz la lb jn iq lc ld jr iu le lf jv iy lg lh jz li bi translated">第 1 部分:睡眠检测器</h2><ol class=""><li id="ecbb" class="kg kh hi ih b ii kb im kc iq lj iu lk iy ll jc kl km kn ko bi translated">第一步是检测是否可以使用<a class="ae ku" href="http://dlib.net/" rel="noopener ugc nofollow" target="_blank"> dlib </a>库识别人脸。</li><li id="3f95" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">一旦找到一张脸，眼睛的坐标就被选定。下面的<a class="ae ku" href="https://www.researchgate.net/publication/343699139_A_framework_for_facial_age_progression_and_regression_using_exemplar_face_templates" rel="noopener ugc nofollow" target="_blank">图</a>显示了面部的坐标。</li></ol><figure class="ln lo lp lq fd lr er es paragraph-image"><div class="er es lm"><img src="../Images/36a8d0009cd7f17c7328640c03fb016d.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*vCNEDpVQr5jEO2SyjvVAcA.jpeg"/></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">面部坐标</figcaption></figure><p id="f197" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.一旦眼睛被识别，每只眼睛的眼睛纵横比(EAR)使用下面所示的等式来计算。</p><p id="e701" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">EAR = ((P2-P6) + (P3-P5)) / 2(P1-P4)</p><figure class="ln lo lp lq fd lr er es paragraph-image"><div class="er es ly"><img src="../Images/f3760fc2f198012da3d0a2190f1a2071.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*ccaBJzKUczjxyuB4uORtxA.png"/></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">耳朵</figcaption></figure><p id="a93c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.取两只眼睛的平均耳朵。</p><p id="a472" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.如果对于给定的连续帧数，双眼的平均耳朵低于阈值，则发出警报，并且驾驶员可以被唤醒。</p><p id="302e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.一个简单的实验就能找到每个司机/人的阈值。</p><blockquote class="lz"><p id="7b42" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">1.简单地使用命令“python main.py”运行主程序。</p><p id="0165" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">2.让这个人睁着眼睛一段时间，然后快速眨一下眼睛，然后让他睁着眼睛，再眨大一点。</p><p id="1e22" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">3.然后按“q”键停止程序。</p><p id="a075" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">4.打开文件“Graphs\EAR.png”。</p><p id="290b" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">5.在此图中，您可以看到相对于框架的可视化 EAR，由此，您可以识别和设置 EAR_threshold。</p><p id="6c4d" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">6.请在“config.json”中对此进行修改。</p><p id="16b9" class="ma mb hi bd mc md me mf mg mh mi jc dx translated">7.下图显示了一个示例图。红色块代表闪烁事件。</p></blockquote><p id="f6d1" class="pw-post-body-paragraph if ig hi ih b ii mj ik il im mk io ip iq ml is it iu mm iw ix iy mn ja jb jc hb bi translated"><strong class="ih hj">第 2 部分:哈欠检测器</strong></p><p id="2b7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.在类似的基础上，打哈欠探测器也工作并发出我们的警告。这些参数可以在<code class="du mo mp mq mr b">config.json</code>中调整。</p><p id="1e3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.哈欠检测器主要检查一个人是否打哈欠，以及是否根据 MAR 是否超过<code class="du mo mp mq mr b">MAR_threshold</code>来检测哈欠。</p><p id="5f85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9.如果在指定数量的帧(由<code class="du mo mp mq mr b">number_of_frames_yawns</code>定义)中有超过定义数量的哈欠<code class="du mo mp mq mr b">number_of_yawns</code>，则发出警报。</p><p id="43ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10.在第 6 点定义的类似基础上，可以检测和设置阈值。</p><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es ms"><img src="../Images/7526c33da815a2e6e0e3d09e485cf82d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jgFFFCBHyzYBVTn_jij-dg.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">耳朵图</figcaption></figure><h1 id="0748" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak"/>的先决条件</h1><ol class=""><li id="33df" class="kg kh hi ih b ii kb im kc iq lj iu lk iy ll jc kl km kn ko bi translated">安装<a class="ae ku" href="https://cmake.org/download/" rel="noopener ugc nofollow" target="_blank"> CMake </a>:因为 dlib 是基于 C 的，所以构建需要 CMake。另外，将 CMake 添加到您的环境变量中。</li><li id="c305" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">在这里安装 Visual Studio<a class="ae ku" href="https://visualstudio.microsoft.com/visual-cpp-build-tools/" rel="noopener ugc nofollow" target="_blank"/>:同时安装额外的软件包<code class="du mo mp mq mr b">CMake tools for Windows</code>。</li></ol><h1 id="61a7" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">运行代码</h1><ol class=""><li id="18c8" class="kg kh hi ih b ii kb im kc iq lj iu lk iy ll jc kl km kn ko bi translated">强烈建议使用虚拟环境。一篇关于此的中型文章可以在<a class="ae ku" rel="noopener" href="/swlh/create-a-python-virtual-environment-with-built-in-venv-module-109f71dccbdf">这里</a>找到。</li><li id="62a2" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">点击下载人脸检测<a class="ae ku" href="http://dlib.net/files/shape_predictor_68_face_landmarks.dat.bz2" rel="noopener ugc nofollow" target="_blank">的 dblib 模型。</a></li><li id="72fe" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">使用 pip <code class="du mo mp mq mr b">install -r requirements.txt</code>安装 requirements.txt</li><li id="7be6" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">为了测试或运行代码，运行命令<code class="du mo mp mq mr b">python main.py</code></li></ol><h1 id="99aa" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">附加说明</h1><h1 id="688c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">编码</h1><p id="e8af" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">该项目的代码可以在<a class="ae ku" href="https://github.com/adnanmushtaq1996/Driver_Sleep_Detection" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h1 id="fe57" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Python 版本</h1><p id="0823" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">整个项目是用 python 版本<code class="du mo mp mq mr b">Python 3.7.7</code>和 pip 版本<code class="du mo mp mq mr b">pip 19.2.3</code>开发的。</p><h1 id="509f" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">接触</h1><p id="4d69" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">如果有错误，请随时通过 Linkedin 联系我，电话是<a class="ae ku" href="https://www.linkedin.com/in/adnan-karol-aa1666179/" rel="noopener ugc nofollow" target="_blank"> Adnan </a>。</p></div></div>    
</body>
</html>