<html>
<head>
<title>Classification of fetal state using Cardiotocography data and SVM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用心脏分娩描记术数据和 SVM 对胎儿状态进行分类</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/classification-of-cardiotocography-using-svm-cbc56a4f68b?source=collection_archive---------0-----------------------#2020-04-11">https://medium.com/nerd-for-tech/classification-of-cardiotocography-using-svm-cbc56a4f68b?source=collection_archive---------0-----------------------#2020-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="f9a2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">心脏分娩图</strong></h1><p id="a3ab" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">因为我们都知道有许多技术可用于观察胎儿，超声技术是常用的技术之一，但是这种超声技术对于记录胎儿的心率和其他细节如子宫收缩不是很有帮助。这就是心育图发挥作用的地方。<strong class="jf hj">胎心描记术是一种帮助医生追踪胎儿心率</strong>的技术，包括在<strong class="jf hj">子宫收缩</strong>的帮助下测量加速度、减速度和变异性。此外，这种胎心描记法可用于将胎儿分为三种状态，即:</p><ul class=""><li id="260d" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">正常轨迹</li><li id="55cb" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">可疑痕迹</li><li id="d652" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">病理痕迹</li></ul><h1 id="53f2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">问题陈述</strong></h1><p id="396b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">胎儿脉搏率和子宫收缩(UC)是在怀孕期间和分娩前判断母亲和胎儿健康的基本和常见的诊断技术。通过观察心脏分娩数据，医生可以预测和观察胎儿的状态。因此<strong class="jf hj">我们将</strong>使用 CTG 数据和支持向量机来预测胎儿的状态。<strong class="jf hj">因此我们将使用 CTG 数据和支持向量机来预测胎儿的状态。</strong></p><p id="7ab1" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated"><strong class="jf hj">定义心育领域的一些最重要的术语:</strong></p><ol class=""><li id="f533" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ku kj kk kl bi translated">CTG 痕迹一般显示两条线。上面的线是以每分钟心跳数为单位的胎儿心率记录。下面一行是 TOCO 记录的子宫收缩。</li></ol><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/86c14215ba260e4e3ae1b43b57e81a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x3XVTndE3OYoFxNl.jpg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">该图像清楚地显示了两条线。上面的代表胎儿心率，下面的显示子宫收缩。</figcaption></figure><p id="b40f" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">2.四种胎心率特征是:</p><ul class=""><li id="d608" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">基线心率</li><li id="52be" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">变化性</li><li id="ae15" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">加速</li><li id="3de1" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">减速</li></ul><p id="4d1b" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">3.将子宫收缩量化为 10 分钟内出现的收缩次数，并在 30 分钟内取平均值。</p><ul class=""><li id="6c60" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">正常:10 分钟内≤ 5 次宫缩</li><li id="fe65" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">高:10 分钟内收缩≥ 5 次</li></ul><p id="c45c" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">4.基线心率是平均基线胎儿心率。</p><ul class=""><li id="6342" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">可靠特性:每分钟 110-160 次(bpm)</li><li id="9018" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">不可靠特性:100–109 BPM 或 161–180 BPM</li><li id="4c4c" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">异常特征:180 bpm</li></ul><p id="e4d1" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">5.可变性是指胎儿心率的波动，这将导致跟踪显示为锯齿状，而不是平滑的线。可变性是胎儿神经系统成熟的标志，并被视为胎儿储备的一种度量。</p><ul class=""><li id="f5cc" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">可靠特性:≥ 5 bpm</li><li id="3375" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">不放心功能:&lt;5 bpm for ≥40 minutes but &lt;90 minutes</li><li id="bdd7" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">Abnormal feature: &lt;5 bpm for &gt; 90 分钟</li></ul><p id="8bb1" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">6.减速是指胎儿心率从基线下降至少每分钟 15 次，持续至少 15 秒。根据减速与子宫收缩的关系，有三种类型的减速。早期减速始于子宫收缩开始，止于收缩结束。</p><ul class=""><li id="dc23" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">令人放心的特点:没有减速</li><li id="1c8b" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">不可靠的特征:早期减速、可变减速或单次延长减速达 3 分钟</li><li id="b0e1" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">异常特征:非典型的可变减速、延迟减速或单次延长减速超过 3 分钟。</li></ul><p id="a3a8" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">7.三类 CTG 痕迹如下:</p><ul class=""><li id="e7a3" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">正常迹线:具有所有四个特征的迹线:基线率 110-160 BPM、正常变异性、无减速和加速(可能存在也可能不存在)。</li><li id="777c" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">可疑跟踪:用一个不可靠的特性跟踪，其他三个是可靠的。</li><li id="bf71" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">病理痕迹:带有两个或两个以上不确定特征或一个或多个异常特征的痕迹。</li></ul><h1 id="1557" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">接近</strong></h1><p id="aa8f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们将使用特征基线值(经医学专家验证)、基线值(通过 SisPorto 获得)、加速度、胎动(SisPorto)、子宫收缩(SisPorto)、轻度减速、重度减速、长期减速、重复减速将胎儿分为三类，即正常、可疑和病理性。出于以下原因，我们将使用支持向量机模型来实现此目的:</p><ul class=""><li id="1302" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">它对高维数据的伸缩性相对较好。</li><li id="d81e" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated"><strong class="jf hj"> SVM </strong>未解决局部最优</li><li id="8425" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">SVM 模型在实践中具有推广性，在 SVM 过拟合的风险较小。</li><li id="73d9" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">内核技巧是支持向量机最棒的地方</li></ul><h1 id="f672" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">查看数据集:</strong></h1><p id="870c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">原始数据集可在以下位置找到:<a class="ae ll" href="https://github.com/dubeyakshat07/Fetal-Heart-Rate-using-SVM/tree/master/Dataset" rel="noopener ugc nofollow" target="_blank">https://github . com/dubeyakshat 07/胎儿心率使用 SVM/tree/master/Dataset </a></p><p id="64f6" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated"><em class="lm">数据集是从 UCI 机器学习知识库下载的，属于各自的所有者。</em></p></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lu"><img src="../Images/136ee4f8841162b219d4a4ad476b3fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHTka5llVr9DzfBQN2LFpw.jpeg"/></div></div></figure><p id="53c9" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">数据集中使用的缩写:</p><ul class=""><li id="f539" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">LBE:基线值(医学专家)</li><li id="37f1" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">LB:基线值(西斯波尔托)</li><li id="225b" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">AC:加速度(西斯波尔托)</li><li id="307f" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">FM:胎动<a class="ae ll" href="https://render.githubusercontent.com/view/ipynb?commit=7d71f777f687cbbc5497219c906891eb7e281808&amp;enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6475626579616b7368617430372f466574616c2d48656172742d526174652d7573696e672d53564d2f376437316637373766363837636262633534393732313963393036383931656237653238313830382f4648522e6970796e623f746f6b656e3d414c4d5853484d4e4150454151454c475954494f365043365347355132&amp;nwo=dubeyakshat07%2FFetal-Heart-Rate-using-SVM&amp;path=FHR.ipynb&amp;repository_id=254860563&amp;repository_type=Repository#FM:----foetal-movement-(SisPorto)" rel="noopener ugc nofollow" target="_blank"> </a></li><li id="a479" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">UC:子宫收缩(西斯波尔托)</li><li id="d62a" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">ASTV:异常短期变化的时间百分比(SisPorto)</li><li id="1c4c" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">DL:轻微减速</li><li id="d1ca" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">DS:严重减速</li><li id="e2ff" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">DP:长期减速</li><li id="9e0b" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">DR:反复减速</li><li id="0fa1" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">NSP:正常= 1；嫌疑人= 2；病理=3</li></ul><p id="f4cb" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated"><strong class="jf hj">寻找空值:</strong></p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lv"><img src="../Images/c6270e31bb4805b3c40236d0bf754c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eT_6LjOObKR8cCPO8UbYWA.jpeg"/></div></div></figure><p id="f785" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">由于缺失值的数量非常少，因此我们可以删除相应的行。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lw"><img src="../Images/4de29099e27cfb16b04a25b5085d5659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tNrGYtoVxQBvWh4Ic250Ug.jpeg"/></div></div></figure><p id="9f53" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">现在，没有空值。</p><h1 id="c3c3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">特征缩放</strong></h1><p id="d284" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">执行特征缩放:</strong></p><p id="ef78" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">我们使用标准缩放器缩放，因为它提高了我们的 SVM 模型的性能。标准化是一种转换，即<strong class="jf hj">通过移除每个特征的平均值来集中数据，然后通过将(非恒定)特征除以其标准偏差</strong>来缩放数据。标准化数据后，平均值为零，标准偏差为一。</p><p id="c654" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">标准化可以极大地提高模型的性能。例如，学习算法的目标函数中使用的许多元素(如支持向量机的 RBF 核或线性模型的 l1 和 l2 正则化子)假设所有特征都以零为中心，并且具有相同顺序的方差</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lx"><img src="../Images/120a92ddb3bb9bb7fb406a84048a115d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BK1DnPmnEWtqEptYUVdkQ.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">使用 StandardScaler()缩放数据</figcaption></figure><p id="ed12" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated"><strong class="jf hj">将数据拆分为训练集和测试集:</strong></p><p id="6c9a" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">我们已经将数据集分成了训练集和测试集。30 %将用于测试，70%将用于培训。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ly"><img src="../Images/6f47b1553892dd490dca1d0a8fde9685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nVU70l41YvVsHNlQ3eHeA.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">使用 train_test_split()拆分数据集</figcaption></figure><h1 id="d8dd" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">训练和测试模型:</strong></h1><p id="83bc" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们将使用多项式核的 SVM。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lz"><img src="../Images/534770fea8ecd121229f5ddf2dba3fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1bSj9QW6a8rotvNVTU2bKQ.jpeg"/></div></div></figure><p id="d153" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">正如我们可以观察到的，最大精度对应于伽马值 0.1。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ma"><img src="../Images/2d0ec2ccb8a35f868fd481ed428c9714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*229_H7A-iTFaM5WkWpK2Sg.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">使用 gamma=0.1 的内核进行训练和测试</figcaption></figure><p id="9ede" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated"><strong class="jf hj">评估模型:</strong></p><p id="fbc8" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">我们使用准确度分数、精确度分数、f1 分数和召回分数对模型进行了评估。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mb"><img src="../Images/f5a598c3f9e46ce0920aeef9992754f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJXjDs94JjoN1G-uP5hvvg.jpeg"/></div></div></figure><p id="8d1b" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated">我们可以观察到:</p><ul class=""><li id="cc6d" class="kb kc hi jf b jg kd jk ke jo kf js kg jw kh ka ki kj kk kl bi translated">accuracy_score:准确性是最直观的性能度量，它只是正确预测的观察值与总观察值的比率。有人可能会认为，如果我们有高精度，那么我们的模型是最好的。是的，准确性是一个很好的衡量标准，但只有当您拥有对称的数据集时，假阳性和假阴性的值几乎相同。<strong class="jf hj">我们模型的准确率为 87.74% </strong></li><li id="ff1b" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">precision_score: Precision 是正确预测的正面观察值与总预测正面观察值的比率。<strong class="jf hj">精度高意味着误报率低。我们的模型的准确率为 87.44% </strong></li><li id="cab7" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">recall_score: Recall 是正确预测的正面观察与实际类中所有观察的比率—是的。它也被称为模型的灵敏度。<strong class="jf hj">我们模型的召回分数是 87.77% </strong></li><li id="aed8" class="kb kc hi jf b jg km jk kn jo ko js kp jw kq ka ki kj kk kl bi translated">f1_score: F1 得分是准确率和召回率的加权平均值。因此，这个分数同时考虑了误报和漏报。直观上，它不像精确度那样容易理解，但是 F1 通常比精确度更有用，尤其是当你的职业分布不均匀的时候。如果假阳性和假阴性具有相似的成本，则准确性最好。<strong class="jf hj">我们模型的 f1_score 为，87.53% </strong></li></ul><p id="a082" class="pw-post-body-paragraph jd je hi jf b jg kd ji jj jk ke jm jn jo kr jq jr js ks ju jv jw kt jy jz ka hb bi translated"><strong class="jf hj">结论:我们的模型在数据集上表现得相当好，也许再做一些修改，它就能产生令医生们信服的结果。</strong></p><h1 id="5d37" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">快乐的一天伙计们！</strong></h1></div></div>    
</body>
</html>