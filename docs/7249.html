<html>
<head>
<title>How to Use Stored Procedure in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Power BI 中使用存储过程</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-use-stored-procedure-in-power-bi-c3ecfe5e5429?source=collection_archive---------0-----------------------#2022-09-07">https://medium.com/nerd-for-tech/how-to-use-stored-procedure-in-power-bi-c3ecfe5e5429?source=collection_archive---------0-----------------------#2022-09-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="224e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好，我们将讨论如何根据我们在 SQL Server 中创建的“存储过程”调用带有参数的数据来查询 PBI。</p><p id="02f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要在 SQL Server 中创建基本的存储过程:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f8ad1cb934883aef56b3ab0453290fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dZg8xqSVbWxlE0SnpaMnTA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">存储过程根据输入的客户 ID 获取基于订单日期的客户数据</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/1b8baa8e6a9399e65ceaa0a4127472c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*rGlFtjArn-Me506oLH_VaA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用存储过程查询</figcaption></figure><p id="1ad2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">创建参数</strong></p><p id="e583" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要定义创建的参数来在 PBI 运行存储过程。</p><p id="5d7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个过程中，我们的第一步将切换到 Power Query Editor 选项卡。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/61e85e32a79a8a4ba60b64d50b140cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19JJfU2iBlAB7aRtSWy8Ag.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">管理参数</figcaption></figure><p id="5517" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个阶段，我们将定义在存储过程中创建的“ID”参数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/f57ab883a6cf43588184dbc38c3839ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*cjVGKuSG1K2iK8OE3GzjnQ.png"/></div></figure><blockquote class="jw jx jy"><p id="5740" class="if ig jz ih b ii ij ik il im in io ip ka ir is it kb iv iw ix kc iz ja jb jc hb bi translated">我们需要确定 3 个领域:</p><p id="e155" class="if ig jz ih b ii ij ik il im in io ip ka ir is it kb iv iw ix kc iz ja jb jc hb bi translated">1)参数类型<br/> 2)建议值<br/> 3)当前值</p></blockquote><p id="ea11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">存储过程</strong></p><p id="0eaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，通过查询存储过程从 SQL Server 导入数据:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0b661c46d525f3583e5c2d971779b0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qK8ZJdqvCpLPlrKNX3R_7Q.png"/></div></div></figure><p id="880a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Power Query 将加载一个包含存储过程的 M 语言预览。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e77db089a74b85dddc671923b14885a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsWnWjSCK223gTckqOykFg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">m 语言</figcaption></figure><p id="dd6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">高级编辑</strong></p><p id="a820" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在高级编辑器上查看查询，并根据创建的参数编辑查询。(客户 ID)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/128b9f903a0fac368e98eedc41b3c0c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QplNLbn0YORcy8JoJfeGxQ.png"/></div></div></figure><p id="cca2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击“编辑权限”以允许超级查询执行存储过程。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/59e6fe3e13bc930c174d04bd23fdc076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5kRBLnzcsAa3rRVlG_oBA.png"/></div></div></figure><p id="aac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">电源查询中加载的数据</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a33250195f61c9b218f83abe985719c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l6-20Tg6qd6jq-q6btdO-A.png"/></div></div></figure><p id="43f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">报告输出</strong></p><p id="dfc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用这个过程定义的客户 ID 为 25 的报告的输出如下表所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/d1e802c7b131da564ef6bd34d30ea2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iogmm574vNaRjjFJQre83Q.png"/></div></div></figure></div></div>    
</body>
</html>