<html>
<head>
<title>Leveraging Salesforce Without Using Salesforce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 Salesforce 而不使用 Salesforce</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/leveraging-salesforce-without-using-salesforce-8ed8c2556926?source=collection_archive---------9-----------------------#2021-08-03">https://medium.com/nerd-for-tech/leveraging-salesforce-without-using-salesforce-8ed8c2556926?source=collection_archive---------9-----------------------#2021-08-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/250eef4e400517ecd52f1ea7f7f39eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jH8QdQnywv4mvQJqKV0nzg.jpeg"/></div></div></figure><p id="1437" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">早在 2008 年的一次 Gartner 企业架构峰会上，我第一次接触到 Salesforce。这里完全透明:我参加发布会的主要原因是一件看起来很酷的 force.comt 恤的承诺，它在最后等待着我们每个人。</p><p id="94aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这件衣服没有让我失望，因为我有几张度假照片，其中包括我穿这件衣服的照片。这是 2010 年我和儿子埃里克最喜欢的一张照片:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/3396f198077174115c86196fd1b83055.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*T5VLdKqM53bBthM22vuEwA.jpeg"/></div></figure><p id="82eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样没有让我失望的是基于当时的 force.com 平台的技术。那些日子有点混乱，因为有 force.com 和 Salesforce.com。我很快就明白了它们之间的区别，如下所示:</p><blockquote class="jt ju jv"><p id="11c1" class="iq ir jw is b it iu iv iw ix iy iz ja jx jc jd je jy jg jh ji jz jk jl jm jn hb bi translated">salesforce.com 通常用于指代 CRM 功能(销售、服务和营销应用程序)，而 force.com 通常用于指代底层平台(构建所有应用程序的数据库、代码和用户界面)</p></blockquote><p id="796f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TechTarget 还提供了如下定义【此处】(<a class="ae ka" href="https://searchcustomerexperience.techtarget.com/definition/Forcecom" rel="noopener ugc nofollow" target="_blank">https://searchcustomerexperience . TechTarget . com/definition/force com</a>)。随着时间的推移，Salesforce 已经停用了 force.com 品牌，将其平台产品简称为“Salesforce Platform”不过，那件 t 恤看起来很酷，对吧？</p><p id="c0dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几年后，我仍在那家派我参加 2008 年 Gartner 峰会的公司工作。就在那时，他们决定使用 Salesforce 来跟踪与租赁业务相关的项目。我对 Salesforce 的基本了解有助于建立通过内部 SendMail 网关传递的自定义电子邮件路由规则。然而，这确实是我唯一参与的 Salesforce 生态系统。</p><h1 id="ac1d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">2015 年和早期出版</h1><p id="a02a" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">快进七年到 2015 年。我现在是一名全职的功能开发人员，为一家非常大的汽车集团工作。在 sprint 的功能设计引入了轻量级 CRM 解决方案之后，我们的团队收到了来自公司办公室的指示，我们应该采用 Salesforce。</p><p id="29a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在接下来的六个月里，我们的敏捷团队——显然处于“<a class="ae ka" href="https://blog.trello.com/form-storm-norm-perform-stages-of-team-productivity" rel="noopener ugc nofollow" target="_blank">执行</a>阶段——成功地从现有的 CRM 解决方案转移到利用 Salesforce。这项工作激发了我在 DZone.com 上的第一批出版物:</p><p id="ccc1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ka" href="https://dzone.com/articles/getting-into-the-development-time-machine" rel="noopener ugc nofollow" target="_blank">进入开发时间机器</a></p><p id="f6d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">事实上，从那时起，我已经发表了几篇关于 Salesforce 的文章，其中一些如下:</p><ul class=""><li id="9b59" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn lj lk ll lm bi translated"><a class="ae ka" href="https://dzone.com/articles/continuous-integration-with-salesforce" rel="noopener ugc nofollow" target="_blank">与 Salesforce 的持续集成</a></li><li id="0301" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated"><a class="ae ka" href="https://dzone.com/articles/building-salesforce-using-atlassian-bitbucket-pipe" rel="noopener ugc nofollow" target="_blank">使用 Atlassian Bitbucket 管道构建 Salesforce】</a></li><li id="2426" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated"><a class="ae ka" href="https://dzone.com/articles/salesforce-offering-javascript-programming-model" rel="noopener ugc nofollow" target="_blank"> Salesforce 提供 JavaScript 编程模型</a></li><li id="2e8b" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated"><a class="ae ka" href="https://dzone.com/articles/planning-poker-using-salesforce-and-heroku" rel="noopener ugc nofollow" target="_blank">使用 Salesforce 和 Heroku 规划扑克</a></li><li id="1271" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated"><a class="ae ka" href="https://dzone.com/articles/integrating-traditional-cloud-development-with-sal" rel="noopener ugc nofollow" target="_blank">将传统云开发与 Salesforce 集成</a></li><li id="1bcf" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated"><a class="ae ka" href="https://dzone.com/articles/salesforce-walled-garden-no-more" rel="noopener ugc nofollow" target="_blank"> Salesforce:围墙花园不复存在</a></li></ul><h1 id="bfec" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">使用 Salesforce 作为服务</h1><p id="53d8" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">虽然 Salesforce 是一种极好的体验，但引入另一种用户界面并不总是一种理想的情况。事实上，早在 2015 年，当我们向习惯于反应式 web 设计的消费者展示(现在称为“Salesforce Classic”)用户界面时，我们的团队感觉我们在倒退。</p><p id="accb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从那时起，Salesforce 发展了他们的用户界面，首先发布了他们专有的 Aura 框架，然后推出了[Lightning web Components](<a class="ae ka" href="https://lwc.dev/" rel="noopener ugc nofollow" target="_blank">https://lwc.dev/</a>)，这是一个 Web 组件标准的实现，可以在其平台上运行，也可以用于您自己的 Web 应用程序。然而，要求消费者在他们的日常技术解决方案组合中采用另一种应用仍然是一个挑战。</p><p id="8cc6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一种方法是简单地利用 Salesforce 作为服务。毕竟，Salesforce 已经提供了一个健壮的 RESTful API 超过 10 年了，它允许 access 根据需要获取、发布、上传和删除对象数据。</p><p id="00d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本出版物的重点是提供如何利用 Salesforce API 的选项，同时回避 Salesforce 客户端的使用。</p><h1 id="6b31" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">我们的场景</h1><p id="126f" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">为了将事情放入使用 Salesforce RESTful API 的上下文中，考虑一个现有应用程序已经就位的示例。该应用程序提供了其用户所需的大部分日常功能。然而，一个主要的缺口是关于当前和潜在客户的联系信息。</p><p id="8277" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">功能团队最近发现 Salesforce 中存在所有必要的信息，并且已经有了维护这些联系人的流程。早期迹象表明，现有应用程序只需要对给定联系人进行少量更新。</p><p id="714f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文将着重于完成一个研究高峰，以完成以下项目:</p><ol class=""><li id="54da" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn ls lk ll lm bi translated">创建 Salesforce 实例以构建解决方案原型。</li><li id="24fa" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">建立在 Salesforce 中检索和更新联系人的机制。</li><li id="2661" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">确定身份验证的工作方式。</li><li id="a808" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">使用 Postman 或简单的 cURL 命令验证功能。</li></ol><h1 id="fbfa" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">你需要知道的是</h1><p id="5465" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">在我们开始之前，我觉得在走这条路之前应该知道一些事情。你知道，我在介绍中提到的关于 force.comt 恤的“完全透明”的事情。</p><h2 id="49b6" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">存在 API 限制</h2><p id="0077" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">我的功能团队在 2015 年面临的最大挑战是 Salesforce 允许每个客户端进行的 RESTful API 调用的数量。下面是来自<a class="ae ka" href="https://developer.salesforce.com/docs/atlas.en-us.salesforce_app_limits_cheatsheet.meta/salesforce_app_limits_cheatsheet/salesforce_app_limits_platform_api.htm" rel="noopener ugc nofollow" target="_blank"> API 请求限制和分配</a>页面的屏幕截图:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/26582d6e3e885384ed040532bfe41b5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGMLm5Y6A3la43k2Cm5DhA.png"/></div></div></figure><p id="0f24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的例子中，上面提到的两个项目是我们团队非常关心的。事后看来，鉴于对 Salesforce 的了解和缓存数据的能力，我相信最终的 Salesforce 实例不会超出这些限制。然而，我希望这篇文章为那些决定何时使用这种方法的人强调这一点。</p><h2 id="8ebf" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">认证选项</h2><p id="da1e" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">本文考虑了两种身份验证方法:</p><ul class=""><li id="130f" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn lj lk ll lm bi translated">使用 OAuth2 的基于用户的身份验证</li><li id="d814" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">使用 OAuth2 的基于服务的身份验证</li></ul><p id="c8b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">决定何时使用其中一个与作为 Salesforce 中的给定用户提出请求的愿望(或需求)直接相关。备选方案是使用基于服务的方法，其中所有请求都来自 Salesforce 中的单个用户。</p><p id="ccbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于本例，将使用基于服务的方法。因此，所有请求将在 Salesforce 中基于服务的帐户身份下完成。</p><h2 id="feb5" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">集成选项</h2><p id="2ddf" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">当连接到 Salesforce 时，有几个选项。在过去的六年里，我已经能够利用以下集成选项:</p><ul class=""><li id="fc39" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn lj lk ll lm bi translated">MuleSoft</li><li id="f5cd" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">Heroku 连接</li><li id="b622" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">通过客户端框架直接连接到 Salesforce RESTful API</li><li id="d161" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">Spring Boot 和 Salesforce RESTful API</li></ul><p id="2396" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用 MuleSoft 和 Heroku Connect 将提供连接器和对 Salesforce data domain 的深入了解。虽然两者都是优秀的解决方案，但它们需要额外的投资，因为它们是基于订阅的。</p><p id="7adb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">直接连接选项是可能的，但是存在一些挑战。首先，基于服务的身份验证不太可能成为一种选择，因为以安全的方式保存登录凭据存在挑战。其次，随着 Salesforce 数据被重新格式化以便于理解，客户端将变得更重。</p><p id="00f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如您所料(并考虑到我的出版历史)，对于这个例子，我将利用 Spring Boot 选项并利用 Salesforce RESTful API。我对这种方法非常满意。</p><h1 id="f4ec" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">创建 Salesforce 实例</h1><p id="b740" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">第一步是创建 Salesforce 的免费开发人员实例。我可以使用以下 URL 开始使用:</p><p id="6a39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ka" href="https://developer.salesforce.com/signup" rel="noopener ugc nofollow" target="_blank">https://developer.salesforce.com/signup</a></p><p id="8d63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这导致了一个我必须在线填写的简单表格:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/2de91d709b1c383131a437e803b758f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*43_gy1_TY68yL0GK0QFSdg.png"/></div></figure><p id="cdce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">表格提交后，我在上述地址收到了以下电子邮件:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/d33f332f8f36f87760321cc55876658e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*fvP5W0WVim85p822-Zg-8A.png"/></div></figure><p id="d4c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这封电子邮件的内容非常有用，因为它提供了我的 Salesforce 开发人员实例的 URL，以及我的用户名。</p><p id="913e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">验证我的帐户后，我被要求设置密码。</p><p id="cbb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于开发人员实例中已经有联系人，Salesforce 的基本设置就完成了。</p><h2 id="5d65" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">添加连接的应用程序</h2><p id="4439" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">要从 Spring Boot 服务连接到 Salesforce，需要创建新的连接应用程序。</p><p id="8db9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下步骤是使用我的 Salesforce 开发人员实例完成的:</p><ol class=""><li id="496f" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn ls lk ll lm bi translated">导航至设置链接</li><li id="5587" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">导航至左侧菜单上的应用程序→应用程序管理器部分</li><li id="960e" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">选择新连接的应用程序按钮</li><li id="311b" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">填充以下属性:</li><li id="c2e4" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">将应用程序名称与“Spring Boot 集成”联系起来</li><li id="bb0b" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">API 名称(计算值应该没问题)</li><li id="24e1" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">联系电子邮件(您的电子邮件地址)</li><li id="dd66" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">API →启用 OAuth 设置= true</li><li id="7e35" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">将回拨网址设置为“【https://login.salesforce.com/】T2</li><li id="689e" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">使用 OAuth 作用域“访问和管理您的数据(api)”和“随时代表您执行请求(refresh_token，offline_access)”(目前)</li><li id="20c8" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">使用“放宽 IP 限制”(目前)</li><li id="f97b" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">使用“刷新令牌在被撤销前有效”(目前)</li><li id="9054" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn ls lk ll lm bi translated">保存新连接的应用程序</li></ol><p id="d2f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我创建的联网应用的一个例子:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/c995e570db2e2baa09e162522fe56b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E7MHGQJcQfzaunbVPoVWjA.png"/></div></div></figure><p id="71f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了澄清，下面是我使用的 OAuth 策略的一个例子:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/63040c84b9c991b6b40d1a2a3f05a15c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*noPqSp6aM8lZOF7YZFVuNw.png"/></div></div></figure><p id="fca5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请务必注意以下事项，以供日后参考:</p><ul class=""><li id="4cf9" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn lj lk ll lm bi translated">消费者关键价值</li><li id="2984" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">消费者秘密价值</li></ul><h2 id="e96c" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">配置网络访问</h2><p id="2cc4" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">原型阶段的一个可选(但推荐)步骤是创建可信 IP 范围。这既可用于您的 Salesforce 客户端实例，也可用于 Spring Boot 服务。</p><p id="e32c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个新的可信 IP 地址范围只需要知道<a class="ae ka" href="https://whatismyipaddress.com/" rel="noopener ugc nofollow" target="_blank">你当前的 IP 地址</a>并遵循下面列出的步骤。</p><p id="3e82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.获取您的 IPv4 地址(例如:45.67.100.27)<br/>2。在 Salesforce 设置<br/> 3 中导航至安全→网络访问。创建一个新的可信 IP 范围，其中包括您当前的 IP 地址(我使用的起始地址是 45.1.1.1 和 45.255.255.255)</p><p id="392a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此时，Salesforce 应该已经设置好，可以供 Spring Boot 服务使用了。</p><h1 id="8880" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">创建 Spring Boot 服务</h1><p id="2521" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">使用 IntelliJ IDEA 中的 Spring Initializr，创建了一个名为“salesforce-integration-service”的新 Spring Boot 服务，具有以下依赖关系:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="0bae" class="lt kc hi mn b fi mr ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>   &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span><span id="2073" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>   &lt;artifactId&gt;spring-boot-starter-jersey&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span><span id="8248" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>   &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span><span id="af39" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;<br/>   &lt;artifactId&gt;httpclient&lt;/artifactId&gt;<br/>   &lt;version&gt;4.5.13&lt;/version&gt;<br/>&lt;/dependency&gt;</span><span id="f48a" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br/>   &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;<br/>   &lt;version&gt;3.12.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span><span id="9ea8" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br/>   &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;<br/>   &lt;version&gt;4.4&lt;/version&gt;<br/>&lt;/dependency&gt;</span><span id="19b2" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>   &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;<br/>   &lt;optional&gt;true&lt;/optional&gt;<br/>&lt;/dependency&gt;</span><span id="ef92" class="lt kc hi mn b fi mv ms l mt mu">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;<br/>   &lt;artifactId&gt;lombok&lt;/artifactId&gt;<br/>   &lt;optional&gt;true&lt;/optional&gt;<br/>&lt;/dependency&gt;</span></pre><p id="4c24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Spring Boot 服务将利用以下两个功能:</p><ul class=""><li id="be7b" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn lj lk ll lm bi translated">RESTful 功能</li><li id="53c3" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">简单抽象缓存</li></ul><p id="f5a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上述值，创建了如下所示的运行配置:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/aa048e531fc4d71232febd5157cb9ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vi-4ymNAB2-8GW-pPlfSnA.png"/></div></div></figure><p id="6b53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动 Spring Boot 服务将在控制台中显示以下信息:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/3c27fcb56e6aa72d8c02d347cb3af816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyulKMLNwLA5vN4wR6D1yw.png"/></div></div></figure><p id="8e5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随着 Salesforce 服务的启动，是时候添加必要的集成类和方法了。</p><h2 id="5052" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">与 Salesforce 集成</h2><p id="b2db" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">由于本文的用例以联系人为中心，所以在 Spring Boot 创建了以下数据转换对象(dto ):</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="f536" class="lt kc hi mn b fi mr ms l mt mu"><a class="ae ka" href="http://twitter.com/AllArgsConstructor" rel="noopener ugc nofollow" target="_blank">@AllArgsConstructor</a><br/><a class="ae ka" href="http://twitter.com/NoArgsConstructor" rel="noopener ugc nofollow" target="_blank">@NoArgsConstructor</a><br/><a class="ae ka" href="http://twitter.com/JsonIgnoreProperties" rel="noopener ugc nofollow" target="_blank">@JsonIgnoreProperties</a>(ignoreUnknown = true)<br/><a class="ae ka" href="http://twitter.com/Data" rel="noopener ugc nofollow" target="_blank">@Data</a><br/>public class Contact {<br/>   public static final String CONTACT_QUERY = "SELECT Name, Title, Department FROM Contact";</span><span id="3784" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/JsonProperty" rel="noopener ugc nofollow" target="_blank">@JsonProperty</a>(value = "Name")<br/>   private String name;</span><span id="9ce3" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/JsonProperty" rel="noopener ugc nofollow" target="_blank">@JsonProperty</a>(value = "Title")<br/>   private String title;</span><span id="77ba" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/JsonProperty" rel="noopener ugc nofollow" target="_blank">@JsonProperty</a>(value = "Department")<br/>   private String department;</span><span id="91bb" class="lt kc hi mn b fi mv ms l mt mu">private SalesforceAttributes attributes;</span><span id="5a9a" class="lt kc hi mn b fi mv ms l mt mu">public String getId() {<br/>       if (attributes != null &amp;&amp; attributes.getUrl() != null) {<br/>           return StringUtils.substringAfterLast(attributes.getUrl(), "/");<br/>       }</span><span id="87c2" class="lt kc hi mn b fi mv ms l mt mu">return null;<br/>   }<br/>}</span><span id="9c07" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/AllArgsConstructor" rel="noopener ugc nofollow" target="_blank">@AllArgsConstructor</a><br/><a class="ae ka" href="http://twitter.com/NoArgsConstructor" rel="noopener ugc nofollow" target="_blank">@NoArgsConstructor</a><br/><a class="ae ka" href="http://twitter.com/JsonIgnoreProperties" rel="noopener ugc nofollow" target="_blank">@JsonIgnoreProperties</a>(ignoreUnknown = true)<br/><a class="ae ka" href="http://twitter.com/Data" rel="noopener ugc nofollow" target="_blank">@Data</a><br/>public class SalesforceAttributes {<br/>   private String type;<br/>   private String url;<br/>}</span></pre><p id="8974" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，当返回一个“Contact”对象时，它将包括一个类似于下面显示的有效负载:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="8c26" class="lt kc hi mn b fi mr ms l mt mu">{<br/>    "attributes": {<br/>        "type": "Contact",<br/>        "url": "/services/data/v52.0/sobjects/Contact/0035e000008eXq0AAE"<br/>    },<br/>    "id": "0035e000008eXq0AAE",<br/>    "Name": "Rose Gonzalez",<br/>    "Title": "SVP, Procurement",<br/>    "Department": "Procurement"<br/>}</span></pre><p id="0179" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于这些对象，Spring Boot RESTful 服务的设计如下所示:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/0b2b4d58478d68278b4dc9eec050ed95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yfrziN49gmXLeRkLxIzu-Q.png"/></div></div></figure><h2 id="7fea" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">介绍缓存</h2><p id="9453" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">为了减少检索数据所需的 API 调用次数，我这样配置了 Spring Boot 中包含的抽象缓存:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="64d9" class="lt kc hi mn b fi mr ms l mt mu"><a class="ae ka" href="http://twitter.com/Cacheable" rel="noopener ugc nofollow" target="_blank">@Cacheable</a>("contacts")<br/>public List&lt;Contact&gt; getContacts() throws Exception {<br/>    …<br/>}</span><span id="911c" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/CacheEvict" rel="noopener ugc nofollow" target="_blank">@CacheEvict</a>(value = "contacts", allEntries = true)<br/>public Contact updateContact(String id, PatchUpdates patchUpdates) throws Exception {<br/>    …<br/>}</span></pre><p id="1e0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">检索联系信息的方法使用`<a class="ae ka" href="http://twitter.com/Cacheable" rel="noopener ugc nofollow" target="_blank"> @Cacheable </a>'注释在可能的情况下设置/检索缓存。为了简单起见，在这个例子中，当一个联系人被更新时，使用`<a class="ae ka" href="http://twitter.com/CacheEvict" rel="noopener ugc nofollow" target="_blank">@ cache evit</a>'注释来驱逐整个缓存。</p><h1 id="83ca" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">添加日志拦截器</h1><p id="18bd" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">为了深入了解 Spring Boot RESTful 服务的性能，我创建了一个简单的日志拦截器，在处理 API 调用时将消息写入控制台。</p><p id="853f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一步是建立“LoggingInterceptor”类:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="2e20" class="lt kc hi mn b fi mr ms l mt mu"><a class="ae ka" href="http://twitter.com/Slf4j" rel="noopener ugc nofollow" target="_blank">@Slf4j</a><br/>public class LoggingInterceptor implements HandlerInterceptor {<br/>   private final String loggedStartTimeKey = "_loggedStartingTime";<br/>  <br/>   <a class="ae ka" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/>   public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {<br/>       long startTime = System.currentTimeMillis();<br/>       request.setAttribute(loggedStartTimeKey, startTime);<br/>       log.info("Request Started: method={} path={}", request.getMethod(), request.getRequestURI());<br/>       return true;<br/>   }</span><span id="a028" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/>   public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, <a class="ae ka" href="http://twitter.com/Nullable" rel="noopener ugc nofollow" target="_blank">@Nullable</a> Exception ex) {<br/>       long loggedStartTime = (long) request.getAttribute(loggedStartTimeKey);<br/>       long endTime = System.currentTimeMillis();<br/>       long timeTakenMs = endTime - loggedStartTime;<br/>       log.info("Request Completed: method={} path={} timeTaken={} (milliseconds)", request.getMethod(), request.getRequestURI(), timeTakenMs);<br/>   }<br/>}</span></pre><p id="d386" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我更新了“WebConfig”类以使用拦截器:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="74bd" class="lt kc hi mn b fi mr ms l mt mu"><a class="ae ka" href="http://twitter.com/Configuration" rel="noopener ugc nofollow" target="_blank">@Configuration</a><br/>public class WebConfig implements WebMvcConfigurer {<br/>   <a class="ae ka" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/>   public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(getLoggingInterceptor()).addPathPatterns("/**"); }</span><span id="f8ba" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/Bean" rel="noopener ugc nofollow" target="_blank">@Bean</a><br/>   public LoggingInterceptor getLoggingInterceptor() {<br/>       return new LoggingInterceptor();<br/>   }</span><span id="f948" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/Bean" rel="noopener ugc nofollow" target="_blank">@Bean</a><br/>   public ObjectMapper objectMapper() {<br/>       return new ObjectMapper().enable(SerializationFeature.INDENT_OUTPUT);<br/>   }</span><span id="49a2" class="lt kc hi mn b fi mv ms l mt mu"><a class="ae ka" href="http://twitter.com/Bean" rel="noopener ugc nofollow" target="_blank">@Bean</a><br/>   public CloseableHttpClient closeableHttpClient() {return HttpClients.createDefault();}<br/>}</span></pre><p id="b5e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在验证部分，下面显示的日志事件将包含在结果中。</p><h1 id="fedf" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">验证功能</h1><p id="d122" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">随着 Spring Boot 服务的使用和运行，下一步是验证我们预期的功能。</p><h2 id="8a4b" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">获取 Salesforce 联系人</h2><p id="767d" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">可以使用以下 cURL 命令通过 Spring Boot RESTful 服务从 Salesforce 检索联系人列表:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="0550" class="lt kc hi mn b fi mr ms l mt mu">curl --location --request GET '<a class="ae ka" href="http://localhost:9999/contacts'" rel="noopener ugc nofollow" target="_blank">http://localhost:9999/contacts'</a></span></pre><p id="c5f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">提交后，我们会收到一个 HTTP 200 (OK)响应，其中包含使用在 Spring Boot 创建的“联系人”DTO 的完整联系人列表:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="186d" class="lt kc hi mn b fi mr ms l mt mu">[<br/>    {<br/>        "attributes": {<br/>            "type": "Contact",<br/>            "url": "/services/data/v52.0/sobjects/Contact/0035e000008eXq0AAE"<br/>        },<br/>        "id": "0035e000008eXq0AAE",<br/>        "Name": "Rose Gonzalez",<br/>        "Title": "SVP, Procurement",<br/>        "Department": "Procurement"<br/>    },<br/>    {<br/>        "attributes": {<br/>            "type": "Contact",<br/>            "url": "/services/data/v52.0/sobjects/Contact/0035e000008eXqJAAU"<br/>        },<br/>        "id": "0035e000008eXqJAAU",<br/>        "Name": "Jake Llorrac",<br/>        "Title": null,<br/>        "Department": null<br/>    }<br/>]</span></pre><p id="86b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意:为了保持结果集的简洁，上面只显示了两个联系人项目。</p><p id="4b45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查看 Spring Boot RESTful 服务日志会显示以下信息:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="6c7c" class="lt kc hi mn b fi mr ms l mt mu">2021-06-29 09:03:46.945  INFO 27343 --- [nio-9999-exec-1] c.g.j.s.interceptors.LoggingInterceptor  : Request Started: method=GET path=/contacts<br/>2021-06-29 09:03:48.079  INFO 27343 --- [nio-9999-exec-1] <br/>2021-06-29 09:03:47.667 DEBUG 27343 --- [nio-9999-exec-1] c.g.j.s.utils.BearerTokenUtilities       : salesforceLoginResult=SalesforceLoginResult(data_goes_here)<br/>2021-06-29 09:03:48.041 DEBUG 27343 --- [nio-9999-exec-1] c.g.j.s.services.ContactService          : contacts=[contact_data_goes_here]<br/>c.g.j.s.interceptors.LoggingInterceptor  : Request Completed: method=GET path=/contacts timeTaken=1134 (milliseconds)</span></pre><p id="4b00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最初的请求需要一秒多一点的时间来处理。为了验证抽象缓存是否正常工作，我再次执行了相同的 cURL 命令。</p><p id="3dfa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二次，结果快得多，并且不需要呼叫“BearerTokenUtilities”或“ContactService ”:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="6ffb" class="lt kc hi mn b fi mr ms l mt mu">2021-06-29 09:10:04.928  INFO 27343 --- [nio-9999-exec-5] c.g.j.s.interceptors.LoggingInterceptor  : Request Started: method=GET path=/contacts<br/>2021-06-29 09:10:04.930  INFO 27343 --- [nio-9999-exec-5] c.g.j.s.interceptors.LoggingInterceptor  : Request Completed: method=GET path=/contacts timeTaken=2 (milliseconds)</span></pre><h2 id="e30c" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">获得单个 Salesforce 联系人</h2><p id="160b" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">要从 Salesforce 检索有关单个联系人的信息，需要该联系人的 ID，并执行原始 cURL 命令的类似版本:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="229a" class="lt kc hi mn b fi mr ms l mt mu">curl --location --request GET '<a class="ae ka" href="http://localhost:9999/contacts/0035e000008eXq0AAE'" rel="noopener ugc nofollow" target="_blank">http://localhost:9999/contacts/0035e000008eXq0AAE'</a></span></pre><p id="3822" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">提交后，我们收到一个 HTTP 200 (OK)响应，其中提供了 DTO 在 Spring Boot 创建的单一“联系人”:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="5a0b" class="lt kc hi mn b fi mr ms l mt mu">{<br/>    "attributes": {<br/>        "type": "Contact",<br/>        "url": "/services/data/v52.0/sobjects/Contact/0035e000008eXq0AAE"<br/>    },<br/>    "id": "0035e000008eXq0AAE",<br/>    "Name": "Rose Gonzalez",<br/>    "Title": "SVP, Procurement",<br/>    "Department": "Procurement"<br/>}</span></pre><p id="856a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当只需要一个联系人时，此 URI 很有用。</p><h2 id="7f0d" class="lt kc hi bd kd lu lv lw kh lx ly lz kl jb ma mb kp jf mc md kt jj me mf kx mg bi translated">更新联系信息</h2><p id="afe4" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">在我们的使用案例中，只需要对 Salesforce 中的联系人数据进行微小的更改。一个例子是改变联系人的头衔值。为了更新联系人的 title 属性，我们将使用以下 cURL 命令:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="6818" class="lt kc hi mn b fi mr ms l mt mu">curl --location --request PATCH '<a class="ae ka" href="http://localhost:9999/contacts/0035e000008eXq0AAE'" rel="noopener ugc nofollow" target="_blank">http://localhost:9999/contacts/0035e000008eXq0AAE'</a> \<br/>--header 'Content-Type: application/json' \<br/>--data-raw '{<br/>    "Title": "SVP, Procurement 2"<br/>}'</span></pre><p id="d484" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本例中，我们只是将标题从“SVP，采购”更改为“SVP，采购 2”</p><p id="42fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">提交此请求后，我们会收到一个 HTTP 202(已接受)响应，以及更新的“联系”DTO:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="f76d" class="lt kc hi mn b fi mr ms l mt mu">{<br/>    "attributes": {<br/>        "type": "Contact",<br/>        "url": "/services/data/v52.0/sobjects/Contact/0035e000008eXq0AAE"<br/>    },<br/>    "id": "0035e000008eXq0AAE",<br/>    "Name": "Rose Gonzalez",<br/>    "Title": "SVP, Procurement 2",<br/>    "Department": "Procurement"<br/>}</span></pre><p id="0eb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于缓存被完全收回，如果我们运行原始 cURL 来检索 Salesforce 中的所有联系人，将会出现以下日志:</p><pre class="jp jq jr js fd mm mn mo mp aw mq bi"><span id="9801" class="lt kc hi mn b fi mr ms l mt mu">2021-06-29 09:18:39.853  INFO 27343 --- [nio-9999-exec-5] c.g.j.s.interceptors.LoggingInterceptor  : Request Started: method=GET path=/contacts<br/>2021-06-29 09:18:40.314 DEBUG 27343 --- [nio-9999-exec-5] c.g.j.s.utils.BearerTokenUtilities       : salesforceLoginResult=SalesforceLoginResult(data_goes_here)<br/>2021-06-29 09:18:40.416 DEBUG 27343 --- [nio-9999-exec-5] c.g.j.s.services.ContactService          : contacts=[contact_data_goes_here]<br/>2021-06-29 09:18:40.418  INFO 27343 --- [nio-9999-exec-5] c.g.j.s.interceptors.LoggingInterceptor  : Request Completed: method=GET path=/contacts timeTaken=565 (milliseconds)</span></pre><h1 id="92e1" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论(展望未来)</h1><p id="7716" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">从 2021 年开始，我一直努力实践以下使命宣言，我觉得这适用于任何 IT 专业人士:</p><blockquote class="jt ju jv"><p id="a289" class="iq ir jw is b it iu iv iw ix iy iz ja jx jc jd je jy jg jh ji jz jk jl jm jn hb bi translated">“将您的时间集中在提供扩展您知识产权价值的特性/功能上。将框架、产品和服务用于其他一切。”—j·维斯特</p></blockquote><p id="420a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就像我的功能团队在 2015 年发现的那样，Salesforce 提供了一个令人惊叹的 CRM 解决方案，它当时满足了我们项目的需求，今天仍能满足该公司的需求。但是，有时使用整个 Salesforce 生态系统并不可取。</p><p id="0f80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们创建了一个 Spring Boot 服务示例，构建在成熟的 Salesforce RESTful API 之上，使用简单的 cURL 命令验证功能。在可能的情况下，缓存结果，以最大限度地减少对底层 Salesforce API 的 API 调用。</p><p id="65e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您对用于 Spring Boot 服务的源代码感兴趣，只需导航到 GitLab 上的以下存储库:</p><p id="2337" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ka" href="https://gitlab.com/johnjvester/salesforce-integration-service" rel="noopener ugc nofollow" target="_blank">https://git lab . com/johnj vester/sales force-integration-service</a></p><p id="7d27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">未来的文章将提供如何为以下基于 JavaScript 的客户端利用这一 Spring Boot 服务的示例:</p><ul class=""><li id="4e26" class="le lf hi is b it iu ix iy jb lg jf lh jj li jn lj lk ll lm bi translated">苗条的</li><li id="5fe0" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">vue . j</li><li id="d8a5" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">反应(自然反应)</li><li id="b34e" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">有角的</li><li id="4c67" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">Lightning Web 组件(在 Salesforce 生态系统之外)</li></ul><p id="a4c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些文章将提供如何将 Salesforce 集成到您当前应用程序中的高级示例，而无需用户登录 Salesforce。</p><p id="10a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">祝你今天过得愉快！</p></div></div>    
</body>
</html>