<html>
<head>
<title>How to deploy Python Django Project on AWS EC2 Ubuntu Server.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 AWS EC2 Ubuntu 服务器上部署 Python Django 项目？</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-deploy-python-django-project-on-aws-ec2-ubuntu-server-5c484fdb8f8c?source=collection_archive---------0-----------------------#2021-12-11">https://medium.com/nerd-for-tech/how-to-deploy-python-django-project-on-aws-ec2-ubuntu-server-5c484fdb8f8c?source=collection_archive---------0-----------------------#2021-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="719d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将学习如何使用 Gunicorn 在 AWS EC2 Ubuntu 服务器上部署 Django 项目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/91e83d2708076037f30c019f53b6a555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Bgrr5SLtZOOuuW-1.png"/></div></div></figure><p id="ddbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">先决条件</strong></p><ol class=""><li id="b245" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">在 AWS EC2 实例上创建一个 Ubuntu 服务器。<br/>如果尚未创建？<br/> <strong class="ih hj"> </strong> <a class="ae jy" rel="noopener" href="/@rahul26021999/how-to-create-a-ubuntu-20-04-server-on-aws-ec2-elastic-cloud-computing-5b423b5bf635"> <strong class="ih hj">了解如何在 AWS EC2(弹性云计算)上创建 Ubuntu 20.04 服务器</strong> </a></li><li id="c27c" class="jp jq hi ih b ii jz im ka iq kb iu kc iy kd jc ju jv jw jx bi translated"><a class="ae jy" href="https://rahul26021999.medium.com/how-to-connect-to-ec2-instance-aws-from-windows-ubuntu-da97c0cc9c8" rel="noopener"> <strong class="ih hj">连接上一步创建的 Ubuntu 服务器。</strong> </a></li></ol><h1 id="8a30" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">在 EC2 实例上部署 Django 项目的步骤</h1><h2 id="419c" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated"><strong class="ak">安装所需的库</strong></h2><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="8598" class="lc kf hi lr b fi lv lw l lx ly"><strong class="lr hj"># Update the ubuntu libraries</strong></span><span id="1458" class="lc kf hi lr b fi lz lw l lx ly">$ sudo apt-get update </span><span id="9c24" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Install Python, pip, Nginx, Postgresql</strong></span><span id="eb7c" class="lc kf hi lr b fi lz lw l lx ly">$ sudo apt-get install python3-pip python3-dev libpq-dev postgresql postgresql-contrib nginx</span><span id="2250" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Install Virtual Environement</strong></span><span id="9cd5" class="lc kf hi lr b fi lz lw l lx ly">$ sudo -H pip3 install --upgrade pip<br/>$ sudo -H pip3 install virtualenv</span></pre><h2 id="5cca" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">为项目创建一个虚拟环境并激活它。</h2><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="79e6" class="lc kf hi lr b fi lv lw l lx ly"><strong class="lr hj"># Create a project Directory</strong></span><span id="e456" class="lc kf hi lr b fi lz lw l lx ly">$ mkdir myproject</span><span id="5616" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Move inside Project Directory</strong></span><span id="5e7a" class="lc kf hi lr b fi lz lw l lx ly">$ cd myproject</span><span id="4de6" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Create Virtual Environment for project</strong></span><span id="ad99" class="lc kf hi lr b fi lz lw l lx ly">$ virtualenv <strong class="lr hj">myprojectenv</strong></span><span id="848c" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Activate virtual Environment</strong></span><span id="0999" class="lc kf hi lr b fi lz lw l lx ly">$ source <strong class="lr hj">myprojectenv</strong>/bin/activate</span></pre><h2 id="29e4" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">使用版本控制创建 Django 项目或克隆，并安装项目依赖项。</h2><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="b303" class="lc kf hi lr b fi lv lw l lx ly"><strong class="lr hj">#  Clone Existing Project in myproject Directory </strong></span><span id="099d" class="lc kf hi lr b fi lz lw l lx ly">$ git clone <a class="ae jy" href="https://github.com/rahul26021999/TicTacToe.git" rel="noopener ugc nofollow" target="_blank">https://github.com/YourUserName/</a><strong class="lr hj">djangoProject</strong><a class="ae jy" href="https://github.com/rahul26021999/TicTacToe.git" rel="noopener ugc nofollow" target="_blank">.git</a></span><span id="4965" class="lc kf hi lr b fi lz lw l lx ly">$ cd <strong class="lr hj">djangoProject</strong></span><span id="36f5" class="lc kf hi lr b fi lz lw l lx ly">$ pip install -r requirements.txt</span><span id="b9e1" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj">                                   OR</strong></span><span id="deb0" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Create a new Django Project in myproject Directory</strong></span><span id="6c3a" class="lc kf hi lr b fi lz lw l lx ly">$ <!-- -->pip install django</span><span id="a6be" class="lc kf hi lr b fi lz lw l lx ly">$ <!-- -->django-admin --version</span><span id="16e3" class="lc kf hi lr b fi lz lw l lx ly">$ <!-- -->django-admin startproject <strong class="lr hj">djangoProject</strong></span><span id="9177" class="lc kf hi lr b fi lz lw l lx ly">$<strong class="lr hj"> </strong>cd <strong class="lr hj">djangoProject</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/01e745774c64a14e3476a9f0403ef88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hzdUGCcLC4KaM9e38vR5kQ.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">目录结构</figcaption></figure><p id="6a87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们已经在 myproject 目录中创建了或者克隆了一个项目。我们的目录结构应该是这样的。</p><h2 id="0608" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated"><strong class="ak">更改项目设置</strong></h2><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="fb29" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ sudo vi <strong class="lr hj">djangoProject</strong>/settings.py</span></pre><p id="15e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)通过添加<strong class="ih hj">' * "</strong>，在 Settings.py 中更改允许的主机，以接受来自服务器 IP 或任何地方的 HTTP 请求。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="9032" class="lc kf hi lr b fi lv lw l lx ly">ALLOWED_HOSTS = ['*' ,'your_server_domain_or_IP', 'second_domain_or_IP']</span></pre><p id="2b5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)更改数据库设置</p><p id="87c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经在实例中安装了 Postgresql 数据库，您可以在 EC2 实例中创建新的数据库，也可以使用您想要的任何数据库。</p><p id="2423" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还可以使用 Django 项目默认附带的 SQLite 数据库。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="4554" class="lc kf hi lr b fi lv lw l lx ly">DATABASES = {<br/>    'default': {<br/>        'ENGINE': 'django.db.backends.postgresql_psycopg2',<br/>        'NAME': 'myproject',<br/>        'USER': 'myprojectuser',<br/>        'PASSWORD': 'password',<br/>        'HOST': 'localhost',<br/>        'PORT': '',<br/>    }<br/>}</span></pre><p id="94f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>将数据库名“myproject”，数据库用户“myprojectuser”，数据库密码“Password”替换为您的。</p><p id="3f2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">c)指示静态文件放置位置的设置</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="fd6c" class="lc kf hi lr b fi lv lw l lx ly"><strong class="lr hj"># Add on the top of setting.py file (Ignore if already there)</strong></span><span id="978d" class="lc kf hi lr b fi lz lw l lx ly">import os</span><span id="ddb4" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Add at the end of the setting.py File (Ignore if already there)</strong></span><span id="35a4" class="lc kf hi lr b fi lz lw l lx ly">STATIC_URL = '/static/'<br/>STATIC_ROOT = os.path.join(BASE_DIR, 'static/')</span></pre><p id="218d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保存并退出 setting.py 文件。</p><h2 id="a8e5" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">完成初始项目设置</h2><ol class=""><li id="b9ca" class="jp jq hi ih b ii mf im mg iq mh iu mi iy mj jc ju jv jw jx bi translated">将初始数据库模式迁移到我们已经创建的新数据库。</li></ol><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="4c40" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ python manage.py makemigrations<br/>(<strong class="lr hj">myprojectenv</strong>) $ python manage.py migrate</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/d374f8d3325af4b3883efa833ea102f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3sS7S-VskCqTKZzuWpF7w.png"/></div></div></figure><p id="e7a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认迁移后，您将看到如下结果。</p><p id="7f90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.创建超级用户</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="7814" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ python manage.py createsuperuser</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/925b23f357c726755933a74bf80e5922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBDPNy2aRIX5wdnK6Utz5w.png"/></div></div></figure><p id="007c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.收集所有静态文件</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="1bf0" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ python manage.py collectstatic</span></pre><p id="230d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可能需要确认操作。静态文件将被放在项目目录中的一个名为<code class="du mm mn mo lr b">static</code>的目录中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mp"><img src="../Images/47fd3dd80c10157e6dc8cdf23cb5fc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6ACw2Ykwh0g3mq6e67yng.png"/></div></div></figure><h2 id="95f4" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">测试服务器</h2><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="5b0f" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ python manage.py runserver 0.0.0.0:8000</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/e729242857ef50b81deed394c46211c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNrOVIGHhHlEDmAOCsn5Hg.png"/></div></div></figure><p id="caff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 web 浏览器中，访问服务器的域名或 IP 地址，然后按<code class="du mm mn mo lr b">:8000</code>。您将看到新项目的 Django 默认主页或现有 repo 的自定义页面。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="a082" class="lc kf hi lr b fi lv lw l lx ly">http://server_domain_or_IP:8000</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/2d38d52bf71978aaf96a670456b17281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGuaOmM4CR6oPyxk7Vsgqw.png"/></div></div></figure><p id="184c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du mm mn mo lr b"><a class="ae jy" href="http://server_domain_or_IP:8000" rel="noopener ugc nofollow" target="_blank">http://server_domain_or_IP:8000</a>/admin.</code>访问管理面板进行检查</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/6e419b2f7975a65dd867fceb7e358b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ihh9Edyuxp0Q7qy4a2dsIA.png"/></div></div></figure><p id="3d69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在终端中使用 CTRL-C 退出。我们将使用 Gunicorn 来主持这个项目，这只是为了探索和测试项目。</p><p id="6a95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>确保在创建 EC2 实例时已经打开了安全组中的安全入站端口 8000，如果没有，现在就可以打开。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/648a21ec7ade25d19a02e2c217648ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mka3exYHVqAFSUDD0InlZA.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">EC2 的安全入站设置</figcaption></figure><h2 id="b271" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">在虚拟环境中安装 Gunicorn 和 Postgres 适配器</h2><p id="836a" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mu is it iu mv iw ix iy mw ja jb jc hb bi translated">激活虚拟环境，安装 Django、Gunicorn 和带有本地实例<code class="du mm mn mo lr b">pip</code>的<code class="du mm mn mo lr b">psycopg2</code> PostgreSQL 适配器</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="b4f0" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ pip install django gunicorn psycopg2-binary</span></pre><h2 id="cf25" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">测试 Gunicorn 为项目服务的能力</h2><p id="75c7" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mu is it iu mv iw ix iy mw ja jb jc hb bi translated">这将在运行 Django 开发服务器的同一界面上启动 Gunicorn。您可以返回并再次测试该应用程序。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="61bf" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ gunicorn --bind 0.0.0.0:8000 <strong class="lr hj">djangoProject</strong>.wsgi</span></pre><p id="2d80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du mm mn mo lr b"><a class="ae jy" href="http://server_domain_or_IP:8000" rel="noopener ugc nofollow" target="_blank">http://server_domain_or_IP:8000</a>/admin</code>访问管理面板进行检查</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mx"><img src="../Images/055b7b9e4d52f17f9c9d9c5a34ea4af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*10k4wNLRcKX3HzgkxcU-Og.png"/></div></figure><p id="1b7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>管理界面不会应用任何样式，因为 Gunicorn 不知道负责这个的静态 CSS 内容。</p><p id="d966" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用 CTRL-C 退出。如果不是，那么试试 CTRL +SHFT + C</p><p id="76d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从虚拟环境中停用</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="8434" class="lc kf hi lr b fi lv lw l lx ly">(<strong class="lr hj">myprojectenv</strong>) $ deactivate</span></pre><p id="35f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经准备好使用 Gunicorn 托管了。</p><h2 id="6c6e" class="lc kf hi bd kg ld le lf kk lg lh li ko iq lj lk ks iu ll lm kw iy ln lo la lp bi translated">创建一个 Gunicorn systemd 服务文件</h2><p id="f00c" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mu is it iu mv iw ix iy mw ja jb jc hb bi translated">我们使用“djangoproject”作为服务名称，您可以在这里使用任何名称。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="3c9b" class="lc kf hi lr b fi lv lw l lx ly">$ sudo vi /etc/systemd/system/djangoproject.service</span><span id="83c0" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Add the below content to djangoproject service file and save it.</strong></span><span id="947b" class="lc kf hi lr b fi lz lw l lx ly">[Unit]<br/>Description=gunicorn daemon<br/>After=network.target</span><span id="2f23" class="lc kf hi lr b fi lz lw l lx ly">[Service]<br/>User=ubuntu<br/>Group=www-data<br/>WorkingDirectory=/home/ubuntu/myproject/<strong class="lr hj">djangoProject</strong><br/>ExecStart=/home/ubuntu/<strong class="lr hj">myproject/myprojectenv</strong>/bin/gunicorn --access-logfile - --workers 3 --bind unix:/home/ubuntu/<strong class="lr hj">myproject</strong>/<strong class="lr hj">djangoProject</strong>/<strong class="lr hj">djangoProject</strong>.sock <strong class="lr hj">djangoProject</strong>.wsgi:application</span><span id="2119" class="lc kf hi lr b fi lz lw l lx ly">[Install]<br/>WantedBy=multi-user.target</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/6c1345d7985029871cfbc5754b47f12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3PMWsthq9qtR6GnBPZ4sg.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">/etc/systemd/system/django project . service</figcaption></figure><p id="ad56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保存并退出文件。</p><p id="e33b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>确保这里的一切都是正确的。如果您使用不同的项目名称，请再次检查服务文件。</p><p id="f81d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以启动我们创建的 Gunicorn 服务并启用它，以便它在引导时启动:</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="4bf9" class="lc kf hi lr b fi lv lw l lx ly">$ sudo systemctl start djangoproject // start the service<br/>$ sudo systemctl enable djangoproject // Enable the service<br/>$ sudo systemctl status djangoproject // Check status</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/808cde9c37c18eb508dea0c9b4359e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2krpDRMNER2OQ4twerrcg.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/0c74af9646233645f90fb3564a5cb557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dXiTQSvxKtIwc-Zt4-1ow.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">djangoproject.service 状态检查</figcaption></figure><p id="f35d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用户 CTRL-C 退出状态。</p><p id="c704" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>如果 djangoproject.service 的状态不是<strong class="ih hj">“活动”</strong>，请检查错误，这可能是 djangoproject.service 文件中的路径错误。您可以编辑服务文件并进行更正。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="6f72" class="lc kf hi lr b fi lv lw l lx ly"><strong class="lr hj"># If there is any Error ( Run below commands after editing the .service file )</strong></span><span id="0b10" class="lc kf hi lr b fi lz lw l lx ly">$ sudo systemctl daemon-reload<br/>$ sudo systemctl restart djangoproject</span></pre><p id="fb9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在项目目录中检查 djangoproject 套接字文件。它一定在那里。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/f42cf524f55ecfaa0dcf9bfaee390224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GI-rESkZA4sv0uNdscrpLQ.png"/></div></div></figure><h1 id="bfbc" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">将 Nginx 配置为代理传递到 Gunicorn</h1><p id="b727" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mu is it iu mv iw ix iy mw ja jb jc hb bi translated">既然 Gunicorn 已经设置好了，我们需要配置 Nginx 将流量传递给进程。</p><p id="cfe7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先在 Nginx 的<code class="du mm mn mo lr b">sites-available</code>目录中创建和打开一个新的服务器块</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="599e" class="lc kf hi lr b fi lv lw l lx ly">$ sudo vi /etc/nginx/sites-available/<strong class="lr hj">djangoproject</strong></span><span id="dd16" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Add the code below</strong></span><span id="5dfe" class="lc kf hi lr b fi lz lw l lx ly">server {<br/>    listen 80;<br/>    server_name server_domain_or_IP;<br/><br/>    location = /favicon.ico { access_log off; log_not_found off; }<br/>    location /static/ {<br/>        root /home/ubuntu/<strong class="lr hj">myproject</strong>/<strong class="lr hj">djangoProject</strong>;<br/>    }<br/><br/>    location / {<br/>        include proxy_params;<br/>        proxy_pass http://unix:/home/ubuntu<strong class="lr hj">/</strong><strong class="lr hj">myproject/djangoProject</strong><strong class="lr hj">/</strong><strong class="lr hj">djangoProject</strong><strong class="lr hj">.sock;</strong><br/>    }<br/>}</span><span id="cb76" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># save and exit</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nc"><img src="../Images/8d6c14de49930312ce0a1de568589da4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_a21iaxp3G7H3-iGyZNwng.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">/etc/nginx/sites-available/ <code class="du mm mn mo lr b"><strong class="bd kg">djangoproject</strong></code></figcaption></figure><p id="ea45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>用<code class="du mm mn mo lr b">"server_domain_or_IP"</code>替换你的 IP 地址。</p><p id="32c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以通过将文件链接到<code class="du mm mn mo lr b">sites-enabled</code>目录来启用它:</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="a801" class="lc kf hi lr b fi lv lw l lx ly">$ sudo ln -s /etc/nginx/sites-available/<strong class="lr hj">djangoproject</strong> /etc/nginx/sites-enabled</span><span id="b6c1" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># Test your Nginx configuration for syntax errors by typing:</strong></span><span id="4946" class="lc kf hi lr b fi lz lw l lx ly">$ sudo nginx -t</span><span id="4604" class="lc kf hi lr b fi lz lw l lx ly"><strong class="lr hj"># If no errors are reported, go ahead and restart Nginx by typing:</strong></span><span id="0546" class="lc kf hi lr b fi lz lw l lx ly">$ sudo systemctl restart nginx</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nd"><img src="../Images/bdadba3778264f494a79cd60219c6beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDzcG3Wa3321TAoXZcbEIw.png"/></div></div></figure><p id="e4be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们完成了，你可以通过使用你的 IP 地址在网络浏览器上访问你的项目来测试它。我们已经在端口 80 上托管了这个应用程序，所以您不必在 URL 中输入任何端口，因为 80 是默认端口。</p><pre class="je jf jg jh fd lq lr ls lt aw lu bi"><span id="48d6" class="lc kf hi lr b fi lv lw l lx ly">http://server_domain_or_IP</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ne"><img src="../Images/64620aaef6320a6aace57b7e0af4e6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uzPOp2erh7XjK2eA4CZhRQ.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">默认 Django 页面</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/810dee275165fd74a6691caa174e5da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8I-XIBaX_l4tPh3uz6gJg.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">管理面板</figcaption></figure></div></div>    
</body>
</html>