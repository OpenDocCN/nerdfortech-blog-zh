<html>
<head>
<title>AWS Certified Solution Architect — EC2 &amp; AMI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS认证解决方案架构师— EC2和AMI</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/aws-certified-solution-architect-ec2-ami-4540126117bb?source=collection_archive---------2-----------------------#2022-04-18">https://medium.com/nerd-for-tech/aws-certified-solution-architect-ec2-ami-4540126117bb?source=collection_archive---------2-----------------------#2022-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3bc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好，在本教程中，我们将关注最受欢迎的AWS服务之一，EC2(弹性计算云)。换句话说，我们使用这项服务从AWS租用虚拟机。因此，作为一名AWS解决方案架构师，在创建EC2实例时，我们需要考虑一些要点，然后再决定要租赁什么样的虚拟机。</p><ul class=""><li id="6eb0" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">操作系统— Linux、Windows或Mac操作系统</li><li id="281a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">中央处理器</li><li id="d0f1" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">随机存取存储</li><li id="5776" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">储存；储备</li><li id="4c26" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">网卡—速度和公共IP地址</li><li id="fa71" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">安全组—防火墙规则</li><li id="5ee1" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">EC2用户数据—引导脚本</li></ul><p id="351a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在我们的上一个教程中，我们创建了一个AWS帐户，并了解了IAM。要访问这些教程，请点击以下链接。</p><div class="jr js ez fb jt ju"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/aws-certified-solution-architect-iam-8930ce442515"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hj fi z dy jz ea eb ka ed ef hh bi translated">AWS认证解决方案架构师— IAM</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">IAM的意思是身份和访问管理服务。当我们在之前的教程中创建AWS帐户时，我们…</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">medium.com</p></div></div><div class="kd l"><div class="ke l kf kg kh kd ki kj ju"/></div></div></a></div><div class="jr js ez fb jt ju"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/aws-certified-solution-architect-intro-2eb2942d11e7"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hj fi z dy jz ea eb ka ed ef hh bi translated">AWS认证解决方案架构师—简介</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">大家好，这是新的教程系列，希望是您在AWS认证解决方案架构师中的主要助手…</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">medium.com</p></div></div><div class="kd l"><div class="kk l kf kg kh kd ki kj ju"/></div></div></a></div><p id="aff3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你们知道如何访问AWS控制台了。就像我们在搜索框中搜索IAM search EC2一样。点击后，您将进入EC2部分。现在你会看到这样的景色。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/1aea90c5cfebef4d4d386a7e5521de22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0zIpDewg9PlwEaUfc8epw.png"/></div></div></figure><p id="2cf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要创建EC2实例，请单击左上角的instances选项卡，然后在我们看到的视图中有一个名为launch instance的按钮。点击它。现在我们的第一步是选择AMI (Amazon机器映像)。对于本教程，我将使用亚马逊Linux 2 AMI。按下那里的选择按钮。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kw"><img src="../Images/fed6539143c204a25fa1c6936f6648f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_fw5ZJJ_bZubB4g4XXrngA.png"/></div></div></figure><p id="87b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中将创建一个免费层(亚马逊不收费)。为此，我们在下一个屏幕中使用<strong class="ih hj"> <em class="kx"> t2.micro </em> </strong>实例类型。这里t表示实例类(这里是通用的)，2表示实例生成，micro表示实例的大小。大概有5种不同的情况。</p><ul class=""><li id="f030" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">通用</li><li id="cf98" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">计算优化</li><li id="f3ec" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">内存优化</li><li id="d95a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">存储优化</li></ul><p id="0f93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">记住这些都是AWS架构师考试要问的。因此，请尝试将这些与您必须使用EC2服务器的实际情况对应起来。我们已经讨论了操作系统、CPU和RAM等，现在让我们来谈谈网卡。</p><p id="48c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，对于EC2实例，有2个不同的IP4地址。私有IP和公有IP。专用IP用于AWS内部网络，公共IP用于互联网(WWW)。当我们停止和启动EC2实例时，这个IP地址可以更改，为了避免这种情况，我们在AWS中使用了弹性IP。因此，我们只需转到EC2 dashboard，转到Elastic IPs，然后创建它。AWS通常允许每个帐户有5个不同的弹性IP。但是在最佳实践中，不建议使用弹性IP。我们可以使用随机的公共IP，并为它们注册一个DNS名称，或者我们可以使用负载平衡器，完全避免使用公共IP。EC2实例是在VPC内部创建的。这些VPC有一个称为虚拟网卡的逻辑组件，这些网卡为EC2实例提供了一个弹性网络接口(ENI)。ENI可以有IP4私有和公有地址、安全组和MAC地址。在AWS中，我们可以创建ENI，并在EC2实例上动态连接它们以进行故障转移。弹性网络接口(Eni)被绑定到特定的AZ。您不能将ENI附加到不同AZ中的EC2例程。</p><p id="9cab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安全组用于向EC2实例添加防火墙规则。创建一个安全组是如此简单。我们只需转到EC2 dasboard，然后转到安全组，在那里创建一个新的安全组。安全组可以附加到多个EC2实例，我们可以使用它们将一个实例锁定到特定的区域。</p><p id="d312" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用安全组的最佳实践包括使用不同的安全组SSH always和always use IAM roles向EC2实例授权。此外，当我们在托管应用中遇到技术问题时，如果问题是超时问题，则可能是安全组问题。默认情况下，所有入站连接都受到限制，所有出站连接都在安全组中得到授权。</p><p id="f9d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在保留内存的情况下终止EC2实例，AWS提供了一个名为AWS Hibernate的新选项。在这里，RAM状态被保留，操作系统没有停止，只是重新启动，因此引导时间较短。在这里，RAM状态被写入EBS卷的根目录中的文件。这用于长时间运行的流程，需要时间初始化的服务。根卷必须加密才能使用，并且实例的RAM大小应小于150GB。实例不能休眠超过60天。要启用EC2休眠，EC2实例根卷类型必须是EBS卷，并且必须加密以确保敏感内容得到保护。</p><p id="b9ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">集群放置组将您的EC2实例并排放置，这为您提供了高性能的计算和网络。Spread Placement Group将您的EC2实例放置在不同az的不同物理硬件上。</p><p id="87cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">购买EC2实例主要有4种方式。当您成为解决方案架构师时，这一点非常重要。您应该了解如何以最低的成本为您的解决方案获得最好的东西。</p><ul class=""><li id="2c5d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">按需—短工作负载</li><li id="1132" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">保留—长期工作负载(可转换的和计划的)—(1-3年)</li><li id="88ec" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Spot reserved预测价格，然后输入高于现货当前价值的现货价格，或者可以使用spot block在计划的时间范围内阻止实例(通过使用Spot Block实例，您可以在指定的持续时间(1-6小时)内不间断地保留一组Spot EC2实例。).Spot Fleet是一组Spot实例和可选的按需实例。它允许您自动请求具有最低价格的现货实例。</li><li id="d088" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">专用—整个物理服务器—3年以上</li></ul><p id="ca15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">终止临时保留的实例时，首先取消临时请求，然后终止实例。</p><p id="9e72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">EC2的最新发展如下。</p><ul class=""><li id="513c" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">EC2 Nitro —新一代EC2，新的虚拟化技术，更高的性能(更高速度的EBS (Nitro — 64000IOPS，而非Nitro — 32000IOPS)，更好的网络(高性能计算、增强网络、IPv6)，更好的底层安全性</li><li id="dbc5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">EC2 vCPU —一个CPU上的多个线程，一个线程称为vCPU。每个CPU个CPU和2个线程，然后是8个vcpu。这些虚拟CPU可以根据我们的需要进行优化，以使用每个CPU—RAM或HPC(高性能计算)</li><li id="395b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">EC2容量预留—不需要1-3年的承诺，但确保我们在需要时拥有EC2容量(节约成本)</li></ul><p id="2c68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经谈了很多关于EC2的内容。所以现在是时候检查一下AMIs了。创建EC2实例时使用Amazon机器映像。因此，我们看到了一些内置的图像，但现在我们要创建一个定制的AMI。做到这一点的步骤非常简单，</p><ul class=""><li id="4ab4" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">创建一个EC2实例，并在该实例上进行我们需要的定制</li><li id="c960" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">将其转换为AMI</li></ul><p id="6274" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建新EC2时，有一个名为<strong class="ih hj">“Advanced details”</strong>的部分。单击它，您将看到一个名为“User Data”的文本框。在此文本框中，我们可以包含创建实例时要运行的特定脚本。另一件重要的事情是如下设置HTTPs和HTTP流量刻度。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div class="er es ky"><img src="../Images/3ff7f25b400bef06b88acc3d9945e506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*gyJh9QNBS2lzQdPhVHB2RQ.png"/></div></figure><p id="597c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如下输入用户详细信息。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div class="er es kz"><img src="../Images/6fb3e696b3cca40bdfa30bfd7c265079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*EF1mGqdeumEC6mG8D1lIuQ.png"/></div></figure><pre class="km kn ko kp fd la lb lc ld aw le bi"><span id="e7b7" class="lf lg hi lb b fi lh li l lj lk">#!/bin/bash<br/>yum update -y<br/>yum install -y httpd<br/>sudo su<br/>systemctl start httpd</span></pre><p id="8469" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里第一行非常重要，因为它将其余的行描述为bash命令。创建EC2实例后，尝试使用公共IPv4 DNS访问该实例。只需复制这个值并粘贴到浏览器中。如果一切正常，您应该会看到一个包含Apache服务器详细信息的网页。(确保在复制的url中使用http而不是https)。比如http://ec2-3-239-27-105.compute-1.amazonaws.com/的<a class="ae ll" href="http://ec2-3-239-27-105.compute-1.amazonaws.com/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="1de4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们创建这个实例的AMI。为此，进入实例屏幕，选择您需要转换的实例。现在点击创建图像。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lm"><img src="../Images/70d8c8938887a96ec3126eb74a51641c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QUwLG5A_DN88TVOMW5RdXg.png"/></div></div></figure><p id="8c0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后给出一个名称并创建AMI。现在转到启动实例并创建一个新的EC2。对于AMI，使用您创建的AMI，如下所示:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ln"><img src="../Images/b59af05d789e33438ab0ccb3705986f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJVUjEor8GqGY9Aa0Tw0pQ.png"/></div></div></figure><p id="fbfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在无需添加用户数据，只需启动实例，但要记住在network部分勾选HTTP。现在检查网址。您将看到apache服务器，这意味着这是我们之前定制的映像。</p></div></div>    
</body>
</html>