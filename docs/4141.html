<html>
<head>
<title>Host a static website on s3 using webhook jenkins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 webhook jenkins 在 s3 上托管一个静态网站</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/host-a-static-website-on-s3-using-webhook-jenkins-beb6328d6a5f?source=collection_archive---------16-----------------------#2021-07-08">https://medium.com/nerd-for-tech/host-a-static-website-on-s3-using-webhook-jenkins-beb6328d6a5f?source=collection_archive---------16-----------------------#2021-07-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="238e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提示:阅读 jenkins 的 web hook</strong></p><p id="0ba8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:这是一个管道方法</strong></p><p id="a951" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">安:</strong></p><p id="dd4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 1:设置简单的 S3 铲斗</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/18f21b0f5b15e4ff6e87f7de85f5fc12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O2h2YGabmzdMoh5MOMW04Q.png"/></div></div></figure><p id="313c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 2:这里我们使用自动化管道方法</p><p id="49b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jp" href="https://github.com/kushagra67414/jenkins-static-s3-deploy" rel="noopener ugc nofollow" target="_blank">https://github.com/kushagra67414/jenkins-static-s3-deploy</a></p><p id="4f0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它包括 Jenkins 管道和 s3 存储桶允许公众访问 index.html 和 error.html 文件所需的策略</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/5deff9b13a1c2321508017f2761c8786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdgHd8imA9J0wJLchbEvNQ.png"/></div></div></figure><p id="4b8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 3:管道设置</p><p id="d883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Jenkins 创建一个新的管道项目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jr"><img src="../Images/4927b45ab32984d48f292ad72b1b588a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7uzgtdpeJNdg5tBCFelKw.png"/></div></div></figure><p id="6cfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">管道= &gt;</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/5deff9b13a1c2321508017f2761c8786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdgHd8imA9J0wJLchbEvNQ.png"/></div></div></figure><p id="5bf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 git 存储库中添加一个 webhook。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es js"><img src="../Images/f86e53b4ba55f956e3bd2c03a33fbfde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3IKNnU152Hh4-L8wDlDAw.png"/></div></div></figure><p id="d120" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果此 repo 中的推送提交将创建一个版本，则需要 webhook 配置。</p><p id="b5b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 4:运行管道来测试它是否工作。它应该上传文件到 S3 桶。</p><p id="7953" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，配置作业。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/240f1f8ba967c83cd5d98470ab680fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_nJ6R45kJybZchf9kbTGQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/c69a1b57be12877037f44f01d6f6bcde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DQ3qOnhcpQqrwd5nr4LKiA.png"/></div></div></figure><p id="e832" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 5:配置作业后，构建项目，它必须将数据存储在 s3 存储桶中，但它可能会显示错误，因为我们没有在 jenkins 用户中配置 aws cli。</p><p id="0d9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在配置 aws cli，因为管道由 aws cli 命令组成，当管道执行时，它会检查 awi cli 环境</p><p id="03b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转到 jenkins 用户，配置 aws cli 以执行管道中的命令。</p><p id="0bc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先转到用户:</p><p id="5e02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">&gt;苏—詹金斯</p><p id="5b66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">&gt; aws 配置 root 用户的 add secret key 和 access key，或者使用 s3 bucket 的策略创建一个 iam 用户来访问它并提供 iam 用户的凭证。</p><p id="0266" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最佳实践是创建一个 iam 用户。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/8411ee852047ec3e1583e66561dd76c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BfWRTi9-RS7ErhEs8wWQwA.png"/></div></div></figure><p id="5f16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤 6:重启 jenkins 并构建项目</p><p id="d61d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">命令:systemctl 重新启动 jenkins</p><p id="5c1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">控制台输出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/6bf00573b6dfef3a8981f366a620b5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XolDPjnApm_uTgEtThM8Nw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/cc6deba365efca206ea2a8a8ea316113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjpUl9u6eTmpC2YyDV8vUQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/19d684cca4c78911fa88289c67f020c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8BSDdXjkcMT6IqoRVOF7g.png"/></div></div></figure></div></div>    
</body>
</html>