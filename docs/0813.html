<html>
<head>
<title>Making a nested accordion in React from JSON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中从JSON制作嵌套手风琴</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/making-a-nested-accordion-in-react-from-json-7d307b038f84?source=collection_archive---------0-----------------------#2021-02-16">https://medium.com/nerd-for-tech/making-a-nested-accordion-in-react-from-json-7d307b038f84?source=collection_archive---------0-----------------------#2021-02-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/292d1d03aff342b3883d7fc89e8aac44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9aecr6eeyToDoax2QTA7DQ.png"/></div></div></figure><p id="a7e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目录</strong> <br/> 1。<a class="ae jo" href="#f825" rel="noopener ugc nofollow">创建我们的项目</a> <br/> 2。<a class="ae jo" href="#979f" rel="noopener ugc nofollow">理解语义-ui-反应嵌套手风琴</a> <br/> 3。从json  <br/> 4制作嵌套手风琴。<a class="ae jo" href="#4d2b" rel="noopener ugc nofollow">工作示例</a></p><h1 id="f825" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">🌠创建我们的项目</h1><p id="75c3" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">使用以下命令创建一个react应用程序。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="45db" class="lb jq hi kx b fi lc ld l le lf">## Make react app<br/>npx create-react-app my-app</span><span id="f8fb" class="lb jq hi kx b fi lg ld l le lf">## change directory<br/>cd my-app</span></pre><p id="6fb0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在首选编辑器中打开文件夹。在我们开始之前，我们需要<a class="ae jo" href="https://react.semantic-ui.com/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">semantic-ui-react</strong></a><strong class="is hj"/>包，它将帮助我们渲染嵌套的手风琴。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="a43f" class="lb jq hi kx b fi lc ld l le lf">$  yarn add semantic-ui-react semantic-ui-css<br/>## Or NPM<br/>$  npm install semantic-ui-react semantic-ui-css</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="979f" class="jp jq hi bd jr js lo ju jv jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km bi translated">🌠<strong class="ak">理解语义-用户界面-反应嵌套手风琴</strong></h1><p id="f2d4" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在从json数据制作嵌套accordion之前，让我们试着熟悉一下semantic-ui-react包提供给我们的n <a class="ae jo" href="https://react.semantic-ui.com/modules/accordion/" rel="noopener ugc nofollow" target="_blank"> ested accordion。如果你已经知道它是如何工作的，请跳过这一部分，看看下一步</a>。</p><p id="7a2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个新文件。我们将它命名为example.js，以匹配(semantic-ui-react)文档。该文件将包含以下代码。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><ul class=""><li id="afe3" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">这段代码允许我们呈现一个嵌套的accordion(在添加index.js文件之后),如下所示。</li></ul><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es me"><img src="../Images/00565b71314a714dab8e7ec3a58abb28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*MVF2htccIUZpx6juQ_ypBQ.png"/></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">一级手风琴</figcaption></figure><ol class=""><li id="5a55" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn mj mb mc md bi translated">分别从react和semantic-ui-react库中导入React和Accordion(第1行和第2行)。</li><li id="6b7c" class="lv lw hi is b it mk ix ml jb mm jf mn jj mo jn mj mb mc md bi translated">根accordion(第34行)将rootPanels作为面板属性的输入。因为我们想要一个Level1面板的子accordion(第29行),所以我们称Level1Content组件(第9行)为它的内容。Level1Content取另一组面板作为其面板道具。它没有任何子accordion，所以我们传递一个简单的字符串作为它的内容(第5行和第6行)。</li></ol><p id="f70a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.这同样适用于2级面板。希望我们能在这里看到模式。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/39cd58451290fec1bf9f061e7c2f8490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*dyv09qy0vffMl-_pSwjPUw.png"/></div></figure><p id="d73d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更新index.js文件(在我们运行create react app命令时创建)以包含以下代码。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><ol class=""><li id="debb" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn mj mb mc md bi translated">我们需要确保添加样式表(第7–11行)。如果您想知道这些向嵌套的accordion组件添加了什么样式，我建议您注释掉这些行，并查看对呈现组件的影响。</li><li id="81a8" class="lv lw hi is b it mk ix ml jb mm jf mn jj mo jn mj mb mc md bi translated">用Container包装我们的嵌套accordion(在第5行作为“Example”导入),以给出一点余量。</li></ol><p id="64ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是语义用户界面反应文档中的一个工作示例。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="mq lu l"/></div><figcaption class="mf mg et er es mh mi bd b be z dx translated"><strong class="ak">嵌套折叠的语义-用户界面-反应沙箱</strong></figcaption></figure></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="078a" class="jp jq hi bd jr js lo ju jv jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km bi translated">🌠<strong class="ak">用json制作嵌套手风琴</strong></h1><p id="34e9" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在我们(希望)已经熟悉了semantic-ui-react包提供的嵌套accordion，让我们看看如何从json创建嵌套accordion。</p><p id="d199" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先更新example.js文件。让我们删除example.js中除导入之外的所有内容，然后像这样添加json数据。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><ol class=""><li id="4a4d" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn mj mb mc md bi translated">为了这篇文章的目的，我选择了一个例子，它有两行那么长，而且是嵌套的。这是为了让我们了解如何制定我们的json数据，以获得我们的嵌套手风琴。</li><li id="50b0" class="lv lw hi is b it mk ix ml jb mm jf mn jj mo jn mj mb mc md bi translated">json实际上只包括下面代码中提到的对象，我将把它称为<strong class="is hj">主对象</strong>。</li></ol><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="c32a" class="lb jq hi kx b fi lc ld l le lf">{<br/>    key : "String",<br/>    title:"String",<br/>    content:"Array including nested object"<br/>}</span></pre><p id="6c64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.如果我们不需要子accordion，内容键将包含一个空数组，如果我们需要子accordion，则包含上面解释的主对象数组。</p><p id="6676" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.还要注意，json数据被添加到一个数组中，因此我们可以有多个根级别面板。</p><p id="6437" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们可以关注这个过程的核心，即递归遍历json并将其转换为嵌套accordion的函数。在example.js文件中追加以下代码。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><ul class=""><li id="0e89" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">accordify函数将包含json数据的数组作为其参数。它将帮助我们递归地遍历json。我们这样做是因为我们首先需要最深的主对象，这样我们就可以将它作为父accordion的输入。</li><li id="4732" class="lv lw hi is b it mk ix ml jb mm jf mn jj mo jn ma mb mc md bi translated">如果我们在第7行的递归调用之后添加一个console.log语句，我们可以看到这个函数是如何遍历我们的输入的。</li></ul><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="ce47" class="lb jq hi kx b fi lc ld l le lf">accordify(<em class="mr">jsonData</em>[i]["content"]);</span><span id="64ef" class="lb jq hi kx b fi lg ld l le lf">console.log(<em class="mr">jsonData</em>[i]["key"])</span></pre><ul class=""><li id="4759" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">它先遍历到最深的{key:"string "，title:"string "，content:[ ]}对象(主对象)，然后移动到同级的兄弟对象(如果有的话)，再跳转到父手风琴，继续这个过程。</li></ul><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/db6db4b265dfceb99addccb54fbbb06c.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*gAmf-jJDtalW10diMf4OcQ.png"/></div></figure><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/c3e6cac214b2073b4a39427c69cb9f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*JlMRVmAOmrDqObNBV47yNA.png"/></div></figure><ul class=""><li id="6561" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">如果主对象有一个空数组作为内容键的值，也就是说它没有子accordion，我们用Accordion包装它。标题组件(第18行-第31行)。当然，您可以使用任何其他组件。</li><li id="d7b1" class="lv lw hi is b it mk ix ml jb mm jf mn jj mo jn ma mb mc md bi translated">如果主对象有一个非空数组作为内容键的值，也就是说它有一个子accordion(这个子accordion本身还可以有一个子accordion)，我们用Accordion包装它。折叠并将非空数组传递给它面板本身(第10行到第16行)。</li><li id="bc30" class="lv lw hi is b it mk ix ml jb mm jf mn jj mo jn ma mb mc md bi translated">如果我们想看看json数据在函数中运行后的实际情况，我们可以在函数调用后添加一个console.log语句，如下所示。</li></ul><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="36dc" class="lb jq hi kx b fi lc ld l le lf">console.log(JSON.stringify(jsonData,null,2))</span></pre><ul class=""><li id="83a1" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">最后，我们将更新后的json数据提供给Accordion组件的panels props，并将其导出。</li></ul><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="d817" class="lb jq hi kx b fi lc ld l le lf"><em class="mr">const</em> AccordionExampleNested = () <em class="mr">=&gt;</em> (</span><span id="55a4" class="lb jq hi kx b fi lg ld l le lf">     &lt;Accordion <em class="mr">defaultActiveIndex</em>={0} <em class="mr">panels</em>={jsonData} <em class="mr">styled</em> /&gt;</span><span id="74ad" class="lb jq hi kx b fi lg ld l le lf">);<br/>export default AccordionExampleNested;</span></pre><ul class=""><li id="583b" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">如果出于某种原因，您想知道这个函数执行需要多长时间，我们可以通过添加performance.now()函数来实现，如下所示。对于示例中的json，平均需要3毫秒。</li></ul><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="769d" class="lb jq hi kx b fi lc ld l le lf"><em class="mr">var start= performance.now();<br/></em>accordify(jsonData);<br/><em class="mr">var end= performance.now();<br/>console.log("Call to accordify took " + (end - start) + " milliseconds.");</em></span></pre><ul class=""><li id="faec" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">完成所有更新后，整个example.js文件应该如下所示。</li></ul><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="9dfc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我们的index.js文件的样子。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="4d2b" class="jp jq hi bd jr js lo ju jv jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km bi translated">🌠工作示例</h1><p id="3d08" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">您可以在代码沙箱中使用这个工作示例。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="mq lu l"/></div></figure><p id="9a61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者克隆这个<a class="ae jo" href="https://github.com/AshCatchEmAll/Accordify" rel="noopener ugc nofollow" target="_blank"> github repo </a>来查看工作示例。</p><p id="669e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看看我和我的团队在<a class="ae jo" href="https://devpost.com/AshCatchEmAll?ref_content=user-portfolio&amp;ref_feature=portfolio&amp;ref_medium=global-nav" rel="noopener ugc nofollow" target="_blank"> devpost </a>上构建的其他项目。感谢您的阅读。</p><p id="f9fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意安全，✨🌸</p></div></div>    
</body>
</html>