<html>
<head>
<title>Things You Must Know About the Man in the Middle Attack-ARP Spoofing, DNS Spoofing, and SSL Certificate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于中间人攻击您必须知道的事情——ARP 欺骗、DNS 欺骗和 SSL 证书</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/things-you-must-know-about-the-man-in-the-middle-attack-arp-spoofing-dns-spoofing-and-ssl-613b8fb74050?source=collection_archive---------7-----------------------#2021-05-19">https://medium.com/nerd-for-tech/things-you-must-know-about-the-man-in-the-middle-attack-arp-spoofing-dns-spoofing-and-ssl-613b8fb74050?source=collection_archive---------7-----------------------#2021-05-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9756d302d8d49b288d515444902a58d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adyRZrPPhm0PDWqAm8Yw8w.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">关于中间人攻击您必须知道的事情——ARP 欺骗、DNS 欺骗和 SSL 证书</figcaption></figure><p id="9994" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ARP 欺骗</strong></p><p id="b417" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ARP 中毒或 ARP 欺骗是一种中间人(MitM)攻击，攻击者进入两台通信设备之间并监听它们的通信。通常，这发生在同一个网络中。下面逐步定义在局域网(LAN)中发生这种情况的方式。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es js"><img src="../Images/f46e4673bdad0880fc98e481390f131e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3T9dyxazcBeoMOUF26gCQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图一。ARP 欺骗。</figcaption></figure><p id="d06c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如图 1 所示；</p><p id="0c9f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当用户 Y 试图访问 google 时，它会向局域网内的所有设备询问路由器的 MAC 地址。通常，路由器会用其 MAC 地址来响应消息。但是，在收到来自路由器的响应后的 MiM 攻击中，同一网络中的另一个设备(假设用户 X 是攻击者)也将使用其自己的 MAC 地址来响应同一消息。然后在 Y 的机器中更新 ARP 缓存，它会将攻击者的 MAC 地址视为路由器的 MAC 地址。正因为如此，通过路由器发送给谷歌的请求将首先到达 X。</p><p id="79d2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下图 2 说明了设备的 ARP 缓存。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es jx"><img src="../Images/42f59adc000faea489fb3c812bae545b.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*EfbZiYUAzqLbMiFUHGlbzg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图二。ARP 缓存表。</figcaption></figure><p id="fed6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果高速缓存表包含两个不同 IP 地址的相同 MAC 地址，这表明您的计算机上正在发生 ARP 攻击。</p><p id="c14b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> DNS 欺骗</strong></p><p id="8949" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在详细讨论 DNS 欺骗之前，让我们先澄清一下术语 DNS。</p><p id="5f35" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy">域名系统</em></p><p id="d6b6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通常，网络浏览器使用目的 IP 地址而不是相应的在线域名来访问网页。因此，应该有一种特定的方法将在线主机名转换成相应的 IP 地址。这是由 DNS 执行的。</p><p id="05b5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通常，当用户在浏览器上输入她或他想要访问的地址(主机名)时，浏览器将在他或她的计算机的缓存文件上搜索相应的 IP 地址。但是，如果找不到浏览器，浏览器会将主机名发送到最近的 DNS。如果也找不到，最近的 DNS 也会将主机名发送给它的直接父 DNS。假设直系父代拥有该域名，那么这将通过最近的 DNS 向浏览器提供相应的 IP 地址。参考图 3。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/36bc5c7e149f65519d548f989f3c1217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*L4W_Os2Y2oZIxzGuuGDDlA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 3。DNS 查找(来源:<a class="ae ka" href="https://retechnic.com/Website/single_service/8)." rel="noopener ugc nofollow" target="_blank">https://retechnic . com/Website/single _ service/8)。</a></figcaption></figure><p id="a4de" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">DNS 欺骗是攻击者使用的一种方法，通过 DNS 记录使受害者重定向到被设计为目标网站的欺诈网站。这也是中间人攻击的一种类型。这是因为攻击者注入了欺诈网站的恶意 IP 地址条目，而不是 DNS 缓存上的确切地址。这将导致受害者被路由到另一个目的地(托管欺诈网站的服务器)，而不是预期的目的地(托管确切网站的服务器)。参考图 4。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/8a8ac29e939888ade1639484a2a1be26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*593jTaf6K0sNnSkVXeIsMg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 4。DNS 欺骗。</figcaption></figure><p id="fb1c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦用户访问了假冒网站，他或她就允许黑客窃取他或她的访问凭证和其他敏感信息。此外，黑客可能会利用这个机会在受害者的计算机上安装恶意软件。</p><p id="7938" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> SSL </strong></p><p id="1133" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">安全套接字层(SSL)是一种用于在客户端和服务器之间建立安全通信的技术。在这里，使用名为<a class="ae ka" href="https://www.ssl.com/faqs/what-is-an-x-509-certificate/" rel="noopener ugc nofollow" target="_blank"> X.509 证书</a>的数字文档将网站和公司的身份绑定到加密密钥对(私有和公共)。通常，私钥保存在数据库中，公钥与证书(SSL 证书)共享，以在客户端和服务器之间建立安全连接。有两种实现 SSL 的方法。下面详细描述每一个。</p><p id="f3ea" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy">单向 SSL </em></p><p id="10ad" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里，客户端负责确保客户端是否从目标服务器接收到数据。下面逐步描述单向 SSL 认证。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/63ab2ca24e84d1f43f45d01d33f3a08f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4LYlO_aDVQdtD6-K5WpQg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 5。单向 SSL。</figcaption></figure><p id="53d1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如图 5 所示；</p><ol class=""><li id="4b0d" class="kd ke hi iw b ix iy jb jc jf kf jj kg jn kh jr ki kj kk kl bi translated">首先，客户端通过 HTTPS 协议向服务器发送请求，在它们之间建立安全连接。</li><li id="7041" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">服务器将其公共证书发送给客户端。</li><li id="02e3" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">客户端通过搜索 CA 中的证书列表来验证这一点。</li><li id="6d82" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">如果客户端找到了相应的证书，那么客户端将能够通过建立的安全连接(加密隧道)访问资源。</li></ol><p id="5cfa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy">双向 SSL </em></p><p id="8804" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里，客户机和服务器都负责确保它们之间的安全连接。下面逐步描述双向 SSL 认证。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/d507df855c5d2aaf1f8fe5dde28a0663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*owotaGYnzB3_6FLG0w1Now.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 6。双向 SSL。</figcaption></figure><p id="dbe3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如图 6 所示；</p><ol class=""><li id="f0d7" class="kd ke hi iw b ix iy jb jc jf kf jj kg jn kh jr ki kj kk kl bi translated">首先，客户端通过 HTTPS 协议向服务器发送请求，在它们之间建立安全连接。</li><li id="1bae" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">服务器将其公共证书发送给客户端。</li><li id="19f7" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">客户端通过搜索 CA 中的证书列表来验证这一点。</li><li id="d570" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">如果客户端找到了相应的证书，则客户端与服务器共享其公共证书。</li><li id="96b8" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">服务器通过搜索 CA 中的证书列表来验证这一点。</li><li id="2131" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr ki kj kk kl bi translated">如果服务器找到了相应的证书，那么客户端将能够通过建立的安全连接(加密隧道)访问资源。</li></ol><p id="30a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">相关术语</strong></p><p id="3fbc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy">认证机构</em></p><p id="30e8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">它负责发布数字证书(SSL 证书等)。)并通过证书的名称主题来证明公钥的所有权。CAs 的一些例子有，SSL.com、哥达迪、RapidSSLonline、Comodo 等。图 7 显示了由 SSL.com 颁发的证书。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/0cbe403c45ae152a7ec20061716ada4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ezOakS4gF8HBzQls5v1tw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 7。由 SSL.com 签发的证书。</figcaption></figure><p id="7e1a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy"> SSL 证书</em> ( <a class="ae ka" href="https://www.venafi.com/blog/what-ssltls-x509-certificate" rel="noopener ugc nofollow" target="_blank">一种 X.509 证书</a>)</p><p id="6330" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是由可信的 CA 签名的，并被操作系统、web 浏览器等信任。SSL 证书遵循 X.509 标准，这意味着证书包含公钥、主机名身份、组织等。SSL 证书在客户端和服务器之间共享，以在它们之间建立安全的连接。</p><p id="a489" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy"> HTTP vs HTTPS </em></p><p id="c3c6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是 HTTP 的安全版本。这里，在客户端和服务器之间传输的所有数据包都用公钥或私钥加密。因此，大多数网站都将 HTTPS 作为默认协议。大多数使用 HTTPS 协议的网站都包含由公共可信 CA 签署的 SSL/TLS (TLS:传输安全层，SSL 的继任者)证书。图 8 显示了受信任的 SSL/TLS 证书保护的网站和不受保护的网站之间的差异。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/019557833b811e1c202cd1ac8d862532.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*wP0ohshsBjp8sT-BYxlt5A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 8。使用 SSL 证书保护与不保护。</figcaption></figure><p id="5c3c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">结论</strong></p><ul class=""><li id="9c29" class="kd ke hi iw b ix iy jb jc jf kf jj kg jn kh jr kt kj kk kl bi translated">RPA 欺骗和 DNS 欺骗属于中间人(MitM)攻击。</li><li id="176f" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr kt kj kk kl bi translated">DNS 用于获取在线域名对应的 IP 地址。</li><li id="09b6" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr kt kj kk kl bi translated">SSL 证书在客户端和服务器之间共享，以在它们之间建立安全的连接。</li><li id="01af" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr kt kj kk kl bi translated">证书颁发机构负责颁发 SSL 证书。</li></ul><p id="603f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">参考文献</strong></p><ul class=""><li id="7b46" class="kd ke hi iw b ix iy jb jc jf kf jj kg jn kh jr kt kj kk kl bi translated"><a class="ae ka" href="https://www.imperva.com/learn/application-security/arp-spoofing/" rel="noopener ugc nofollow" target="_blank">https://www . imper va . com/learn/application-security/ARP-spoofing/</a></li><li id="7ba4" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr kt kj kk kl bi translated"><a class="ae ka" href="https://www.imperva.com/learn/application-security/dns-spoofing/" rel="noopener ugc nofollow" target="_blank">https://www . imper va . com/learn/application-security/DNS-spoofing/</a></li><li id="fb5f" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr kt kj kk kl bi translated"><a class="ae ka" href="https://dzone.com/articles/ssl-in-java" rel="noopener ugc nofollow" target="_blank">https://dzone.com/articles/ssl-in-java</a></li><li id="bdb1" class="kd ke hi iw b ix km jb kn jf ko jj kp jn kq jr kt kj kk kl bi translated"><a class="ae ka" href="https://www.ssl.com/faqs/faq-what-is-ssl/" rel="noopener ugc nofollow" target="_blank">https://www.ssl.com/faqs/faq-what-is-ssl/</a></li></ul></div></div>    
</body>
</html>