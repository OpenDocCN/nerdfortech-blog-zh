<html>
<head>
<title>What is `Asynchronous I/O`?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是异步输入输出？</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/what-is-asynchronous-i-o-b37994359471?source=collection_archive---------0-----------------------#2022-04-15">https://medium.com/nerd-for-tech/what-is-asynchronous-i-o-b37994359471?source=collection_archive---------0-----------------------#2022-04-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6e7d86477ab65a33375f79b56964d29d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfEq7uhIf33vpb3mogM6aw.jpeg"/></div></div></figure><blockquote class="iq ir is"><p id="9348" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们将讨论异步的含义和例子</p></blockquote><h1 id="8baf" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">异步是什么意思？</h1><p id="7236" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">在计算机科学中，异步操作意味着一个进程独立于其他进程运行，而同步操作意味着该进程仅在其他进程完成或移交时运行。</p><h1 id="08bf" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">例子</h1><p id="ded8" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">异步运行程序的一个简单例子是打印机的嵌入式软件。当打印机向用户发出墨粉不足警告时，它会继续打印。打印机不会停止一切来发出警报，然后继续。发出警报的程序部分不依赖于触发打印的部分。它们可以同时发生，因为它们独立发挥作用。</p><p id="0056" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">另一个更抽象的例子是在普通编程语言中使用异步方法，比如JavaScript、Python和C#。也被称为<em class="iv">非阻塞代码</em>，异步编程为程序提供了在等待长时间运行的任务完成时继续运行其他代码的机会。这项耗时的任务在后台执行，而其余代码继续执行。</p><p id="9e26" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">这些语言中支持异步编程的特性被称为<em class="iv">回调函数</em>。在JavaScript中，函数中嵌套的所有操作都被发送到web应用程序或数据库，以收集必要的信息，同时程序的其余部分继续运行。当信息被收集时，它通过程序被发送回来，并应用于程序中依赖它的函数，因此有了<em class="iv">回调</em>。</p><h1 id="e471" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">异步I/O的工作原理</h1><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/2b7694ffd912a201ecb47f813f091366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7iyX8j4ZQalFUZNiTbDXw.jpeg"/></div></div></figure><ol class=""><li id="522e" class="ld le hi iw b ix iy jb jc ks lf ku lg kw lh jr li lj lk ll bi translated">线程告诉内核它想要完成什么I/O工作(“请从这个套接字读取”或“请写入这个文件”)。</li><li id="0aed" class="ld le hi iw b ix lm jb ln ks lo ku lp kw lq jr li lj lk ll bi translated">内核为线程提供了一个句柄来监控请求。</li><li id="3c60" class="ld le hi iw b ix lm jb ln ks lo ku lp kw lq jr li lj lk ll bi translated">内核将请求添加到要照看的项目列表中。</li><li id="53e4" class="ld le hi iw b ix lm jb ln ks lo ku lp kw lq jr li lj lk ll bi translated">线程继续运行，定期检查事件的I/O句柄。</li><li id="0b00" class="ld le hi iw b ix lm jb ln ks lo ku lp kw lq jr li lj lk ll bi translated">每当有趣的事情发生时，内核都会向I/O句柄发送一个事件。</li><li id="61d9" class="ld le hi iw b ix lm jb ln ks lo ku lp kw lq jr li lj lk ll bi translated">Thread获取每个事件，处理它，并检查更多的事件，直到请求的操作完成。</li></ol></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><blockquote class="iq ir is"><p id="a673" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们将讨论操作系统中的异步</p></blockquote><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/c24b149e12bf2cff055e9a9dd775223d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9WfZnCHjJc2GgOcLASc4Q.png"/></div></div></figure><h1 id="8088" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">系统调用</h1><p id="ae78" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated"><strong class="iw hj">系统调用</strong>(通常缩写为<strong class="iw hj">系统调用</strong>)是计算机程序向执行它的操作系统内核请求服务的编程方式。这可能包括与硬件相关的服务(例如，访问硬盘驱动器或访问设备的摄像头)、新进程的创建和执行，以及与集成内核服务(如进程调度)的通信。系统调用在进程和操作系统之间提供了一个重要的接口。</p><h1 id="b377" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">向上调用</h1><p id="af81" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">我们可以使用系统调用来完成应用程序<br/>和操作系统内核之间的大部分通信。当一个程序需要请求一些受保护的操作时，它可以请求内核代表它执行操作。同样，如果内核中有应用程序需要的数据，程序可以简单地执行一个系统调用来检索它。</p><p id="58b6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">但是如果我们想让应用程序能够实现类似操作系统的功能，我们需要更多的东西。出于操作系统内核需要基于中断的事件交付的许多原因，当一些值得立即关注的事件发生时，应用程序也可以从被告知中受益。在本书中，我们会反复看到这种模式:需要虚拟化操作系统内核的某个部分，以便应用程序的行为更像操作系统。我们称虚拟中断和异常为向上调用。在UNIX中，它们被称为信号，在Windows中，它们被称为异步事件。</p><h1 id="03f8" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">带有向上调用的即时事件交付非常有用的情况</h1><h2 id="2d42" class="ma jt hi bd ju mb mc md jy me mf mg kc ks mh mi kg ku mj mk kk kw ml mm ko mn bi translated">异步输入输出通知</h2><p id="82b3" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">系统调用被设计为等待，直到所请求的操作完成，然后返回。如果该进程在此期间还有其他工作要做呢？一种方法是异步I/O:系统调用启动请求并立即返回；稍后，应用程序可以轮询内核的I/O完成情况，或者当<br/>I/O完成时，可以通过upcall向应用程序发送一个单独的通知。</p><h2 id="fb82" class="ma jt hi bd ju mb mc md jy me mf mg kc ks mh mi kg ku mj mk kk kw ml mm ko mn bi translated">进程间通信</h2><p id="5949" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">大多数进程间通信都可以用系统调用来处理——一个进程写入数据，而另一个进程稍后读取数据。如果一个进程生成了一个需要另一个进程立即关注的事件，就需要内核向上调用。例如，当调试器希望<br/>暂停或恢复进程时，UNIX将发送一个upcall来通知进程。另一个用途是注销——通知<br/>应用程序应该保存文件数据并干净地终止。</p><h2 id="b132" class="ma jt hi bd ju mb mc md jy me mf mg kc ks mh mi kg ku mj mk kk kw ml mm ko mn bi translated">用户级资源分配策略</h2><p id="91d6" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">操作系统的任务之一是资源分配——决定哪些用户或哪些进程获得多少CPU时间、多少内存等等。反过来，许多应用程序是资源自适应的——能够针对不同的CPU时间或内存量优化它们的行为。一个例子是像Java运行时这样的垃圾收集系统。在一定范围内，Java进程可以通过改变运行垃圾收集器的频率来适应不同的可用内存量。内存越多，时间越少</p><h1 id="7d59" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">优点和缺点</h1><p id="031d" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">如上所述，异步通信格式的好处是增加了信息交换结构的灵活性，并且不依赖于通用时标或对话逻辑。</p><p id="c300" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">然而，异步的主要缺点是它会给通信带来一层复杂性，这会使信息交换复杂化，甚至破坏信息交换。</p><p id="8cf1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">这些优缺点在异步计算机代码中显而易见。例如，编写过多的回调函数会变得混乱，成为试图分析它们的程序员的噩梦。语法特性，比如承诺和async/await模式，已经被引入来简化代码语法，并简化程序员的阅读体验。尽管如此，这些特性还是增加了代码的复杂性。</p><p id="cdc4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">如果程序的唯一目的是运行简单的、顺序的任务——比如数据处理，它可以忍受同步编程的停止和等待——那么同步是更好的选择。异步代码的优点使其更适合需要响应事件的程序，如图形用户界面(GUI)程序。</p><h1 id="a84c" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="0285" class="pw-post-body-paragraph it iu hi iw b ix kq iz ja jb kr jd je ks kt jh ji ku kv jl jm kw kx jp jq jr hb bi translated">最后，你应该从像<br/> - <a class="ae lr" href="https://www.amazon.com/Operating-Systems-Principles-Thomas-Anderson/dp/0985673524" rel="noopener ugc nofollow" target="_blank">操作系统:原理与实践第二版</a>这样的书中读到更多关于这个话题的内容</p><p id="fd33" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je ks jg jh ji ku jk jl jm kw jo jp jq jr hb bi translated">或者像那些<a class="ae lr" href="https://applied-programming.github.io/Operating-Systems-Notes/" rel="noopener ugc nofollow" target="_blank">操作系统笔记</a>的文章</p></div></div>    
</body>
</html>