<html>
<head>
<title>Geo-Location Analysis using Geopandas &amp; Shapely</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Geopandas &amp; Shapely进行地理位置分析</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/geo-location-analysis-using-geopandas-shapely-d93775ae8a01?source=collection_archive---------4-----------------------#2021-04-04">https://medium.com/nerd-for-tech/geo-location-analysis-using-geopandas-shapely-d93775ae8a01?source=collection_archive---------4-----------------------#2021-04-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/76163957a5ddaa20d09a973a480e893a.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*GoJv894nPfMBf94LroJXRw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">新加坡的咖啡店</figcaption></figure><p id="2de1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如今，企业在衡量业绩或计划拓展新分支机构时，会关注地区、次地区和城市层面。</p><p id="d24f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">地理位置分析近年来变得流行起来，以帮助企业满足他们的需求。在这篇文章中，我们将介绍关于shapefiles、坐标参考系统的基础知识，最后是使用python的实现和可视化。</p><h2 id="fedf" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">Shapefile</h2><p id="a5de" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">地理空间数据可以使用矢量格式(点、线或多边形)之一以shapefile格式存储。但是，由于结构不同，每个shapefile只能包含一种矢量类型。</p><p id="ff7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">存储在shapefile中的对象有一组描述数据的相关属性。例如，包含国家/地区子区域位置的多边形shapefile可能包含子区域名称、代码等。</p><p id="957d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与文本文件不同，空间数据通常存储在多个文件中。shapefile由3个或更多文件组成，所有文件必须具有相同的名称，并存储在相同的文件目录中，以便在Python中打开。与shapefiles相关联的三个重要文件是。所有特征的几何图形。shx(索引几何图形)和。dbf(表格格式的要素属性)。</p><h2 id="3234" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">坐标参考系统</h2><p id="8347" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">我们生活在一个三维的地球上，但是当我们制作地图时，我们需要把它转换成二维空间。CRS用于定义二维投影地图和地球上真实位置之间的关系。</p><p id="a8c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下代码片段显示了CRS的几个关键组成部分，包括坐标系(如纬度/经度或北距/东距)、单位(如度或米)、包含用于放置空间坐标系的原点信息的数据。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="638d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">了解数据使用的坐标系非常重要，尤其是当我们处理存储在不同坐标系中的各种数据时。</p><h1 id="9d09" class="ku jp hi bd jq kv kw kx ju ky kz la jy lb lc ld kb le lf lg ke lh li lj kh lk bi translated">数据源</h1><p id="c5ee" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">数据取自<a class="ae ll" href="https://data.gov.sg/dataset/subzone-census-2010" rel="noopener ugc nofollow" target="_blank">data.gov.sg</a>，是2010年新加坡人口普查的分区边界指示多边形。分区是规划区内的划分，通常以一个焦点为中心，如邻里中心或活动节点。地理数据由311行和16列组成。</p><p id="a1db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对数据的快速检查为我们提供了关于区域和地区及其相应子区域数量的信息。层级结构是区域和区域，后面是子区域。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">区域级别的子区域数量</figcaption></figure><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">地区一级的子区域数量</figcaption></figure><p id="fe5a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，让我们检查数据集的CRS。它是投影的CRS — <a class="ae ll" href="https://app1.sla.gov.sg/SIRENT/About/PlaneCoordinateSystem" rel="noopener ugc nofollow" target="_blank"> SYV21 </a>，采用横轴墨卡托法创建，坐标系统为东/北。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">检查协调参考系统</figcaption></figure><p id="2059" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我希望我的CRS是经度/纬度格式，所以使用了重投影方法来改变位置的表示。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">重新投影坐标参考系统</figcaption></figure><p id="7b30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们有了WGS84格式的地理定位，让我们创建一些矢量数据(点)来检查它们属于哪个子区域。</p><p id="fe24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">旁注:我特别选择了<a class="ae ll" href="https://forewordcoffee.com/" rel="noopener ugc nofollow" target="_blank">前言咖啡</a>，因为我钦佩他们的远见。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">在点地理数据中创建前言咖啡店位置</figcaption></figure><p id="f64f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我编写了一个小循环来检查每个点的位置，并结合多边形地理数据的一些属性。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">用于将多边形分配给相应点的代码</figcaption></figure><p id="8db0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我们的最终数据集，包括具有各自面属性的感兴趣的商店。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/2b1e53a8fb3eaac17960606d40eb83fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5i-EOY0Mf9YrSt_9mB39A.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">前言具有各自多边形属性的咖啡店</figcaption></figure><p id="0f16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，让我们在新加坡地图上画出咖啡店的顺序。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es if"><img src="../Images/76163957a5ddaa20d09a973a480e893a.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*GoJv894nPfMBf94LroJXRw.png"/></div></figure></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><p id="74d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请随意使用<a class="ae ll" href="https://github.com/ZinTun/Geolocation/blob/main/geolocation_singapore.ipynb" rel="noopener ugc nofollow" target="_blank"> github </a>中的代码。</p></div></div>    
</body>
</html>