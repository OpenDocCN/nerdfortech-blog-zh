<html>
<head>
<title>React native: Implement Time range picker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应本机:实现时间范围选择器</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/react-native-implement-time-range-module-ee4eacdd10eb?source=collection_archive---------1-----------------------#2021-01-13">https://medium.com/nerd-for-tech/react-native-implement-time-range-module-ee4eacdd10eb?source=collection_archive---------1-----------------------#2021-01-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/b19b050014c3f1acd47e4d221d1c7eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*m70zSfCc6FQI9w9YRQ77-Q.png"/></div></figure><p id="e72c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我正在开发一个 react 本地应用程序，它需要实现一个时间范围模块，能够为用户输入开始和结束时间，并使用两个最小和最大截止时间验证开始和结束时间。我实现的主要目的是，主用户应该能够管理子用户在其时间范围内的应用程序访问时间。在这篇文章中，我将分享我是如何建造它的。</p><p id="298b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">完成的时间范围模块如下所示:</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es jk"><img src="../Images/c06b6706963d1fd346fc07aa6fc1a1b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/1*mxdsuxib5un6dxpS7ca0KA.gif"/></div></figure><p id="ce03" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以让我们开始行动吧！</p><p id="61bc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">实施:</strong></p><p id="97fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，我使用<a class="ae jp" href="https://www.npmjs.com/package/react-native-navigation" rel="noopener ugc nofollow" target="_blank"> react-native-navigation </a>将时间选择器显示为覆盖图。</p><p id="9688" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面是<strong class="io hj"> <em class="jq"> onPress </em> </strong>函数的样子:</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="6092" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，我将开始和结束时间分离数据对象、本地化和<em class="jq"> onpressOkFn </em> <em class="jq">函数</em>作为<em class="jq"> passprops </em>发送。时间分离对象的初始格式如下。</p><pre class="jl jm jn jo fd jt ju jv jw aw jx bi"><span id="baa3" class="jy jz hi ju b fi ka kb l kc kd">let time_separation_data = {</span><span id="51bb" class="jy jz hi ju b fi ke kb l kc kd">hours: 0,</span><span id="2996" class="jy jz hi ju b fi ke kb l kc kd">minutes: 0,</span><span id="c066" class="jy jz hi ju b fi ke kb l kc kd">is_am: false,</span><span id="c92a" class="jy jz hi ju b fi ke kb l kc kd">is_pm: false</span><span id="c395" class="jy jz hi ju b fi ke kb l kc kd">};</span></pre><p id="a41b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果已经为用户设置了时间范围，我们需要通过验证默认时间将它们分开，如下所示。</p><p id="59f9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">时间验证:</strong></p><pre class="jl jm jn jo fd jt ju jv jw aw jx bi"><span id="0100" class="jy jz hi ju b fi ka kb l kc kd">const isValidAgentStartEndTime = (time) =&gt; {</span><span id="18ea" class="jy jz hi ju b fi ke kb l kc kd">let is_valid_time = false;</span><span id="5e86" class="jy jz hi ju b fi ke kb l kc kd">if (time !== undefined &amp;&amp; time !== null &amp;&amp; time !== '') {</span><span id="e57a" class="jy jz hi ju b fi ke kb l kc kd">is_valid_time = true;</span><span id="3a67" class="jy jz hi ju b fi ke kb l kc kd">}</span><span id="ac31" class="jy jz hi ju b fi ke kb l kc kd">return is_valid_time;</span><span id="d33a" class="jy jz hi ju b fi ke kb l kc kd">};</span></pre><p id="a338" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">时间间隔:</strong></p><pre class="jl jm jn jo fd jt ju jv jw aw jx bi"><span id="43f7" class="jy jz hi ju b fi ka kb l kc kd">const separateTimeIn12h = (time) =&gt; {</span><span id="d7ec" class="jy jz hi ju b fi ke kb l kc kd">let time_separation_data = {</span><span id="50f9" class="jy jz hi ju b fi ke kb l kc kd">hours: 0,</span><span id="1c7d" class="jy jz hi ju b fi ke kb l kc kd">minutes: 0,</span><span id="78bb" class="jy jz hi ju b fi ke kb l kc kd">is_am: false,</span><span id="870e" class="jy jz hi ju b fi ke kb l kc kd">is_pm: false</span><span id="e523" class="jy jz hi ju b fi ke kb l kc kd">};</span><span id="d6a9" class="jy jz hi ju b fi ke kb l kc kd">if (isValidAgentStartEndTime(time)) {</span><span id="ba04" class="jy jz hi ju b fi ke kb l kc kd">let time1 = time.split(':');</span><span id="3968" class="jy jz hi ju b fi ke kb l kc kd">let hours = time1[0];</span><span id="f1c0" class="jy jz hi ju b fi ke kb l kc kd">let minutes = time1[1];</span><span id="c5b3" class="jy jz hi ju b fi ke kb l kc kd">let am_pm = parseInt(hours) &gt;= 12 ? TIME_LABEL.PM : TIME_LABEL.AM;</span><span id="f5a1" class="jy jz hi ju b fi ke kb l kc kd">hours = parseInt(hours) % 12;</span><span id="7ec3" class="jy jz hi ju b fi ke kb l kc kd">hours = hours ? hours : 12;</span><span id="f1db" class="jy jz hi ju b fi ke kb l kc kd">minutes = parseInt(minutes) &lt; 10 ? '0' + parseInt(minutes) : parseInt(minutes);</span><span id="65e1" class="jy jz hi ju b fi ke kb l kc kd">hours = hours &lt; 10 ? '0' + hours : hours;</span><span id="49bb" class="jy jz hi ju b fi ke kb l kc kd">time_separation_data = {</span><span id="e2a8" class="jy jz hi ju b fi ke kb l kc kd">hours: hours,</span><span id="46c0" class="jy jz hi ju b fi ke kb l kc kd">minutes: minutes,</span><span id="dbd1" class="jy jz hi ju b fi ke kb l kc kd">is_am: (am_pm === TIME_LABEL.AM) ? true : false,</span><span id="6bc8" class="jy jz hi ju b fi ke kb l kc kd">is_pm: (am_pm === TIME_LABEL.PM) ? true : false,</span><span id="39e4" class="jy jz hi ju b fi ke kb l kc kd">am_pm: am_pm</span><span id="7854" class="jy jz hi ju b fi ke kb l kc kd">};<br/>}</span><span id="3965" class="jy jz hi ju b fi ke kb l kc kd">return time_separation_data;</span><span id="a74c" class="jy jz hi ju b fi ke kb l kc kd">};</span></pre><p id="1f49" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">时间范围模块组件:</strong></p><p id="283f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面是时间范围模块的 UI 实现，最初我将开始和结束时间、分钟、am/pm 配置分别分配给状态变量。接下来，我实现了<em class="jq">timeinputuicomponent . js</em>来呈现开始和结束时间输入模块。这里我对<em class="jq">常量</em>和<em class="jq">公共函数</em>使用单独的文件，因为这将有助于轻松管理模块。我稍后会在我的帖子中解释这些，你也可以在我的源代码中清楚地找到。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="2ba0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">时间输入组件:</strong></p><p id="059f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面是<em class="jq">timeinputuicomponent . js</em>作为功能组件的实现。这里我使用<a class="ae jp" href="https://www.npmjs.com/package/react-native-masked-text" rel="noopener ugc nofollow" target="_blank">react-native-masked-text</a>进行文本输入。对于 AM/PM 切换器，我实现了一个独立的功能组件。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="9030" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> AM/PM 切换器组件:</strong></p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="eb8f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，我为开始和结束时间输入分别实现了<em class="jq"> onChangeText </em>功能逻辑，如下所示。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="75fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里我们需要使用<em class="jq">validatehouinput</em>函数验证用户输入的小时数，如下所示。</p><pre class="jl jm jn jo fd jt ju jv jw aw jx bi"><span id="efc5" class="jy jz hi ju b fi ka kb l kc kd">const validateHourInput = (newHoursFromInput) =&gt; {</span><span id="439c" class="jy jz hi ju b fi ke kb l kc kd">if (parseInt(newHoursFromInput) &gt; 24) {</span><span id="7d30" class="jy jz hi ju b fi ke kb l kc kd">console.log('validateHourInput');</span><span id="bc8b" class="jy jz hi ju b fi ke kb l kc kd">return 12;</span><span id="5f35" class="jy jz hi ju b fi ke kb l kc kd">} else {</span><span id="b8c8" class="jy jz hi ju b fi ke kb l kc kd">return convert12HourFormat(newHoursFromInput);</span><span id="0f55" class="jy jz hi ju b fi ke kb l kc kd">}</span><span id="9771" class="jy jz hi ju b fi ke kb l kc kd">};</span></pre><p id="5535" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用一个单独的函数来验证用户输入的分钟数，如下所示。我已经使用了<em class="jq">默认时间值作为‘00’</em>，它被声明为常量。</p><pre class="jl jm jn jo fd jt ju jv jw aw jx bi"><span id="d627" class="jy jz hi ju b fi ka kb l kc kd">const validateMinuteInput = (newMinutesFromInput) =&gt; {</span><span id="5998" class="jy jz hi ju b fi ke kb l kc kd">if (newMinutesFromInput &gt; 59) {</span><span id="c532" class="jy jz hi ju b fi ke kb l kc kd">console.log('validateMinuteInput 2');</span><span id="a97c" class="jy jz hi ju b fi ke kb l kc kd">return DEFAULT_TIME_VALUE;</span><span id="8693" class="jy jz hi ju b fi ke kb l kc kd">} else {</span><span id="b9a7" class="jy jz hi ju b fi ke kb l kc kd">return newMinutesFromInput;</span><span id="5f5d" class="jy jz hi ju b fi ke kb l kc kd">}</span><span id="51ba" class="jy jz hi ju b fi ke kb l kc kd">};</span></pre><p id="032d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此外，我实现了逻辑来验证用户输入的开始和结束时间，主要用户的时间范围如下。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="c572" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，我需要实现 AM/PM 按钮的逻辑，如下所示。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="71fc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我用来构建逻辑的支持函数分别添加如下。</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="66e6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以下是我用过的常量:</p><figure class="jl jm jn jo fd ij"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="104e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这个帖子到此为止！这个实现很简单，但是你可以在它的基础上使用时钟图标选择用户输入，并且更加复杂和功能丰富。</p><p id="e4cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你可以在这里找到完整的源代码。</p><p id="0a6a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>