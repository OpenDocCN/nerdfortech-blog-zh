<html>
<head>
<title>Using Context in React with Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React with Typescript中使用上下文</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/using-context-in-react-with-typescript-55c1383f9c9d?source=collection_archive---------1-----------------------#2021-01-31">https://medium.com/nerd-for-tech/using-context-in-react-with-typescript-55c1383f9c9d?source=collection_archive---------1-----------------------#2021-01-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ff86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以你要用上下文(<a class="ae jd" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/docs/context.html</a>)🙌<br/> ➡️所以你希望你的上下文提供状态和一个更新状态的函数。<br/> ➡️所以你要用Typescript。</p><p id="2909" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">试试这个:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="c7ee" class="jn jo hi jj b fi jp jq l jr js">import { createContext } from "react";</span><span id="66f6" class="jn jo hi jj b fi jt jq l jr js">const Context = createContext({<br/>  state: [] as string[],<br/>  dispatch: (state: string[]) =&gt; {},<br/>});</span></pre><p id="0257" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">🤫<em class="ju">假设</em> <code class="du jv jw jx jj b"><em class="ju">state</em></code> <em class="ju">是一个字符串数组。</em></p><p id="651b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许这是显而易见的，但我花了一段时间来键入传递给<code class="du jv jw jx jj b">createContext</code>的<code class="du jv jw jx jj b">defaultValue</code>。</p><p id="689b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">《T3》的演员阵容很有趣。如果你不强制转换，当你将<code class="du jv jw jx jj b">state</code>传递给context的<code class="du jv jw jx jj b">value</code>道具时，Typescript会抱怨(见下文)。它会说<code class="du jv jw jx jj b">state</code>的类型是<code class="du jv jw jx jj b">never[]</code>(毕竟是空数组)并且和状态变量冲突，状态变量是<code class="du jv jw jx jj b">string[]</code>。</p><p id="0e68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是钩子以及如何将它传递给上下文。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="4557" class="jn jo hi jj b fi jp jq l jr js">const [state, dispatch] = useState(["initial"]);</span><span id="783b" class="jn jo hi jj b fi jt jq l jr js">return (<br/>  &lt;div&gt;<br/>    &lt;Context.Provider value={{ state, dispatch }}&gt;<br/>      &lt;ComponentTreeThatNeedsAccessToState /&gt;<br/>      &lt;ComponentTreeThatNeedsAccessToDispatch /&gt;<br/>    &lt;/Context.Provider&gt;<br/>  &lt;/div&gt;<br/>);</span></pre><p id="9a7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，如果您的<code class="du jv jw jx jj b">createContext</code>调用中有一个空数组，并且出现以下错误:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="9dbc" class="jn jo hi jj b fi jp jq l jr js">Type 'string[]' is not assignable to type 'never[]'</span></pre><p id="ddcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么我希望这有所帮助🙌</p><p id="4957" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">参见</em><a class="ae jd" href="https://bitbucket.org/gabrielmccallin/react-context/src/main/src/App.tsx" rel="noopener ugc nofollow" target="_blank"><em class="ju">https://bit bucket . org/gabrielmccallin/react-context/src/main/src/app . tsx</em></a></p></div></div>    
</body>
</html>