<html>
<head>
<title>Wallstreetbets Sentiment Analysis on Stock Prices using Natural Language Processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于自然语言处理的股票价格情绪分析</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/wallstreetbets-sentiment-analysis-on-stock-prices-using-natural-language-processing-ed1e9e109a37?source=collection_archive---------1-----------------------#2021-06-09">https://medium.com/nerd-for-tech/wallstreetbets-sentiment-analysis-on-stock-prices-using-natural-language-processing-ed1e9e109a37?source=collection_archive---------1-----------------------#2021-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="576f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是一个正在进行的项目的第一部分，分析对著名的(或臭名昭著的？)subreddit，r/Wallstreetbets。这个价值百万美元的问题是:对r/Wallstreetbets的看涨或看跌情绪与股票基本面的结合能否用来建立一个预测特定股票价格方向的模型？</p><p id="0d23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">声明:这不是投资建议。如果你根据这篇文章或我写的任何东西做投资决定，你很可能会赔钱。请做好自己的研究，做出自己的投资决定。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="497e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">流程</strong></p><p id="b799" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管这个项目仍处于研究阶段，但仍有许多有待发现。该项目将分为两个部分:</p><ol class=""><li id="c89d" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">收集数据和建立数据库。这包括为分析、可视化和建模准备而进行的清理优化。</li><li id="c3cc" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">模型开发。这包括模型制定、特征工程、超参数调整、优化和测量性能。</li></ol><p id="5abf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据ETL过程需要一些时间。以下是该过程的基本总结:</p><ol class=""><li id="398e" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">生成当天10个最常提及的报价机，并分配情感类型和分数。例如:</li></ol><figure class="jz ka kb kc fd kd er es paragraph-image"><div class="er es jy"><img src="../Images/a6f240349efd8ab59c872508fd81c4fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Sq45-VWzIoBfgS4IwUnwtQ.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">图表鸣谢:EatTheBlocks YouTube频道</figcaption></figure><figure class="jz ka kb kc fd kd er es paragraph-image"><div class="er es jy"><img src="../Images/641f08589dcc5c7759f80edaab733fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*gWfgTEBDcFKFJHFX8hEjtA.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">图表鸣谢:EatTheBlocks YouTube频道</figcaption></figure><ol class=""><li id="34f1" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">从<a class="ae kk" href="https://developer.tdameritrade.com/apis" rel="noopener ugc nofollow" target="_blank"> TDAmeritrade的开发者API </a>中获取特定股票的价格和基本面信息</li><li id="dfc2" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">在100天内每天运行这两个脚本</li><li id="f82c" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">通过PostgreSQL将每天的数据存储在个性化数据库中</li></ol><p id="312b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成大约1，000行数据后，我应该有足够的数据来开始分析股票价格的可预测性。当然，我将继续运行每日脚本以达到统计显著性(即:我们有足够的数据来确信我们的观察不是随机产生的)。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="8cfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据</strong></p><p id="e9d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何有自尊的数据科学家都必须花时间来解释数据，它是如何产生的，以及为什么选择这个特定的数据。subreddit生成的数据是纯文本:与关于股票和股票市场的对话相关的单词。我使用Reddit API，它非常简单，但是非常健壮。价格和基本信息由TDAmeritrade API生成。</p><p id="ea2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该理论认为，股票价格是其运营/财务表现和公众情绪的函数。一个企业的基本面(净利润率、市盈率、杠杆、市值等。)对价格有直接影响，而公众舆论(例如，华尔街的技术交易者和投机者)对价格有间接影响。目标是根据这些重要因素准确预测股票的走向。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="69fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是情感分析？</strong></p><p id="349a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">情感分析是自然语言处理中的一种机器学习方法，它通过分析单词的含义、上下文和频率来量化文本中的情感。例如，在0到10的范围内，0表示最消极，10表示最积极，以下句子的得分如下:</p><ol class=""><li id="38b2" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">" AAPL绝对值得购买！"→ 10</li><li id="5c6f" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">“我对AAPL持中立态度”→大约5</li><li id="c168" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">" AAPL是个十足的卖家！"→ 0</li></ol><p id="44b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Python库自然语言工具包对分析文本非常有帮助。它包含一个预先确定的单词及其各自情感的词典。以下是算法如何处理r/Wallstreetbets上的每个评论的逻辑工作流:</p><ol class=""><li id="3fa1" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">评论是通过Reddit API检索的</li><li id="fbbc" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">删除所有标点符号</li><li id="ad81" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">删除停用词(例如:I、in、or等。)，这不会增加上下文或含义的价值</li><li id="67c9" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">在词典中扫描每个评论中的单词，计算每个评论中正面和负面的数量。为每个评论计算每个类别的比例。positive _ score = # positive words/total # words，Neutral_score以此类推</li><li id="7945" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">将分数归一化，提取股票进行隔离。现在我们有了每只股票的极性分数</li></ol><figure class="jz ka kb kc fd kd er es paragraph-image"><div class="er es kl"><img src="../Images/5cb02e81724d006aa292b8f405357396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*QAfZA2WuuxiaBRPAJ6kNXg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">今天的情绪得分示例</figcaption></figure><p id="e9b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单吧？不对！</p><p id="59d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">量化上下文和含义可能很棘手。例如，观察句子“我爱AAPL”和“我爱AAPL ”?嗯，对！”。这两句话用词相似，但感悟完全不同。第一个是正面/看涨，第二个是讽刺和负面。此外，第三种可能的变体“我喜欢吃AAPLs”的上下文与前两种完全不同(相信我，像这样的奇怪评论是存在的)。对我们人类来说，这非常容易理解。但是机器学习模型怎么知道区别呢？</p><p id="12cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是复合分数发挥作用的地方。当看跌、中性和看涨的分数接近时，就会出现模糊性(例如:三个分数都接近0.3，情绪是看跌、看涨还是中性？不清楚)。Total_Compound分数是介于-1和1之间的标准化加权综合分数。如果你只需要一个维度来预测情绪，这是最有用的指标。采用单一指标可能有助于消除看涨、看跌和中性情绪得分之间存在小差异的模糊性。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="14d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">财务数据</strong></p><p id="95a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">股票价格信息和基本数据是通过TDAmeritrade API检索的。我在之前一篇名为<a class="ae kk" rel="noopener" href="/analytics-vidhya/forecasting-googles-stock-price-with-arima-modeling-1148cd8496c8">用ARIMA模型</a>预测谷歌股价的文章中讨论了这个过程。我收集了很多信息，但这里有几个例子:</p><ol class=""><li id="a5a1" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">收盘价格</li><li id="1c77" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">净价格变化</li><li id="8b09" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">价格波动</li><li id="40ae" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">52周高/低</li><li id="d62d" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">市盈率</li><li id="1550" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">市值</li><li id="09b0" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">纯利润率</li><li id="779d" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">速动/流动比率</li><li id="8043" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">还有更多…</li></ol><p id="5905" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每只股票大约有90列数据。想法是，使用价格数据结合基本面数据和情绪得分，我们可以开发一些模型来预测股票的方向。敬请关注…</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="4091" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">未来工作</strong></p><p id="a7db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在几个星期内，我将有一个不断增长的数据库和适当的基础设施。我将更新这个项目的趋势和有趣的发现。看到我找到的东西超级兴奋。具体的代码示例可以查看我的Github Repo。但是我会在下面列出代码片段。</p><p id="267f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">代号</strong></p><p id="932c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建立程序参数:在美国，市值&gt; 1亿美元、价格&gt; 3美元的每只股票。您可以根据自己的喜好更改这些参数。<em class="km">黑名单</em>变量是为了不将tickers与‘YOLO’等常用词混淆。<em class="km"> new_words </em>帮助程序创建更准确的情感分数</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="31d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主程序</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="6923" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要一步一步地了解这段代码，请查看作者# EatTheBlocks YouTube频道</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="kp ko l"/></div></figure><p id="2112" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成价格和基本数据</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="dbf7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绘制情绪趋势</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="d69a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在PostgreSQL中运行以下脚本将设置数据库和表模式。为了节省时间，我将所有列都设置为文本。另外，数据类型可以很容易地在Python中转换。</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="69a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随时查看我的<a class="ae kk" href="https://github.com/mdominguez2010" rel="noopener ugc nofollow" target="_blank"> Github回购</a>，如果您有任何问题/意见，请发电子邮件至<a class="ae kk" href="mailto: md.ghsd@gmail.com" rel="noopener ugc nofollow" target="_blank">md.ghsd@gmail.com</a>给我。</p><p id="54ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">开源致谢</strong></p><ol class=""><li id="5efc" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">非常感谢# EatTheBlocks YouTube频道，他的Python代码对使用Reddit API有很大帮助。<a class="ae kk" href="https://github.com/jklepatch/eattheblocks/tree/master/screencast/290-wallstreetbets-sentiment-analysis" rel="noopener ugc nofollow" target="_blank">点击这里</a>查看他的Github回购。</li><li id="99e7" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated"><a class="ae kk" href="https://www.nltk.org/_modules/nltk/sentiment/vader.html" rel="noopener ugc nofollow" target="_blank">自然语言工具包:Vader </a>情感评分</li><li id="c503" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated"><a class="ae kk" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank">维德情绪Github回购</a></li><li id="4cd5" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">安迪·金关于情感分析的Ted演讲</li><li id="fdd7" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated"><a class="ae kk" href="https://github.com/laserson/squarify" rel="noopener ugc nofollow" target="_blank">方形化</a>用于可视化提及</li><li id="e245" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">Python的开源库:Pandas和Matplotlib</li></ol></div></div>    
</body>
</html>