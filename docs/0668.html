<html>
<head>
<title>Preprocessing Invoice PDF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预处理发票PDF</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/preprocessing-invoice-pdf-93b5ecf6716?source=collection_archive---------7-----------------------#2021-02-02">https://medium.com/nerd-for-tech/preprocessing-invoice-pdf-93b5ecf6716?source=collection_archive---------7-----------------------#2021-02-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8a9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将通过代码接受、处理和输出PDF发票文件的内容到一个文本文件中。</p><div class="jd je jf jg fd ab cb"><figure class="jh ji jj jk jl jm jn paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><img src="../Images/0a3fb8dd3e2502b36f5bbecb41771b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*iIZeg2qht-i98nCQgnHZLw.png"/></div></figure><figure class="jh ji ju jk jl jm jn paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><img src="../Images/6c7ad01b7003692a06392e658e630b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*H78DLBOeNhrWBYjXmqfeRg.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx jz di ka kb translated">基于图像的PDF发票和文本输出</figcaption></figure></div><p id="cd36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从导入这个项目所需的包开始:</p><figure class="jd je jf jg fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kc"><img src="../Images/3934837b32e6616f68c9f643dc92e30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yTtWXWI2lMAGudxsnYchKw.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">所需的库</figcaption></figure><ol class=""><li id="1f03" class="kd ke hi ih b ii ij im in iq kf iu kg iy kh jc ki kj kk kl bi translated">Cv2来处理发票的图像文件。</li><li id="0851" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">Matplotlib检索已处理发票文件的输出。</li><li id="1e11" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">使用pytesseract时的图像包。</li><li id="a772" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">Pytesseract将用于执行OCR。</li><li id="225f" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">Convert_from_path和path将用于处理文件目录。</li></ol><p id="bd72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们检索输入PDF文件的文件路径和文件名:</p><figure class="jd je jf jg fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kr"><img src="../Images/f61b460a312709905d808cec36caa500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bz9Bgjz-tWlY51cWiS9oLQ.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">文件路径和文件名</figcaption></figure><p id="1a61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们导入分辨率为300dpi的PDF文件，并将其转换为PIL图像对象。为此，必须提供poppler的bin路径。然后，我们浏览PDF文件中的页面，并将页面保存为JPEG格式的图像文件:</p><figure class="jd je jf jg fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ks"><img src="../Images/5a14761a1c44c4e2c9041d45756bc9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KetY3B7GGaHrBaQ7-um7dw.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">将PDF转换为JPEG</figcaption></figure><p id="86ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用OpenCV处理JPEG发票文件。我试验了一些自适应阈值算法，最后选择了高斯算法。通过将最后两个值调整为51和10，我得到了这个项目的最佳输出图像。然后，我们将其绘制成图形，但不是在控制台上显示，而是将其保存为最终的JPEG文件:</p><figure class="jd je jf jg fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kt"><img src="../Images/795ae2cc1a9f7059cbb845dc6d90c689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVc9o6PpZmqnM_7_1RlOMA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">保存处理过的图像</figcaption></figure><p id="bd55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个过程的最后阶段，我们将创建一个与输入的PDF文件同名的文本文件。我们将使用pytesseract包打开最终的JPEG文件，并对其执行OCR。提取的文本将被写入输出文本文件并保存在本地目录中:</p><figure class="jd je jf jg fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ku"><img src="../Images/823d0cc5b651bd57c4657708c2ce8393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKVT5CGZoYEySqqvXJYEzg.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">输出文本文件</figcaption></figure><p id="bde0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就结束了从本地以及基于图像的发票PDF文件中预处理和提取文本的过程。我将留下我的GitHub存储库的链接，您可以从那里克隆Python脚本，以及下载最新发布的poppler-windows和tesseract文件的链接。</p><p id="03c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GitHub:<a class="ae kv" href="https://github.com/rajeev-koushik/pdf-preprocessing" rel="noopener ugc nofollow" target="_blank">https://github.com/rajeev-koushik/pdf-preprocessing</a>T2【波普勒:<a class="ae kv" href="https://github.com/oschwartz10612/poppler-windows/releases/" rel="noopener ugc nofollow" target="_blank">https://github.com/oschwartz10612/poppler-windows/releases/</a>T5】宇宙魔方:<a class="ae kv" href="https://digi.bib.uni-mannheim.de/tesseract/" rel="noopener ugc nofollow" target="_blank">https://digi.bib.uni-mannheim.de/tesseract/</a></p></div></div>    
</body>
</html>