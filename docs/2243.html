<html>
<head>
<title>Running Spring Boot console application under IDE &amp; Maven</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在IDE &amp; Maven下运行Spring Boot控制台应用程序</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/running-spring-boot-console-application-under-ide-maven-16b59465a7e0?source=collection_archive---------1-----------------------#2021-04-28">https://medium.com/nerd-for-tech/running-spring-boot-console-application-under-ide-maven-16b59465a7e0?source=collection_archive---------1-----------------------#2021-04-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bd27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Spring Boot是web应用程序的一个很好的框架，但是在编写控制台应用程序时，它并不像web那样简单。</p><p id="05a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，你想，正如我需要的，从一些数据源导入数据，如CSV文件。从污染REST API和安全考虑的角度来看，为此创建web端点可能不太实际。因此，CLI应用程序是一个很好的选择。</p><p id="b587" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过重用持久性模型来遵循<a class="ae jd" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="noopener ugc nofollow" target="_blank"> DRY </a>原则，还必须拥有Spring上下文。因此，无论何时模型发生变化，我们都要确保导入功能保持不变，因为导入逻辑在大多数情况下也会受到影响，并且在编译器级别上可见，除此之外，这个安全网可以通过单元或集成测试轻松增强。此外，它应该与web应用程序代码一起运行。</p><p id="7335" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下解决方案不需要任何外部依赖:</p><h1 id="7c91" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">实现CommandLineRunner</h1><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><h1 id="286c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">仅在定义的配置文件下运行，并禁用web应用程序</h1><p id="9e35" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">添加注释:</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="dba7" class="kt jf hi kp b fi ku kv l kw kx">@Profile("import")</span></pre><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><p id="3ace" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">向<em class="ky">src/main/resources/application-import . properties</em>添加属性以禁用“导入”配置文件下的web应用程序</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><p id="3fd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，在“导入”配置文件下运行将禁用web部件，只运行控制台部件。</p><h1 id="2c09" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">IntelliJ理念下的调试和运行</h1><p id="8e17" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">复制现有的演示应用程序，根据需要重命名并添加“导入”配置文件</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/7f3f6bcecff36cf3f775e07211d22477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbQpygXCOrxOCuEPEPLP7Q.png"/></div></div></figure><p id="4c32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只需点击“调试”图标:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lg"><img src="../Images/ef9dd95dc31a1ceb67ee38ce56bd48d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-FMmUvswrXfgO93kqoA_Vw.png"/></div></div></figure><h1 id="0e9a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">在Maven下运行</h1><p id="77bb" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">通常我们使用<a class="ae jd" href="https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/" rel="noopener ugc nofollow" target="_blank"> Spring Boot Maven插件</a>运行spring boot应用程序，就像这样</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="433a" class="kt jf hi kp b fi ku kv l kw kx">mvn spring-boot:run</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lh"><img src="../Images/188f8c776cca100c6880768b39b2619e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FCtloFD429ph4bj2Oz5jXw.png"/></div></div></figure><p id="92a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要运行我们的控制台应用程序，我们必须在“import”概要文件处于活动状态的情况下运行它(-这里的q开关用于抑制编译器输出):</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="df90" class="kt jf hi kp b fi ku kv l kw kx">mvn -q spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=import"</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lh"><img src="../Images/b8d2dba34f4914f706439f1fffb7cfb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ms-0MLSi2mBt3AuT_StiwA.png"/></div></div></figure><h1 id="757c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">传递参数</h1><p id="720a" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在IntelliJ理念下非常简单，在运行配置中，我们已经在上一步中进行了配置，只需展开“环境”选项卡并添加参数:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/fbea98fbf47d840da8ac78f87da6b1f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTY93dKXTj0a-8QNVDNXZg.png"/></div></div></figure><p id="e38e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这导致:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lg"><img src="../Images/a1c8a5445df5123b401dd8928ce64022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1uS5wY-7qid30hw-OyvDA.png"/></div></div></figure><p id="bb4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Maven下就有点棘手了，因为参数不是直接提供给应用程序的，所以我们必须通过<a class="ae jd" href="https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/htmlsingle/#goals-run-parameters-details-commandlineArguments" rel="noopener ugc nofollow" target="_blank">spring-boot . run . arguments</a>变量传递参数来解决这个问题:</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="7404" class="kt jf hi kp b fi ku kv l kw kx">mvn -q spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=import" -Dspring-boot.run.arguments="a b c"</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lg"><img src="../Images/b432aeb432a1f0fc3ffb3edd5d81f4dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VOKo8Qmy0zLyZuzDkyjtJA.png"/></div></div></figure><p id="c553" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用包装外壳脚本将常规参数转换为spring-boot.run.arguments变量，以更方便的方式运行导入作业:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><p id="34e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们可以简单地运行</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="ccbf" class="kt jf hi kp b fi ku kv l kw kx">./import.sh a b c</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es li"><img src="../Images/66917d32754886838958e8e962b65564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlimeBsJfwH6D_nTEbJVwg.png"/></div></div></figure><h1 id="3fed" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">在包装好的罐子里运行</h1><p id="e612" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">因为参数是直接传递的，所以更加简单:</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="c16c" class="kt jf hi kp b fi ku kv l kw kx">mvn package</span></pre><p id="8eaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和</p><pre class="kc kd ke kf fd ko kp kq kr aw ks bi"><span id="1a58" class="kt jf hi kp b fi ku kv l kw kx">java -Dspring.profiles.active=import -jar target/demo-0.0.1-SNAPSHOT.jar a b c</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lh"><img src="../Images/31c82496386fa3bd3c39a635ded7206e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDeAlmKIC7JUR5nqtWhkLw.png"/></div></div></figure><h1 id="6fc0" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">github上的演示项目</h1><div class="lj lk ez fb ll lm"><a href="https://github.com/cmyker/spring-boot-console-application" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab dw"><div class="lo ab lp cl cj lq"><h2 class="bd hj fi z dy lr ea eb ls ed ef hh bi translated">cmyker/spring-boot-控制台-应用程序</h2><div class="lt l"><h3 class="bd b fi z dy lr ea eb ls ed ef dx translated">在GitHub上创建一个帐户，为cmyker/spring-boot-console应用程序的开发做出贡献。</h3></div><div class="lu l"><p class="bd b fp z dy lr ea eb ls ed ef dx translated">github.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma le lm"/></div></div></a></div></div></div>    
</body>
</html>