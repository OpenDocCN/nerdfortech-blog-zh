<html>
<head>
<title>Decision Tree — a Revolution Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策树——一种革命算法</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/decision-tree-a-revolution-algorithm-13b9a4173d37?source=collection_archive---------9-----------------------#2021-07-16">https://medium.com/nerd-for-tech/decision-tree-a-revolution-algorithm-13b9a4173d37?source=collection_archive---------9-----------------------#2021-07-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f164" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于树的方法的第一层。就是aka分类回归树(CART)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/40a99b30a56868d7ca7ca75bd8d0ee22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/0*PYZLMJR7a5EL0uxo"/></div></figure><p id="dfbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从一个思维实验开始，给我们使用决策树方法背后的一点动机。</p><p id="6bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一个场景，我每周六打网球，我总是邀请一个朋友和我一起去。有时，我的朋友会出现，有时不会。对他来说，这取决于多种因素，如:天气、温度、湿度、风等..我开始记录新功能，以及他是否出现和我一起玩。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jl"><img src="../Images/7c3bdeb8076fcf996b42184641da4298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*O3RZ4cMGYqS5hnwldts3kw.png"/></div></figure><p id="9e65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是数据，每一列代表特征，每一行代表某一天。最后一栏有一个标签，标明我的朋友是否来和我一起玩。你可以看到第一天天气温和，阳光明媚，湿度80%，无风，我的朋友出来玩。</p><p id="8582" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而在第二天，天气炎热，天气晴朗，75 %的湿度，有风，我的朋友没有来玩。我可以用这个过程建立决策树，在考虑几个因素的基础上，帮助预测他是否会参加比赛。一种直观的方法是通过决策树。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jm"><img src="../Images/d24adc421f4b26ae8e0c4fbc0c703f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*F0fkSvxsl3YEiNRuv8Jb-w.png"/></div></figure><p id="f365" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，我们在决策树中有术语。在上面的树中，我们有</p><p id="3fa2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→ <strong class="ih hj">根节点</strong>:执行第一次拆分的节点。</p><p id="5621" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→ <strong class="ih hj">决策节点:</strong>中间节点，为某个属性值而分裂。</p><p id="e295" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→ <strong class="ih hj">叶:</strong>预测胜负的终端节点。</p><p id="d35a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能会想，这些分裂是怎么发生的？这就是信息增益(熵)或基尼指数在分割节点时发挥重要作用的地方。这些是选择最佳分割的数学方法。</p><p id="b9dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我讲讲熵，以便理解信息增益。</p><p id="bfcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">熵</strong>是不确定性或杂质的度量。它测量分裂的纯度。在下图中，我们可以理解低熵意味着变量的低混合，而高熵意味着变量的高混合。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es jn"><img src="../Images/a33a5d9f895826f0582e68605e571f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0O27rdJcNSXQljo64eV69Q.png"/></div></div></figure><p id="36ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算每个属性的信息增益有两个步骤:</p><p id="40dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→计算目标的熵。</p><p id="cd64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→计算每个属性的熵。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es js"><img src="../Images/9455d3fa087a3226080b8c29a41e1258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzqctIB1XibvsiOuC-RzeA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/258449aef18cc23350c819b7c5bef2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*m2GoSGM9yCmGp0zf2ixDdg.png"/></div></figure><p id="210d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了说明信息增益是如何工作的，让我以上面的数据集为例。首先，我们需要计算目标的熵，计算如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ju"><img src="../Images/72ab5db997d4866dd8a587000eac45a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4QBaZhPyJskegQdK9KIdQ.png"/></div></div></figure><p id="f9d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们需要计算属性的熵。为了计算属性的熵，我们需要为属性创建频率表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es jv"><img src="../Images/b33d2c4a7e89372d57b250ca9c53878e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqSskWuEmD3nVy43WDSPgQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">频率表</figcaption></figure><p id="5951" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，计算每个属性的熵。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ka"><img src="../Images/fa8a114c081b6b5683913cb5caba4e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wylN4Wh1lQod0gLFe5BTlQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">展望的熵计算</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kb"><img src="../Images/d788c0787304f35f930b9d0522374526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdzyJd7xD9mNMPpNoEo4uQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">展望的信息增益。</figcaption></figure><p id="ce99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，为每个属性计算信息增益。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kc"><img src="../Images/03a3ddc28de90f8ac4f79f46c316337a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_IBC_kKBFRHJEDqhajY1w.png"/></div></div></figure><p id="9798" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的信息增益计算图中，我们可以得出结论，outlook特征具有较高的I.G值，这意味着它具有较高的标签纯度或较少的目标标签混合，因此我们可以用outlook创建树的根节点。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kd"><img src="../Images/8f3197fbbecb033ca945c290f76448cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*mD2BOo2NTdOZWcmQ7GMkRw.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">树的构造</figcaption></figure><p id="1b22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们重复排除outlook的相同过程。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ke"><img src="../Images/9497d1bf7fd727500ebd97a62fb35d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iikN19gyhhv9q6PIXrRnhg.png"/></div></div></figure><p id="e61b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上表中，我们可以说没有标签的混合，如果场景是阴天，这个人来玩，所以我们可以直接用它来构造决策节点。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kf"><img src="../Images/5ef5b994037439b2543e1073e92821d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfZzisB4DBMmoieiPoigzQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">决策树。</figcaption></figure><p id="ca32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一步中，我们可以为前景晴朗的特征计算信息增益。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kg"><img src="../Images/2704ba8ed1ad9afd4413077d70eb8c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0z6qpiwweenfZgc6RjbftQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">信息增益</figcaption></figure><p id="5407" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据上面的计算，特征windy具有最高的I.G值，因此我们可以用该变量构建决策树。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kh"><img src="../Images/73b59bb7981bfed1ec11599ba361d8d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCR_3XGzGDOkDNFqr3YneQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">决策树的构造。</figcaption></figure><p id="21d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们需要找到决策节点，如果前景是多雨的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ki"><img src="../Images/a94e1f3fdcca118dcdf31f60dd40bf37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wx0cH0vsWcdh3Ai2hWZr9w.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">信息增益计算</figcaption></figure><p id="e1aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">湿度具有最高的信息增益值。湿度特征被用作树的下一次构造的决策节点。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/41758039350e737d0f514d77d68fb442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*D0_2yHU0z_lz2zHypCOJHA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">决策树的最终结构。</figcaption></figure><div class="je jf jg jh fd ab cb"><figure class="kk ji kl km kn ko kp paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><img src="../Images/af337f53aee58cb3b27b9d10a887233c.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*380hty7RCnvQhEhVmGZHIw.png"/></div></figure><figure class="kk ji kq km kn ko kp paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><img src="../Images/3fd4742dcd494c8c3b4374ca364d5a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*FqRGl0MaMszdloOaOqkNsw.png"/></div></figure></div><p id="71c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过查看决策树的最终结构，我们可以很容易地预测各种场景的最终结果。</p><p id="86e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基尼指数</strong>作为构建决策树的默认方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/99aacc350b44d2b4736a58ed64af4769.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/0*xAgdVf4FkX8zLKE2.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">基尼指数公式</figcaption></figure><p id="c15c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj">基尼系数</strong>方法构建树的步骤与熵方法相同。由于我们对每个类别取概率的平方和，而不是取对数值，因此计算速度优于熵值法。</p><p id="3530" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于连续值，最佳分割通过<strong class="ih hj">标准偏差减少(SDR) </strong>方法计算。</p><div class="je jf jg jh fd ab cb"><figure class="kk ji ks km kn ko kp paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><img src="../Images/438c6d440fc9da79f0b1908b3e5255cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*SpzP5j8PKJc6OHyvboy2bA.png"/></div></figure><figure class="kk ji kt km kn ko kp paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><img src="../Images/950d69088d123d99cd089b7f028b1163.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*wMYBv1Cy3d9U5Utn5IIBHA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx ku di kv kw translated">特别提款权公式</figcaption></figure></div><p id="89ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这与熵方法相同，但是计算的是值的标准偏差，而不是熵。</p><h2 id="86f1" class="kx ky hi bd kz la lb lc ld le lf lg lh iq li lj lk iu ll lm ln iy lo lp lq lr bi translated">优势:</h2><ul class=""><li id="3ae4" class="ls lt hi ih b ii lu im lv iq lw iu lx iy ly jc lz ma mb mc bi translated">决策树非常容易实现，也很容易理解。</li><li id="aabf" class="ls lt hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">树可以很容易地处理和启动预测。</li></ul><h2 id="8ec8" class="kx ky hi bd kz la lb lc ld le lf lg lh iq li lj lk iu ll lm ln iy lo lp lq lr bi translated">缺点:</h2><ul class=""><li id="397f" class="ls lt hi ih b ii lu im lv iq lw iu lx iy ly jc lz ma mb mc bi translated">树通常不具有与任何其他回归和分类方法相同水平的预测准确性。</li><li id="6038" class="ls lt hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">这通常会导致过度拟合，这意味着树对训练数据给出了好结果，而对测试数据给出了坏结果。</li></ul><h2 id="e70f" class="kx ky hi bd kz la lb lc ld le lf lg lh iq li lj lk iu ll lm ln iy lo lp lq lr bi translated">结论:</h2><ul class=""><li id="0b69" class="ls lt hi ih b ii lu im lv iq lw iu lx iy ly jc lz ma mb mc bi translated">决策树是非常古老的概念，是随机森林、Boosting方法等升级模型的基础。为了理解所有这些算法，我们需要理解决策树的工作方法。</li><li id="2925" class="ls lt hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">希望您对决策树的工作原理有了基本的了解。感谢您阅读这篇文章。</li><li id="c7c0" class="ls lt hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">参考这个<a class="ae mi" href="https://github.com/Rishikumar04/Data-Science-Training/blob/main/Classification%20Problems/05-Decision%20Trees%20and%20Random%20Forest%20Project.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>用Python实现决策树。</li></ul></div></div>    
</body>
</html>