<html>
<head>
<title>How to implement Redis Cache in ASPNET</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在ASPNET中实现Redis缓存</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-implement-redis-cache-in-aspnet-52e2a2926f32?source=collection_archive---------11-----------------------#2021-03-26">https://medium.com/nerd-for-tech/how-to-implement-redis-cache-in-aspnet-52e2a2926f32?source=collection_archive---------11-----------------------#2021-03-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/d6c198c4567ccacfb6938266afe6e529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*fojeqEROj6zVSU7_IXvk1w.jpeg"/></div></figure><p id="7786" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">到目前为止，您应该已经知道什么是缓存，以及为什么开发人员经常使用缓存来提高应用程序的性能。如果没有，我们建议您阅读我们之前关于缓存基础的文章，以帮助您浏览这篇文章。缓存已经被广泛用于减少资源的消耗，Redis缓存是实现缓存的流行手段之一。</p><p id="a6f6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可能有很多框架可以实现缓存，但是我们选择Redis是因为它的快速性能、可伸缩性、对多种语言的支持等等。</p><p id="2131" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本帖中，我们将带您在缓存之旅中领先一步，帮助您了解如何在ASP.NET<em class="jl">应用程序中实现</em><strong class="io hj"><em class="jl">Redis缓存。</em></strong></p><h1 id="ce56" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">目录</h1><ol class=""><li id="599a" class="kk kl hi io b ip km it kn ix ko jb kp jf kq jj kr ks kt ku bi translated">如何安装Redis缓存？</li><li id="b989" class="kk kl hi io b ip kv it kw ix kx jb ky jf kz jj kr ks kt ku bi translated">设置客户端</li><li id="822f" class="kk kl hi io b ip kv it kw ix kx jb ky jf kz jj kr ks kt ku bi translated">您的应用程序如何与Redis缓存交互？</li><li id="b651" class="kk kl hi io b ip kv it kw ix kx jb ky jf kz jj kr ks kt ku bi translated">包扎</li></ol><h1 id="e070" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">如何安装Redis缓存？</h1><p id="93dc" class="pw-post-body-paragraph im in hi io b ip km ir is it kn iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">寻找问题'<strong class="io hj">如何在ASP.NET应用程序中实现Redis缓存'答案的第一步是在本地系统上安装Redis。GitHub有一个可下载的Redis Cache for Windows版本。下面是<a class="ae jk" href="https://github.com/microsoftarchive/redis/releases" rel="noopener ugc nofollow" target="_blank">链接</a>下载。</strong></p><p id="fb04" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您可以选择下载MSI文件或zip文件。MSI文件通常会在您的本地计算机上安装Redis，并创建一个windows服务。这将在启动时自动启动Redis服务器。另一方面，在zip文件版本中，每次需要应用程序与Redis交互时，都必须手动启动服务器。</p><p id="702c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我们的例子中，我们已经下载了压缩版本。一旦你解压文件到你的本地系统，点击文件server.exe。这将启动Redis服务器，并使您能够查看如下所示的屏幕。该屏幕还显示服务器现在准备好接受端口6379上的连接。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ld"><img src="../Images/a85841fbca1b1cca5579e6ff03498fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MDt8ZWpb_NqfxbKH"/></div></div></figure><p id="f537" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您还可以通过选择文件redis-cli.exe并输入命令“<em class="jl"> ping </em>”来验证服务器是否已经启动。如果服务器运行良好，您将得到“pong”响应。</p><p id="20b5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里的127.0.0.1:6379是我们的客户机将要连接的本地主机。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/10e997fbbd46d10a3438892c39bba2e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/0*fKByv_47iKVWHnMb"/></div></figure><h1 id="1633" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">设置客户端</h1><p id="43b3" class="pw-post-body-paragraph im in hi io b ip km ir is it kn iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">既然Redis缓存服务器已经启动并运行，下一步就是让客户机与缓存进行交互。为此，让我们构建一个客户机，在Redis缓存中存储和检索数据。通过在Visual Studio中创建一个新的控制台应用程序项目来开始该过程。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/ca0ce33d96c8212f57437f5fbb0c62ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oIohsCHxFIuKHESo"/></div></div></figure><p id="46d6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">成功创建控制台项目后，安装ServiceStack。Redis包在NuGet包管理器的帮助下。这个库对于让您的客户机与Redis服务器进行交互是必不可少的。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/7191949f012b408942d4f9a037d05e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C02TkTPbFL36I8NC"/></div></div></figure><p id="7ff4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要安装这个包，你所要做的就是搜索<a class="ae jk" href="https://github.com/ServiceStack/ServiceStack.Redis" rel="noopener ugc nofollow" target="_blank"> ServiceStack。在NuGet explorer中Redis包</a>并安装它。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/ad850a09750e5864f384f8116d2a96ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8yvsgAhKYaeMK2Ox"/></div></div></figure><p id="a449" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一旦ServiceStack。Redis包安装完毕，下一步是定义<strong class="io hj">保存</strong>和<strong class="io hj">获取</strong>功能。但是在我们理解SAVE和GET函数是什么或者如何设置它之前，让我们借助一个例子快速回顾一下Redis缓存是如何工作的。</p><h1 id="9836" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">您的应用程序如何与Redis缓存交互？</h1><p id="1b78" class="pw-post-body-paragraph im in hi io b ip km ir is it kn iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">假设您的应用程序被组织用来存储员工的详细信息。要捕获的字段之一是他们的国家，我们决定以下拉菜单的形式显示给用户。</p><p id="80e9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们假设您的数据库由于某种原因没有存储country字段(比如国家列表经常变化或者您的应用程序禁止存储国家)。相反，您可以从第三方服务中提取国家列表，并在每次用户尝试注册时将其填充到下拉列表中。</p><p id="e9b2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在某一天，成千上万的用户试图注册。这意味着对第三方服务的请求超过一千个。现在，如果第三方服务对其服务的每个请求收费，这就变成了一个昂贵的提议。</p><p id="c6ab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了避免这种情况，我们使用Redis缓存来临时存储信息。当第一个用户尝试注册时，将从第三方服务中提取国家列表，并在下拉菜单中显示给用户。同时，国家也存储在Redis缓存中。一旦数据存储在Redis缓存中，就可以以更快的速度(并且免费)将数据再次提取给下一个用户。国家列表可以在一天结束时在缓存中重置，以便第二天重新开始。</p><p id="c49a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下图描述了您的应用程序如何与Redis缓存和第三方服务进行交互来获取数据。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/bef94b9a1ea60466aec334491a6fbd02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OfTfMORg1dTVP_oh"/></div></div></figure><p id="0323" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上图中，您会注意到有两个名为GET和SAVE的函数。GET函数用于从Redis缓存中提取信息并将其显示在应用程序中，而SAVE函数用于将从第三方服务提取的数据保存在Redis缓存中。</p><p id="4e15" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在Visual Studio的控制台项目中，可以如下定义SAVE函数。为了定义这一点，我们在这里考虑了保存/提取国家列表的相同示例，这在前面的部分中已经解释过了。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/65d6f00320f245e0cd896e32f86303ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/0*XqmCIH5brY-IUA-b"/></div></figure><p id="0ecd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">并将GET函数定义如下。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/8f0f7a3581ae9907932784c1449d6f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/0*NBM8iaSL1WMjs4h_"/></div></figure><p id="627f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们定义主函数来调用GET和SAVE函数。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/d0a3b215349afd69548112c60b2584f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uErtLSfL4VOGcAUl"/></div></div></figure><p id="b0fc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上面的定义中，您还会注意到定义了一个<code class="du lq lr ls lt b">ValidateKeyIsPresent</code>函数。你知道为什么吗？</p><p id="39cd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">记住Redis是一个基于键的缓存系统。这意味着只有发送与数据相关联的键，才能从缓存中获取数据。这个检查是由ValidateKeyIsPresent函数执行的。如果密钥不存在，则不能从缓存中提取数据，而是从第三方服务中提取。</p><p id="f06d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">运行控制台应用程序后，应该有一个关键名称南盟国家。如果我们在终端中运行redis-cli.exe并运行命令<code class="du lq lr ls lt b">KEYS *</code>,我们将获得Redis中存储的所有当前密钥。</p><p id="8796" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">获取我们的国家列表只需运行带有键名的<a class="ae jk" href="https://redis.io/commands/get" rel="noopener ugc nofollow" target="_blank"> GET </a>命令，带有模式<code class="du lq lr ls lt b">GET SAA*</code>的<code class="du lq lr ls lt b">GET "SAARC Countries"</code>。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ln"><img src="../Images/a08d473d20b12cd9c618a214e2f7c6b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0nndoHgPQ696zSJ5"/></div></div></figure><h1 id="f58e" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">包扎</h1><p id="fbb8" class="pw-post-body-paragraph im in hi io b ip km ir is it kn iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">这篇文章向你展示了如何在你的ASP.NET应用程序中实现Redis。Redis对于商业和非商业用途都是一个很好的选择，因为它是完全免费和开源的。最重要的是，在管理数据时，它的速度极快，性能开销可以忽略不计。因此，继续在您的应用程序中设置Redis，让您的访问者获得快得惊人的用户体验。</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><p id="18eb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jl">原发布于</em><a class="ae jk" href="https://www.partech.nl/nl/publicaties/2020/07/how-to-implement-redis-cache-in-aspnet" rel="noopener ugc nofollow" target="_blank"><em class="jl">https://www . partech . nl</em></a><em class="jl">。</em></p></div></div>    
</body>
</html>