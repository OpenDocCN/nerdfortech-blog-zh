<html>
<head>
<title>Machine Learning — Introduction to Modeling #2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习—建模介绍#2</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/machine-learning-introduction-to-modeling-2-9bc441c3a2b8?source=collection_archive---------11-----------------------#2021-05-01">https://medium.com/nerd-for-tech/machine-learning-introduction-to-modeling-2-9bc441c3a2b8?source=collection_archive---------11-----------------------#2021-05-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/501463cdca34567cc5e9acd0acb395c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Wmv3R_HQ9Nf0UsXBwT4z_A.gif"/></div></div></figure><p id="0c97" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上一篇文章中，我对机器学习有一个大概的介绍。我检查了关于数据、<em class="jo">使用区域</em>和<em class="jo">常用概念</em>的<em class="jo">信息。在本文中，我将继续使用常用的概念。然后，我将检查<em class="jo">模型验证方法</em>。</em></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="431c" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">模特培训</em> </strong></h2><p id="ccbe" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">在机器学习模型的开发中，经过训练的模型应该在新的或未知的数据上表现良好。我们将现有数据分为 2 个作为训练和测试数据集，以模拟新的/看不见的数据。具体来说，第一部分是用作训练集的数据的较大数据子集(例如考虑到原始数据的 80%)，第二部分是较小的子集并用作测试集(剩余的 20%数据)。</p><p id="9d6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">比如我们给算法数据，通过这个数据，算法学习一个结构(比如房价预测模型)。换句话说，它学习因素的影响以及这些影响的方面。我们将我们的数据集分成 2 份，以测试我们通过教学创建的这些算法是否成功。假设我们有一个 1000 个观察值的数据集，我们分配 800 个来训练和测试剩余的 200 个，看看他们是否训练了模型。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/aba46d11120751ef77627f7f5e77ac23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_MT9zX64RLphkkztsR-Okg.png"/></div></div></figure><h2 id="3140" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak">变量选择</strong></h2><p id="863d" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">在建模研究过程中，根据数据集的大小，我们可能有 5 个、10 个甚至 100 个独立变量。我们将尝试用这些自变量来估计因变量 Y。在建模研究中，我们不试图在模型中保留所有变量，目的是试图用最少的变量获得最多的解释。</p><h2 id="fd8b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">型号选择</em> </strong></h2><p id="638b" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">两种方法脱颖而出。</p><ul class=""><li id="e6c5" class="lc ld hi is b it iu ix iy jb le jf lf jj lg jn lh li lj lk bi translated">尽量确保在用可能出现的变量组合创建的模型中选择最佳模型。</li><li id="fe7c" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">尝试在安装的不同型号中选择一个型号。</li></ul><h2 id="d045" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">如何选择型号？</em> </strong></h2><p id="429b" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">对于回归问题，使用解释比率和 RMSE(误差测量度量)导数值。<br/>对于分类问题，使用正确分类率的导数值(用于评估模型成功的度量)。</p><h2 id="63f9" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">过拟合</em> </strong></h2><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/84f09d30910ba01736d35dff9aabdc87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wcfqxyNBi4HQ-RPmNEIVNg.png"/></div></div></figure><p id="771f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该模型学习了特定于训练数据的模式，但它不能很好地预测新的、看不见的数据。</p><p id="4785" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">换句话说，我们把数据一分为二，作为测试和训练。它很好地学习了算法训练集。但是，当我们尝试使用它看不到的数据集来预测模型时，预测性能开始下降。这种情况称为过度拟合。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/ffac601d49a89478f43747e5e76f455e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcvsyOCjWCX0YegQeUOjWQ.png"/></div></div></figure><h2 id="061e" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">确定性模型 vs 随机模型</em> </strong></h2><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/07c2e773ee6d47b26432d233245d2036.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*Azb3uLO4j8Q8sVWNXqwjYA.jpeg"/></div></figure><p id="cd98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">在确定性模型</em>中，模型假设变量之间存在确定的关系。这两个变量之间的关系用一条线表示。换句话说，模型的输出完全由参数值决定。</p><p id="0baa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">随机模型</em>是概率模型。这里有一个随机误差。</p><p id="cc06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上图中我们可以看到，在随机模型中，当我们试图预测 X 和 Y 之间的关系时，我们不能线性地表达它。有一个误差范围。</p><h2 id="dfc3" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">线性 vs 非线性</em> </strong></h2><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/90bc3e25472a47ac894c4ac586fa01c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*dydB0M4bR-I6sDrLswLwzA.png"/></div></figure><p id="0345" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果用直线表示，X 和 Y 之间的关系是线性的。如果变量之间的关系使用曲线、基于树的方法或其他方法而不是直线来建模，这被称为非线性方法。</p><blockquote class="lu"><p id="6a57" class="lv lw hi bd lx ly lz ma mb mc md jn dx translated">机器学习简单来说就是从数学过渡到统计学的过程。数学包括精确性，统计学包括概率。统计学中没有确定性，总会有误差和猜测。</p></blockquote><h1 id="ddfb" class="me jx hi bd jy mf mg mh kc mi mj mk kg ml mm mn kj mo mp mq km mr ms mt kp mu bi translated"><strong class="ak">模型验证方法</strong></h1><p id="f145" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">我们建立一个模型来寻找因变量和自变量之间的关系。例如，我们要预测的因变量是房屋的价格，我们的自变量是房屋的大小、位置、楼层等。在拟合模型之后，我们需要评估模型的结果。这些研究被称为模型验证方法。回归模型和分类模型使用不同的方法。</p><h2 id="0c1f" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">维持方式</em> </strong></h2><p id="f5c0" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">假设你有一个原始数据集。我们将具有 1000 个观察值的数据集划分为 80% — 20%作为训练集和测试集。我们用 800 个观察值进行训练，用 200 个观察值进行测试。例如，我们通过训练集学习房价预测模型中的系数，然后我们通过 200 次观察来测试这种预测有多好。</p><p id="7bed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在维持方法中，如果观察值很少，我们可能无法将数据集分为训练集和测试集。例如，当我们有 50 个观察值时，我们可能不会划分数据来训练和测试它。</p><h2 id="79a7" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr"> K 折交叉验证方法</em> </strong></h2><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/52db1c064770ff5abc55fb9d72836429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hCZ7JbJ70w9GrsVv8uSUJA.gif"/></div></div></figure><p id="fb9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集被分成 k 个部分。在第一次迭代中，第一次折叠用于测试模型，然后其余的用于训练模型。在第二次迭代中，第二个折叠用作测试集，而其余折叠用作训练集。重复这个过程，直到所有的折叠都被用作测试集。</p><p id="6218" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当获得的误差被平均时，这将是我们的验证(训练)误差。然后，我们用研究开始时划分的测试集来测试我们的模型。</p><p id="11ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们总是需要将我们拥有的数据集分成测试集和训练集。在这种分离之后，我们总是需要对训练集进行 K 折叠方法。我们需要在训练集上计算一个正确的训练误差，将其放在一边，并在测试集上测试我们创建的模型。</p><p id="92b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，我们有一个原始数据集。我们将这个数据集一分为二作为测试训练，80% -20%。我们使用这 80%的训练数据进行验证。我们这样做 5 或 10 倍，并从这里建立一个模型。利用得到的模型中的训练误差，对测试数据进行测试。</p><h2 id="b5a4" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">留一个出来的方法</em> </strong></h2><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/932d13a477c8f0e981ac7979e1eb4e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*L9Sld5i_hq8QTs3mAKOA6g.gif"/></div></div></figure><p id="0842" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是 K 倍法的一个特殊版本。在 K 中，我们将数据集分成 5-10 个部分，在每次迭代中排除一个折叠，并使用我们遗漏的部分来建立和测试具有其他折叠的模型。这里，数据集中样本的数量等于聚类数量的 n 倍。也就是说，假设有 n 个集群。和 K 一样，都是分别测试。</p><p id="44c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，我们有 1000 个观察值。每次，一个模型适合 999 个观察单元，然后测试一个观察单元。在第二次迭代中，排除另一个观察单元，并用所有其他观察值拟合模型，然后测试排除的观察单元。这样就分析了整个数据集。</p><p id="4c5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">虽然这种方法在理论上可以应用，但随着数据集的增长，很难使用。</p><h2 id="8472" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated"><strong class="ak"> <em class="kr">自举法</em> </strong></h2><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/b12705e79d8b7656dcaa1dddcb3df752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vu8wKK-b_fhzZ1sr1hr2zg.png"/></div></div></figure><p id="4daa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与其他方法类似，它基于这样的方法，例如以某种方式将数据集一分为二，让我们用一部分来训练模型，用另一部分来测试。除了其他方法所做的之外，Bootstrap 以一种重新采样的方式工作。</p><p id="f046" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，我们有原始数据集。从这个数据集中，创建引导样本，使得数据集少于观察的数量。比如 Bootstrap1，Bootstrap2，Bootstrap3 等 10 个。该模型根据这 10 个数据进行拟合。用测试集方法测试拟合的模型，并且通过分别取训练和测试的平均值来评估结果。</p><p id="533c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总而言之，它是用来以替代的方式从一个数据集中导出数据的。对创建的每个新数据拟合一个模型。对这些模型进行测试，并对结果进行相应的评估。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="4c0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，上述方法中最常见的是 K 倍交叉验证法。当我们考虑一个新的数据集时，首先会把它一分为二作为测试和训练。我们将在这里的训练/训练集上使用 K-Fold 交叉验证方法来评估它，我们将已经创建了我们的最终模型并获得了我们的测试误差。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="e4e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下一篇文章中，我们将看到评估模型预测成功的方法…</p></div></div>    
</body>
</html>