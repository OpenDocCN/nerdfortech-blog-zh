<html>
<head>
<title>Everything You Should Know About Binding in Android, Part-2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于Android绑定您应该知道的一切，第2部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/everything-you-should-know-about-binding-in-android-part-2-8fd0c7fd3dfd?source=collection_archive---------0-----------------------#2020-10-07">https://medium.com/nerd-for-tech/everything-you-should-know-about-binding-in-android-part-2-8fd0c7fd3dfd?source=collection_archive---------0-----------------------#2020-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f7859913e4cd3c9a3974273750ed6806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aiURlgEZZ_dIma-ZX_mBmQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@emilep?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃米尔·佩伦</a>在<a class="ae iu" href="https://unsplash.com/s/photos/binding-code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="d823" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在第一部分中，我们了解了什么是视图绑定，什么是数据绑定。两者有什么不同。和绑定的基本功能。如果您尚未查看，请点击此处查看:</p><div class="jt ju ez fb jv jw"><a rel="noopener follow" target="_blank" href="/@karishma.agr1996/everything-you-should-know-about-binding-in-android-a8a70bc882f0"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">关于Android绑定你应该知道的一切</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">你好朋友们。我希望你喜欢我的写作，如果你有任何建议让我知道。所以这周，我们要去…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jw"/></div></div></a></div><p id="7d0a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们将讨论如何为嵌套布局应用绑定。如何在视图上显示之前使用BindingAdapter自定义值，然后使用双向数据绑定。</p><h1 id="9d04" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">包括</strong></h1><p id="5286" class="pw-post-body-paragraph iv iw hi ix b iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo ln jq jr js hb bi translated">Include用于通过绑定向包含的布局传递数据。例如，你有diff-diff屏幕，它使用一个公共布局，包含一个编辑文本、标签、图标和按钮。我们希望在diff-diff位置包含该布局。</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="4d19" class="lx km hi lt b fi ly lz l ma mb">&lt;layout xmlns:android="http://schemas.android.com/apk/res/android"<br/>        xmlns:bind="http://schemas.android.com/apk/res-auto"&gt;<br/>   &lt;data&gt;<br/>       &lt;variable name="user" type="com.example.User"/&gt;<br/>   &lt;/data&gt;</span></pre><p id="fd1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设在主布局中你有一个类对象，你想在包含的布局中传递它。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="d0da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用<code class="du me mf mg lt b">bind</code>作为属性，然后是您在包含的布局中使用的数据对象的名称。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="d443" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以传递任何具有相同数据对象名称的内容。</p><h1 id="890d" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">绑定适配器</h1><p id="e0df" class="pw-post-body-paragraph iv iw hi ix b iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo ln jq jr js hb bi translated">它帮助你创建一个合适的框架来设置价值观。例如</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/e72e7867c53066878d8aa13c6f4dc65a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cEWwnnJCk2MvrIMPOFTprQ.png"/></div></div></figure><p id="26b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在给定的图案中展示文字，我们可以做2件事:<br/> 1。使用给定样式的2 diff文本视图<br/> 2。使用单一文本视图并在运行时动态设置样式</p><p id="9683" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用绑定适配器，我们将使用绑定做第二件事。</p><p id="fce6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">步骤1:创建绑定适配器类。文件名可以是任何东西。</p><p id="3fdc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">步骤2:创建一个方法，在名字的地方用<br/> <code class="du me mf mg lt b">@BindingAdapter(value = [<strong class="ix hj">“&lt;name&gt;”</strong>])<br/></code>注释它，你可以定义一个变量名，我们需要在我们的XML文件中使用它来显示数据，或者使用适配器定制它。</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="fa28" class="lx km hi lt b fi ly lz l ma mb"><strong class="lt hj">fun </strong>bindSleepProgressText(textView: TextView, sleepProgressData: SleepProgressData) {<br/>.........<br/>}</span></pre><p id="d41d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为方法参数，首先我们将拥有视图id，第二个是我们需要显示的值。</p><p id="6df0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以对于我们给定的设计方法会是这样的:</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="09f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它将以定制的形式返回文本。</p><p id="c5f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">步骤3:在布局文件中使用:</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="e570" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du me mf mg lt b">sleepProgressData</code>哪个被注释的名字将被用作你的视图中的属性并传递参数。查看它将自动获取的参数。</p><h1 id="2df9" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">绑定方法</h1><p id="f65f" class="pw-post-body-paragraph iv iw hi ix b iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo ln jq jr js hb bi translated">对于名为<code class="du me mf mg lt b">example</code>的属性，库会自动尝试寻找接受兼容类型作为参数的方法<code class="du me mf mg lt b">setExample(arg)</code>。在搜索方法时，不考虑属性的名称空间，只使用属性名称和类型。</p><p id="bd54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">即使不存在具有给定名称的属性，数据绑定也能工作。然后，您可以使用数据绑定为任何setter创建属性。例如，支持类<code class="du me mf mg lt b"><a class="ae iu" href="https://developer.android.com/reference/androidx/drawerlayout/widget/DrawerLayout" rel="noopener ugc nofollow" target="_blank">DrawerLayout</a></code>没有任何属性，但是有很多setters。下面的布局自动使用<code class="du me mf mg lt b"><a class="ae iu" href="https://developer.android.com/reference/androidx/drawerlayout/widget/DrawerLayout#setScrimColor(int)" rel="noopener ugc nofollow" target="_blank">setScrimColor(int)</a></code>和<code class="du me mf mg lt b"><a class="ae iu" href="https://developer.android.com/reference/androidx/drawerlayout/widget/DrawerLayout#setDrawerListener(android.support.v4.widget.DrawerLayout.DrawerListener)" rel="noopener ugc nofollow" target="_blank">setDrawerListener(DrawerListener)</a></code>方法分别作为<code class="du me mf mg lt b">app:scrimColor</code>和<code class="du me mf mg lt b">app:drawerListener</code>属性的设置器:</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><h1 id="7c2b" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">使用LiveData向UI通知数据更改</h1><p id="cde0" class="pw-post-body-paragraph iv iw hi ix b iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo ln jq jr js hb bi translated">您可以使用<code class="du me mf mg lt b">LiveData</code>对象作为数据绑定源，自动通知UI数据的变化。</p><p id="af6d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使用带有绑定的动态数据，我们需要定义生命周期所有者来定义动态数据的范围。</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="b29f" class="lx km hi lt b fi ly lz l ma mb">binding.setLifecycleOwner(this)</span></pre><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="44e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每当你的动态数据发生任何更新，它将改变用户界面。</p><p id="7c8e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以使用一个<code class="du me mf mg lt b">ViewModel</code>组件，将数据绑定到布局。</p><h1 id="ef43" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">将ViewModel绑定到更新UI</h1><p id="4dcb" class="pw-post-body-paragraph iv iw hi ix b iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo ln jq jr js hb bi translated">将<code class="du me mf mg lt b">ViewModel</code>组件与数据绑定库一起使用允许您将UI逻辑移出布局并移入组件，这样更容易测试。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><h1 id="4f9e" class="kl km hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">双向数据绑定</h1><p id="8d8c" class="pw-post-body-paragraph iv iw hi ix b iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo ln jq jr js hb bi translated">使用单向数据绑定，您可以在属性上设置一个值，并设置一个对该属性的更改做出反应的侦听器。双向数据绑定为这一过程提供了一条捷径。</p><p id="e607" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在双向绑定中，我们使用<code class="du me mf mg lt b">@={}</code>符号，它接收对属性的数据更改，同时监听用户更新。</p><p id="8250" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">例如:</strong>您正在填充用户配置文件，因此首先我们使用绑定获取已经保存的数据。当用户更新表单中的信息时，我们更新ViewModel中的实时数据，所以当用户单击保存按钮时，实时数据将有更新信息。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="3b5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du me mf mg lt b">android:text=”@={viewModel.name}”</code>，它将从ViewModel获取用户名，当用户更新该值时，它也将更新实时数据。</p><p id="78ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于在我们的应用程序中灵活绑定数据的健壮性，数据绑定可以在我们的应用程序中有选择地使用。您可以选择在一个布局文件中使用数据绑定，也可以选择在另一个布局中完全避免使用数据绑定，因为它变得很难管理而且非常混乱。这完全取决于你。</p><p id="3448" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢您的阅读。👏我真的希望这篇文章对你有所帮助。非常感谢你的鼓掌帮助其他人找到这篇文章😃。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/bf024829742f625ee65e4c09cdc00380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*eYXESbPHZI5Qe7I_QZFXVA.gif"/></div></figure></div></div>    
</body>
</html>