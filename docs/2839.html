<html>
<head>
<title>Machine Learning Model Performance Metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习模型性能指标</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/machine-learning-model-performance-metrics-84f94d39a92?source=collection_archive---------21-----------------------#2021-05-21">https://medium.com/nerd-for-tech/machine-learning-model-performance-metrics-84f94d39a92?source=collection_archive---------21-----------------------#2021-05-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="691d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类问题的重要模型评估指标！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0c145f38d509fac5ed3ffddb9529f326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AlS6_i_saViESi8n.jpg"/></div></div></figure><p id="6880" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jp translated">构建机器学习模型的想法基于建设性的反馈原则。您建立一个模型，从度量中获得反馈，进行改进，并继续下去，直到达到理想的准确度。顾名思义，性能指标解释了模型的性能。性能指标的一个重要方面是它们区分模型结果的能力。</p><p id="a6e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我见过很多分析师和有抱负的数据科学家甚至懒得检查他们的模型有多稳健。一旦他们完成了一个模型的建立，他们就匆忙地将预测值映射到看不见的数据上。这是不正确的做法！</p><p id="ee41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一个模型的输出因变量(标签)始终是准确的，即使一个或多个输入自变量(特征)或假设由于不可预见的情况而发生剧烈变化，该模型也被认为是稳健的。简单地建立一个预测模型不是你的动机。它是关于创建和选择一个对样本外数据给出高精度的模型。因此，在计算预测值之前检查模型的准确性至关重要。</p><p id="c056" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有不同种类的指标来评估我们的模型。完成模型构建后，这6个指标将帮助您评估模型的准确性。</p><h1 id="3b8d" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">内容</h1><ol class=""><li id="e851" class="kw kx hi ih b ii ky im kz iq la iu lb iy lc jc ld le lf lg bi translated">快速预热:预测模型的类型</li><li id="b91e" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">举例说明</li><li id="af02" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">混淆矩阵</li><li id="1612" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">分类准确度</li><li id="83fe" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">精确</li><li id="380f" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">回忆</li><li id="9c7f" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">f1-分数</li><li id="5dc6" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">AUC-ROC</li></ol><h1 id="27c2" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">快速预热:预测模型的类型</h1><p id="7312" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">当我们谈论预测模型时，我们谈论的是回归模型(连续输出)或分类模型(名义或二进制输出)。这些模型中使用的评估指标各不相同。在分类问题中，我们使用两种类型的算法(取决于它创建的输出类型):</p><ul class=""><li id="edef" class="kw kx hi ih b ii ij im in iq lp iu lq iy lr jc ls le lf lg bi translated"><strong class="ih hj">类输出:</strong>像SVM和KNN这样的算法创建一个类输出。例如，在二进制分类问题中，输出将是0或1。然而，今天我们有算法可以将这些类输出转换成概率。但是这些算法并没有被统计界很好地接受。</li><li id="0ce1" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">概率输出:</strong>逻辑回归、随机森林、梯度推进、Adaboost等算法。给出概率输出。将概率输出转换为类输出只是创建一个阈值概率的问题。</li></ul><p id="5f59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在回归问题中，我们在输出中没有这样的不一致。输出在本质上总是连续的，不需要进一步的处理。</p><p id="df8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于分类模型评估指标的讨论，我使用了我对Kaggle上的一个二元分类问题的预测。这个问题的解决办法不在我们讨论的范围之内。但是，本文使用了对训练集的最终预测进行说明。对这个问题的预测是概率输出，假设阈值为0.5，已经转换为类输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/0c8331f526dabb850edee4dc20e886ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BFUz_PJYz8-yghfx.gif"/></div></div></figure><p id="b25b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参见上文，数据中有5个输入样本，其中3个属于负样本(类别1)，2个属于正样本(类别0)。考虑到阈值为0.5，概率为0.76的第5个观察值被错误分类为1类。</p><h1 id="0b97" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">混淆矩阵</h1><p id="0907" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">混淆矩阵是一个N×N矩阵，其中N是被预测的类的数量。在上面的例子中，我们有N=2，因此我们得到一个2×2的矩阵。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/3f4aa85da877368a3a7b760255a220e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/0*hUZNvUUjpAktpjSr.png"/></div></figure><p id="6bb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有6个重要术语:</p><ul class=""><li id="d8bc" class="kw kx hi ih b ii ij im in iq lp iu lq iy lr jc ls le lf lg bi translated"><strong class="ih hj">真阳性:</strong>我们预测为阳性，实际输出也为阳性的情况。在这里，真阳性是2。</li><li id="f67f" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">真阴性:</strong>我们预测为阴性，实际输出为阴性的情况。在这里，真正的负数是2。</li><li id="cf63" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">假阴性:</strong>我们预测为阴性而实际输出为阳性的情况。我记得它是错误地预测负面的。这里，假阴性是1。</li><li id="e200" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">假阳性:</strong>我们预测为阳性而实际输出为阴性的情况。我记得这是错误的预测。在这里，没有假阳性，即0。</li><li id="46d9" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">I型误差:</strong>在统计假设检验中，是指当一个零假设为真时，拒绝该假设而产生的误差。它是在本该被接受的假设被拒绝时产生的。它用α (alpha)表示，称为误差，也称为测试的显著性水平。</li><li id="7313" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">第二类误差:</strong>是在原假设不成立的情况下接受原假设时出现的误差。简单来说，就是在不该接受的时候接受假设。它用β(β)表示，也称为β误差。</li></ul><h1 id="2a4d" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">分类准确度</h1><p id="5be4" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">当我们使用术语“准确性”时，分类准确性就是我们通常所指的。</p><p id="c656" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">准确度是正确预测的数量与输入样本或观测值的总数之比。通俗地说，准确性是我们的模型正确预测的分数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/1f227b69958741d28d41a6bf459d2fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*36kFZbzW_rXyI4bt.png"/></div></div></figure><p id="7c69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，精度= (2+2)/(2+0+1+2) = 4/5 ie。, 80%</p><p id="df17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，考虑在我们的训练集中有98%的类0样本和2%的类1样本。那么我们的模型通过简单预测属于0类的每一个训练样本，就可以轻松获得98%的训练准确率。</p><p id="8620" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当在测试集上用60%的类0样本和40%的类1样本测试同一个模型时，测试精度会下降到60%。分类精度很高，但是给了我们达到高精度的错觉。</p><p id="2778" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当小类样本的错误分类成本非常高时，真正的问题就出现了。如果我们处理一种罕见但致命的疾病，未能诊断出患者疾病的成本远远高于将健康人送去进行更多测试的成本。</p><h1 id="c289" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">精确</h1><p id="483a" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">精度是正确的阳性结果数除以分类器预测的阳性结果数。结果是介于0.0(无精度)和1.0(完全或完美精度)之间的值。Precision查看有多少垃圾邮件被混在一起。如果没有坏的肯定(那些FPs)，那么模型有100%的精确度。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/68b4e5f565a9bc6fa9e26daaf3e2e698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/0*naJPxwgNAFPOo4YI.png"/></div></figure><p id="a63e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，精度= 2/(2+0) = 1 ie。, 100%</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/a96b0385df696fe18050fd87cec09004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KQT79JOwl_MRxHFg.gif"/></div></div></figure><h1 id="d3d1" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">回忆</h1><p id="7f1b" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">召回率是正确阳性结果的数量除以所有相关样本的数量(所有应被鉴定为阳性的样本)。结果是介于0.0(无回忆)和1.0(完全或完全回忆)之间的值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/5d5a6ce81a2c4ba4fc7ba6c5b11732ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/0*sWBRtOeUVbRFiRqP.png"/></div></figure><p id="964e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，回忆= 2/(2+1) = 2/3，即67%</p><p id="08e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与precision只对所有肯定预测中的正确肯定预测进行评论不同，recall提供了对错过的肯定预测的指示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/ef13a2d0635c63aa917d8397ececbc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qZ5uY6CZ0r-gkRaS.gif"/></div></div></figure><h1 id="119f" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">f1-分数</h1><p id="0212" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">精确度和召回率调和平均值。这是一个既代表精确度又代表召回率的单一分数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/24195ae5525e8ec17ad9b9f9c8e8e063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7Ofp5iISolcrdguy"/></div></div></figure><p id="6fdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，F1-score =(2 * 1 * 0.67)/(1+0.67)= 0.80%</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/6fcbf7809446f74f50f55c3a4c4f1e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dFxGyvZINOyJAbv0.gif"/></div></div></figure><p id="44f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">那么为什么是调和平均数，为什么不是算术平均数呢？</strong>因为它更惩罚极值。</p><p id="85e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑一个简单的方法(例如，总是返回类0)。有无限个类1的数据元素和一个类0的元素:</p><p id="6099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">精确度= 0.0，召回率= 1.0</p><p id="9f5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当取算术平均值时，它将有50%正确。尽管这可能是最坏的结果！但是，对于调和平均值，F1值为0。</p><p id="2d6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">算术平均值= 0.5，调和平均值= 0.0</p><p id="ddc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">换句话说，要想获得高F1分数，你需要同时具备高精确度和高召回率。</strong></p><h1 id="5d85" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">AUC-ROC(曲线下面积——受试者操作曲线)</h1><p id="603f" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">曲线下面积(AUC)是最广泛使用的评估指标之一。它用于二进制分类问题。分类器的AUC等于分类器将随机选择的正例排序高于随机选择的负例的概率。ROC曲线是显示分类模型在所有分类阈值下的性能的图表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/eec3897fbb633863a7ea2bd59730772a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6De4lLVpk3zN0XlV.png"/></div></div></figure><p id="21de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROC的轴是TPR(真阳性率)和FPR(假阳性率)。</p><ul class=""><li id="284a" class="kw kx hi ih b ii ij im in iq lp iu lq iy lr jc ls le lf lg bi translated"><strong class="ih hj">真阳性率TPR(灵敏度)</strong>:真阳性率定义为TP/ (FN+TP)。真阳性率对应于所有阳性数据点中被正确认为是阳性的阳性数据点的比例。</li><li id="1545" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">真阴性率TNR(特异性)</strong>:真阴性率定义为TN / (FP+TN)。假阳性率对应于所有阴性数据点中被正确认为是阴性的阴性数据点的比例。</li><li id="5ec9" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ls le lf lg bi translated"><strong class="ih hj">假阳性率FPR </strong>:假阳性率定义为FP / (FP+TN)。假阳性率对应于阴性数据点相对于所有阴性数据点被错误地认为是阳性的比例。</li></ul><p id="0401" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假阳性率和真阳性率的值都在范围[0，1]内。FPR和TPR都是在不同的阈值下计算的，例如(0.00，0.02，0.04，…)。1.00)并绘制图表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/bb88a45738037171ed3804573c872766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pSZ3YdbfpAIuHjZR.gif"/></div></div></figure><p id="425a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AUC是[0，1]中不同点的假阳性率对真阳性率的曲线下面积。显然，<strong class="ih hj"> AUC的范围是[0，1]。值越大，我们模型的性能越好。</strong>该曲线告诉我们，该模型可以很好地区分这两个类别。更好的模型可以准确区分两者。然而，一个差的模型将很难区分这两者。</p><p id="c1e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！</p><p id="b98a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">_____________________________________________________________</p><p id="f781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢你阅读❤.对于任何建议或疑问，请在下面留下您的评论，并关注更新。</p><p id="d7fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，请点击👏图标来支持它。这将有助于其他媒体用户找到它。分享一下，让别人也能看！</p><p id="79e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐学习！😊</p></div></div>    
</body>
</html>