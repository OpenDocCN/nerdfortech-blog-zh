<html>
<head>
<title>May be Puppeteer is the tool you want for Web Automation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">也许木偶师是你想要的网络自动化工具</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/may-be-puppeteer-is-the-tool-you-want-for-web-automation-1cd2a1e3fcdf?source=collection_archive---------12-----------------------#2021-06-18">https://medium.com/nerd-for-tech/may-be-puppeteer-is-the-tool-you-want-for-web-automation-1cd2a1e3fcdf?source=collection_archive---------12-----------------------#2021-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/fcd42407e6ff815296df30a72c8305b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_tmHDYCrfUDxZGHB9F_Tg.png"/></div></div></figure><div class=""/><h1 id="3be7" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="2bf0" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hu">木偶师</strong>是由<strong class="jq hu"> Chrome </strong>开发团队创建的一个节点库，它提供了一个高级 API 来通过<strong class="jq hu">开发工具协议</strong>控制<strong class="jq hu">无头 Chrome </strong>或<strong class="jq hu">Chrome</strong>。也可以配置使用全(非无头)<strong class="jq hu">铬</strong>或<strong class="jq hu">铬</strong>。基本上，它可以为您执行任何自动化任务。</p><h1 id="ed06" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">木偶师能做什么？</h1><p id="37ad" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">使用<strong class="jq hu">木偶师</strong>，你在浏览器中手动做的大多数事情都可以轻松高效地完成！让我们看看一些最有用和最流行的任务。</p><ol class=""><li id="f080" class="km kn ht jq b jr ko jv kp jz kq kd kr kh ks kl kt ku kv kw bi translated">爬行和抓取单页 Web 应用程序以及预呈现的 Web 应用程序。</li><li id="99aa" class="km kn ht jq b jr kx jv ky jz kz kd la kh lb kl kt ku kv kw bi translated">生成任何网站的 pdf 和图像。</li><li id="c010" class="km kn ht jq b jr kx jv ky jz kz kd la kh lb kl kt ku kv kw bi translated">自动化登录、表单提交、用户界面测试等。</li><li id="2949" class="km kn ht jq b jr kx jv ky jz kz kd la kh lb kl kt ku kv kw bi translated">您可以创建一个自动化测试环境，并直接在最新版本的<strong class="jq hu"> Chromium 中运行测试。</strong></li></ol><h1 id="51aa" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">入门指南</h1><p id="9736" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我们通过使用这个示例命令启动一个新的节点项目来开始我们的项目。</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><h1 id="f3ca" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">装置</h1><p id="b16d" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">安装<strong class="jq hu">木偶师</strong>是相当简单的任务。感谢<strong class="jq hu"> NPM </strong>和<strong class="jq hu">纱。你需要使用这个简单的命令来安装<strong class="jq hu">木偶师。</strong></strong></p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="6042" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">当我们安装<strong class="jq hu">木偶师</strong>时，它下载了一个最新版本的<strong class="jq hu"> Chrome 浏览器</strong>或<strong class="jq hu"> Chromium </strong>(约 170 MB MacOS，~280MB Windows)。你可以通过安装<strong class="jq hu">木偶核心</strong>而不是<strong class="jq hu">木偶来跳过下载。它没有集成的浏览器。它将使用现有的浏览器，而不是安装一个新的。</strong></p><h1 id="abc4" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">让我们创造一些令人敬畏的东西</h1><p id="e449" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">熟悉其他测试框架的人会很容易理解。我们将创建一个<strong class="jq hu">浏览器</strong>实例，打开网页并用<strong class="jq hu">木偶师的 API 操纵它们。</strong></p><ol class=""><li id="2813" class="km kn ht jq b jr ko jv kp jz kq kd kr kh ks kl kt ku kv kw bi translated"><strong class="jq hu">创建一个应用程序来从网页上截取屏幕截图</strong></li></ol><p id="ad71" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">让我们创建一个名为 screenshot.js 的文件，并使用 require 函数导入木偶师模块。然后我们将编写一个<strong class="jq hu">匿名异步</strong>函数来初始化一个<strong class="jq hu">浏览器</strong>实例，并打开一个<strong class="jq hu"> URL </strong>来捕获一个截图。代码将如下所示:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="bad9" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">我们简单地启动了一个浏览器，然后去<a class="ae ll" href="https://www.youtube.com" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com</a>拍了一张截图。默认的视窗尺寸是<strong class="jq hu"> 800 × 600 像素</strong>，有点小。这就是为什么我们通过<strong class="jq hu"> setViewport() </strong>函数定义了一个自定义视口。现在在你的终端中运行<strong class="jq hu"> <em class="lm">节点截图. js </em> </strong>。</p><p id="641e" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">它将生成一个 PNG 文件。就我而言，程序的输出相当令人满意。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ln"><img src="../Images/e415c8ab96ac753279d10848eba4c906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0XE3qEadrrh6vKwcLlOnw.png"/></div></div></figure><p id="a97f" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">让我们探索更多。</p><p id="124d" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">2.<strong class="jq hu">创建一个应用程序将网页转换成 PDF 格式</strong></p><p id="d31e" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">将<strong class="jq hu">文章页面</strong>转换成可读的 pdf 可能是非常有用的实时应用程序。因此，让我们开始创建一个新文件，并将其命名为<strong class="jq hu"> createpdf.js. </strong>一切都将保持不变，我们将只更改一个函数。我们将使用 use <strong class="jq hu"> page.pdf() </strong>函数，而不是<strong class="jq hu"> page.screenshot() </strong>。代码将如下所示:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="adba" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">使用命令<strong class="jq hu"> <em class="lm">节点 createpdf.js </em> </strong>通过终端运行这个脚本。对我来说，输出是令人满意的。</p><p id="319a" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">我们看到了两个最基本的应用<strong class="jq hu">木偶师</strong>。现在，让我们来谈谈木偶师更高级的用法。要创建任何动态的应用程序，我们需要数据。比如，你想开发一个新闻应用。在这种情况下，你需要新闻数据。有很多<strong class="jq hu"> API </strong>会为你的项目提供<strong class="jq hu"> JSON </strong>数据，但是如果你不想使用外部 API 呢？答案是<strong class="jq hu">网页抓取。Web 抓取</strong>是从 web 上收集信息的过程。废掉一个网站主要有两个步骤。</p><ol class=""><li id="08fb" class="km kn ht jq b jr ko jv kp jz kq kd kr kh ks kl kt ku kv kw bi translated"><strong class="jq hu">报废一个网站的全部源代码。</strong></li><li id="5b11" class="km kn ht jq b jr kx jv ky jz kz kd la kh lb kl kt ku kv kw bi translated"><strong class="jq hu">从完整源代码中抓取所需数据。</strong></li></ol><p id="822d" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">我们将使用<strong class="jq hu">木偶师</strong>删除源代码，使用<strong class="jq hu"> Cheerio </strong>过滤数据。<strong class="jq hu"> Cheerio </strong>是使用<strong class="jq hu"> jQuery </strong> like 语法过滤数据的高效库。</p><p id="5f4f" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">我们将废弃谷歌新闻来获取新闻数据…</p><p id="31af" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">首先，创建一个新文件，命名为<strong class="jq hu"> newapi.js. </strong>，然后通过终端安装<strong class="jq hu"> cheerio </strong>。</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="b204" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">它将在您的项目目录中安装 cheerio。假设我们想从<strong class="jq hu">谷歌新闻中收集标题和图片。</strong>现在转到谷歌新闻页面，通过点击 ctrl+shift+i 打开<strong class="jq hu"> DevTool </strong>，现在选择新闻栏的<strong class="jq hu">标题</strong>文本，右击它，然后点击 inspect。可以看看源代码。记下课程。在我的例子中，我找到了<strong class="jq hu">“JheGif ndgy 9d”</strong>作为这个元素的类名。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ln"><img src="../Images/550bb956ff381e9bb6f80796471f1125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4T6x9Ek6cCOoTJC6tgOVQ.png"/></div></div></figure><p id="2131" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">现在，对图像做同样的操作。我没有找到图像的类名。因此，我记下了它的父 div 元素的类，即<strong class="jq hu">“KNcnob”。</strong>最后，我们准备废除<strong class="jq hu">谷歌新闻。</strong></p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="b1b3" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">在这段代码中，我们引入了两个模块，<strong class="jq hu">木偶师</strong>和<strong class="jq hu"> Cheerio。</strong>为<strong class="jq hu">谷歌新闻</strong>标签定义默认 URL。在匿名函数中，我们启动一个浏览器，然后通过<strong class="jq hu"> page.goto() </strong>函数转到<strong class="jq hu"> URL </strong>。<strong class="jq hu"> page.content() </strong>函数帮助我们获得源代码。现在，用<strong class="jq hu"> <em class="lm">节点 newsapi.js </em> </strong>命令运行这个程序。结果会是这样:</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ln"><img src="../Images/4dd47db04249bfa064ab360a5ffe2735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1go7AOD4uYQvbu1iJo84A.png"/></div></div></figure><p id="fc4f" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">但这种无组织和肮脏的，对不对？来了，再见。我们将用它来过滤我们需要的数据。</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="5acf" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated">在 14 号线之前，一切都是一样的。我们加载了<strong class="jq hu">谷歌新闻</strong>页面的源代码来过滤数据。定义一个空数组对于收集筛选的数据很重要。我们记下了<strong class="jq hu">标题</strong>和<strong class="jq hu">图片的类别。</strong>所以，我们遍历这个类的每个外观，通过<strong class="jq hu"> cheerio text() </strong>函数提取它的内部文本，通过<strong class="jq hu"> attr() </strong>函数提取图像源。并且将值添加到<strong class="jq hu">结果</strong>数组。最后通过 console.log()函数打印<strong class="jq hu">结果</strong>。再次运行这个脚本！！！你得到了这样一个结构良好的 JSON 数据:</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lo"><img src="../Images/a6b7c5dd32653ddff1be9b514879a002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p26igbbl8bxWt5bry_W_PQ.png"/></div></div></figure></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h1 id="412c" class="iq ir ht bd is it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm jn bi translated">结论</h1><p id="1b0f" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在这篇文章中，我试图解释<strong class="jq hu">木偶师</strong>最基本的应用以及它最高级的应用。网络抓取是每一个数据传输网站使用的秘密技术，从互联网上收集数据并传递给用户。现在，你可以编写你自己的<strong class="jq hu">网页抓取器</strong>来从互联网上收集数据并用于你自己的应用程序。</p><p id="e65c" class="pw-post-body-paragraph jo jp ht jq b jr ko jt ju jv kp jx jy jz li kb kc kd lj kf kg kh lk kj kk kl hb bi translated"><strong class="jq hu">快乐编码！！！</strong></p></div></div>    
</body>
</html>