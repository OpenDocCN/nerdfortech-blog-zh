<html>
<head>
<title>Xamarin.Forms Country Picker with Rg.Plugins.Popup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Xamarin。用 Rg 形成国家/地区选取器。插件.弹出式菜单</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/xamarin-forms-country-picker-with-rg-plugins-popup-fec1a045f7c?source=collection_archive---------0-----------------------#2021-04-04">https://medium.com/nerd-for-tech/xamarin-forms-country-picker-with-rg-plugins-popup-fec1a045f7c?source=collection_archive---------0-----------------------#2021-04-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/90036c7d613d986858fc83eab5c3b011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMk28FPNDEKs18hX3OK5Tw.png"/></div></div></figure><div class=""/><div class=""><h2 id="aa9d" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">美丽的国家采摘任何 Xamarin。使用 Rg 的表单应用程序。插件。弹出 NuGet 和在线 SVG 标志</h2></div><p id="d8fe" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">嗨，伙计们😛。今天，我想与大家分享一个美丽的国家选择器实现，您可以将其集成到任何 Xamarin 中。表单应用程序。你所需要的就是从 GitHub repo 中复制几个文件夹，然后根据你的项目需求来享受或者定制。</p><div class="hh hi ez fb hj ke"><a href="https://github.com/bbenetskyy/XamarinCountryPicker" rel="noopener  ugc nofollow" target="_blank"><div class="kf ab dw"><div class="kg ab kh cl cj ki"><h2 class="bd hu fi z dy kj ea eb kk ed ef hs bi translated">bbenetskyy/xamarinrcountrypicker</h2><div class="kl l"><h3 class="bd b fi z dy kj ea eb kk ed ef dx translated">所有可用的国家。不是硬编码的——都是通用的。每个国家的 SVG 来自…</h3></div><div class="km l"><p class="bd b fp z dy kj ea eb kk ed ef dx translated">github.com</p></div></div><div class="kn l"><div class="ko l kp kq kr kn ks hp ke"/></div></div></a></div><p id="a33a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> F </span>有时我们需要为用户提供选择国家的可能性，但不经常我们也需要指定国家代码。那么，为什么没有一个漂亮的弹出窗口，让我们有可能搜索一个国家并立即看到国家代码呢？</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="8336" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated">弹出要求</h1><ul class=""><li id="9cbf" class="mh mi ht jk b jl mj jo mk jr ml jv mm jz mn kd mo mp mq mr bi translated">弹出窗口应该在两个平台上完全相同——Android 和 iOS。</li><li id="2920" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">弹出窗口应该有打开和关闭动画。</li><li id="35f8" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">弹出窗口应该包含尽可能多的国家，而不需要任何硬编码。</li><li id="9507" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">弹出窗口应该包含每个国家的标志，而不是作为嵌入资源添加每个标志。</li><li id="2fb1" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">弹出窗口应该包含没有任何硬编码键值对的国家代码。</li><li id="7369" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">弹出应该有可能通过国家名称搜索。</li><li id="7802" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">弹出应该有可能取消选择，并回到最初的国家。</li></ul><p id="ea16" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我想这就是我想要实现的，它几乎接近一些真实世界的使用场景🙃。现在让我们来实现它😎</p></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="9800" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated">NuGet 包</h1><p id="07c8" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr mx jt ju jv my jx jy jz mz kb kc kd hb bi translated">这里是用于弹出窗口的 NuGet 包的最小集合。我将提供每个 NuGet 使用的简短描述，也许不是你的应用程序中需要的所有功能，然后你可以省略一些包:</p><ul class=""><li id="7efc" class="mh mi ht jk b jl jm jo jp jr na jv nb jz nc kd mo mp mq mr bi translated"><strong class="jk hu"> Rg。Plugins.Popup </strong>用于显示弹出窗口</li><li id="96f7" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated"><strong class="jk hu"> Xamarin。PancakeView </strong>用于圆角</li><li id="7c8d" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated"><strong class="jk hu"> libphonenumber-csharp </strong>用于获取国家代码编号</li><li id="b98d" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated"><strong class="jk hu"> Xamarin。FFImageLoading.Svg.Forms </strong>用于显示来自互联网的 Svg 图像</li></ul></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="edef" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated">项目结构</h1><p id="4d2e" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr mx jt ju jv my jx jy jz mz kb kc kd hb bi translated">示例应用程序<a class="ae nd" href="https://github.com/bbenetskyy/XamarinCountryPicker" rel="noopener ugc nofollow" target="_blank">https://github.com/bbenetskyy/XamarinCountryPicker</a>在默认 Xamarin 上创建。表单外壳模板，因此我们不会停留在它上面，而只是将我们的注意力转移到下一个文件夹:</p><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es ne"><img src="../Images/25f04392e8ee7fe48d2777df8fc66c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*0_W5wuSYSvHkLDC2.png"/></div></figure><p id="a331" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">所有的文件夹和文件只需要复制到你的应用程序中，除了<code class="du nf ng nh ni b">namespaces</code>什么都不需要改变。此外，我们在 Android 和 iOS 项目中有两个<code class="du nf ng nh ni b">Custom Renderers</code>也需要复制:</p><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es nj"><img src="../Images/f60a789a3691f0c06bc99bc96e0d43e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/0*4A_0voVS2MwQCCHE.png"/></div></figure></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="a0e0" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated"><strong class="ak">型号</strong></h1><p id="af37" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr mx jt ju jv my jx jy jz mz kb kc kd hb bi translated">我们只有一个模型<code class="du nf ng nh ni b">CountryModel</code>，它实现了<code class="du nf ng nh ni b">INotifyPropertyChanged</code>接口，有三个字段:</p><ul class=""><li id="4138" class="mh mi ht jk b jl jm jo jp jr na jv nb jz nc kd mo mp mq mr bi translated">flag Url——到 https://hatscripts.github.io/circle-flags 网站的完整 URL，该网站上有每个国家的 svg 标志。</li><li id="c7f8" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">CountryName —英文国家名称。</li><li id="c9b5" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated">国家代码—国家电话号码。</li></ul></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="45d6" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated">实用工具</h1><p id="40e0" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr mx jt ju jv my jx jy jz mz kb kc kd hb bi translated">我们有一个<code class="du nf ng nh ni b">CountryUtils</code> <code class="du nf ng nh ni b">static</code> <code class="du nf ng nh ni b">class</code>，它将根据 ISO3166 为我们获取<code class="du nf ng nh ni b">RegionInfo</code>列表，并将英国国名转换为<code class="du nf ng nh ni b">CountryModel</code>:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><p id="bea2" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这里一切都很简单，您可能感兴趣的是这个<code class="du nf ng nh ni b">PhoneNumberUtil</code>——这是来自<strong class="jk hu">libphonenumber-cs harp NuGet</strong>的实例，它在第<code class="du nf ng nh ni b">41</code>行通过两个字母的 ISO 地区名(<code class="du nf ng nh ni b">US</code>、<code class="du nf ng nh ni b">PL</code>、…)获得<code class="du nf ng nh ni b">CountryCode</code></p></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="3aa9" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated">控制</h1><p id="e312" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr mx jt ju jv my jx jy jz mz kb kc kd hb bi translated">这里我只创建一个控件来显示<code class="du nf ng nh ni b">Flag</code>以及<code class="du nf ng nh ni b">Country Name</code>和<code class="du nf ng nh ni b">Code</code>，因为你的应用程序中完整控件的最终用户界面可以是任何东西，但是你可以看看<code class="du nf ng nh ni b">AboutPage.xaml</code></p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es nl"><img src="../Images/6aa4ff98b3faf84c4a90dba08724adfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*jI37TqhZAKFDDtnPfLYNKw.png"/></div></figure><p id="c487" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">如果您想要类似的东西—根据您的需要用类似的代码和所需的可绑定属性创建控件。</p><p id="6620" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">好了，现在我们来看看<code class="du nf ng nh ni b">CountryControl</code>是在<code class="du nf ng nh ni b">ChooseCountryPopup</code>里面用来显示<code class="du nf ng nh ni b">Country Model</code>的:</p><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es nm"><img src="../Images/543186b775565cdd3486ad8105deb7d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*r-ul96wkdjn-ZMgmEH-HHg.png"/></div></figure><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><p id="130b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">并用一个类型为<code class="du nf ng nh ni b">CountryModel</code>的可绑定属性<code class="du nf ng nh ni b">Country</code>进行代码隐藏:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><p id="f0fd" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">仍然一切都很简单😋，让我们来看看这个博客的明星——选择国家弹出式菜单。</p></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="41b3" class="lp lq ht bd lr ls lt lu lv lw lx ly lz iz ma ja mb jc mc jd md jf me jg mf mg bi translated">弹出窗口</h1><p id="9096" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr mx jt ju jv my jx jy jz mz kb kc kd hb bi translated">让我展示一下 XAML 的 Popup 代码，然后我们在几个要点上停下来:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><p id="057a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">您可能还记得，要求之一是打开和关闭动画。由于内置在 Rg 中，这很容易实现。插件弹出窗口<code class="du nf ng nh ni b">PopupPage.Animation</code>:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><p id="2502" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这将从底部显示，并在短时间内隐藏。根据我自己的测试，最好的是 400 毫秒到 in 和 300 毫秒到 out，但是花一点时间来玩这个值，也许你会找到更好的选择😉</p><p id="e053" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">接下来要讨论的重要事情是<code class="du nf ng nh ni b">ListView</code>与所有国家的集合:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><blockquote class="nn no np"><p id="d5fb" class="ji jj nq jk b jl jm iu jn jo jp ix jq nr js jt ju ns jw jx jy nt ka kb kc kd hb bi translated">🛑 ⛔️ 📛如果你在 iOS 上选择了除<code class="du nf ng nh ni b">RetainElement</code>之外的任何其他<code class="du nf ng nh ni b">CachingStrategy</code>，弹出窗口将不会出现！！！！在 Android 上一切都很好，但在 iOS 上你需要有<code class="du nf ng nh ni b">RetainElement</code>才能看到这个弹出窗口！！！🛑 ⛔️ 📛</p></blockquote><p id="5f5e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">同样，正如我之前提到的——我们有两个自定义渲染器，它们用于为<code class="du nf ng nh ni b">SearchBar</code>和<code class="du nf ng nh ni b">ListView</code>内部的<code class="du nf ng nh ni b">ViewCell</code>设置<code class="du nf ng nh ni b">transparent</code>或<code class="du nf ng nh ni b">white</code>背景。把它们的代码都放在这里只会浪费你的时间去跳过那些代码，所以如果你真的对它们是怎么做的感兴趣，我会留下一个 GitHub 的链接。</p><p id="9e48" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">iOS 渲染器:</p><ul class=""><li id="87e9" class="mh mi ht jk b jl jm jo jp jr na jv nb jz nc kd mo mp mq mr bi translated"><a class="ae nd" href="https://github.com/bbenetskyy/XamarinCountryPicker/blob/master/XamarinCountryPicker.iOS/Renderers/CustomSearchBarRenderer.cs" rel="noopener ugc nofollow" target="_blank">https://github . com/bbenetskyy/xamarincontric picker/blob/master/xamarincontric picker . IOs/Renderers/customsearchbarender . cs</a></li><li id="ba50" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated"><a class="ae nd" href="https://github.com/bbenetskyy/XamarinCountryPicker/blob/master/XamarinCountryPicker.iOS/Renderers/CustomSearchBarRenderer.cs" rel="noopener ugc nofollow" target="_blank">https://github . com/bbenetskyy/xamarincontric picker/blob/master/xamarincontric picker . IOs/Renderers/customsearchbarender . cs</a></li></ul><p id="081b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">Android 渲染器:</p><ul class=""><li id="f7f3" class="mh mi ht jk b jl jm jo jp jr na jv nb jz nc kd mo mp mq mr bi translated"><a class="ae nd" href="https://github.com/bbenetskyy/XamarinCountryPicker/blob/master/XamarinCountryPicker.Android/Renderers/CustomSearchBarRenderer.cs" rel="noopener ugc nofollow" target="_blank">https://github . com/bbenetskyy/xamarinrcountrypicker/blob/master/xamarinrcountrypicker。Android/Renderers/customsearchbarender . cs</a></li><li id="41f4" class="mh mi ht jk b jl ms jo mt jr mu jv mv jz mw kd mo mp mq mr bi translated"><a class="ae nd" href="https://github.com/bbenetskyy/XamarinCountryPicker/blob/master/XamarinCountryPicker.Android/Renderers/CustomViewCellRenderer.cs" rel="noopener ugc nofollow" target="_blank">https://github . com/bbenetskyy/xamarinrcountrypicker/blob/master/xamarinrcountrypicker。Android/Renderers/customviewcellrenderer . cs</a></li></ul><p id="795d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">好了，<code class="du nf ng nh ni b">ChooseCountryPopup</code>后面的代码到了，没有什么特别的，只是一些加载完整的国家列表和搜索的逻辑，所以我就把它留在这里，没有任何额外的描述:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="nk lh l"/></div></figure><p id="6267" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我想这是所有人🤪现在，我只留下了几个链接到我的个人资料和一个来自 Android 的带有国家弹出窗口的短视频🙂</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="lg lh l"/></div></figure><div class="hh hi ez fb hj ke"><a href="https://twitter.com/bbenetskyy" rel="noopener  ugc nofollow" target="_blank"><div class="kf ab dw"><div class="kg ab kh cl cj ki"><h2 class="bd hu fi z dy kj ea eb kk ed ef hs bi translated">JavaScript 不可用。</h2><div class="kl l"><h3 class="bd b fi z dy kj ea eb kk ed ef dx translated">编辑描述</h3></div><div class="km l"><p class="bd b fp z dy kj ea eb kk ed ef dx translated">twitter.com</p></div></div><div class="kn l"><div class="nu l kp kq kr kn ks hp ke"/></div></div></a></div><div class="hh hi ez fb hj ke"><a href="https://www.buymeacoffee.com/bbenetskyy" rel="noopener  ugc nofollow" target="_blank"><div class="kf ab dw"><div class="kg ab kh cl cj ki"><h2 class="bd hu fi z dy kj ea eb kk ed ef hs bi translated">Bohdan Benetskyi 正在为 Xamarin 创建高级 CSS 渐变，在会议上发言</h2><div class="kl l"><h3 class="bd b fi z dy kj ea eb kk ed ef dx translated">Bohdan 是 Rzeszow 的 Xamarin 软件开发人员，是 Rzeszow &amp; Cracow 的 Xamarin 本地活动的共同组织者，本地 CSS…</h3></div><div class="km l"><p class="bd b fp z dy kj ea eb kk ed ef dx translated">www.buymeacoffee.com</p></div></div><div class="kn l"><div class="nv l kp kq kr kn ks hp ke"/></div></div></a></div></div></div>    
</body>
</html>