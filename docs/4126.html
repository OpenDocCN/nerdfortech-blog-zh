<html>
<head>
<title>SQL Simplified — 10 advanced practice problems and solutions covering most SQL concepts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL简化版—涵盖大多数SQL概念的10个高级实践问题和解决方案</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/sql-simplified-10-advanced-practice-problems-and-solutions-covering-most-sql-concepts-61fb96e7ec5a?source=collection_archive---------1-----------------------#2021-07-08">https://medium.com/nerd-for-tech/sql-simplified-10-advanced-practice-problems-and-solutions-covering-most-sql-concepts-61fb96e7ec5a?source=collection_archive---------1-----------------------#2021-07-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="1869" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有效地使用SQL是任何数据科学家的关键技能，也是面试中最受考验的技能之一。在我们自己提高这一技能的尝试中，我们发现了Mrinal Gupta <strong class="io hj"> ( </strong> <a class="ae jk" href="https://towardsdatascience.com/10-problems-to-practice-almost-all-sql-concepts-37545e7c5219" rel="noopener" target="_blank"> <strong class="io hj">原文链接于此</strong> </a> <strong class="io hj"> ) </strong>的一篇非常有用的文章，这篇文章涵盖了10个高质量的问题，涉及了面试中测试的大多数SQL概念。在这篇文章之后，无论我们尝试了多难的练习题，与那10道题相比都相形见绌，令人惊讶的是我们的能力突然提高了！为了从上述文章中获得最大收益，我们必须做3个准备步骤:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/726a78bdfe345a5b91a2c8f562fe3b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WvKKTfHj6SRcPrIXKypdBg.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">来自<a class="ae jk" href="https://www.pexels.com/photo/person-in-blue-denim-jeans-using-macbook-3987114/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae jk" href="https://www.pexels.com/@shvetsa?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Anna Shvets </a>的照片</figcaption></figure><ol class=""><li id="3935" class="kb kc hi io b ip iq it iu ix kd jb ke jf kf jj kg kh ki kj bi translated">准备实践数据(在最初的文章中，训练数据并不容易获得。我们不得不手工制作SQL表并输入数据来尝试我们的测试查询)。</li><li id="98c4" class="kb kc hi io b ip kk it kl ix km jb kn jf ko jj kg kh ki kj bi translated">写下我们一步一步的思考过程(有些回答问题乍一看很吓人。花了很长时间才搞清楚他们背后的一步一步的思维过程)。</li><li id="fdfc" class="kb kc hi io b ip kk it kl ix km jb kn jf ko jj kg kh ki kj bi translated">过时的关键字替换(原始文章中使用的一些SQL关键字可能由于版本变化而过时。我们必须找到当前版本的替代品)。</li></ol><p id="22d6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇文章中，我们分享了我们的准备步骤(10个关键问题),以获得更顺利的学习体验。我们希望您能像我们一样从中受益！</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="08c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q1。给定下面两个表，写一个查询，显示某部门员工平均工资与公司平均工资的比较结果(高/低/相同)。</em>T15】</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="7486" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，让我们创建必要的表。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="aa88" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们已经设置好了表，让我们进行初始连接。</p><p id="8430" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。</strong>加入</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="b3f5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，这两个表使用共享的“employee_id”列连接在一起:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="a600" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。</strong>现在我们已经连接了两个表，考虑最终表所需的中间列。选择和设计这些。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="4ce2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过这一步，我们实现了一些目标。通过使用DATE_FORMAT关键字，我们允许窗口函数按月进行平均。为了清楚起见，我们给这些陈述起了别名。下面是上述语句的输出。如果这看起来有点不清楚，我们建议快速谷歌一下什么是窗口函数，因为它们会在接下来的问题中大量出现。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="035a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第三步。让我们将现有代码转换为子查询&amp;管道，再转换为空白的最终查询。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="496e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们使用WITH关键字创建临时表，因为这允许我们查询别名。下面是上面代码的输出:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="67cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第四步。</strong>这样，剩下的就是为我们的最终展示做相关的选择&amp;特征工程。我们将使用DISTINCT关键字从结果集中删除重复的列，并使用CASE WHEN子句设置我们的条件。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="d980" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们可以显示某部门员工平均工资与公司平均工资的对比结果(较高/较低/相同)。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="0967" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q2。</em> </strong> <strong class="io hj"> <em class="kp">编写一个SQL查询，报告学生(student_id，student_name)在所有考试中“安静”的情况。“安静”的学生是指至少参加了一次考试，既没有高分也没有低分的学生。</em>T11】</strong></p><p id="d008" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp">方案二:</em> </strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="c4d5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，让我们创建必要的表。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="f8b6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。</strong>加入(我们做内部加入，因为对没有考试的孩子不感兴趣)</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="5fbd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，这些表在student_id上被连接起来。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="0e7f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。</strong>接下来，我们创建所有需要的中间列。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="6839" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第三步。将以前的查询转换为子查询，以便我们可以访问中间列。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="7590" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第四步。考虑最终输出&amp;使用相关的【选择】&amp;【过滤】产生。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="91d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q3。编写一个查询来显示连续行数超过3或<br/>且人数超过100(含)的记录。</em> </strong></p><p id="78d6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp">方案三:</em> </strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="1865" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，让我们创建必要的表。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="d5ad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。</strong>制作一个可识别100+条纹的列。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="35fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。</strong>选择其他相关的中间列&amp;组成子查询，以便我们可以访问它们。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="5043" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">步骤3。</strong>然后，我们制作一个表格，从t1开始计算每个条纹的条纹大小。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="338e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第四步。我们只过滤掉3+ streak_size的条纹。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="e0c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第5步。</strong>让我们把这个内部连接到t1，这样我们就得到入围streak_num的所有条目。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="5029" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第6步。</strong>然后根据最终输出的需要进行相关选择。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="3863" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q4。编写一个SQL查询来查找有多少用户访问了银行但没有进行任何交易，有多少用户访问了银行并进行一次交易等等。</em>T3】</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="b1a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，让我们创建必要的表。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="af25" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。</strong>让我们从按用户id查找每天的访问次数开始。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="df3a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。</strong>然后我们通过user_id计算每天的交易数量。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="dd00" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">步骤3。让我们做一个左连接，这样我们就可以保持总访问量&amp;一起争论数据。</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="c83c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第四步。</strong>我们只选择日期列，num_visits列&amp;用0替换null num_trans。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="b99d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第五步。</strong>让我们将之前的结果转换成一个子查询，然后使用另一个查询t2进行适当的分类。我们将不得不使用t2的递归子句来正确地使它起作用。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="0588" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第6步。</strong>适当加入t1 &amp; t2，就有了我们想要的输出！</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="d2af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q5。编写SQL查询，为2019年1月1日至2019年12月31日期间的每个连续天数间隔生成period_state报告。</em>T19】</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="ba49" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们从做桌子开始吧。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="4810" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一步。让我们做一个专栏，记录2019年的每一次连胜。添加状态1只是为了表示成功状态。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="de63" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第二步。让我们找到每一个连胜的开始&amp;结束日期。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="c7c0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第三步。让我们重复失败状态的过程。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="e574" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第四步。让我们使用UNION ALL &amp; order by date合并t1 &amp; t2。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="0859" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第五步。让我们用成功的&amp;失败时替换1 &amp; 0的用例，我们得到了我们想要的输出！</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="82a9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q6。编写一个SQL查询来报告一周中每天每个类别中订购了多少台。</em> </strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="8f95" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，创建模式和表:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="1fd0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。用右连接来连接表，因为每一项都没有顺序。</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="840b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您查看结果表的输入值，我们会看到“T-Shirt”没有值，但是表中的所有商品都在那里。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="5621" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第2.1步。</strong>让我们创建一个临时表，连接orders和items表中的必要列，并在一周的第一天，星期一进行测试。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="1c29" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于输出，我们应该可以看到星期一所有项目的总和。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="413d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第2.2步。太好了，现在我们知道这是可行的，让我们获取一周中的所有日子。</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="8423" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">输出:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="0e26" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第三步。</strong>以上输出有什么问题？我们不希望看到多个item_categories出现，所以让我们在item_category列上使用DISTINCT。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="d2cd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们可以看到在一周的每一天，每个类别中有多少个单位被订购。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="e736" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q7。编写一个SQL查询来查找每个部门中工资最高的三名员工。对于上面的表，您的SQL查询应该返回下面的行(行的顺序无关紧要)。</em>T3】</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="f8a1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先让我们创建模式和表:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="4ed6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。我们需要将两个表连接到各自的id上。</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="324a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们有以下结果要处理。我们关心连接表中的哪些数据？</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="8bd6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。嗯，我们需要员工姓名、部门名称和薪水</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="9a98" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">步骤3。太好了，这样我们就有了最终需要的信息。让我们将现有代码转换成一个子查询，并设置一个只返回前3个值的条件。</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="e015" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在IT部门，马克斯的工资最高，兰迪和乔并列第二，威尔的工资第三高。销售部只有两个员工，亨利的工资最高，而萨姆的工资第二高。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="c7e5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q8。编写一个SQL查询来计算7天内(当天+ 6天前)客户支付金额的移动平均值。</em>T13】</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="e5d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先让我们创建我们需要的模式和“客户”表。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="0a72" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步。</strong>让我们首先用SUM合计金额，并按visited_on分组，以便查看时间窗口</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="3efb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以现在我们可以看到每天访问的客户数量。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="ec5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。我们需要找到滚动平均值。我们想知道这段时间的总量，以及平均量。10天中的每7天相当于每天4种可能性。</strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="a47d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第三步。</strong>为了在这个语句中选择visited_on，我们需要使我们的第一个查询成为一个临时表，就像这个一样。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="a95a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们可以看到客户在7天内(当天+ 6天前)支付的移动平均值和总金额。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="a85e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q9。编写一个查询，找出这些点之间的最短距离，四舍五入到2位小数。</em> </strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="aabb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先让我们创建表格:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="ff31" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一步。首先让我们使用一个交叉连接，这是一种生成第一个表的每一行与第二个表的每一行的配对组合的连接。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="1b88" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第二步。既然我们已经处理好了交叉连接，让我们找出每个坐标之间的最短距离。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="785c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第三步。从输出中我们可以清楚地看到最短距离是1，但是为了保持简洁，我们将通过按ASC排序并限制1来完成这个问题，因此只显示最短距离。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="b907" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的查询将输出1，这是我们所期望的。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="a7f6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="kp"> Q10。编写一个SQL查询来查找至少连续出现三次的所有数字。</em> </strong></p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="4edf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一步。由于我们对获取连续的数字感兴趣，以查看哪些数字在一行中出现了3次，我们将使用LAG函数从前一行获取数据，并引导下一行。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="19f3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请注意，prev的第一行为null，因为应该从中获取值(num)的行并不存在。“下一个”的情况正好相反。</p><p id="14ea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步。</strong>让我们将SELECT语句变成子查询，以启用窗口函数条件。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="adfc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第三步。</strong>让我们使用DISTINCT返回满足我们条件的数字(正如我们看到的，它只是上一个查询中的1)来完成这个任务。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kq kr l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="138f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们希望您喜欢我们的文章，并对SQL更有信心。对于接下来的步骤，我们建议自由设计一些中高难度的数据科学SQL面试问题。Stratascratch 在他们的免费专栏中有几个这样的问题(至少在撰写本文的时候)。然后在那之后，考虑你可以应用你新发现的SQL技能的项目。再次感谢您参与我们的工作。我们很高兴知道它帮助了别人，比如我们过去的自己！</p><p id="23c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">真诚的，邓肯·安德森。<br/>阿马尔的<a class="ae jk" href="https://www.linkedin.com/in/ammar-masood-khan/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>T12】邓肯的<a class="ae jk" href="https://www.linkedin.com/in/duncan-kg-anderson/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p></div></div>    
</body>
</html>