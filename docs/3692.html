<html>
<head>
<title>Introducing Odom: Creating a Reactive Signup Page</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍 Odom:创建一个反应式注册页面</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/introducing-odom-creating-a-reactive-signup-page-6dc95c81224?source=collection_archive---------17-----------------------#2021-06-19">https://medium.com/nerd-for-tech/introducing-odom-creating-a-reactive-signup-page-6dc95c81224?source=collection_archive---------17-----------------------#2021-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4ecbf3a9609d52c4a08efabce79f41ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f84jpkpASYVAC8AjXdgZsg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://mishieckmwale.medium.com/" rel="noopener">米谢克·姆瓦尔</a>设计。</figcaption></figure><h1 id="3396" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">介绍</h1><p id="87c7" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在开发注册页面时，有几件事情需要考虑。在设计符号方面，用户必须容易地弄清楚在每个字段中输入什么信息。如果信息必须采用特定的格式，最好给用户一个提示，告诉他们应该怎么做。在表单处理方面，验证确保表单不会被发送到服务器，其中包含无效信息。在输入或提交时，可以通知用户信息的有效性。当报告错误时，错误越具体，用户就能越早发现问题所在。</p><p id="969f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">实现这一切需要做大量的工作。我们可以通过使用<a class="ae iu" href="https://github.com/riu-web/odom" rel="noopener ugc nofollow" target="_blank">奥多姆</a>让实施过程变得更容易。Odom 是一个用于构建用户界面的 JavaScript 框架。这是系列<a class="ae iu" rel="noopener" href="/nerd-for-tech/introducing-odom-the-open-ui-framework-ed29572a46bb">介绍奥多姆</a>的第二部分。在第一集中，<a class="ae iu" rel="noopener" href="/nerd-for-tech/introducing-odom-the-open-ui-framework-ed29572a46bb">开放的 UI 框架</a>，看了一下奥多姆的基本特性。在这一集里，我们将通过创建一个单页应用程序(SPA)来看看奥多姆是如何工作的。该应用程序将包含一个注册部分。注册部分将包含一个注册表单。下图显示了应用程序的快照(在宽屏上)。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/271fc7965e46de4d53f52189d3952c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*-vlNbLDQvRNj36Oqatj7jQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">应用程序的快照。被<a class="ae iu" href="https://mishieckmwale.medium.com/" rel="noopener">米谢克·姆瓦尔</a>抓获。</figcaption></figure><p id="01af" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们将关注以下主题:</p><ul class=""><li id="5e8d" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/create-component/create-component.md#markup" rel="noopener ugc nofollow" target="_blank">标记</a></li><li id="68d5" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/create-component/create-component.md#styles" rel="noopener ugc nofollow" target="_blank">款式</a></li><li id="3a33" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/create-component/create-component.md#eventlisteners" rel="noopener ugc nofollow" target="_blank">事件</a></li><li id="19cc" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/data.md#data-binding" rel="noopener ugc nofollow" target="_blank">动态数据</a></li></ul><p id="59dd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">该应用的回购发布在<a class="ae iu" href="https://github.com/Mishieck/introducing-odom/tree/creating-a-reactive-signup-page" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上。现场演示发布在<a class="ae iu" href="https://festive-tereshkova-7b87cb.netlify.app/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>上。如果你愿意，你可以克隆或下载回购。然而，在这篇文章中，我将包括所有的代码，并给出如何构建这个项目的说明。</p><h1 id="d7d5" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">文件结构</h1><p id="3b22" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们将为应用程序使用以下文件结构:</p><pre class="kx ky kz la fd lp lq lr ls aw lt bi"><span id="fe0e" class="lu iw hi lq b fi lv lw l lx ly">.<br/>└── odom-signup/<br/>    ├── src/<br/>    │   ├── assets/<br/>    │   │   └── index.css<br/>    │   ├── components/<br/>    │   │   ├── alert-message.js<br/>    │   │   ├── app.js<br/>    │   │   ├── confirmation-message.js<br/>    │   │   ├── form.js<br/>    │   │   ├── input-group.js<br/>    │   │   └── signup.js<br/>    │   └── index.js<br/>    └── index.html</span></pre><p id="598f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">使用空文件创建如上所示的文件系统。我们稍后将填充所有文件。</p><h1 id="c4c3" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">创建组件</h1><p id="7284" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了简单起见，我们将使用一个<a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/quick-start.md#cdn" rel="noopener ugc nofollow" target="_blank"> CDN </a>来创建应用程序。析构将用于从<code class="du lz ma mb lq b">window</code>对象<code class="du lz ma mb lq b">window.odom</code>中获取方法。如果你更愿意和像 NPM 这样的包管理人员一起工作，这将使你很容易转换项目。下面的代码演示了如何用 import 语句替换析构赋值。</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="51cb" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们将把<code class="du lz ma mb lq b">/odom-signup/src/components</code>模块中的所有导出称为组件，因为它们是自包含的实体。然而，一些模块将导出返回 DOM 节点的函数，而不是 Odom 提供的组件<a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/component/component.md" rel="noopener ugc nofollow" target="_blank">的实例。这样做的原因在第一集</a>中给出。</p><p id="67cf" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我将把一些模块分成多个代码片段，以使代码更具可读性。</p><h2 id="9377" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">应用</h2><p id="6f3d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们应用程序的根组件将是<strong class="jv hj"> App </strong>。这是我们将要呈现给 DOM 的组件。我们将在<code class="du lz ma mb lq b">/odom-signup/src/components/app.js</code>在模块中创建组件。将以下代码粘贴到文件中:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="02cd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在模块中，导入组件注册。方法<code class="du lz ma mb lq b">createComponent</code>是从<code class="du lz ma mb lq b">odom</code>中获得的。<code class="du lz ma mb lq b">markup</code>包含两个要素。根元素是一个<code class="du lz ma mb lq b">div</code>，内部元素的属性<code class="du lz ma mb lq b">odom-node</code>被设置为<code class="du lz ma mb lq b">Signup</code>，这是指我们已经导入的组件。用下面的 CSS 代码替换变量<code class="du lz ma mb lq b">styles</code>的模板文本中的注释(<code class="du lz ma mb lq b">/* styles */</code>):</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="4acf" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">选择器<code class="du lz ma mb lq b">:scope</code>选择组件的根元素。在<code class="du lz ma mb lq b">:scope</code>中，我们声明了颜色主题和间隔的 CSS 变量(用于边距、填充等等)。CSS 的其余部分设置组件的宽度、最小高度、字体系列和文本颜色。</p><p id="e812" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们看看模块中的每一个功能是做什么的。</p><ul class=""><li id="3616" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><code class="du lz ma mb lq b">App</code>:组件的<a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/assets.md#constructor" rel="noopener ugc nofollow" target="_blank">构造器</a>。在 Odom 中，构造函数是一个返回组件、dom 节点、标记或文本实例的函数。调用时，<code class="du lz ma mb lq b">App</code>会返回<code class="du lz ma mb lq b"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/component/component.md" rel="noopener ugc nofollow" target="_blank">Component</a></code>的一个实例，也是<code class="du lz ma mb lq b"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/create-component/create-component.md" rel="noopener ugc nofollow" target="_blank">createComponent</a></code>的返回值。构造函数的名字不一定要大写。我们将以此为惯例。我们还将以小写字母开始组件实例的名称。您不能像使用 JavaScript 本地构造函数那样使用<code class="du lz ma mb lq b">new</code>关键字来调用 Odom 构造函数。</li><li id="bb60" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">createComponent</code>:创建组件。参数是一个具有三个属性的对象。<code class="du lz ma mb lq b">markup</code>将用于为组件创建 DOM 元素。<code class="du lz ma mb lq b">styles</code>将被用来设计组件的样式。对象<code class="du lz ma mb lq b">utils</code>有一个属性<code class="du lz ma mb lq b">nodes</code>，用于提供节点资产。因此，标记中属性<code class="du lz ma mb lq b">odom-node</code>的值<code class="du lz ma mb lq b">Signup</code>指的是<code class="du lz ma mb lq b">utils.nodes.Signup</code>。</li></ul><h2 id="5fd0" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">注册</h2><p id="6adb" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">报名是<strong class="jv hj"> App </strong>的唯一板块。它将处理表单提交和提交失败或成功的报告。将以下代码放入模块中的<code class="du lz ma mb lq b">/odom-signup/src/components/signup.js</code>:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="aa88" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在该模块中，我们导入组件表单和确认消息。我们还从<code class="du lz ma mb lq b">odom</code>中得到方法<code class="du lz ma mb lq b">createComponent</code>和<code class="du lz ma mb lq b"><a class="ae iu" href="https://github.com/riu-web/odom/blob/master/docs/api/replace-node.md" rel="noopener ugc nofollow" target="_blank">replaceNode</a></code>。<code class="du lz ma mb lq b">markup</code>中属性<code class="du lz ma mb lq b">odom-src</code>的值<code class="du lz ma mb lq b">form</code>引用了<code class="du lz ma mb lq b">Form</code>的一个实例。值<code class="du lz ma mb lq b">form</code>没有大写，因为它引用了一个组件的实例，而不是组件本身。<code class="du lz ma mb lq b">styles</code>中的媒体查询在宽度至少为<code class="du lz ma mb lq b">576px</code>的窗口上的组件顶部设置一个填充。注意，我们使用了在<strong class="jv hj">应用</strong>中声明的变量<code class="du lz ma mb lq b">--spacer-xl</code>。Odom 中的所有组件都继承了祖先的风格。</p><p id="2987" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们看看模块中每个功能的作用:</p><ul class=""><li id="9a39" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><code class="du lz ma mb lq b">Signup</code>:节点的构造器。在函数内部，我们创建一个组件，使用它并返回一个 DOM 节点<code class="du lz ma mb lq b">signup.scope</code>。我们返回一个节点而不是一个组件，因为不再需要组件接口了。</li><li id="8cf2" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">onvalid</code>:如果所有输入都有效，则发送表单。如果表单已成功发送，它会显示一条确认消息。方法<code class="du lz ma mb lq b">replaceNode</code>用于将表单替换为<code class="du lz ma mb lq b">confirmationMessage</code>。如果表格发送失败，调用<code class="du lz ma mb lq b">form.onSignupFail</code>通知用户由于错误，他们没有注册。</li><li id="7744" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">createComponent</code>:用于创建组件。参数的属性<code class="du lz ma mb lq b">components</code>提供了标记中引用的组件资产。</li><li id="045e" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">sendForm</code>:发送表单到服务器。该函数模拟发送到服务器的过程。它会提前返回一个解析为响应对象模型的承诺。删除 return 语句会留下一些代码，您可以使用这些代码将表单发送到实际的服务器。</li></ul><p id="b233" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">注意，我们将<code class="du lz ma mb lq b">onvalid</code>作为道具传递给了<code class="du lz ma mb lq b">Form</code>。在下一节中，我们将看到<code class="du lz ma mb lq b">onvalid</code>是如何在<code class="du lz ma mb lq b">Form</code>中使用的。</p><h2 id="e904" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">形式</h2><p id="61d6" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj">表单</strong>发起表单提交。它还报告来自输入验证和表单提交的错误。将以下代码放入<code class="du lz ma mb lq b">/odom-signup/src/components/form.js</code>的模块中:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="7f96" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在该模块中，我们正在导入组件<code class="du lz ma mb lq b">AlertMessage</code>和<code class="du lz ma mb lq b">InputGroup</code>。用以下 HTML 代码替换<code class="du lz ma mb lq b">markup</code>值中的注释:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="8f83" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><code class="du lz ma mb lq b">section</code>元素中属性<code class="du lz ma mb lq b">odom-src</code>的值指的是组件的实例。</p><p id="7699" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">用以下 CSS 代码替换样式值中的注释:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="30b8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">选择器<code class="du lz ma mb lq b">&gt; *:not(footer)</code>相当于<code class="du lz ma mb lq b">:scope &gt; *:not(footer)</code>。媒体查询在至少<code class="du lz ma mb lq b">576px</code>宽的窗口上的组件上设置边框和固定宽度。</p><p id="be2e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">用以下代码替换<code class="du lz ma mb lq b">props</code>的空对象:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="4715" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">对象<code class="du lz ma mb lq b">props</code>包含所有<code class="du lz ma mb lq b">InputGroup</code>实例的道具。以下是每个实例的每个属性的用途:</p><ul class=""><li id="40c6" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><code class="du lz ma mb lq b">type</code>:输入元素的类型。</li><li id="c6d4" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">name</code>:通过属性<code class="du lz ma mb lq b">name</code>设置的输入元素的名称。</li><li id="7b5b" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">label</code>:每个输入组标签的文本内容。</li><li id="2f26" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">pattern</code>:用于验证输入值的模式。</li><li id="32a3" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">instruction</code>:用户期望信息格式的说明。</li><li id="8c43" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">errorMessage</code>:输入无效时显示的信息。</li><li id="ff63" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">successMessage</code>:输入有效时显示的信息。</li></ul><p id="7c8c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们看看模块中使用的函数的用途:</p><ul class=""><li id="ff6a" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><code class="du lz ma mb lq b">Form</code>:组件的构造器。</li><li id="99a2" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">onsubmit</code>:事件<code class="du lz ma mb lq b">submit</code>的监听器。它检查所有输入是否有效。如果输入有效，它通过调用<strong class="jv hj">注册</strong>的道具<code class="du lz ma mb lq b">onvalid</code>启动发送过程。它还禁用了 submit 按钮，这样用户就不会在发送过程中点击它。它从用于确认密码的元素中删除了属性<code class="du lz ma mb lq b">name</code>，这样元素的值就不会随表单一起发送到服务器。如果任何输入无效，它会通过调用<code class="du lz ma mb lq b">onerror</code>显示一条错误消息。</li><li id="2375" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">onerror</code>:调用<code class="du lz ma mb lq b">alertMessage.show</code>显示错误信息。</li><li id="ec3d" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">onSignupFail</code>:如果注册失败，显示错误信息。它还启用了提交按钮，使用户能够重试。</li><li id="3393" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">password.addObserver</code>:用于在<code class="du lz ma mb lq b">InputGroup</code>组件中添加一个输入值变化的观察器。由于<code class="du lz ma mb lq b">password</code>是<code class="du lz ma mb lq b">InputGroup</code>的一个实例，该方法用于观察密码的变化。注意<code class="du lz ma mb lq b">confirmPassword</code>的<code class="du lz ma mb lq b">pattern</code>(在<code class="du lz ma mb lq b">props</code>中)与<code class="du lz ma mb lq b">password</code>的相同。我们希望用户通过重新输入密码来确认他们的密码。观察器用于更新<code class="du lz ma mb lq b">confirmPassword</code>的模式，使其与密码相匹配。它还将<code class="du lz ma mb lq b">confirmPassword</code>的有效性设置为假，以防止用户在输入确认密码后编辑密码时提交无效的确认密码。</li><li id="e323" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">createComponent</code>:用于创建组件。属性<code class="du lz ma mb lq b">props</code>指定了组件的属性。以这种方式指定的属性可以在标记中引用，并最终出现在组件的接口上。在这种情况下，<strong class="jv hj">注册</strong>通过接口使用<code class="du lz ma mb lq b">onSignupFail</code>方法。参数的属性<code class="du lz ma mb lq b">eventListeners</code>将 CSS 选择器<code class="du lz ma mb lq b">:scope</code>映射到一个包含事件对象的数组。选择器用于选择我们想要应用事件侦听器的元素，在本例中是组件的根元素。该数组可以包含任意数量的事件对象。属性<code class="du lz ma mb lq b">type</code>指定了我们想要收听的事件类型。属性<code class="du lz ma mb lq b">listener</code>指定了事件的监听器。</li></ul><h2 id="c39e" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">警报消息</h2><p id="1c6a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">组件<strong class="jv hj">报警信息</strong>处理<strong class="jv hj">表格</strong>中错误信息的显示。将以下代码放入<code class="du lz ma mb lq b">/odom-signup/src/components/alert-message.js</code>处的模块:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="0484" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><code class="du lz ma mb lq b">markup</code>包含一个根元素及其唯一的子元素。默认情况下，设置类别<code class="du lz ma mb lq b">hide</code>是为了隐藏警告消息。<code class="du lz ma mb lq b">styles</code>中的选择器<code class="du lz ma mb lq b">:scope.hide</code>选择根元素，当它有类<code class="du lz ma mb lq b">hide</code>时。这些功能有以下目的:</p><ul class=""><li id="5333" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><code class="du lz ma mb lq b">AlertMessage</code>:组件的构造器。</li><li id="3229" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">show</code>:显示警告信息。</li><li id="5669" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">createComponent</code>:创建组件。参数中的属性<code class="du lz ma mb lq b">props</code>用于将<code class="du lz ma mb lq b">show</code>添加到组件接口中。</li></ul><h2 id="57bc" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">输入组</h2><p id="4a42" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">InputGroup 获取用户输入并执行验证。将以下代码放入模块中的<code class="du lz ma mb lq b">/odom-signup/src/components/input-group.js</code>:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="76dd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><code class="du lz ma mb lq b">markup</code>包含一个<code class="du lz ma mb lq b">section</code>作为根元素。<code class="du lz ma mb lq b">label</code>表示用户应该输入什么。值<code class="du lz ma mb lq b">@props.inputID</code>指的是<code class="du lz ma mb lq b">createComponent</code>参数的属性<code class="du lz ma mb lq b">props</code>中设置的值(后面会详细介绍)。<code class="du lz ma mb lq b">label</code>内<code class="du lz ma mb lq b">span</code>的属性<code class="du lz ma mb lq b">odom-text</code>表示该元素将被文本替换。注意在<code class="du lz ma mb lq b">input</code>元素上没有属性。我们稍后将设置这些属性。这是因为输入元素有几个属性，直接在<code class="du lz ma mb lq b">markup</code>中设置它们会使<code class="du lz ma mb lq b">markup</code>难以阅读。</p><p id="4d8e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">用以下 CSS 代码替换<code class="du lz ma mb lq b">styles</code>值中的注释:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="1666" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们看看模块中每个功能的作用:</p><ul class=""><li id="92e1" class="lb lc hi jv b jw kr ka ks ke ld ki le km lf kq lg lh li lj bi translated"><code class="du lz ma mb lq b">InputGroup</code>:组件的构造器。</li><li id="6cd8" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">updateValue</code>:用于更新组件中输入的值。每当用户更改输入字段中的值时，该值都会更新。</li><li id="8c50" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">updateValidity</code>:更新输入的有效性。每次用户更改输入时都会执行更新。</li><li id="d8dd" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">updateMessage</code>:更新验证信息。如果输入无效，信息将显示为绿色。否则，该消息将被染成红色。</li><li id="642e" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">hasValidValue</code>:检查输入是否有效。它还通过调用<code class="du lz ma mb lq b">updateInputBorder</code>触发边框颜色更新。</li><li id="6cbc" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">updateInputBorder</code>:更新输入字段的边框。如果输入无效，边框会变成红色。否则，它将被染成灰色，这是默认颜色。</li><li id="81b1" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">props.addObserver</code>:为输入值添加一个观察者。每次值发生变化时，都会用新值调用观察器。</li><li id="f264" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">props.setValidity</code>:设置输入值的有效性。这用在组件的接口上。</li><li id="b750" class="lb lc hi jv b jw lk ka ll ke lm ki ln km lo kq lg lh li lj bi translated"><code class="du lz ma mb lq b">createComponent</code>:创建组件。这些函数以<code class="du lz ma mb lq b">options</code>为参数。</li></ul><p id="f2c7" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">参数<code class="du lz ma mb lq b">options</code>的属性<code class="du lz ma mb lq b">props</code>用于设置界面上的属性，并提供可以在<code class="du lz ma mb lq b">markup</code>中引用的值。在标记中，值<code class="du lz ma mb lq b">@props.inputID</code>是指<code class="du lz ma mb lq b">props.inputID</code>。属性<code class="du lz ma mb lq b">attributes</code>用于设置输入元素的属性。CSS 选择器<code class="du lz ma mb lq b">input</code>选择输入字段。设置为<code class="du lz ma mb lq b">input</code>的对象包含输入元素的属性名和值的键-值对。</p><p id="a9ca" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">属性<code class="du lz ma mb lq b">utils.data</code>包含可以在标记中引用的数据。属性<code class="du lz ma mb lq b">utils.data.dynamic</code>包含在应用程序执行期间可能改变的数据。数据可以绑定到 DOM，这样对 DOM 的更改就会反映在组件数据中，反之亦然。所以，值<code class="du lz ma mb lq b">::@data.value</code>指的是<code class="du lz ma mb lq b">utils.data.dynamic.value.data</code>。两个冒号表示 DOM 更新和组件数据之间有双重绑定。数组<code class="du lz ma mb lq b">utils.data.dynamic.value.updaters</code>指定了响应更新的函数。属性<code class="du lz ma mb lq b">utils.data.dynamic.valid</code>遵循相同的模式，但是没有 DOM 绑定。</p><p id="563e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">属性<code class="du lz ma mb lq b">utils.texts</code>指定了属性<code class="du lz ma mb lq b">odom-text</code>在<code class="du lz ma mb lq b">markup</code>中引用的文本资产。</p><p id="0a4d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在<code class="du lz ma mb lq b">data</code>中指定的所有动态数据都在<code class="du lz ma mb lq b">inputGroup.dynamicData</code>中结束。要更新像<code class="du lz ma mb lq b">data.dynamic.valid.data</code>这样的值，可以直接在<code class="du lz ma mb lq b">inputGroup.dynamicData</code>上设置值。例如，<code class="du lz ma mb lq b">setValidity</code>使用指令<code class="du lz ma mb lq b">inputGroup.dynamicData.valid = valid</code>直接设置数值。这样做会调用<code class="du lz ma mb lq b">updateValidity</code>。函数<code class="du lz ma mb lq b">updateValidity</code>获取新值作为参数，并在更新消息后返回一个<code class="du lz ma mb lq b">Boolean</code>值。注意方法<code class="du lz ma mb lq b">updateValue</code>将<code class="du lz ma mb lq b">inputGroup.dynamicData.valid</code>设置为它的参数<code class="du lz ma mb lq b">value</code>，这是一个字符串。函数<code class="du lz ma mb lq b">updateValidity</code>截取该值，检查它是否有效，并返回一个布尔值。如果该值不是一个字符串，则假定它是一个<code class="du lz ma mb lq b">Boolean</code>，因此它被不加修改地返回。返回值是<code class="du lz ma mb lq b">inputGroup.dynamicData.valid</code>将被设置的值。</p><h2 id="699c" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">确认消息</h2><p id="6bdd" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">成功注册的确认将通过<strong class="jv hj">确认消息</strong>完成。将以下代码放入模块中的<code class="du lz ma mb lq b">/odom-signup/src/components/confirmation-message.js</code>:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="f9ac" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">用以下代码替换<code class="du lz ma mb lq b">styles</code>值中的注释:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="3b5f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">媒体查询在宽度至少为<code class="du lz ma mb lq b">576px</code>的窗口上设置组件边框。函数<code class="du lz ma mb lq b">ConfirmationMessage</code>是构造函数。它返回一个解析为 DOM 节点的承诺。</p><h1 id="69b1" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">翻译</h1><p id="3603" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在这一节中，我们将把组件<strong class="jv hj"> App </strong>呈现给 DOM。将以下代码放入模块中的<code class="du lz ma mb lq b">/odom-signup/src/index.js</code>。</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="592e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在该模块中，<strong class="jv hj"> App </strong>被导入。在生命周期中，组件的一个实例(<code class="du lz ma mb lq b">app</code>)被创建。方法<code class="du lz ma mb lq b">app.render</code>将组件呈现给 DOM。该方法的参数是一个元素的 CSS 选择器，该元素将被 DOM 中的<strong class="jv hj"> App </strong>替换。</p><p id="6243" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在文件<code class="du lz ma mb lq b">/odom-signup/index.html</code>中，放入以下代码:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="3ca8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><code class="du lz ma mb lq b">head</code>元素中的<code class="du lz ma mb lq b">link</code>元素为页面添加样式。在文件<code class="du lz ma mb lq b">/odom-signup/assets/index.css</code>中，放入以下 CSS 代码:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="a20f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这些样式用于重置一些默认样式。所有元件的<code class="du lz ma mb lq b">box-sizing</code>值被重置为<code class="du lz ma mb lq b">border-box</code>。<code class="du lz ma mb lq b">body</code>元件的<code class="du lz ma mb lq b">margin</code>和<code class="du lz ma mb lq b">padding</code>被重置为<code class="du lz ma mb lq b">0</code>。</p><p id="5f29" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">元素<code class="du lz ma mb lq b">div#app</code>是将要被组件 App 替换的内容。第一个<code class="du lz ma mb lq b">script</code>元素包括通过 CDN 到页面的 Odom。第二个<code class="du lz ma mb lq b">script</code>元素将我们之前创建的主 JavaScript 文件添加到页面中。</p><p id="e4c1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">保存文件。确保所有创建的文件都已保存。在浏览器中打开 HTML 文件(<code class="du lz ma mb lq b">/odom-signup/index.html</code>)。您应该能够看到带有表单的页面。如果任何事情看起来不对劲，你可以检查你是否没有正确地遵循任何步骤，或者你可以使用回购中的文件。</p><p id="bd6f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在所有字段中输入有效值，然后提交表单。您应该能够看到确认消息。刷新页面，在任何字段中输入无效值，然后提交表单。您应该能够在表单标题下方看到一条错误消息。刷新页面并提交表单，无需在任何字段中输入任何值。您应该能够看到像以前一样显示的错误消息。</p><h1 id="8b42" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">最佳化</h1><h2 id="ddee" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">风格</h2><p id="1b31" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">如果您使用浏览器中的开发工具检查页面元素，您应该在<code class="du lz ma mb lq b">head</code>元素中看到 8 个<code class="du lz ma mb lq b">style</code>元素。<code class="du lz ma mb lq b">style</code>元素用于<strong class="jv hj"> App </strong>、<strong class="jv hj">签约</strong>、<strong class="jv hj">表单</strong>、<strong class="jv hj"> Alert </strong>和<strong class="jv hj"> InputGroup </strong> (4)的组件。输入组的所有 4 个实例使用相同的样式。这使得 3 个<code class="du lz ma mb lq b">style</code>元素变得多余。我们可以通过告诉 Odom,<strong class="jv hj">input group</strong>的 4 个实例来自同一个组件来消除冗余。我们可以通过在输入组的<strong class="jv hj">上设置一个 ID 来实现。在<strong class="jv hj">输入组</strong> ( <code class="du lz ma mb lq b">/odom-signup/src/components/input-group.js</code>)的模块中，将属性<code class="du lz ma mb lq b">options.id</code>设置为<code class="du lz ma mb lq b">odom-"input-group"</code>或任何您喜欢的<code class="du lz ma mb lq b">String</code>值。下面的代码说明了如何做到这一点。</strong></p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="d78b" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">保存文件，刷新页面并再次检查元素。这次您应该只看到 5 个<code class="du lz ma mb lq b">style</code>元素。奥多姆能够通过在第一个实例之后不处理和添加样式来防止冗余。所有实例都使用相同的样式。</p><h2 id="b226" class="lu iw hi bd ix me mf mg jb mh mi mj jf ke mk ml jj ki mm mn jn km mo mp jr mq bi translated">DOM 节点嵌套</h2><p id="4a40" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在 Odom 中，尽可能避免 dom 节点的嵌套对于优化非常重要。给定组件的所有子组件都是一次生成的。这意味着构建所有子组件所花费的时间大约等于构建花费最长时间构建的组件所花费的时间。</p><p id="9d5b" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们假设构建<strong class="jv hj"> AlertMessage </strong>需要 100 毫秒，构建<strong class="jv hj"> InputGroup </strong>需要 200 毫秒。构建表单的<strong class="jv hj">的所有子组件大约需要 200 毫秒。如果我们决定将所有的<strong class="jv hj"> InputGroup </strong>元素放入一个类似于<code class="du lz ma mb lq b">section</code>元素的元素中，那么将首先构建<strong class="jv hj"> InputGroup </strong>实例。之后将构建<strong class="jv hj"> AlertMessage </strong>实例。这意味着构建所有组件所需的时间大约等于 300 毫秒(100 + 200)。我们已经通过使所有组件都是表单</strong>的根元素的直接后代来执行这种优化。</p><h1 id="11d8" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">结论</h1><p id="3aa3" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">无论是添加 OAuth、将注册过程分成多个步骤还是其他什么，我想看看你如何定制应用程序。如果你有时间，请在评论区分享你的项目和经验。感谢您的阅读。</p></div></div>    
</body>
</html>