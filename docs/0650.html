<html>
<head>
<title>Async/Await: Modern Concurrency in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">async/Await:JavaScript 中的现代并发</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/async-await-modern-concurrency-in-javascript-e8e1a2d9e861?source=collection_archive---------11-----------------------#2021-01-31">https://medium.com/nerd-for-tech/async-await-modern-concurrency-in-javascript-e8e1a2d9e861?source=collection_archive---------11-----------------------#2021-01-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="323a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">传统的 CPU 以同步顺序一个接一个地处理任务，多线程 CPU 增强了这一点，如今大多数电脑都有多个核心 CPU。量子计算是一个例外，但这不在本文的讨论范围之内，而且到目前为止还没有工作。</p><p id="c615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多线程 CPU 使 CPU 能够同时处理多个问题，从而提高电脑的性能。</p><p id="633d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这种“代码”本质上是同步的，因为它是由 CPU 运行的，所以在 JavaScript 中，你给出一个指令，该指令就进入“调用堆栈”。调用栈是等待执行的指令队列，所有的请求按照它们被调用的顺序排列。</p><p id="0b73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比如说。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c7ea" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">CODE</strong><br/>console.log("Task1");<br/>console.log("Task2");<br/>console.log("Task3");</span><span id="8d53" class="jm jn hi ji b fi js jp l jq jr"><strong class="ji hj">RESULT</strong><br/>Task1<br/>Task2<br/>Task3</span></pre><p id="2d1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意执行的顺序。</p><p id="55c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题是，如果事情需要很长时间才能完成，会发生什么？</p><p id="5226" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您正在查询一个繁忙的数据库，而响应需要一段时间才能返回？这将是一场灾难，因为它会阻塞队列，直到它完成执行。</p><p id="86b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这个问题是用异步函数解决</strong></p><p id="71cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">异步允许我们将一条指令移到一边，直到调用堆栈清空，然后将它取回并重新排队。</p><p id="6c6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">见下文</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="7875" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">CODE</strong><br/>console.log(“<strong class="ji hj">Task1</strong>”);<br/>setTimeout(function(){ console.log(“<strong class="ji hj">Task2</strong>”); }, 3000);<br/>console.log(“<strong class="ji hj">Task3</strong>”);</span><span id="d03e" class="jm jn hi ji b fi js jp l jq jr"><strong class="ji hj">RESULT</strong><br/>Task<strong class="ji hj">1</strong><br/>Task<strong class="ji hj">3</strong><br/>Task<strong class="ji hj">2</strong></span></pre><p id="9067" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，您可以在这里看到，我们运行了与前面相同的代码，只是我们给了“Task 2”一个异步函数，在本例中是“setTimeout ”,当解释器看到它时，它将它放在一边(它将它放在 Webapis 中)。然后继续执行下一条指令，并在完成其他任务后调用“任务 2”。</p><p id="2820" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它们是多种可用的异步函数，其中许多你可能已经使用过了。例如“fetch”方法。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="74ba" class="jm jn hi ji b fi jo jp l jq jr">fetch(file)<br/>.then(x =&gt; x.text())<br/>.then(y =&gt; myDisplay(y));</span></pre><p id="68e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于 Fetch 是基于 async 和 await 的，上面的例子可能更容易理解:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="4c5e" class="jm jn hi ji b fi jo jp l jq jr">async function getText(file) {<br/>  let x = await fetch(file);<br/>  let y = await x.text();<br/>  myDisplay(y);<br/>}</span></pre><h1 id="090c" class="jt jn hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">事件循环</h1><p id="98cc" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">要完全掌握 async 的威力，最好的方法是你需要很好地掌握 JavaScript 事件循环是如何工作的，这个视频对我来说非常重要，它彻底改变了我编写代码的方式。</p><figure class="jd je jf jg fd kv"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="edff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">理解异步的下一步是使用它，测试不同的东西。<a class="ae ky" href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D" rel="noopener ugc nofollow" target="_blank">这里有一个沙盒</a>可以让你这么做。尝试各种场景(在尝试查看输出时，不要忘记打开控制台。)</p><figure class="jd je jf jg fd kv er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/aaec7317adf64b6e46f9bd925de8bf6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3is2DYwu-gA40ncxMK4eSQ.jpeg"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated"><a class="ae ky" href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="e0c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源:</p><p id="7b7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ky" href="https://www.w3schools.com/js/js_api_fetch.asp" rel="noopener ugc nofollow" target="_blank"> W3School </a></p></div></div>    
</body>
</html>