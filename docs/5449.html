<html>
<head>
<title>Connect Azure Functions to Azure Cosmos DB SQL API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Azure函数连接到Azure Cosmos DB SQL API</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/connect-azure-functions-to-azure-cosmos-db-sql-api-18ce6192a807?source=collection_archive---------1-----------------------#2021-10-02">https://medium.com/nerd-for-tech/connect-azure-functions-to-azure-cosmos-db-sql-api-18ce6192a807?source=collection_archive---------1-----------------------#2021-10-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8804" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">演示如何在<a class="ae jd" href="https://azure.microsoft.com/services/cosmos-db/" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB </a>中存储数据，并将Azure函数连接到Cosmos DB以公开这些数据</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/5ab0899e67102ff8809012a5d71919ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCRM_i-gFpTcy-DzgH8JZA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">这张图片改编自文件:2021年8月15日，曼谷示威游行期间，抗议者燃放的烟花在防暴警察上方爆炸。图片来源:法新社</figcaption></figure><p id="4314" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae jd" rel="noopener" href="/nerd-for-tech/add-an-api-to-azure-static-web-apps-with-azure-functions-dbf0dd3fce0a">我之前的博客</a>中，我已经向您展示了如何从前端迁移模拟数据，以供API存储和公开。</p><p id="a64a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我正在演示如何在<a class="ae jd" href="https://azure.microsoft.com/services/cosmos-db/" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB </a>中存储数据，并将API连接到Cosmos DB以公开这些数据。</p><p id="f889" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Azure Cosmos DB 是一个完全托管的NoSQL数据库，提供多种数据库API，即Core (SQL) API、MongoDB API、Cassandra API、Gremlin API和Table API。在本教程中，我选择核心(SQL) API，因为它是Azure Cosmos DB的原生API，并声称提供了最新的特性。对于其他API，它可能适用于现有的应用程序— <em class="ju">并且您不想重写数据访问层</em> —或者您的团队已经熟悉了其中一个数据库。</p><h1 id="7132" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">概观</h1><p id="5280" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">重写后的流程将是:在API(<em class="ju">/API/activities</em>)被触发时，例如通过HTTP调用，API从Azure Cosmos DB读取数据并将数据返回。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/62fa421fcea75a78a62dde670f3f1d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_0aENyR-rqz1BYzr.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">来源:<a class="ae jd" href="https://docs.microsoft.com/en-us/azure/cosmos-db/serverless-computing-database#why-choose-azure-functions-integration-for-serverless-computing" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/cosmos-db/server less-computing-database # why-choose-azure-functions-integration-for-server less-computing</a></figcaption></figure><p id="3b27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博客分两个部分演示了如何实现上述流程:</p><ol class=""><li id="c7cd" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">创建Azure Cosmos DB帐户、数据库和容器，并添加示例数据</li><li id="babd" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">创建<strong class="ih hj">输入绑定</strong>将Azure函数绑定到Azure Cosmos DB容器，这样，当函数执行时，输入绑定将从容器中读取数据并返回给调用者</li></ol><h1 id="f843" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">创建Azure Cosmos DB帐户、数据库和容器，并添加示例数据</h1><h2 id="f10b" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">创建一个Azure Cosmos DB帐户</h2><ol class=""><li id="8dbd" class="kz la hi ih b ii kt im ku iq mb iu mc iy md jc le lf lg lh bi translated">转到<a class="ae jd" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ju">微软Azure门户</em> </a></li><li id="1b95" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">选择<em class="ju">蔚蓝宇宙数据库</em></li></ol><p id="c22b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.选择<em class="ju">创建</em></p><p id="dedf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.选择API选项[ <em class="ju">核心(SQL) </em></p><p id="cd69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.在<em class="ju">创建Azure Cosmos DB帐户</em>页面中，输入新Azure Cosmos DB帐户的基本设置。</p><ul class=""><li id="f68d" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc me lf lg lh bi translated"><em class="ju">订阅</em>:选择您的<em class="ju"> Azure订阅</em></li><li id="eb21" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">资源组</em>:选择你的资源组，如果有的话，或者选择<em class="ju">新建— </em>你可以把<em class="ju">资源组</em>当做一个文件夹来包含这个app</li><li id="2f8b" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">帐户名称</em>:输入一个唯一的名称来标识您的Azure Cosmos DB帐户。</li><li id="50ad" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">位置</em>:选择一个地理位置来托管您的Azure Cosmos DB帐户。使用离用户最近的位置，让他们能够最快地访问数据。</li><li id="ed74" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">容量模式</em>:在<a class="ae jd" href="https://docs.microsoft.com/en-us/azure/cosmos-db/set-throughput" rel="noopener ugc nofollow" target="_blank">配置吞吐量</a>模式下选择<em class="ju">配置吞吐量</em>创建账户，或者在<a class="ae jd" href="https://docs.microsoft.com/en-us/azure/cosmos-db/serverless" rel="noopener ugc nofollow" target="_blank">无服务器</a>模式下选择<em class="ju">无服务器</em>创建账户。</li><li id="8f17" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">应用自由层折扣</em>:应用<em class="ju">自由层</em>。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mf"><img src="../Images/e17bc03244cadbb25d217eed51d26720.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5EFgURvEzgdPZVv95OyevQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">输入新Azure Cosmos帐户的基本设置</figcaption></figure><p id="e1a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.选择<em class="ju">审核+创建</em>。</p><p id="52ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.查看帐户设置，然后选择<em class="ju">创建</em>。创建帐户需要几分钟时间。等待门户页面显示<em class="ju">您的部署已完成</em>。</p><p id="f8fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.选择<em class="ju">转到资源</em>转到Azure Cosmos DB帐户页面。</p><h2 id="2feb" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">创建Azure Cosmos DB数据库和容器</h2><p id="b740" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">创建帐户后，您现在可以使用<a class="ae jd" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ju"> Azure门户</em> </a> <em class="ju"> </em>中的<em class="ju">数据浏览器</em>工具来创建数据库和容器。</p><ol class=""><li id="cb08" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">选择<em class="ju">数据浏览器</em>，然后点击<em class="ju">添加容器</em></li><li id="f42e" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">在“新建容器”页面中，输入新容器的设置。</li></ol><ul class=""><li id="3e0b" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc me lf lg lh bi translated"><em class="ju">数据库ID </em>:输入<em class="ju"> Abolish112-blog </em>作为新数据库的名称。</li><li id="86b9" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">容器ID </em>:输入<em class="ju">活动分子</em>作为您收集的名称。</li><li id="7c0c" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">分区键</em>:输入<em class="ju">/昵称</em>作为分区键。</li><li id="63aa" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">数据库吞吐量:</em>您可以提供<em class="ju">自动缩放</em>或<em class="ju">手动</em>吞吐量。<em class="ju">手动</em>吞吐量允许您自己扩展RU/s，而<em class="ju">自动扩展</em>吞吐量允许系统根据使用情况扩展RU/s。本例中选择<em class="ju">手动</em>。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mg"><img src="../Images/fa84c45a6ada1a810021e71ad7ef7198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYKrK4pNoKVhr1m7IF4hNQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">输入新容器的设置</figcaption></figure><h2 id="f37d" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">添加示例数据</h2><p id="3ba7" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">现在，您可以使用数据资源管理器向新容器中添加数据。</p><ol class=""><li id="1309" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">从<em class="ju">数据浏览器</em>，展开<em class="ju">废除博客</em>数据库，展开<em class="ju">活动家</em>容器。选择<em class="ju">项目</em>，然后选择<em class="ju">新项目</em>。</li></ol><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mh"><img src="../Images/8986fa09bd6efb307f3e5d6dafc4b3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9BNy5umIK131T5A5lVI81w.png"/></div></div></figure><p id="d818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.将文档添加到容器中。</p><pre class="jf jg jh ji fd mi mj mk ml aw mm bi"><span id="f6ae" class="ln jw hi mj b fi mn mo l mp mq">{<br/>  "name": "Arnon Nampa",<br/>  "nickname": "arnon",<br/>  "detainedDuration": [<br/>    {<br/>      "detainedDate": { "year": 2021, "month": 2, "day": 9 },<br/>      "releasedDate": { "year": 2021, "month": 6, "day": 1 }<br/>    },<br/>    {<br/>      "detainedDate": { "year": 2021, "month": 8, "day": 11 }<br/>    }<br/>  ]<br/>}</span></pre><p id="b003" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.将json添加到文档选项卡后，选择<em class="ju">保存</em>。</p><p id="a3a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.如果你不提供，Azure会自动生成一些字段，包括<em class="ju"> id — </em>。</p><p id="649c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.创建并保存另一个文档。你的新文档可以有你想要的任何结构，因为Azure Cosmos DB不会对你的数据强加任何模式。</p><h1 id="eb6e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">创建<strong class="ak">输入绑定</strong>将Azure函数绑定到Azure Cosmos DB容器</h1><p id="1528" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">为了允许静态Web应用程序中的Azure函数与数据库通信，我们需要将数据库连接字符串存储在应用程序设置中。这将使部署的应用程序能够连接到Azure Cosmos DB。另一方面，我们需要创建文件<em class="ju"> local.settings.json </em>，来存储相同的连接字符串，以便让它在本地开发中工作。</p><h2 id="5c5e" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">从Azure Cosmos DB复制数据库连接字符串</h2><ol class=""><li id="8a15" class="kz la hi ih b ii kt im ku iq mb iu mc iy md jc le lf lg lh bi translated">前往<a class="ae jd" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ju">微软Azure门户</em> </a></li><li id="c653" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">选择<em class="ju"> Azure Cosmos DB账号</em> — <em class="ju">废除112 </em>。</li><li id="0231" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">在<em class="ju">设置下，</em>选择<em class="ju">键</em></li><li id="075a" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">复制<em class="ju">主连接字符串</em>下列出的连接字符串</li></ol><h2 id="a948" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">在Azure static Web Apps中创建应用程序设置以存储连接字符串</h2><ol class=""><li id="334a" class="kz la hi ih b ii kt im ku iq mb iu mc iy md jc le lf lg lh bi translated">转到<a class="ae jd" href="https://portal.azure.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ju">微软Azure门户</em> </a></li><li id="eacf" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">选择<em class="ju">静态网页应用</em> — <em class="ju">取消112-博客</em></li><li id="9cb4" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">在<em class="ju">设置</em>下点击<em class="ju">配置</em></li><li id="2b49" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">单击添加，并使用以下值创建新的应用程序设置:</li></ol><ul class=""><li id="f11d" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc me lf lg lh bi translated">名称:<em class="ju">宇宙连接字符串</em></li><li id="def7" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated">值:&lt;<em class="ju">粘贴_连接_字符串_复制_早先</em>T58】</li></ul><p id="2455" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.点击<em class="ju">确定</em></p><p id="96a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.点击<em class="ju">保存</em></p><p id="b965" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成后，您应该会看到类似下面的屏幕:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mr"><img src="../Images/25e8a9849f03db40e4f6836f9956252b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7rPaBsLmabUucRRtfwMuA.png"/></div></div></figure><h2 id="63fc" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">更新<em class="ms"> local.settings.json使其在本地开发中工作</em></h2><p id="d1d9" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">在本地开发期间，应用程序设置被添加到local.settings.json文件中的<code class="du mt mu mv mj b">Values</code>对象。这将由Azure函数在本地运行时使用。</p><p id="43db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文件:local.settings.json</p><pre class="jf jg jh ji fd mi mj mk ml aw mm bi"><span id="8dd0" class="ln jw hi mj b fi mn mo l mp mq">{<br/>  "IsEncrypted": false,<br/>  "Values": {<br/>    <strong class="mj hj">"CosmosConnectionString":<br/>"AccountEndpoint=https://abolish112.documents.azure.com:443/;AccountKey=__some_value__;"</strong><br/>  }<br/>}</span></pre><h2 id="581d" class="ln jw hi bd jx lo lp lq kb lr ls lt kf iq lu lv kj iu lw lx kn iy ly lz kr ma bi translated">为Azure函数创建Azure Cosmos DB输入绑定</h2><p id="67a5" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">Azure Cosmos DB输入绑定使用SQL API来检索由SQL查询指定的文档，并将它们传递给函数的输入参数。</p><p id="1563" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中，通过填充以下配置来创建Azure Cosmos DB输入绑定:</p><ul class=""><li id="6abf" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc me lf lg lh bi translated"><em class="ju">类型</em>:必须设置为<code class="du mt mu mv mj b">cosmosDB</code></li><li id="c981" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">方向</em>:必须设置为<code class="du mt mu mv mj b">in</code></li><li id="c0a9" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju"> name </em>:绑定参数的名称，在本例中为<code class="du mt mu mv mj b">activistsData</code>，表示函数中的文档</li><li id="0bc7" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">数据库名</em>:包含文档的数据库<code class="du mt mu mv mj b">Abolish112-blog</code></li><li id="910b" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">集合名称</em>:包含文档的集合名称<code class="du mt mu mv mj b">Activists</code></li><li id="87e6" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">connectionStringSetting</em>:包含你的Azure Cosmos DB连接字符串的应用设置名称，<code class="du mt mu mv mj b">CosmosConnectionString</code></li><li id="8f7e" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><em class="ju">SQL query</em>:Azure Cosmos DB SQL查询，用于检索多个文档。在这种情况下，<code class="du mt mu mv mj b">select * from c</code>检索整个集合</li></ul><p id="a0c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文件:function.json</p><pre class="jf jg jh ji fd mi mj mk ml aw mm bi"><span id="ad35" class="ln jw hi mj b fi mn mo l mp mq">{<br/>  "bindings": [<br/>    ...<br/>    {<br/>      "type": "cosmosDB",<br/>      "direction": "in",<br/>      "name": "activistsData",<br/>      "databaseName": "Abolish112-blog",<br/>      "collectionName": "Activists",<br/>      "connectionStringSetting": "CosmosConnectionString",<br/>      "sqlQuery": "select * from c"<br/>    }<br/>  ]<br/>}</span></pre><p id="3e0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加使用<code class="du mt mu mv mj b">activistsData</code>输入绑定对象并作为响应返回的代码。</p><p id="389d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文件:index.js</p><pre class="jf jg jh ji fd mi mj mk ml aw mm bi"><span id="b551" class="ln jw hi mj b fi mn mo l mp mq">module.exports = async function (context, req, activistsData) {<br/>  context.log('JavaScript HTTP trigger function processed a request.');<br/>  try {<br/>    context.res.status(200).json(activistsData);<br/>  } catch (error) {<br/>    context.res.status(500).json(error);<br/>}}</span></pre><h1 id="9a31" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">在本地运行该功能</h1><p id="0b95" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">运行静态Web Apps CLI，并提供包含前端应用程序和API后端的文件夹:</p><pre class="jf jg jh ji fd mi mj mk ml aw mm bi"><span id="95df" class="ln jw hi mj b fi mn mo l mp mq">swa start ./public --api api</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mw"><img src="../Images/3a531961a63783227c6605759e2b1798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X9IR5p82nXvXcq-6R7GEEA.png"/></div></div></figure><h1 id="85f0" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">重新部署并验证更新的应用程序</h1><p id="0104" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">将新代码推送到<em class="ju">主</em>(或任何指定分支)，将自动触发新部署。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mw"><img src="../Images/d5b403211be0ff238d96113cadbc7ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ELpMV7vcJ8cD3mklYZNhw.png"/></div></div></figure><h1 id="480e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">参考</h1><ul class=""><li id="4a00" class="kz la hi ih b ii kt im ku iq mb iu mc iy md jc me lf lg lh bi translated"><a class="ae jd" href="https://docs.microsoft.com/en-us/azure/cosmos-db/sql/serverless-computing-database#why-choose-azure-functions-integration-for-serverless-computing" rel="noopener ugc nofollow" target="_blank">使用Azure Cosmos DB和Azure函数的无服务器数据库计算</a></li><li id="1e95" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><a class="ae jd" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-integrate-store-unstructured-data-cosmosdb?tabs=javascript" rel="noopener ugc nofollow" target="_blank">使用Azure函数和Azure Cosmos DB存储非结构化数据</a></li><li id="2230" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><a class="ae jd" href="https://docs.microsoft.com/en-us/azure/cosmos-db/sql/create-sql-api-nodejs" rel="noopener ugc nofollow" target="_blank">快速入门:使用Node.js连接并查询Azure Cosmos DB SQL API帐户的数据</a></li><li id="bcb8" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><a class="ae jd" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-cosmosdb-v2-input?tabs=javascript" rel="noopener ugc nofollow" target="_blank">Azure Functions 2 . x及更高版本的Azure Cosmos DB输入绑定</a></li><li id="8ba3" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc me lf lg lh bi translated"><a class="ae jd" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference-node?tabs=v2" rel="noopener ugc nofollow" target="_blank"> Azure Functions JavaScript开发者指南</a></li></ul></div></div>    
</body>
</html>