<html>
<head>
<title>Kubernetes Handnotes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes手记</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/kubernetes-handnotes-4a3a437428b4?source=collection_archive---------15-----------------------#2021-03-11">https://medium.com/nerd-for-tech/kubernetes-handnotes-4a3a437428b4?source=collection_archive---------15-----------------------#2021-03-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/379071cc8f3d2f9b895136e5383311aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h6w6OcfvDiZHmaJ5ZCxpqw.png"/></div></div></figure><p id="945a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些是我在与kubernetes合作的几年中准备的一些笔记。其中许多通常不为人所知，除非一个人深入挖掘了官方的kubernetes文档。</p><p id="a318" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些没有特定的顺序，旨在作为快速和相对详细地参考kubernetes的注释。</p><p id="432b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些手记的目标读者是已经熟悉kubernetes核心概念的初学者，现在希望更深入地理解，以及希望快速和全面地参考kubernetes最重要的方面，而不是一遍又一遍地参考官方文档的专业人士。</p><p id="7661" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些绝不是kubernetes官方文件的替代品。无论如何，它们都是学习kubernetes的最佳资源。与官方的kubernetes文档相比，这些手记只是试图提供一个获得的<em class="jo">知识与花费的</em>时间的更好比率。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="0c2b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">涵盖的资源:</h2><ol class=""><li id="8951" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">分离舱</li><li id="3a22" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">复制集</li><li id="0864" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">控制器</li><li id="afbb" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">主组件</li><li id="b224" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">节点组件</li><li id="5dfe" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">目标</li><li id="ad93" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">UID的</li><li id="866a" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">名称空间</li><li id="e525" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">服务</li><li id="d57b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">标签</li><li id="0769" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">标签选择器</li><li id="44af" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">字段选择器</li><li id="9ac5" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">释文</li><li id="0a6a" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">对象管理</li><li id="edea" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">初始化容器</li><li id="1b97" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">秘密生成器</li><li id="4ce8" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">永久卷(pv)和永久卷声明(pvc)</li><li id="07bb" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">进入</li><li id="2edf" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">入口控制器</li><li id="636e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">服务发现</li><li id="5c7d" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">端点</li><li id="ad68" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Kube代理</li><li id="4e5e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Kube dns</li><li id="dc22" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Etcd</li></ol></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="8887" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">分离舱</h2><ol class=""><li id="1822" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">Kubernetes集群中的每个Pod都有一个唯一的IP地址，即使是同一节点上的Pod也是如此。</li><li id="1189" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Pod中的每个容器共享网络名称空间，包括IP地址和网络端口。</li><li id="0a5f" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">默认情况下，docker使用主机私有网络，因此容器只有在同一台机器上才能与其他容器对话。</li><li id="68da" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Pod内的容器可以使用localhost相互通信，并且集群中的所有Pod都可以在没有NAT的情况下相互查看。</li><li id="1c26" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Pod中的所有容器都可以访问共享卷，从而允许这些容器共享数据。</li><li id="4aa1" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">尽管每个Pod都有一个唯一的IP地址，但如果没有服务，这些IP不会暴露在群集之外。<em class="jo">服务允许您的应用程序接收流量</em>。</li></ol><h2 id="ba1c" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">复制集</h2><ol class=""><li id="e7a8" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">通过更改部署中副本的数量来实现扩展</li><li id="8854" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">一个<strong class="is hj">复制集</strong>可能会通过创建新的Pods来动态地驱动集群回到期望的状态，以保持应用程序的运行</li><li id="dc8f" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Kubernetes也支持pod的自动伸缩，但是这超出了本文的范围。缩放到零也是可能的，它将终止指定部署的所有pod。</li><li id="3140" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">kubernetes复制集中的状态</li></ol><ul class=""><li id="510f" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<em class="jo">期望的</em>:配置的副本数量</li><li id="4127" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<em class="jo">当前</em>:显示现在有多少副本正在运行</li><li id="a70e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<em class="jo">最新</em>:为匹配所需(已配置)状态而更新的副本数量</li><li id="3d52" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.<em class="jo">可用</em>:显示用户实际可用的副本数量</li></ul><p id="7a86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.kubernetes中的更新是有版本的，任何<em class="jo">部署更新</em>都可以恢复到以前的(稳定的)版本。</p><h2 id="670b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">控制器</h2><ol class=""><li id="98b0" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">一个<strong class="is hj">控制器</strong>处理pod管理的所有方面，包括但不限于pod的创建、调度、复制和修复。</li></ol><h2 id="f5ce" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kubernetes主组件</h2><ol class=""><li id="32e5" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated"><strong class="is hj"> kube-apiserver </strong>:公开Kubernetes API。它被设计为水平扩展</li><li id="da7d" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj"> etcd </strong>:一致且高度可用的键值存储，用作Kubernetes所有集群数据的后备存储。始终为您的Kubernetes集群的etcd数据制定一个备份计划。</li><li id="ffd4" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">kube-scheduler :根据个人和集体资源需求、硬件/软件/策略约束、相似性和反相似性规范、数据局部性、工作负载间干扰和最后期限，调度新创建的pods在节点上运行。</li><li id="fe5c" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">kube-控制器-管理器</strong>:运行控制器。每个控制器包括:</li></ol><ul class=""><li id="ee3d" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj">节点控制器</strong>:负责节点宕机时的通知和响应。</li><li id="c419" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj">复制控制器</strong>:负责维护系统中每个复制控制器对象的正确数量。</li><li id="e0ce" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<strong class="is hj">端点控制器</strong>:填充端点对象(即加入服务&amp;窗格)。</li><li id="bb99" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.<strong class="is hj">服务帐户&amp;令牌控制器</strong>:为新的名称空间创建默认帐户和API访问令牌。</li></ul><p id="794e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.<strong class="is hj">云控制器管理器</strong>:运行与底层云提供商交互的控制器。云控制器管理器二进制文件是Kubernetes版中引入的alpha特性。以下控制器具有云提供商依赖性:</p><ul class=""><li id="93c0" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj">节点控制器</strong>:用于检查云提供商，以确定某个节点在停止响应后是否已从云中删除</li><li id="931d" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj">路由控制器</strong>:用于在底层云基础设施中设置路由</li><li id="50c1" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<strong class="is hj">服务控制器</strong>:用于创建、更新和删除云提供商负载平衡器</li><li id="01d1" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.<strong class="is hj">卷控制器</strong>:用于创建、附加和安装卷，并与云提供商交互以协调卷</li></ul><h2 id="0130" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kubernetes节点组件</h2><ol class=""><li id="97c1" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">kubelet :在集群中的每个节点上运行的代理。它确保容器在pod中运行。它不管理不是由Kubernetes创建的容器。</li><li id="8e02" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">容器运行时</strong></li><li id="6d5b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">插件</strong>:提供集群功能</li><li id="7e9f" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj"> DNS </strong> : DNS服务器。为Kubernetes服务提供DNS记录。Kubernetes启动的容器会自动将该DNS服务器包含在它们的DNS搜索中。</li><li id="f970" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">网络用户界面</strong></li><li id="7901" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">集装箱资源监控</strong></li><li id="e025" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">集群级日志</strong></li></ol><h2 id="c3d4" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kubernetes对象</h2><ol class=""><li id="a58b" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">它们是库伯内特系统中的持久实体。Kubernetes使用这些实体来表示集群的状态。</li><li id="195b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">通过创建一个对象，您可以有效地告诉Kubernetes系统您希望集群的工作负载是什么样子；这是您的集群所需的状态。</li><li id="a356" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">每个Kubernetes对象都包含两个管理对象配置的嵌套对象字段:对象规范和对象状态。</li></ol><ul class=""><li id="23ce" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj"> Spec </strong>:描述你对对象的期望状态</li><li id="b544" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj">状态</strong>:描述对象的实际状态，由Kubernetes系统提供并更新。</li></ul><p id="65aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.<em class="jo">对象规格</em>文件中的必填字段:</p><ul class=""><li id="5792" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj"> apiVersion </strong></li><li id="7351" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj">种类</strong></li><li id="1c25" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<strong class="is hj">元数据</strong></li><li id="2645" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">1.<em class="jo">名称</em>:必填项</li><li id="4522" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<em class="jo"> uid </em>:强制:系统提供</li><li id="9965" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<em class="jo">名称空间</em>:可选</li><li id="8497" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.<strong class="is hj">规格</strong></li></ul><p id="ca29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.Kubernetes REST API中的所有对象都由一个<strong class="is hj">名称</strong>和一个<strong class="is hj"> UID </strong>明确标识。</p><p id="6bb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 6。Name </em>是客户端提供的字符串，引用资源URL中的对象，比如<em class="jo"> /api/v1/pods/some-name </em>。这就成了DNS_NAME？。</p><p id="f818" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.一次只能有一个给定种类的对象有给定的名称。但是，如果删除该对象，可以创建一个同名的新对象。</p><h2 id="367d" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kubernetes UID的</h2><ol class=""><li id="f939" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">它们是kubernetes <em class="jo">系统生成的唯一标识对象的字符串</em>。</li><li id="9991" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">在Kubernetes集群的整个生命周期中创建的每个对象都有一个<strong class="is hj">独特的UID </strong>。它旨在区分相似实体的历史事件。</li></ol><h2 id="5710" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">名称空间</h2><ol class=""><li id="d525" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">Kubernetes支持由同一个物理集群支持的多个虚拟集群。这些虚拟集群被称为<strong class="is hj">名称空间</strong>。</li><li id="26aa" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">名称空间适用于许多用户分布在多个团队或项目中的环境。</li><li id="910c" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">命名空间为名称提供了范围。<em class="jo">资源的名称需要在一个名称空间内是唯一的，但不能跨名称空间</em>。</li><li id="a2e3" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">命名空间不能相互嵌套。</li><li id="ba7b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">默认名称空间:</li></ol><ul class=""><li id="d312" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj">默认</strong></li><li id="5401" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj"> kube-system </strong>:用于由Kubernetes系统创建的对象</li><li id="1ae8" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<strong class="is hj"> kube-public </strong>:所有用户(包括未经认证的用户)均可读取。</li></ul><p id="54cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.如果想要跨名称空间访问服务，需要使用完全限定的域名(FQDN)。</p><p id="6291" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.kubernetes的默认行为是在本地名称空间中查找服务。服务DNS条目的格式为:<strong class="is hj">..svc.cluster.local </strong>。</p><p id="3939" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 8。名称空间资源</em>本身不在名称空间中。</p><p id="3915" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 9。低级资源</em>，如<em class="jo">节点</em>和<em class="jo">持久卷</em>，在任何名称空间中都是<strong class="is hj">而不是</strong>。</p><h2 id="e824" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">服务</h2><ol class=""><li id="bcc7" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">Kubernetes中的一个<strong class="is hj">服务</strong>是一个抽象，它定义了一组逻辑pod和一个访问它们的策略。服务使依赖pod之间的松散耦合成为可能。</li><li id="46eb" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">尽管每个Pod都有一个唯一的IP地址，但如果没有服务，这些IP不会暴露在群集之外。<em class="jo">服务允许您的应用程序接收流量</em>。</li><li id="49d5" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">服务被分配一个唯一的IP地址(也称为clusterIP)。</li><li id="42fc" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">该地址与服务的生命周期相关联，并且在服务存在时不会改变</li><li id="ad7d" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">一个服务由一组pod支持，这些pod通过端点公开。</li><li id="4f74" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">服务的选择器将被连续评估，结果将被发布到一个端点对象</li><li id="ea64" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">当一个Pod终止时，它会自动从端点中删除，并且与服务选择器匹配的新Pod会自动添加到端点中。</li><li id="24a2" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">一个服务IP是完全虚拟的，它永远不会上网。</li><li id="3652" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Kubernetes服务提供了一个稳定的，<strong class="is hj">虚拟IP (VIP) </strong>地址。</li><li id="f0a7" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">虚拟IP(VIP)地址意味着它没有连接到任何网络接口</li><li id="a1a6" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">VIP的目的是将流量转发到pod</li><li id="ca83" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">保持VIP和pod之间的映射最新是kube-proxy的工作，kube-proxy运行在每个节点上，查询API服务器以了解集群中的新服务。</li><li id="47e2" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">服务的<em class="jo">目标不一定是pod </em>。它可以是外部集群组件、其他名称空间中的组件、非kubernetes组件。只需定义没有选择器属性的服务。</li><li id="9457" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">如果没有选择器属性，则不会创建端点对象。</li><li id="201b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">对于多端口服务(公开多个端口的服务)，您必须给出所有端口的名称，以便端点能够被区分</li><li id="ddf6" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">通过在<em class="jo"> ServiceSpec </em>中指定类型，可以以不同的方式公开服务:</li></ol><ul class=""><li id="a639" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj"> ClusterIP(默认)</strong> —在集群中的内部IP上公开服务。这种类型使服务只能从群集内部访问。</li><li id="942b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj">节点端口</strong> —使用NAT在集群中每个选定节点的同一端口上公开服务。使用<code class="du ll lm ln lo b">&lt;NodeIP&gt;:&lt;NodePort&gt;</code>从集群外部访问服务。这充当ClusterIP的超集。</li><li id="2648" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<strong class="is hj">负载平衡器</strong> —在当前云中创建一个外部负载平衡器(如果支持)，并为服务分配一个固定的外部IP。这充当节点端口的超集。</li><li id="b4dd" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.<strong class="is hj"> ExternalName </strong> —通过返回具有任意名称(由规范中的ExternalName指定)的CNAME记录来公开服务。不使用代理。这种类型需要1.7版或更高版本的kube-dns。</li><li id="d9e4" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">5.综上所述，<strong class="is hj"> ExternalName </strong> = &gt;是<strong class="is hj">负载均衡器的超集</strong> = &gt;是<strong class="is hj">节点端口</strong> = &gt;是<strong class="is hj">集群IP </strong>的超集</li></ul><p id="1bf4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">17.差异黑白端口、目标端口和节点端口:</p><ul class=""><li id="1ca6" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<strong class="is hj"> Port </strong>:端口号，使一个服务对同一集群内运行的其他服务可见</li><li id="2542" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<strong class="is hj">目标端口</strong>:服务运行的端口</li><li id="a10f" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<strong class="is hj">节点端口</strong>:外部用户<em class="jo">使用<strong class="is hj"> Kube-Proxy </strong>可以访问服务的端口</em></li></ul><p id="f717" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">18.服务在一组pod之间路由流量。</p><p id="e94c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">19.关于<strong class="is hj">节点端口</strong>类型服务的几点说明:</p><ul class=""><li id="b73f" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.它<em class="jo">不是</em>为生产环境设计的。同样使用<em class="jo">负载平衡器</em>或<em class="jo">入口控制器/资源</em></li><li id="ed89" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.需要为服务定义指定额外的节点端口属性</li><li id="dd80" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.在每个节点上打开指定的(如果未指定，则自动选择)端口</li><li id="d162" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.每个端口只能有一个服务</li><li id="b7de" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">5.您只能使用30000–32767端口</li><li id="5040" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">6.如果您节点/虚拟机IP地址发生变化，您需要处理它</li></ul><p id="3f12" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">20.关于<strong class="is hj">负载平衡器</strong>类型服务的几点注意事项:</p><ul class=""><li id="4cbe" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.向外界公开服务的最佳方法，如果您的云提供商支持的话</li><li id="e080" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.没有过滤，没有路由等。这意味着您可以向它发送几乎任何类型的流量，如HTTP、TCP、UDP、Websockets、gRPC或其他。</li><li id="048e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.每个使用<em class="jo"> LoadBalancer </em>公开的服务都将获得自己的IP地址，并且您必须为每个公开的服务支付一个LoadBalancer，这可能会非常昂贵。</li></ul><p id="80af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">21.使用服务规范中的<em class="jo"> externalips </em>将IP地址设置为服务目标。这可以在群集之外</p><p id="bafd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">22.服务有一个集成的负载平衡器，可以将网络流量分配给公开部署的所有单元。服务将使用端点持续监控正在运行的pod，以确保流量仅发送到可用的pod。</p><p id="9bd5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">23.如果想要跨名称空间访问服务，需要使用完全限定的域名(FQDN)。</p><p id="983c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">24.kubernetes的默认行为是在本地名称空间中查找服务。服务DNS条目的格式为:<em class="jo"> &lt;服务名&gt;。&lt;名称空间名称&gt; .svc.cluster.local </em>。</p><p id="1145" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">25.Kubernetes提供了一个DNS <strong class="is hj">集群插件服务</strong>，可以自动为其他服务分配DNS名称。</p><p id="2782" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">26.关于<strong class="is hj">无头服务</strong>的几点说明:</p><ul class=""><li id="81da" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.当您不需要或不想要负载平衡和单一服务IP时。</li><li id="b75a" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.指定<em class="jo">无</em>作为<em class="jo">集群IP </em>值。</li><li id="1b5e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.允许开发人员以自己的方式自由发现，从而减少与Kubernetes系统的耦合。</li><li id="a758" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">4.没有分配群集IP。</li><li id="2763" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">5.kube-proxy不处理这些服务。</li><li id="451a" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">6.平台不会为它们进行负载平衡或代理。</li><li id="ea76" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">7.如果定义了选择器，端点控制器在API中创建端点记录，并修改DNS配置以返回直接指向支持服务的Pods的记录(地址)。</li><li id="7b39" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">8.如果没有定义选择器，就不会创建<em class="jo">端点</em>对象。但是，为所有其他类型的<em class="jo"> ExternalName </em>类型服务创建<em class="jo"> CNAME </em>记录，并为与该服务共享名称的任何<em class="jo">端点</em>创建记录。</li></ul><h2 id="99d1" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">标签</h2><ol class=""><li id="639e" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">标签可以在创建时或以后附着到对象上。此外，它们可以随时修改。</li><li id="f363" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">标签用于指定对象的识别属性。</li><li id="2b88" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><em class="jo">名称段</em>是<strong class="is hj">必需的</strong>，必须在<em class="jo"> 63个字符以内</em>。</li><li id="9751" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">前缀必须是一个DNS子域:由点(.)，总长度不超过253个字符，后跟一个斜杠(/)。</li><li id="8e6d" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">标签用于指定<strong class="is hj">识别对象</strong>的属性。<em class="jo">非识别信息</em>应使用<strong class="is hj">注释</strong>进行记录。</li><li id="ec76" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">如果省略前缀，则标签密钥被认为是用户私有的。</li><li id="db49" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">kubernetes.io/</strong>和<strong class="is hj">k8s.io/</strong>前缀是为Kubernetes核心组件保留的。</li><li id="c2fd" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">有效标签值必须等于或少于63个字符。它们也可能是空的。</li></ol><h2 id="1d23" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">标签选择器</h2><ol class=""><li id="9470" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">客户端或用户可以识别一组对象。标签选择器是Kubernetes中的核心分组原语。</li><li id="77e5" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">支持以下<em class="jo">类型的标签选择器</em>:基于<strong class="is hj">等式的</strong>和基于<strong class="is hj">集合的</strong>。</li></ol><ul class=""><li id="5dc3" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.基于等式的标签选择器:</li><li id="8c99" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.基于集合的标签选择器:</li></ul><p id="cb13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.基于等式的标签选择器:</p><ul class=""><li id="6c4f" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.允许的操作员:<code class="du ll lm ln lo b">=,==,!=</code></li><li id="4bbc" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">这些可以指定为:</li></ul><p id="a3c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">— 3.1.新线路终止:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="70ea" class="jw jx hi lo b fi lx ly l lz ma">environment = production<br/>tier != frontend</span></pre><p id="5a57" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">— 3.2.逗号分隔:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="5a17" class="jw jx hi lo b fi lx ly l lz ma">environment=production,tier!=frontend</span></pre><p id="d7e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.基于集合的标签选择器:</p><ul class=""><li id="d4d2" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">允许的操作员:<code class="du ll lm ln lo b">in, notin and exists</code>(仅密钥标识符)</li><li id="8a6e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">示例:</li></ul><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="b724" class="jw jx hi lo b fi lx ly l lz ma">environment in (production, qa)<br/>tier notin (frontend, backend)<br/>partition<br/>!partition<br/>partition,environment notin (qa)<br/>&gt;&gt;&gt; Above one selects resources with a partition key(no matter the value) and with environment different than  qa</span></pre><p id="4671" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 5。基于集合的</em>标签选择器可以与基于<em class="jo">等式的</em>选择器混合使用。示例:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="e624" class="jw jx hi lo b fi lx ly l lz ma">partition in (customerA, customerB),environment!=qa</span></pre><p id="b9a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.标签选择器可以与作为查询参数的API调用和kubectl命令结合使用，以<em class="jo">过滤返回的结果</em>。示例:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="3ece" class="jw jx hi lo b fi lx ly l lz ma">partition in (customerA, customerB),environment!=qa</span></pre><p id="e635" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 7。服务</em>和<em class="jo">复制控制器</em>不支持<em class="jo">基于集合的标签选择器</em>。</p><p id="be72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.较新的资源，如<em class="jo">作业</em>、<em class="jo">部署</em>、<em class="jo">副本集</em>和<em class="jo">守护进程集</em>，支持基于集合的标签选择器。</p><h2 id="afcf" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">字段选择器</h2><ol class=""><li id="7833" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">它们允许您根据一个或多个资源域的值来选择Kubernetes资源。示例:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="d424" class="jw jx hi lo b fi lx ly l lz ma">status.phase=Pending<br/>kubectl get pods --field-selector status.phase=Running</span></pre><p id="bcc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.受支持的字段选择器因Kubernetes资源类型而异。</p><p id="cbfa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.所有资源类型都支持<em class="jo">元数据.名称</em>和<em class="jo">元数据.名称空间</em>字段。</p><p id="fe64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.使用不支持的字段选择器会产生错误。</p><p id="9b8a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.可以一次过滤多个资源。此外，可以使用逗号作为分隔符给出多个字段选择器。示例:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="b71f" class="jw jx hi lo b fi lx ly l lz ma">kubectl get statefulsets,services --field-selector=status.phase!=Running,spec.restartPolicy=Always</span></pre><h2 id="51aa" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">释文</h2><ol class=""><li id="88bb" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">它们存储<em class="jo">非识别对象数据</em>。它们<em class="jo">不能</em>用于根据它们的值定位/选择对象。</li><li id="285b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">注释中的<em class="jo">元数据</em>可大可小，结构化或非结构化，并且可以包含标签不允许的字符。</li><li id="9c92" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">注释具有与标签相同的语法。</li></ol><h2 id="f738" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kubernetes对象管理</h2><p id="867c" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">以下是与kubernetes对象交互的3种方式:</p><ol class=""><li id="98d1" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn ky kz la lb bi translated">使用<strong class="is hj">命令式命令</strong>:它们作用于<em class="jo">活体</em></li><li id="20ad" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">使用<strong class="is hj">命令式对象配置</strong>:它们操作<em class="jo">单个文件</em></li><li id="56ad" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">使用<strong class="is hj">声明性对象配置</strong>:它们对文件的<em class="jo">目录进行操作</em></li></ol><h2 id="b145" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">命令式命令</h2><ol class=""><li id="54ef" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">与命令中带有资源名称的kubectl一起使用</li></ol><h2 id="bee1" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">命令性对象配置</h2><ol class=""><li id="5b16" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">与kubectl with操作(创建、替换等)一起使用。)和单个对象配置文件。</li><li id="0f35" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">指定的对象配置文件必须包含YAML或JSON格式的对象的完整定义。</li><li id="8e4b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">也可以指定多个文件。示例:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="a3b6" class="jw jx hi lo b fi lx ly l lz ma">kubectl delete -f nginx.yaml -f redis.yaml</span></pre><h2 id="daa7" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">声明性对象配置</h2><ol class=""><li id="b50b" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">对本地存储的对象配置文件进行操作。</li><li id="4f5b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">用户不定义要对文件采取的操作。</li><li id="6f11" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">kubectl自动检测每个对象的创建、更新和删除操作。</li><li id="2b29" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">使用<strong class="is hj">补丁</strong>操作保存其他编写器所做的更改，同时应用新的更改(<em class="jo">仅与</em>不同)。</li><li id="76c1" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">要查看将要进行的更改，请使用:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="44a4" class="jw jx hi lo b fi lx ly l lz ma">kubectl diff -f configs/</span></pre><p id="c931" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.要应用更改:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="66a6" class="jw jx hi lo b fi lx ly l lz ma">kubectl apply -f configs/</span></pre><p id="49c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.使用命令行标志<strong class="is hj"> -R </strong>递归处理目录。</p><p id="590d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.这些文件被称为资源配置。</p><h2 id="f3aa" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">初始化容器</h2><ol class=""><li id="a1b0" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">它们是在应用程序容器之前运行的<em class="jo">专用容器。</em></li><li id="e3f4" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Thwy可以包含应用程序映像中没有的实用程序或设置脚本。</li><li id="7b21" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">他们总是运行到完成。</li><li id="18ca" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">在下一个任务开始之前，每个任务都必须成功完成。</li><li id="c2fe" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><em class="jo">自定义容器</em>可以使用PodSpec 的<em class="jo"> initContainers字段指定为<strong class="is hj"> initContainers </strong>。</em></li><li id="05ad" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">在<em class="jo">规格</em>对象的所有方面几乎与常规容器完全相同。</li><li id="9728" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">不支持就绪探测，因为它们必须在pod就绪之前运行完成。</li><li id="0288" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">它们在网络和卷初始化后<strong class="is hj">启动。</strong></li><li id="8977" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">对<em class="jo">初始化容器规范</em>的更改仅限于容器图像字段。</li><li id="1cd9" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj"> activeDeadlineSeconds </strong>适用于两种类型的容器。</li><li id="b207" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">应用程序容器映像更改只会重新启动应用程序容器，而不会重新启动初始化容器。为此，需要更改init容器映像。</li></ol><h2 id="3e96" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">秘密生成器:kustomization.yaml</h2><ol class=""><li id="60b4" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">机密是一种存储敏感数据(如密码或密钥)的对象。</li><li id="67aa" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">从1.14开始，kubectl支持使用库化文件管理kubernetes对象。</li><li id="0484" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">您可以在<strong class="is hj"> kustomization.yaml </strong>中通过生成器创建一个秘密。</li></ol><h2 id="a15e" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">永久卷(pv)和永久卷声明(pvc)</h2><ol class=""><li id="e3db" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">使用共享卷时，使用<strong class="is hj"> ReadWriteMany </strong>而不是<strong class="is hj"> ReadWriteOnce </strong>。</li><li id="a9b7" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><em class="jo">访问控制</em> : <strong class="is hj"> gid(组id) </strong>可以分配给创建的卷，以<em class="jo">限制对具有相同gid的特定pod的访问</em>。</li><li id="ee23" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj"> PersistentVolume (PV) </strong>是集群中的一块存储，由管理员手动配置，或者由kubernetes使用<strong class="is hj"> StorageClass </strong>动态配置。</li><li id="2bb3" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">PersistentVolumeClaim(PVC)</strong>是用户的存储请求，可由<em class="jo">持久卷</em>满足。</li><li id="8a0d" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">PersistentVolumes和PersistentVolumeClaims独立于Pod生命周期，并通过重新启动、重新计划甚至删除Pod来保存数据。</li><li id="5101" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">许多群集环境都安装了默认的存储类。当PersistentVolumeClaim中未指定StorageClass时，将使用群集的默认StorageClass。</li><li id="242a" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">在具有默认存储类(hostPath)的本地集群中，数据保存在节点的<strong class="is hj"> /tmp </strong>目录中。因此，可能会在重新启动时丢失。</li></ol><h2 id="df9a" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kubernetes秘密对象类型</h2><ol class=""><li id="5fc4" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">存储一段敏感数据，如密码或密钥。</li></ol><h2 id="8eb2" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">域名服务器(Domain Name Server)</h2><ol class=""><li id="0f18" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">Kubernetes提供了一个dns集群插件服务,可以自动将DNS名称分配给其他服务。</li><li id="aa8a" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">要检查集群上是否正在运行相同的程序，请使用以下命令:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="9257" class="jw jx hi lo b fi lx ly l lz ma">kubectl get services kube-dns --namespace=kube-system</span></pre><h2 id="2e24" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">进入</h2><ol class=""><li id="89dc" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">管理对群集中服务的外部访问的API对象，通常是HTTP。</li><li id="2b0c" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Ingress可以提供负载平衡、SSL终止和基于名称的虚拟主机。</li><li id="6bf3" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">有点像反向代理</li><li id="8008" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">入口可以配置为向服务提供外部可达的URL、负载平衡流量、终止SSL以及提供基于名称的虚拟主机。</li><li id="2ac7" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">入口不会暴露任意端口或协议。向互联网公开除HTTP和HTTPS之外的服务通常使用类型为<code class="du ll lm ln lo b">Service.Type=NodePort</code>或<code class="du ll lm ln lo b">Service.Type=LoadBalancer</code>的服务。</li><li id="e0db" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">你必须有一个<strong class="is hj">入口控制器</strong>来满足一个入口。<em class="jo">只创建入口资源没有效果</em>。</li><li id="d32b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">请注意，并非所有入口控制器都支持全部规格。选择时要小心。</li><li id="6cc8" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">它支持TLS。</li><li id="25db" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">支持负载平衡。支持一些常用算法。对于其他情况，可以使用服务负载平衡器。</li><li id="25d1" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">默认情况下不公开运行状况检查。但是，可以使用就绪探测器。</li><li id="2dc3" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">可以进行跨可用性区域部署，但这取决于云提供商的支持。有关在联合集群中部署<em class="jo">入口的详细信息，请参考<strong class="is hj">联合文档</strong>。</em></li><li id="276b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">入口类型:</li></ol><ul class=""><li id="0307" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<em class="jo">单一服务入口</em>:公开单一服务。没有主机和路径映射</li><li id="6bb5" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<em class="jo">样本扇出</em>:使用仅路径映射公开多个服务</li><li id="df36" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">3.<em class="jo">基于名称的虚拟主机</em>:使用域和路径映射</li></ul><p id="0522" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">13.至少在GKE上，旋转出L7层HTTP负载平衡器，因此是非协议不可知的。</p><p id="f1ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">14.许多可用的入口控制器:谷歌云负载平衡器、Nginx、Contour、Istio等等。</p><h2 id="d567" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">入口控制器</h2><ol class=""><li id="1974" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">入口控制器监听Kubernetes API获取<em class="jo">入口资源</em>，然后处理与之匹配的请求。</li><li id="a751" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">技术上可以是任何能够反向代理的系统，但最常见的是Nginx。</li><li id="e741" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Nginx控制器需要一个后端。其他控制器<em class="jo">可能</em>不需要。</li><li id="76eb" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">没有规则的入口将所有流量发送到单个默认后端。</li><li id="d21f" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">默认后端通常是入口控制器的一个配置选项，不在入口资源中指定</li></ol><h2 id="7ee5" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">服务发现</h2><p id="ade2" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">以下是可以提供服务发现的两种方式:</p><ol class=""><li id="f08b" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn ky kz la lb bi translated">使用环境变量</li><li id="d5b3" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">DNS(推荐)</li></ol><h2 id="991e" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">环境变量—用于服务发现</h2><ol class=""><li id="fdad" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">kubelet以{SVCNAME} <em class="jo"> {SOME_NAME}的形式公开环境变量。例如，对于集群ip为_10.0.0.11 </em>的redis服务:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="40aa" class="jw jx hi lo b fi lx ly l lz ma">REDIS_MASTER_SERVICE_HOST=10.0.0.11<br/>REDIS_MASTER_SERVICE_PORT=6379<br/>REDIS_MASTER_PORT=tcp://10.0.0.11:6379<br/>REDIS_MASTER_PORT_6379_TCP=tcp://10.0.0.11:6379<br/>REDIS_MASTER_PORT_6379_TCP_PROTO=tcp<br/>REDIS_MASTER_PORT_6379_TCP_PORT=6379<br/>REDIS_MASTER_PORT_6379_TCP_ADDR=10.0.0.11</span></pre><h2 id="d66f" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">DNS —用于服务发现</h2><ol class=""><li id="5f10" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">这是一个集群附件。</li><li id="26fa" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">DNS服务器<em class="jo">为新的<em class="jo">服务</em>监视Kubernetes API </em>，并为每个服务创建一组DNS记录。</li><li id="b142" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">对于命名空间<em class="jo"> my-ns </em>中的服务<em class="jo"> my-service </em>，为<em class="jo"> my-service.my-ns </em>创建一个DNS记录。</li><li id="605c" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">如果pod属于同一个名称空间，则不需要指定名称空间。</li><li id="1c76" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">Kubernetes DNS服务器是访问ExternalName类型服务的唯一方式。</li></ol><h2 id="3595" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">端点</h2><ol class=""><li id="9c04" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">一个<strong class="is hj">端点</strong>是一个<em class="jo">REST API端点</em>的面向对象表示，它被填充在Kubernates API服务器上。因此，就Kubernetes而言,<em class="jo">端点</em>是访问其资源(如Pod)的方式，即“端点”后面的资源。</li><li id="8ec2" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">包含<strong class="is hj">端点子集</strong>数组。</li><li id="8499" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><em class="jo">端点子集</em>是一组具有一组公共端口的地址。扩展的端点集是地址x端口的<em class="jo">笛卡尔乘积。</em></li><li id="9e43" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hj">endpoint subset的EndpointAddress </strong>可能<strong class="is hj">不是</strong>是环回(127.0.0.0/8)、链路本地(169.254.0.0/16)或链路本地组播(224.0.0.0/24)。</li><li id="4c47" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">IPv6 也被接受，但并非所有平台都完全支持。</li><li id="2792" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">服务的选择器被连续评估，结果被<em class="jo">发送到一个端点对象</em></li><li id="24c9" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">当一个Pod终止时，它会自动从端点中删除，并且与服务选择器匹配的新Pod会自动添加到端点中。</li><li id="f109" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><em class="jo">端点</em>跟踪服务向其发送流量的对象的IP地址。</li><li id="a34e" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">并且通过保持服务和端点的名称相同，端点可以与服务松散耦合。详情请见<a class="ae me" href="https://kubernetes.io/docs/concepts/services-networking/service/#services-without-selectors" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/concepts/services-networking/service/# services-without-selectors</a>。</li><li id="27f7" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">如果没有提到选择器属性(是一个服务)，则不会创建端点对象。</li></ol><h2 id="4ee3" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kube代理</h2><ol class=""><li id="e668" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">它是一个运行在每个工作节点上的特殊守护程序(应用程序)。</li><li id="dbd3" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">可以在两种模式下运行，可通过<code class="du ll lm ln lo b">--proxy-mode</code>命令行开关进行配置:</li></ol><ul class=""><li id="dd47" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.<em class="jo">用户空间</em></li><li id="37cf" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.<em class="jo"> iptables </em></li></ul><p id="1de8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.为了获得更高的吞吐量和更好的延迟，请使用<em class="jo"> iptables </em>代理模式。</p><p id="74f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 4。未准备好IPv6。</em></p><p id="f1bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.维护网络规则并执行连接转发。</p><p id="fbb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.这有助于:</p><ul class=""><li id="e006" class="kr ks hi is b it iu ix iy jb lh jf li jj lj jn lk kz la lb bi translated">1.调试您的服务，或者出于某种原因从您的笔记本电脑直接连接到它们</li><li id="6cc0" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn lk kz la lb bi translated">2.允许内部流量、显示内部仪表盘等。</li></ul><h2 id="9421" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Kube dns</h2><ol class=""><li id="9fb1" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">这允许直接使用名称访问K8s服务，而不是使用<em class="jo"> VIP:PORT </em>的组合。</li><li id="7a9b" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">当您使用kube-dns时，K8s <em class="jo">将</em>特定的名称服务查找配置注入到新的pods中，允许您查询集群中的dns记录。</li><li id="1763" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">kube-dns创建一个<em class="jo">内部集群dns区域</em>，用于DNS和服务发现。这意味着我们可以通过服务名直接从pod内部访问服务。示例:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="b28c" class="jw jx hi lo b fi lx ly l lz ma">curl -I nginx-svc:8080</span></pre><p id="9a7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.您可以使用以下命令查看kube-dns设置的节点dns配置:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="4ea0" class="jw jx hi lo b fi lx ly l lz ma">cat /etc/resolv.conf<br/>&gt; search default.svc.cluster.local svc.cluster.local cluster.local google.internal c.kube-blog.internal<br/>  nameserver 10.32.0.10<br/>  options ndots:5</span></pre><p id="2167" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.如果服务是在默认名称空间中创建的，也可以使用<em class="jo">集群内部DNS名称</em>来访问它:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="c10f" class="jw jx hi lo b fi lx ly l lz ma">curl -I nginx-svc.default.svc.cluster.local:8080</span></pre><h2 id="309b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq bi translated">Etcd</h2><ol class=""><li id="1664" class="kr ks hi is b it kt ix ku jb kv jf kw jj kx jn ky kz la lb bi translated">这是一个一致且高度可用的键值存储，用作kubernetes所有集群数据的后备存储。</li><li id="7d3c" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">确保始终为您的kubernetes集群的etcd数据制定备份计划。</li><li id="6ba9" class="kr ks hi is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">所有数据都作为注册表保存在etc中。示例:</li></ol><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="fe41" class="jw jx hi lo b fi lx ly l lz ma">/registry/services<br/>/registry/events<br/>/registry/secrets<br/>/registry/minions</span></pre><p id="deae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.以下命令可用于查询etcd中的数据:</p><pre class="lp lq lr ls fd lt lo lu lv aw lw bi"><span id="a507" class="jw jx hi lo b fi lx ly l lz ma">etcdctl --ca-file=/etc/etcd/ca.pem get /registry/services/endpoints/default/kubernetes</span></pre><p id="0525" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就这些了，各位\ <em class="jo"> (ツ) </em> /</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="4a60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您在软件开发方面有任何建议或需要任何帮助，请给我发邮件至<a class="ae me" href="https://mailto:contact@nitinbansal.dev/" rel="noopener ugc nofollow" target="_blank"> contact@nitinbansal.dev </a>或在<a class="ae me" href="https://twitter.com/9wxg1" rel="noopener ugc nofollow" target="_blank"> twitter </a>上给我发短信。</p><h1 id="5bac" class="mf jx hi bd jy mg mh mi kc mj mk ml kg mm mn mo kj mp mq mr km ms mt mu kp mv bi translated">参考</h1><p id="4135" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">1.<a class="ae me" href="https://kubernetes.io/docs/tutorials/kubernetes-basics/expose/expose-intro/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/tutorials/kubernetes-basics/expose/expose-intro/</a><br/>2 .<a class="ae me" href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/reference/generated/kubectl/kubectl-commands</a><br/>3 .<a class="ae me" href="https://kubernetes.io/docs/tasks/access-application-cluster/communicate-containers-same-pod-shared-volume/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/tasks/access-application-cluster/communicate-containers-same-pod-shared-volume/</a><br/>4 .<a class="ae me" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/concepts/workloads/pods/pod-life cycle/</a><br/>5。<a class="ae me" href="https://github.com/kubernetes/website/blob/master/content/en/examples/service/nginx-service.yaml" rel="noopener ugc nofollow" target="_blank">https://github . com/kubernetes/website/blob/master/content/en/examples/service/nginx-service . YAML</a><br/>6 .<a class="ae me" href="https://github.com/kubernetes/website/blob/master/content/en/examples/service/networking/run-my-nginx.yaml" rel="noopener ugc nofollow" target="_blank">https://github . com/kubernetes/website/blob/master/content/en/examples/service/networking/run-my-nginx . YAML</a><br/>7 .<a class="ae me" href="https://github.com/kubernetes/examples/blob/master/mysql-wordpress-pd/wordpress-deployment.yaml" rel="noopener ugc nofollow" target="_blank">https://github . com/kubernetes/examples/blob/master/MySQL-WordPress-PD/WordPress-deployment . YAML</a><br/>8。<a class="ae me" href="https://stackoverflow.com/questions/54923806/why-do-i-get-unbound-immediate-persistentvolumeclaims-on-minikube" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/54923806/why-do-I-get-unbound-immediate-persistentvolumeclaims-on-minikube</a><br/>9。<a class="ae me" href="https://kubernetes.io/docs/tutorials/stateful-application/mysql-wordpress-persistent-volume/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/tutorials/stateful-application/MySQL-WordPress-persistent-volume/</a><br/>10 .<a class="ae me" href="https://github.com/containous/traefik" rel="noopener ugc nofollow" target="_blank">https://github.com/containous/traefik</a>T29】11。<a class="ae me" href="https://blog.openshift.com/kubernetes-services-by-example/" rel="noopener ugc nofollow" target="_blank">https://blog.openshift.com/kubernetes-services-by-example/</a>T32】12。<a class="ae me" href="http://containerops.org/2017/01/30/kubernetes-services-and-ingress-under-x-ray/" rel="noopener ugc nofollow" target="_blank">http://container ops . org/2017/01/30/kubernetes-services-and-ingress-under-x-ray/</a><br/>13 .<a class="ae me" href="https://matthewpalmer.net/kubernetes-app-developer/articles/kubernetes-ingress-guide-nginx-example.html" rel="noopener ugc nofollow" target="_blank">https://Matthew palm er . net/kubernetes-app-developer/articles/kubernetes-ingress-guide-nginx-example . html</a><br/>14 .<a class="ae me" rel="noopener" href="/@cashisclay/kubernetes-ingress-82aa960f658e">https://medium . com/@ cash sclay/kubernetes-ingress-82aa 960 f 658 e</a><br/>15 .【https://github.com/kubernetes/kops/tree/master/addons T42】</p></div></div>    
</body>
</html>