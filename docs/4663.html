<html>
<head>
<title>Running a Subset of Cypress Tests using Grep and Test Tags</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Grep 和 Test 标签运行 Cypress 测试的子集</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/running-a-subset-of-cypress-tests-using-grep-and-test-tags-394dac8b700e?source=collection_archive---------4-----------------------#2021-08-01">https://medium.com/nerd-for-tech/running-a-subset-of-cypress-tests-using-grep-and-test-tags-394dac8b700e?source=collection_archive---------4-----------------------#2021-08-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="124f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用赛普拉斯<a class="ae ix" href="https://docs.cypress.io/guides/guides/module-api" rel="noopener ugc nofollow" target="_blank">模块 API </a>和<a class="ae ix" href="https://github.com/cypress-io/cypress-grep" rel="noopener ugc nofollow" target="_blank">测试标记</a>组合测试标记，以方便地过滤和运行测试的子集。</h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/248adb2148cb838119be5bbd7c19248a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lJK1RxuiVvStcu3C"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">泰勒·尼克斯在<a class="ae ix" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1b67" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">测试自动化很少是静态的，因为它需要定期维护。您可能需要添加额外的测试来增加覆盖率，或者添加测试来覆盖特定的用户流。或者，您可能需要将 web 应用程序的测试、应用程序 CMS 的测试和 enabler 的测试分开——这并不完全是一个测试，但更像是一个过程自动化，因为您可能在做重复性的任务，比如定期下载报告。test enabler(或 RPA)的另一个好例子<a class="ae ix" href="https://deepstacker.com/2020-02-20-using-cypress-to-do-rpa/" rel="noopener ugc nofollow" target="_blank">是你可以使用 GitHub 做一些网站废弃和自动化的过程。</a></p><p id="9f53" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，这是我寻找过滤和运行 Cypress 测试子集的完美方法的旅程(这是特定于文件夹和特定测试的)。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="eeff" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">开始</h1><p id="0f60" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">像我这样的普通开发人员或初学者肯定会使用 Google 来搜索过滤 Cypress 测试的可用解决方案。根据搜索词的不同，您肯定会看到这些很棒的结果:</p><ul class=""><li id="7ebd" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated"><a class="ae ix" rel="noopener" href="/geekculture/how-i-filtered-tests-with-cypress-io-9c7a85460a1d">我如何用 Cypress.io 过滤测试。</a></li><li id="32bc" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">使用标签过滤你的 Cypress 测试。</li><li id="6617" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated"><a class="ae ix" href="https://testersdock.com/cypress-test-tags/" rel="noopener ugc nofollow" target="_blank">如何将标签应用于 E2E 如烟的柏树测试。</a></li></ul><p id="a644" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第一篇和第二篇使用自定义函数<code class="du mc md me mf b">TestFilters</code>，第三篇使用 Gleb Bahmutov 编写的插件<code class="du mc md me mf b">cypress-select-tests</code>。</p><p id="38f6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">不幸的是，没有一个建议的解决方案足够适用于我的情况。如果您不介意将<code class="du mc md me mf b">describe</code>或<code class="du mc md me mf b">it</code>包装在<code class="du mc md me mf b">TestFilters</code>中，并且不介意将它写在整个规范文件中，那么使用自定义函数可能会很好。使用<code class="du mc md me mf b">cypress-select-tests</code>也不适用，因为标签被放在测试标题或文件名中，更不用说插件本身被否决了。</p><h1 id="5578" class="kr ks hi bd kt ku mg kw kx ky mh la lb io mi ip ld ir mj is lf iu mk iv lh li bi translated">测试 Grepping 到救援</h1><p id="d841" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">Filip Hric 有一篇关于<a class="ae ix" href="https://filiphric.com/test-grepping-in-cypress-using-module-api" rel="noopener ugc nofollow" target="_blank">测试 grepping </a>的非常好的文章，我的解决方案就是基于这篇文章。它足够简单，易于理解和遵循，我认为它对大多数情况都足够有帮助。基本上，您提供要运行的测试文件夹。</p><p id="97b8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是，等等！我还需要过滤掉 spec 文件中的特定测试，例如:如何在一个文件夹中运行所有的阳性测试，并在不同的文件夹中结合一些其他的阳性测试？</p><h1 id="c4b7" class="kr ks hi bd kt ku mg kw kx ky mh la lb io mi ip ld ir mj is lf iu mk iv lh li bi translated">输入 cypress-grep</h1><p id="a9b2" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">从 TestersDock 解决方案中阅读和挖掘关于<code class="du mc md me mf b">cypress-select-tests</code>的内容，实际上会导致<a class="ae ix" href="https://github.com/cypress-io/cypress-grep" rel="noopener ugc nofollow" target="_blank"> cypress-grep </a>。一个来自 Cypress guru 的超级方便的插件。您可以使用测试标题的一部分和使用显式标签来运行特定的测试，这完全符合我的需要。</p><h1 id="7ba8" class="kr ks hi bd kt ku mg kw kx ky mh la lb io mi ip ld ir mj is lf iu mk iv lh li bi translated">最终解决方案</h1><p id="cd8c" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">那么，我如何将 test grepping 解决方案与 cypress-grep 结合起来呢？无论如何不要被这个名字搞混了，因为它们包含同一个单词“grep”。</p><ul class=""><li id="c7bf" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">遵循菲利普·赫里克的测试结果。在根文件夹<code class="du mc md me mf b">cypress.ts</code>中创建一个新文件，并修改<code class="du mc md me mf b">package.json</code>以合并更改</li></ul><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es ml"><img src="../Images/2552ec4e6ec3160d5c020db16dfde748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ShrE_gsh_ADk2q4GQV4R5A.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">cypress.ts</figcaption></figure><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mm"><img src="../Images/61dd0c16cf6271cb671d375bc1b816a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*P13ny--SDHufS-JZx6gGcA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">package.json</figcaption></figure><ul class=""><li id="ad1f" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">通过执行<code class="du mc md me mf b">npm install --save-dev cypress-grep</code>安装 cypress-grep。</li><li id="9a70" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">在支持文件中添加所需模块。注意，你真的应该<strong class="jq hj">用</strong> <code class="du mc md me mf b">require</code>而不是<code class="du mc md me mf b">import</code>，否则插件就不能用了。</li></ul><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mn"><img src="../Images/231595ce41ced4d29850bb27c1206b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*S53n733yDTrEgDTgem8K1A.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">柏树/支架/索引. ts</figcaption></figure><ul class=""><li id="5eb3" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">自述文件说你可以选择从插件文件加载和注册。反正我是要加的。</li></ul><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mo"><img src="../Images/a05d604a2443ce1779fe6b13f054183c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*dRspD4il2aW8gOkNxVJa7A.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">赛普拉斯/插件/索引. ts</figcaption></figure><ul class=""><li id="f65a" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">将<code class="du mc md me mf b">cypress-grep</code>添加到 tsconfig 文件中的类型。</li></ul><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es mp"><img src="../Images/60d49127e89b3e32dbc4c7f0fb60180a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*iAMVJaEDO2RCBmLnCX5A6Q.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">cypress/tsconfig.json</figcaption></figure><ul class=""><li id="a23c" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">最后，为<code class="du mc md me mf b">grepTags</code>(如果需要，还有<code class="du mc md me mf b">grep</code>)添加附加参数，类型为<code class="du mc md me mf b">string</code>，默认为<code class="du mc md me mf b">''</code>。</li></ul><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es mq"><img src="../Images/4bfef26178a3946b050436dbeedac333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xdnKJw0pCbHHRLEceQDlA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">最终 cypress.ts 文件</figcaption></figure><p id="0506" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">测试用例的一个例子应该是这样的。</p><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es mr"><img src="../Images/9e6182267c7a7550a9f1361ad5f432de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yle6uMiGj-DVgIVpmd0zUw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">登录.规格. ts</figcaption></figure><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es ms"><img src="../Images/5bd4f4ed2fd54b5afcb1f8a405a4971c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-W2yF30w5jcY74WsMLvdSA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">更新了 package.json 以支持按标签执行和执行所有测试而不管标签</figcaption></figure></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="947b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">那都是我送的。我希望我寻找过滤柏树测试的完美配方的旅程能对你有用。如果你有任何改进的建议，请告诉我。感谢阅读！</p></div></div>    
</body>
</html>