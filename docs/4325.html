<html>
<head>
<title>System Design — Choosing Between AWS Kinesis and AWS SQS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">系统设计—在AWS Kinesis和AWS SQS之间选择</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/system-design-choosing-between-aws-kinesis-and-aws-sqs-2586c814be8d?source=collection_archive---------0-----------------------#2021-07-16">https://medium.com/nerd-for-tech/system-design-choosing-between-aws-kinesis-and-aws-sqs-2586c814be8d?source=collection_archive---------0-----------------------#2021-07-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="471b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博文中，我探讨了AWS Kinesis与AWS SQS，展示了每种系统的优缺点，并根据您的系统设计要求选择哪种系统。它强调了数据流和队列之间的区别。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/4c114040147faa816e02bfe2881cfff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VeKM7_1VbLPRPLTRjEmyjA.jpeg"/></div></div></figure><h1 id="c948" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">为什么AWS Kinesis </strong></h1><p id="a13a" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">AWS Kinesis Streams支持大规模数据摄取和流数据的实时处理。它提供了记录的排序，以及以相同顺序读取和/或重放记录的能力。</p><ul class=""><li id="5b0f" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">允许录制的<a class="ae lc" href="http://docs.aws.amazon.com/streams/latest/dev/service-sizes-and-limits.html" rel="noopener ugc nofollow" target="_blank">大小</a>最大1 MB</li><li id="6e8d" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">在碎片级别而不是消息级别工作</li><li id="0a72" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">没有自动缩放，开发者需要跟踪分片使用情况，并在必要时对Kinesis流进行重新分片</li><li id="821b" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">有限读取t <a class="ae lc" href="https://docs.aws.amazon.com/streams/latest/dev/service-sizes-and-limits.html" rel="noopener ugc nofollow" target="_blank"> hroughput </a>(每个碎片每秒5个事务)</li><li id="bcf8" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">流中的碎片数量决定了最大吞吐量</li><li id="d018" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">一个流可以连接多个消费者，每个消费者可以单独处理每个记录(多亏了分片迭代器)</li></ul><h1 id="fe3e" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">为什么选择AWS SQS </strong></h1><p id="65f2" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">AWS简单队列服务(SQS)提供了一个可靠的、高度可伸缩的无服务器托管队列，用于存储消息和在分布式应用程序组件之间轻松移动数据。</p><ul class=""><li id="be21" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">允许相对较小的邮件大小，最大为256 KB</li><li id="395a" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">每条消息都可以独立处理</li><li id="f195" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">自动扩展，通过扩展从队列中读取的任务数量来动态增加读取吞吐量</li><li id="c46a" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">提供消息传递语义(例如消息级确认/失败)和消息可见性超时</li><li id="bf86" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">120，000个<a class="ae lc" href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-limits.html" rel="noopener ugc nofollow" target="_blank">限制</a>用于标准队列的进行中消息数量，20，000个用于FIFO队列</li></ul><h1 id="60e6" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak"> AWS Kinesis v/s AWS SQS </strong></h1><h2 id="59fa" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">消息保留</h2><ul class=""><li id="e2a3" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis —默认情况下存储记录24小时，最多可保留流数据7天</li><li id="3897" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS —可以配置从1分钟到14天的消息保留期，默认为4天</li></ul><h2 id="01db" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">消息重试</h2><ul class=""><li id="2257" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis —没有交付保证，只要数据存在，使用数据的服务就可以重试，消费者不会删除数据，在重新驱动项目的情况下，订购也有保证</li><li id="11a6" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS —至少一次传递保证，继续重新发布未确认的消息，直到消息达到消息保留期规定的最大期限</li></ul><h2 id="c0a0" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">故障处理</h2><ul class=""><li id="f26a" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis — No <a class="ae lc" href="https://en.wikipedia.org/wiki/Dead_letter_queue" rel="noopener ugc nofollow" target="_blank">死信队列</a> (DLQ)开箱即用，每个使用流的应用程序都必须自己处理故障</li><li id="4977" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS —如果消费者未能在可见性超时内处理消息，消息将被发送到已配置的DLQ，并可在SQS再次接收</li></ul><h2 id="e317" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">消费者数量</h2><ul class=""><li id="e717" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis —支持多消费者功能，相同的数据记录可以由多个消费者同时处理，也可以由同一消费者在不同时间处理</li><li id="5634" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS —一次仅支持一个消费者，一旦消息被确认，它将从队列中删除</li></ul><h2 id="02a6" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">记录的排序</h2><ul class=""><li id="36bb" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">kine sis——支持碎片内的有序处理，但是不能保证碎片之间的排序</li><li id="1f13" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS——标准SQS队列不保证按序处理，但FIFO队列支持，但有局限性</li></ul><h2 id="1b9d" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">记录的传送</h2><ul class=""><li id="c08a" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis相关记录可以发送到同一个记录处理器</li><li id="0ea4" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS —不支持路由</li></ul><h2 id="d546" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated">其他AWS服务支持</h2><ul class=""><li id="adca" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis可以将流记录直接发送到亚马逊S3、亚马逊红移、亚马逊弹性搜索、Splunk、AWS Lambda等服务</li><li id="1607" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS —其他服务可以通过AWS Lambda集成</li></ul><h2 id="dfd3" class="li jr hi bd js lj lk ll jw lm ln lo ka iq lp lq ke iu lr ls ki iy lt lu km lv bi translated"><strong class="ak">样本用例</strong></h2><ul class=""><li id="21f6" class="kt ku hi ih b ii ko im kp iq lw iu lx iy ly jc ky kz la lb bi translated">Kinesis —日志和事件数据收集、实时分析、移动数据捕获、物联网数据馈送</li><li id="23f2" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc ky kz la lb bi translated">SQS——应用集成，分离微服务，将实时用户请求与密集的后台工作分离，批处理消息以供将来处理</li></ul><blockquote class="lz ma mb"><p id="c389" class="if ig jd ih b ii ij ik il im in io ip mc ir is it md iv iw ix me iz ja jb jc hb bi translated">希望你喜欢这篇文章，它可以帮助你决定在你的系统设计中使用哪种基于队列的AWS服务！</p><p id="3d6d" class="if ig jd ih b ii ij ik il im in io ip mc ir is it md iv iw ix me iz ja jb jc hb bi translated">以下是您可以采取的一些后续步骤:</p></blockquote><ol class=""><li id="ab7d" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc mf kz la lb bi translated">查看<a class="ae lc" href="https://aws.amazon.com/kinesis/data-streams/faqs/" rel="noopener ugc nofollow" target="_blank"> AWS文档</a>获取他们关于何时使用Kinesis vs SQS的建议！</li><li id="ccfe" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc mf kz la lb bi translated">给我点掌声！</li><li id="85c6" class="kt ku hi ih b ii ld im le iq lf iu lg iy lh jc mf kz la lb bi translated">在Medium &amp; Twitter上关注我，获取更多技术博客！</li></ol></div></div>    
</body>
</html>