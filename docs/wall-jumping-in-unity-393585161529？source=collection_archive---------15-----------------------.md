# 团结跳墙

> 原文：<https://medium.com/nerd-for-tech/wall-jumping-in-unity-393585161529?source=collection_archive---------15----------------------->

![](img/4c92113c17eb4cc129e83a2eec03e4b4.png)

SUNSOFT 出版的《蝙蝠侠:NES》中的经典翻墙动作。

跳墙是平台游戏中一个受欢迎的游戏机制，有充分的理由，到达顶端是具有挑战性和令人满意的！我将快速向您展示如何使用工具内置的角色控制器在 Unity 中做到这一点。

为了进行跳墙，我们需要将规则限制在:

1.  必须离开地面
2.  计算曲面法线并垂直施加力。

听起来很难？别担心，Unity 会做所有的重活！

首先，我们将使用一个新工具，我们的玩家角色控制器！

![](img/747d5b2c65d44a90bdeacd2c6ab40af2.png)

这看起来很像 OnColliderEnter 或 OnTriggerEnter，不是吗？我们可以利用它！

![](img/47eee3dac220fefea5864e4aa5b581cb.png)

当我们运行这段代码时，我们将会看到一条蓝线，从玩家将会碰到的任何正常物体开始。

![](img/f600b06b3f3901433ae532160ffdbe58.png)

所以为了跳墙，我们需要知道我们在墙上。最简单的方法是选择任何垂直环境元素，并将它们标记为“墙”。

![](img/183ad65702a6c5b567ac23f2bfff3f1d.png)

用“墙”标签标记垂直墙。

目前，我们的玩家可以在跳跃中改变主意。为了让跳墙成功，我们需要他在玩家落地的时候跳起来。

![](img/34acd1893133540ec5f34b462ebc61ae.png)

这个代码将允许玩家在跳中“改变主意”。

![](img/476cd5565c277c61b317ad2a31e4817d.png)

让我们把方向和速度变量移到。是一个圆形零件。

![](img/4c87c2ddabf979363cb2648df6720fac.png)![](img/1bd7033b6e1243ec455c26ce75cca3e5.png)

现在玩家一跳，就没有回头路了！这将有助于我们的墙跳。现在让我们开始编程！让我们创建一个 boolean 来获得 walljump 的许可。

![](img/7da9efb4999eace2c83d2e5e789f252d.png)

现在，在我们的控制器代码中，我们检查我们是否不在地面上，我们是否真的碰到了一堵墙，如果是这样，我们将把 _canWallJump 设置为 true。

![](img/ef5299ed7a6b9e80b9f57a0f0292812f.png)

为了知道表面法线，我们需要一个名为 _wallNormal 的变量容器。

![](img/29e70e4635628fc1f95863122ad23bae.png)

接下来我们需要思考的是，如果跳墙是真的，什么时候是假的？Update()下的第一个命令是一个很好的例子。

![](img/b558957f3219ae47b0f95380e4dbc6e2.png)

我们要跳墙的地方是 else 语句，玩家通常会第二次点击 jump。

![](img/fe9f426f052f72ad27b0e4805f9983bc.png)

在这里，如果玩家可以两次跳跃，他们很好，但如果我们碰到一堵墙，并且 _canWallJump 为真，那么我们将 yVelocity 乘以 _jumpHeight。我还把它放大了 0.2 倍来增加一点活力。记住速度的公式是方向乘以速度，我们将把 _wallNormal(方向)乘以 _speed 放入 _velocity 变量中。

应该可以了！让我们看看它的实际效果吧！

![](img/d6e958b39bf42b8c715940cad4d78d4e.png)

除了可见的小发明，我认为我们有一个功能性的墙跳！万岁。明天我们将学习推物体解谜。