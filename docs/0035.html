<html>
<head>
<title>AWS Lambda behind Application Load Balancer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应用程序负载平衡器后面的AWS Lambda</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/aws-lambda-behind-application-load-balancer-75f71413c9e6?source=collection_archive---------0-----------------------#2019-07-06">https://medium.com/nerd-for-tech/aws-lambda-behind-application-load-balancer-75f71413c9e6?source=collection_archive---------0-----------------------#2019-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/8e68611257837a586ce57d2322b6e25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9iXpKinenNwua8034N0SLQ.png"/></div></div></figure><div class=""/><p id="1530" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于包括Lambda在内的所有集成类型，API Gateway的集成超时硬限制为29秒。另一种方法是在后面使用lambda和ALB。通过这种方式，我们可以直接从lambda获得一个页面应用程序。此外，这种方法为我们提供了从同一个ALB提供多个域和服务的选项。在某种程度上，我们可以将EC2(较大的应用程序)、ECS(微服务)、内部部署(传统)和lambda(SPA或即席查询)都绑定到一个端点。路由将由ALB完成。现在让我们看看如何在ALB后面提供lambda的内容。</p><p id="ad6e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们首先创建一个lambda函数来服务内容。为此，我选择了AWS的一个预建的无服务器应用程序(ALB-Lambda-Target-WhatisMyIP)。这个模板创建了一个lambda函数和一个必要的IAM角色。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jo"><img src="../Images/572b7e98df51a59da1bd485c4dd1ba55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UDMI61NrGZzflD4byB1n2A.png"/></div></div></figure><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/79dd1a4fcf00ad3672c1628644f1e70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UbSiNeFHZVhgbQsY2nlp1g.png"/></div></div></figure><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ju"><img src="../Images/2caaad9f720412d353b5a714ada8867f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tY9zTyhYndQ5HH5fEzLRlQ.png"/></div></div></figure><p id="689a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦lambda被创建，我就开始从EC2控制台提供ALB。在此之前，只是一个快速参考如何ALB工程。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jv"><img src="../Images/f99dfde125b5339601d0530b5e9bc3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nwfFVzS0tesRR961Hs-BPQ.png"/></div></div></figure><p id="8a5f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">主要的变化是路由和注册lambda。因此，在目标类型中创建目标组时，我选择了最后一个选项(Lambda函数)。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jw"><img src="../Images/fc3691c52fa528194d29f05ffdcf0b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONU_ejRHh67jxLNpk_h6IQ.png"/></div></div></figure><p id="1880" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我需要向目标组注册我的lambda函数。很简单。我从下拉列表中选择了之前创建的函数。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jx"><img src="../Images/8a7a49a5c8338e10b2b7185dac9a3e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQ1VzrDpEMriNtkinlD5MA.png"/></div></div></figure><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jy"><img src="../Images/fd8c21f2b24c8f8849f8a685d80ba50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iyPA8pq0XezlrRM_K6veqw.png"/></div></div></figure><p id="c164" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建ALB后，我复制了URL并在浏览器中打开它。瞧，来自lambda的内容呈现出来了。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jz"><img src="../Images/a6bcba9bf9282656833b30da2b7a3e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOhwoqwSA6S99M_Ks2gsiw.png"/></div></div></figure><p id="ee65" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">只是为了看看基于路径的路由如何与lambda一起工作，这次我从示例中创建了一个Lambda(al b-Lambda-Target-hello world)。创建了一个与前一个类似的新目标(Hello)组。注册了第二个λ。之后，我编辑了如下的监听器规则。</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ka"><img src="../Images/bd930e5bebe389d63e02143c2c0f3896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DHYHZFYWLdMb2tb8Qgr_A.png"/></div></div></figure><p id="8656" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">再次完成后，我复制了ALB的网址并附加了/hello/</p><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kb"><img src="../Images/64003e13cd0cdffc99a1612d1207bad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrJQZUIQw3liZ-1kAGI9yw.png"/></div></div></figure><p id="5be7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是我们如何将lambda注册到ALB并提供内容。</p><p id="7b95" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望这有用。</p></div></div>    
</body>
</html>