<html>
<head>
<title>Dependency management with Gradle 101</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Gradle 101 进行依赖性管理</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/dependency-management-with-gradle-101-6c36fbeeeac4?source=collection_archive---------7-----------------------#2021-02-10">https://medium.com/nerd-for-tech/dependency-management-with-gradle-101-6c36fbeeeac4?source=collection_archive---------7-----------------------#2021-02-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="db89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">几年前，在软件领域，很多时候需要第三方工具来完成任何扩展功能的特定目标，有时以一种有效的方式将它们组合在一起是一件非常头疼的事情。</p><p id="b638" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开源软件背后的理念就是协作和透明。依赖关系调用也被称为“库”，所以基本上，开源项目也使用另一个项目，它也有其他依赖关系，或者它如何被称为传递依赖关系。</p><p id="6bb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开发人员已经了解到拥有一个标准化的构建工具是开发工作流程的一个重要部分，尤其是对于团队来说。</p><h2 id="dac1" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">格拉德勒</h2><p id="8394" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">Gradle 是一个为 Java 开发的工具，可以自动将代码打包给用户。简而言之，处理项目中存在的所有直接和可传递的依赖关系。</p><p id="e3b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Gradle 将构建过程作为任务来处理，任务在内部运行单元测试并使用特定的元数据创建 jars 文件。这种功能也存在于其他工具中，如 Maven 或 Apache 的 Ant。</p><p id="6cd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它公开了一种基于 Groovy 的 DSL 或特定于领域的语言(非常类似于 Java，但更灵活)来使用它。它有自己的惯例，但是如果你来自基于 C 语言或者甚至是相同的 Java，就不难理解。</p><h2 id="a7fc" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">演示项目</h2><p id="352f" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated"><em class="kd">注意:我将使用 IntelliJ IDEA 作为 IDE </em></p><p id="c178" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个项目的目标是将 CSV 库集成到我们的控制台 Java 应用程序中。</p><ol class=""><li id="1acd" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">在 IDE 已经打开的情况下，转到<code class="du kn ko kp kq b">New Project</code>，选择<code class="du kn ko kp kq b">Gradle</code>和<code class="du kn ko kp kq b">Java</code></li><li id="e6e0" class="ke kf hi ih b ii kr im ks iq kt iu ku iy kv jc kj kk kl km bi translated">添加您的<code class="du kn ko kp kq b">GroupID</code>(基础包)，在我的情况下将:<code class="du kn ko kp kq b">com.davidlares.reviews</code></li><li id="88a2" class="ke kf hi ih b ii kr im ks iq kt iu ku iy kv jc kj kk kl km bi translated">加上你的<code class="du kn ko kp kq b">ArtifactID</code>(你的罐子的名字)，对我来说就是:<code class="du kn ko kp kq b">reviews</code></li></ol><p id="3572" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，IDE 将创建一个项目，一切都将为我们设置好。</p><h2 id="7062" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">项目结构</h2><p id="c60e" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">一个简单的 Gradle 文件将包含以下文件。</p><p id="fa12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kn ko kp kq b">build.gradle</code>是一个配置文件，包含项目信息、所需的任何插件，以及用于处理直接和可传递依赖关系的存储库。在向导中定义了<code class="du kn ko kp kq b">group</code>值的地方，<code class="du kn ko kp kq b">version</code>是文件的版本，<code class="du kn ko kp kq b">apply plugin: 'java'</code>定义了文件夹的布局以及如何打包</p><p id="4f78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kn ko kp kq b">repositories()</code>是项目中定义的一种方法，它指示允许哪个存储库 Gradle 下载文件。更详细的信息可以在<a class="ae kw" href="https://docs.gradle.org/current/userguide/declaring_repositories.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到，它有很多替代品。</p><p id="268b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个文件是<code class="du kn ko kp kq b">gradlew</code>，它是一个 Gradle 包装器。如果有人想亲自动手做你的项目，你可以安装一个 Gradle 的自安装程序吗</p><p id="0521" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第三个文件是<code class="du kn ko kp kq b">gradlew.bat</code>，是相同的文件，但用于 Windows 操作系统。</p><p id="5b33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以下载最后一个文件并运行它们，这将安装 Gradle 工具及其项目依赖项</p><p id="7d62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，作为我们项目的一部分。我们在一个<code class="du kn ko kp kq b">/src</code>目录中有两个文件夹，一个是包含 Java 类的<code class="du kn ko kp kq b">main</code>文件夹，另一个是作为我们测试环境的<code class="du kn ko kp kq b">test</code>文件夹</p><p id="cf58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，我们已经准备好编码和处理外部依赖项了。</p><h2 id="d0fd" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">添加依赖关系</h2><p id="a849" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">您可能已经知道，Gradle 下载依赖项和传递依赖项，而且还提供了一个包缓存系统，可以在许多其他项目或库之间共享</p><p id="4435" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们详细描述我们的<code class="du kn ko kp kq b">build.gradle</code>,你将得到具有这个基本语法的<code class="du kn ko kp kq b">repositories()</code>方法</p><pre class="kx ky kz la fd lb kq lc ld aw le bi"><span id="da25" class="jd je hi kq b fi lf lg l lh li">repositories() {<br/>  mavenCentral()<br/>}</span></pre><p id="3952" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个闭包方法，它从 mavenCentral 存储库中返回一个调用。所以，这一切都发生在构建项目的时候。</p><p id="5720" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们需要一个 CSV 库，我们将使用 Apache commons CSV 库，<a class="ae kw" href="https://commons.apache.org/proper/commons-csv/" rel="noopener ugc nofollow" target="_blank">这里是库的链接。指令表明有一种方法可以从 Maven 仓库中提取它</a></p><p id="a447" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是文件库文档(Maven 版本)中的 XML 脚本</p><pre class="kx ky kz la fd lb kq lc ld aw le bi"><span id="ed7c" class="jd je hi kq b fi lf lg l lh li">&lt;dependency&gt;<br/>  &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br/>  &lt;artifactId&gt;commons-csv&lt;/artifactId&gt;<br/>  &lt;version&gt;1.8&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="108d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们需要将它包含到<code class="du kn ko kp kq b">dependencies</code>闭包中</p><p id="18e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kn ko kp kq b">testCompile</code>配置指令包含任意数量的命名参数。同时,<code class="du kn ko kp kq b">compile</code>部分设置要安装的库</p><p id="b5a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您需要在那里添加以下内容:<code class="du kn ko kp kq b">compile group: 'org.apache.commons', name; 'commons-csv', version: '1.8'</code>(基于描述 XML 的信息。在此之后，您将需要刷新项目并构建它，但它可以是自动的，您可以在 IDE 的 Gradle projects 选项卡下启用自动导入选项</p><p id="e0c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一种添加依赖项的简单方法:<code class="du kn ko kp kq b">compile ‘org.apache.commons:commons-csv:1.8’</code></p><p id="a0a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过在 ide 的<code class="du kn ko kp kq b">CLI</code>中运行<code class="du kn ko kp kq b">./gradlew dependencies</code>来检查是否列出了依赖项，如果成功，您将看到“dependencies”闭包下安装的每个依赖项的依赖树及其对应的语义版本。</p><p id="99ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Gradle 的另一个很酷的地方是，你可以用 Github/Gitlab 或其他什么东西给<code class="du kn ko kp kq b">gradle.build </code>文件版本化，每个人都可以得到相同依赖项的副本，而不用直接查看<code class="du kn ko kp kq b">jar</code>文件。</p><h2 id="8962" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">最后，怎么用？</h2><p id="822a" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">在我们的<code class="du kn ko kp kq b">src/main</code>文件夹中，添加一个<code class="du kn ko kp kq b">Main.java</code>文件，直接使用这个库。</p><p id="b1b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的包叫<code class="du kn ko kp kq b">Reviews</code>，完整路径是<code class="du kn ko kp kq b">com.davidlares.reviews</code></p><p id="62a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我为<code class="du kn ko kp kq b">Main.java</code>写的剧本:</p><pre class="kx ky kz la fd lb kq lc ld aw le bi"><span id="dbfb" class="jd je hi kq b fi lf lg l lh li">public class Main {<br/> public static void main(String[] args) {<br/>  try {<br/>   CSVPrinter p = new CSVPrinter(System.out, CSVFormat.EXCEL);<br/>   p.printRecord("David", "Lares", 22, "Backend");<br/>  } catch (IOException e) {<br/>   e.printStackTrace();<br/>  } <br/> } <br/>}</span></pre><p id="4709" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">IDE 将自动处理导入语句。</p><p id="e58d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这很简单，对吗？</p></div></div>    
</body>
</html>