<html>
<head>
<title>Windows Cybersecurity series: NTFS’s ADS.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Windows网络安全系列:NTFS的广告。</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/windows-cybersecurity-series-ntfss-ads-68f5333ef09e?source=collection_archive---------3-----------------------#2021-01-08">https://medium.com/nerd-for-tech/windows-cybersecurity-series-ntfss-ads-68f5333ef09e?source=collection_archive---------3-----------------------#2021-01-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0576" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可能知道，<strong class="ih hj"> NTFS </strong>是Windows操作系统中使用的默认文件系统，它基本上由表示属性和所包含的数据的子结构组成，但也有一个<strong class="ih hj">备用数据流部分</strong>或<strong class="ih hj"> ADS </strong>，这对许多应用程序来说几乎是不可见的。</p><p id="4928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“新”备用数据流的目的是以隐藏的方式将文件存储到系统中的其他文件或文件夹中，这些新的“隐藏文件”最终仍然是<strong class="ih hj"> NTFS </strong>结构，但是不能以简单的方式访问。要访问特定的替代内容，您必须使用命令行界面，尤其是使用<code class="du jd je jf jg b">type</code>和<code class="du jd je jf jg b">notepad</code>命令。</p><h2 id="a072" class="jh ji hi bd jj jk jl jm jn jo jp jq jr iq js jt ju iu jv jw jx iy jy jz ka kb bi translated">怎么做到的？</h2><p id="d2a7" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">为了证明这一点，我们需要两个。txt文件，相当简单。第一个叫<code class="du jd je jf jg b">normal.txt</code>，第二个就叫<code class="du jd je jf jg b">hidden.txt</code>。每个文件的内容无关紧要。</p><p id="8dea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，假设文件在用户桌面目录的根目录下，我们需要首先检查每个文件的散列，这是用<code class="du jd je jf jg b">Certutil</code>命令完成的，并且是绝对可选的。</p><pre class="kh ki kj kk fd kl jg km kn aw ko bi"><span id="03a5" class="jh ji hi jg b fi kp kq l kr ks">cd %userprofile%\desktop<br/>Certutil -hashfile normal.txt<br/>Certutil -hashfile hidden.txt</span></pre><p id="deae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此之后，让我们现在创建广告(备用数据流)。<code class="du jd je jf jg b">normal.txt</code>文件将托管<code class="du jd je jf jg b">hidden.txt</code>文件，甚至维护相同的哈希值。这是这样完成的:</p><p id="9bec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">type hidden.txt &gt; normal.txt:secret.txt</code></p><p id="fdd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将类型为<code class="du jd je jf jg b">hidden.txt</code>的输出通过管道传输到<code class="du jd je jf jg b">normal.txt</code>文件的<strong class="ih hj"> ADS </strong>中，该文件在本例中被称为<code class="du jd je jf jg b">secret.txt</code>，您可以随意对其进行命名，但必须记住以供以后调用。</p><p id="f21a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这之后，你可以<code class="du jd je jf jg b">dir</code>，你会看到两个文件完全相同。</p><p id="123c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好，现在让我们看看<strong class="ih hj">广告</strong>的内容。</p><p id="4b59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要查看存储在<strong class="ih hj"> ADS </strong>文件中的数据，我们需要执行<code class="du jd je jf jg b">notepad</code>命令。实际上，它会在那里显示内容。下面是怎么做的。</p><p id="3156" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">notepad normal.txt:secret.txt</code></p><p id="b789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我指的是<code class="du jd je jf jg b">normal.txt</code>文件的<strong class="ih hj">广告</strong>。</p><p id="eb49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最酷的是，你可以为一个广告创造尽可能多的<strong class="ih hj">广告</strong>。txt文件，只需在冒号(:)后引用不同的名称，就不会出现提示，以便您可以确认新的部分。</p><p id="223f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，你可以<strong class="ih hj">将<strong class="ih hj">广告</strong>内容扩展到一个新文件中，我喜欢称之为将<strong class="ih hj">广告</strong>内容“回滚”到一个文件中，无论如何，这是用<code class="du jd je jf jg b">expand</code>命令完成的。</strong></p><p id="00fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">expand normal.txt:secret.txt %userprofile%\desktop</code></p><p id="2c97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你<code class="du jd je jf jg b">dir</code>到<code class="du jd je jf jg b">Desktop</code>目录时，你会看到<code class="du jd je jf jg b">secret.txt</code>文件也显示了广告内容。</p><p id="4f88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，NFTS的整个广告为坏演员带来了一个全新的完整世界。这个简单的方法适用于隐藏信息，但也可以用来执行磁盘饱和。所以我放上面，这个新内容不会影响文件的哈希，可以被占用但不会被体现。</p><p id="ce55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这很容易从外部磁盘或闪存驱动器上泄露公司信息，而不会引起任何怀疑。但是像所有东西一样，也有对应的东西，那就是如果文件被压缩或格式化到不同的文件系统，数据可能会丢失。</p><p id="3766" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发挥你的创造力，并意识到这些可能发生的事件。</p><p id="d490" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐隐藏:)</p></div></div>    
</body>
</html>