<html>
<head>
<title>Running GUI based applications inside a Docker container.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Docker容器中运行基于GUI的应用程序。</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/running-gui-based-applications-inside-a-docker-container-645399ca2ef0?source=collection_archive---------3-----------------------#2021-04-06">https://medium.com/nerd-for-tech/running-gui-based-applications-inside-a-docker-container-645399ca2ef0?source=collection_archive---------3-----------------------#2021-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4638619acb585e1f431c8f56a735a7f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mzu4Ydin5w8-VJDvw4FcTA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2 Docker容器上的GUI应用程序</figcaption></figure><p id="3eb3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">今天，整个IT世界都在接受容器化技术，主要用于企业服务器应用程序。docker仍然是一个领先的平台，可以在由服务器组成的分布式环境中快速部署应用，并根据需要移动应用。作为应用程序可移植性的优先工具，使用Docker来安装和运行GUI应用程序的想法甚至没有被想到过。</p><p id="b7ac" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，由于Docker本质上是用于后端项目的，所以你通常将在后台运行的应用程序(或服务)容器化，如数据库、web服务器等。但是，你有没有想过部署GUI应用程序，运行在前台(显然！)?</p><p id="d4f4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你能在Docker中运行GUI应用程序吗？</p><p id="cdd4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">答案是肯定的！！</p><p id="1f7d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是使用普通的docker运行命令，你将无法看到这些应用程序或与之交互。为此，您需要将显示器与容器连接起来。在本文中，我们将讨论如何做到完全一样。</p><p id="a531" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，我们将看到如何在docker容器中运行firefox浏览器和gedit这样的文本编辑器，并在您的主机中与之交互。为此，首先需要将本地Linux机器的X11套接字转发到容器，以便容器可以直接使用它。</p><blockquote class="js jt ju"><p id="ec69" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr hb bi translated">X11是Unix操作系统中的GUI环境，是每个Linux桌面环境的一部分，如果不是，您需要安装XLaunch。</p></blockquote><p id="1640" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">完成此操作后，您需要转发display环境变量。即使在这之后，它也可能失败，因为我们还没有为X服务器主机设置权限。起初，这似乎是一项艰巨的任务。让我们通过代码来运行这些步骤。</p><ol class=""><li id="6fae" class="jz ka hi iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated"><strong class="iw hj">创建dockerfile </strong></li></ol><p id="8075" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你首先需要创建一个docker文件，这将有助于我们建立一个相同的形象。使用以下代码创建docker文件:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="024e" class="kr ks hi kn b fi kt ku l kv kw">#set centos:latest as base image<br/>FROM centos:latest</span><span id="453b" class="kr ks hi kn b fi kx ku l kv kw">#installation of dependencies<br/>RUN yum update -y<br/>RUN yum install firefox -y <br/>RUN yum install gedit -y<br/>RUN yum install xauth -y</span><span id="fb97" class="kr ks hi kn b fi kx ku l kv kw">#Exposing a port number<br/>EXPOSE 8687</span><span id="31f6" class="kr ks hi kn b fi kx ku l kv kw">#run cmd firefox as default <br/>CMD /usr/bin/firefox</span></pre><p id="5f43" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上面的<em class="jv"> dockerfile，</em>我们已经拉了一个Centos作为基础图像。之后，在上面运行yum update，然后安装一些GUI应用程序，如firefox、gedit和Xauth。然后它暴露端口8887并运行Firefox。<strong class="iw hj"> Xauth </strong>仅仅允许Docker容器访问显示服务器。</p><p id="0891" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.<strong class="iw hj">复制cookie以连接显示服务器</strong></p><p id="1648" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">要访问cookie，请在您的主机上运行以下命令:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="83b3" class="kr ks hi kn b fi kt ku l kv kw">xauth list</span></pre><p id="a5e5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出将是如下所示的形式。复制输出。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/1cfa4de55703cf55a7d18f6513511f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dt8-wrhy8t_9Az0UFgiE9Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">授权cookie</figcaption></figure><p id="a658" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">3.<strong class="iw hj">构建Docker映像</strong></p><p id="a3fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用以下命令使用上面创建的Docker文件创建Docker映像:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="2d3c" class="kr ks hi kn b fi kt ku l kv kw">docker build -t &lt;image-name&gt;:&lt;version&gt; .</span></pre><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/751e9839f0712d4f1db89ba653c98a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B238Y2PTWK9Nji5UI0XDSA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">构建图像</figcaption></figure><p id="dc09" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用上面创建的图像启动docker容器。以下是相同的完整命令:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="b037" class="kr ks hi kn b fi kt ku l kv kw">docker run -it --name &lt;container_name&gt; --net=host -e DISPLAY -v /tmp/.X11-unix &lt;image-name&gt; bash</span></pre><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/097ef176942cb5830d96c3c8dbd098a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ErCIbh1CkUA3b961MJ0sCw.png"/></div></div></figure><p id="2878" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Docker图像现在已经构建好了，它会弹出一个新的已创建图像的bash。</p><p id="4817" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">6.<strong class="iw hj">将cookie添加到列表中</strong></p><p id="1099" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，在bash中，您需要使用下面的命令添加上一步中复制的cookie。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="204f" class="kr ks hi kn b fi kt ku l kv kw">xauth add &lt;the output cookie copied eariler&gt;</span><span id="7aac" class="kr ks hi kn b fi kx ku l kv kw">#to verify that the host system is connected to the remote system<br/>xauth list</span></pre><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/420bbadfedd6aea4bcda084fc03ca6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GMKhsTs-F4IJb-98T-yrjg.png"/></div></div></figure><p id="17a3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">6.<strong class="iw hj">运行GUI应用程序</strong></p><p id="a6c0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">只需在bash中键入“firefox ”,您就会发现Firefox浏览器会在您的本地机器上弹出，尽管它是在Docker容器中运行的。执行类似的过程，您可以在Docker容器中运行几乎任何GUI应用程序，并在屏幕上显示它们并与之交互。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/6b8fec6102c83fed99eaa0ad520c6019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ti6sGVIz17kghcJLgQqajQ.png"/></div></div></figure><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/ed461224db0f7bbaf6fa07b40e317f09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SGqElKndxXRpgyN1RGGtVQ.png"/></div></div></figure><p id="6a08" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在Docker容器中运行GUI应用程序真的是一种很棒的体验，它永远不会损害/使用你的主机文件系统。这完全取决于你的Docker容器。</p><p id="c821" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我们看到了如何使用<em class="jv">Docker文件</em>创建Docker映像，并构建和运行该映像。我们还讨论了如何将Docker容器的显示连接到本地机器的显示，并访问了在本地机器上的容器内部运行的UI应用程序。通过这项技术，我们可以使用更多的GUI应用程序。</p><p id="3d4b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">到此结束吧！</p><p id="82c1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于任何类型的疑问，建议，反馈，请写在评论中，这样我就可以改进或更新我的内容。</p><p id="7ab4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">谢谢大家！</p><p id="2688" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">享受:-)</p></div></div>    
</body>
</html>