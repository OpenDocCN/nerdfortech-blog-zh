<html>
<head>
<title>Async Await in Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript中的异步等待</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/async-await-in-javascript-e29abc2bfab7?source=collection_archive---------9-----------------------#2021-07-09">https://medium.com/nerd-for-tech/async-await-in-javascript-e29abc2bfab7?source=collection_archive---------9-----------------------#2021-07-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a089" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何用async，await处理JavaScript中的异步执行</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/edce8a6aaf4f1bd936c025aa51bba37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DsnX6qB-fo8qYVyZHtY4lQ.jpeg"/></div></div></figure><p id="1ee7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">刚接触javascript的人似乎经常对如何处理Javascript的异步特性感到困惑。这篇文章通过实用且易于理解的例子来帮助你理解async await是什么，为什么和什么时候。</p><h1 id="c80d" class="kf kg hi bd kh ki kj kk kl km kn ko kp io kq ip kr ir ks is kt iu ku iv kv kw bi translated">为什么异步/等待introduced❔</h1><p id="cde7" class="pw-post-body-paragraph jj jk hi jl b jm kx ij jo jp ky im jr js kz ju jv jw la jy jz ka lb kc kd ke hb bi translated">异步编程肯定有它的好处，但当要求某段代码只有在上面的代码成功执行后才能执行时，这就成了一个问题，为了处理这种情况，JavaScript在ECMAScript 2017中引入了async/await。在引入async/await之前，曾经有过承诺。Async/Await使用promises本身，但使用async/ await比使用promises更容易，在本文中，我们将通过示例来了解如何使用async/await。</p><h1 id="ec02" class="kf kg hi bd kh ki kj kk kl km kn ko kp io kq ip kr ir ks is kt iu ku iv kv kw bi translated">让我们首先理解这个问题👀</h1><p id="1d93" class="pw-post-body-paragraph jj jk hi jl b jm kx ij jo jp ky im jr js kz ju jv jw la jy jz ka lb kc kd ke hb bi translated">考虑一个场景，你希望在家里制作橙汁，你首先需要从商店购买橙子，切开并去皮，最后加入榨汁机制作清爽的橙汁，但这些活动需要一些时间，需要按上述顺序完成，让我们将这些步骤写在代码中，并为每个任务关联一个时间，这个时间将是JavaScript的setTimeout函数。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lc"><img src="../Images/d10f9ae123811b9d8406d146004ea17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPkdWGo2wm-yq2oNAZCD8Q.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">用代码制作橙汁😋</figcaption></figure><p id="3d9f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们为每个任务创建了三个函数，通过调用executeTheProcess()函数中的这些函数来实现制作橙汁的最终目标，并通过setTimeOut为每个任务分配时间，我从商店购买橙子花费了更多时间，而将橙子切开/去皮并添加到榨汁机中花费的时间则更少。现在我们运行executeTheProcess()函数来启动橙汁制作过程，让我们看看得到的输出。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lh"><img src="../Images/86d82e0aeeab7448bcddc038096cd4a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*cqlRSemzVdJjFMHmBo6ZXw.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">不，这不是我们想要的过程，☹</figcaption></figure><p id="c395" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">哦！！，我们肯定不是这样做橙汁的！！。我们来了解一下这里发生了什么。</p><p id="3a17" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们想先执行buyOranges()函数，但它有2秒的超时，由于JavaScript的异步执行，这被添加到eventloop中，并开始执行下一个函数，即cutAndPeelOranges()和addOrangesInJuicer()，此时2秒的等待时间已完成buyOranges()函数及其执行已完成，但这影响了使juice处理这个问题的步骤async/await在JavaScript中引入。</p><h1 id="460a" class="kf kg hi bd kh ki kj kk kl km kn ko kp io kq ip kr ir ks is kt iu ku iv kv kw bi translated">理解async/await以及它如何帮助解决问题😁</h1><p id="5b14" class="pw-post-body-paragraph jj jk hi jl b jm kx ij jo jp ky im jr js kz ju jv jw la jy jz ka lb kc kd ke hb bi translated"><strong class="jl hj"> Async/Await与promises </strong>一起工作，该函数在成功执行时返回一个promises<strong class="jl hj">resolve()</strong>或者可以使用<strong class="jl hj"> reject() </strong>拒绝。<strong class="jl hj"> Await关键字将保持进一步的执行，直到函数</strong>返回承诺。当一个函数被标记为async only时，那么await关键字可以在其中使用。通过将<strong class="jl hj">父函数标记为async </strong>并将返回承诺的<strong class="jl hj">子函数标记为await </strong>，可以暂停执行直到完成，然后继续下一行。如果你还不知道到底要做什么，不要担心，一旦我们看到并理解了下面的例子，就清楚了。</p><p id="7081" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在让我们使用async/await来解决橙汁问题</p><p id="2673" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们将从三个子函数buyOranges()、cutAndPeelOranges()、addOrangesInJuicer()中的每一个返回promise，并将父函数executeTheProcess()标记为async，然后通过将它们标记为await来调用父函数中的上述每一个函数。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es li"><img src="../Images/6f24e86316818722fe75f5544aeeb7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hOD4vwlYueDmtdon5L6bg.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">使用async/await制作橙汁😋</figcaption></figure><p id="69ea" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如上面的代码示例所示，我们已经从三个函数中的每一个函数返回了promise，并且该函数通过使用resolve()关键字解析promise，我们希望打印的输出也在resolve关键字内，如果不是console，而是您想要返回某个值，您可以使用resolve关键字作为resolve("some value ")返回相同的值；。</p><p id="49a0" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">来到executeProcess()函数，您可以看到它已被标记为async，并且其中的所有子函数都被标记为await，现在下一行代码将保持挂起，直到标记为await的上一行代码的执行没有完成。因此，现在将首先执行buyOranges()，执行将持续2秒钟，然后执行cutAndPeelOranges()，执行将持续1秒钟，最后执行addOrangesInJuicer()。现在让我们看看输出</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lj"><img src="../Images/a2899851c70f558a11db8355f1cfeaa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*Dq7aUypfAvhpbxB1dPgjiA.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">成功制备橙汁✨🎉😋</figcaption></figure><p id="841f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">任务完成！！！😎🍊🍊🍊</strong></p><p id="d053" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">完整代码示例:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">asyn_await示例完整代码</figcaption></figure><h1 id="0b23" class="kf kg hi bd kh ki kj kk kl km kn ko kp io kq ip kr ir ks is kt iu ku iv kv kw bi translated">关闭</h1><p id="6d7e" class="pw-post-body-paragraph jj jk hi jl b jm kx ij jo jp ky im jr js kz ju jv jw la jy jz ka lb kc kd ke hb bi translated">我们已经了解了如何使用async/await关键字和承诺将同步行为传递给JavaScript代码的异步特性。</p><p id="1ae1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你觉得这篇文章有帮助，请鼓掌👏并与你的朋友和同事分享这些知识。不断学习📖，保持增长📈</p></div></div>    
</body>
</html>