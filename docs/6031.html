<html>
<head>
<title>Visualizing what a Neural Network thinks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化神经网络的想法</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/visualizing-what-a-neural-network-thinks-dc30bfafec3f?source=collection_archive---------4-----------------------#2021-12-21">https://medium.com/nerd-for-tech/visualizing-what-a-neural-network-thinks-dc30bfafec3f?source=collection_archive---------4-----------------------#2021-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="68b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，神经网络并不真正“思考”，但它们肯定有自己的观点。如果你给一个卷积神经网络，比如说一个分类器，输入一幅图像，它会告诉你它“认为”是什么，但有时你可能会想知道是什么促成了这个特定的决定，试图“调试”你的网络。</p><p id="4ec4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，在设计性别分类神经网络时，我注意到网络正在关注耳朵，它学会了识别它们。原来耳朵可以用来检测性别，所以这是一个好迹象，表明我的网络正在寻找它们。</p><p id="6fb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文的其余部分，我们将看到如何使用显著图来了解神经网络认为什么是重要的。以下内容主要摘自我在Krishtof Korda的帮助下为Packt Publishing撰写的《自动驾驶汽车的实践愿景和行为》一书。在本章的前一部分，我们训练了一个神经网络来学习如何在模拟器Carla中自动驾驶汽车，网络的模型存储在一个名为<strong class="ih hj">模型</strong>的变量中。</p><h1 id="e66b" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">可视化显著图</h1><p id="630f" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">为了理解神经网络关注的是什么，我们应该使用一个实际的例子，所以让我们选择一个图像:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/07cc118c7c60bac0d08d3014aa20478b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZ-zGdTYzVvQ72s0-PQQtA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">测试图像</figcaption></figure><p id="5d0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们必须在这条路上开车，作为人类，我们会注意车道和墙，尽管不可否认，墙没有之前的最后一条车道重要。<br/>我们已经知道如何了解像DAVE-2这样的<strong class="ih hj"> CNN </strong>(卷积神经网络<strong class="ih hj">的缩写</strong>)正在考虑什么:由于卷积层的输出是一个图像，我们可以将其可视化如下:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kx"><img src="../Images/111db6a2c857f538dbeffdfc3593dad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ecoxYvIZUb_lVfd6nKGl5g.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第一卷积层的部分激活</figcaption></figure><p id="fcad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个很好的起点，但我们想要更多。我们希望了解哪些像素对预测贡献最大。为此，我们需要得到一个<strong class="ih hj">显著图</strong>。</p><p id="2a3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Keras不直接支持它们，但是我们可以使用keras-vis。您可以使用pip安装它，如下所示:</p><figure class="ki kj kk kl fd km"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="581b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获得显著图的第一步是创建一个模型，该模型以我们模型的输入开始，但以我们想要分析的图层结束。生成的代码与我们看到的激活非常相似，只是为了方便起见，我们还需要层的索引:</p><figure class="ki kj kk kl fd km"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="01dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然在我们的情况下没有必要，但您可能希望将激活更改为线性，然后重新加载模型:</p><figure class="ki kj kk kl fd km"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="e4ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，只需要调用<strong class="ih hj">visualize _ studentity</strong>():</p><figure class="ki kj kk kl fd km"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="6699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们对最后一层(输出)的显著图感兴趣，但作为练习，我们将遍历所有卷积层，看看它们理解了什么。<br/>让我们看看第一个卷积层的显著性图:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es la"><img src="../Images/d9051b547e19510aff47bf458c4d4089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76ljJ0jdDVslRBEuFPwPbA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第一卷积层的显著图</figcaption></figure><p id="cd75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">印象不深，因为没有显著性，我们只能看到原始图像。<br/>让我们看看第二层的地图是什么样的:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lb"><img src="../Images/aac089d9f0086320d2d36df0fecb2fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yw6WJJwv16HoqEZvQZTpSQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第二卷积层的显著图</figcaption></figure><p id="aa8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个进步，但即使我们在中线，在墙上和右车道后的土地上看到一些注意，也不是很清楚。让我们看看第三层:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lc"><img src="../Images/a90fb28e2cd1a534de84ae70be9957a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_t8r0VPykKcXoxxlEfh3w.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第三卷积层的显著图</figcaption></figure><p id="6481" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们正在谈话！我们可以看到对中间和左边线的极大关注，以及对墙和右边线的一些关注。电视网似乎在试图了解这条路的尽头在哪里。我们再来看第四层:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ld"><img src="../Images/a5f9219c524f72c203af9755e6c52f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h148KcnZhxU19blphSbI2A.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第四卷积层的显著图</figcaption></figure><p id="bf2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里我们可以看到，注意力大多集中在中线，但在左线和墙上也有注意力的火花，在整条路上也有一点。<br/>我们还可以检查第五个也是最后一个卷积层:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es le"><img src="../Images/e9124331f6123cd67924139a0088b403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RZi_oU9inc_d62lbPUH1EQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第五卷积层的显著图</figcaption></figure><p id="814a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第五层与第四层相似，只是在左边的线条和墙上多了一些关注。<br/>我们也可以可视化密集层的显著图。让我们看看最后一层的结果，这是我们认为的这张图像的真正显著性图:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lf"><img src="../Images/6c96aa4fc8fd31036dc2dc9dbdd7bc50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6r2vEYdW7JJE40gN3h3uvg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">输出层的显著图</figcaption></figure><p id="246a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后一个显著性图是最重要的一个，它显示了对中心线和右侧线的极大关注，加上对右上角的一些关注，这可能是试图估计与右侧车道的距离。我们还可以看到墙上和左侧车道上的一些注意。所以，总的来说，看起来很有希望。<br/>让我们试试另一张图片:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lg"><img src="../Images/402685f2318ea92880e1031d5f204d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRiBiHS7eaEVHf5qj5b1Ww.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第二张测试图像</figcaption></figure><p id="dd3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个有趣的图像，因为它是从网络没有被训练的道路的一部分拍摄的，但是它仍然表现得很好。<br/>我们来看看第三个卷积层的显著图:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lh"><img src="../Images/5374100acd894e87c0e6eeedd2abcb9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccgFNmoECDV1L_CTl1YF5w.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第三卷积层的显著图</figcaption></figure><p id="3145" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络似乎非常关心路的尽头，它似乎也检测到了几棵树。如果它受过刹车训练，我敢打赌它会这样做！</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es li"><img src="../Images/e36334074e42369ac35785b38c8fcdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_yhen-uVUwg-meP6TsPdA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">输出层的显著图</figcaption></figure><p id="2395" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这与前一个非常相似，但是有一些对中线和右线的注意，以及一般道路上的少量注意。我觉得不错。<br/>让我们来看最后一张图片，它来自教何时右转的培训:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lj"><img src="../Images/8e3d6da876a1d468a04b7c6fecfa2f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCrJ4drx_7FyYRWElY3kVQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第三张测试图像</figcaption></figure><p id="56fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是它的最终显著图:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lk"><img src="../Images/1bda7c68cea2615086844039e26b64dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6zRr13EnT6IOMKsvz6MKw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">输出层的显著图</figcaption></figure><p id="56be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以看到神经网络主要关注右边的线，同时也关注整个道路，还有一些注意力集中在左边的线上。<br/>正如你所看到的，显著图是一个有效的工具，可以更好地理解网络的行为，并对其对世界的解释进行某种健全性检查。</p><h1 id="73f4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">临终遗言</h1><p id="e58b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">文章到此结束。在书中，本章的其余部分解释了如何将神经网络与模拟器Carla集成，这样你就可以实际体验自动驾驶汽车，尽管是在模拟器中；它还解释了如何使用生成器来支持使用更大的数据集进行训练，以及进行更高级的数据扩充。</p><p id="438c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，如果你对自动驾驶汽车使用的一些技术感到好奇，请考虑一下<a class="ae jd" href="http://packt.live/3jimRoS" rel="noopener ugc nofollow" target="_blank">自动驾驶汽车的实践愿景和行为</a>这本书。它还谈到了车道检测，神经网络，物体检测，语义分割，传感器，激光雷达，地图，控制等等。</p></div></div>    
</body>
</html>