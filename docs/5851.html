<html>
<head>
<title>From Zero to Hero Django Admin: ModelAdmin Class (Part2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零到英雄Django Admin: ModelAdmin类(第二部分)</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/from-zero-to-hero-django-admin-modeladmin-class-part2-2c8665d6cd5?source=collection_archive---------0-----------------------#2021-11-25">https://medium.com/nerd-for-tech/from-zero-to-hero-django-admin-modeladmin-class-part2-2c8665d6cd5?source=collection_archive---------0-----------------------#2021-11-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="636b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Faker包，ModelAdmin类，ModelAdmin类的基本字段</h2></div><p id="c479" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在之前的故事中，我们已经深入到Django管理应用程序中。你可以从<a class="ae jt" rel="noopener" href="/nerd-for-tech/from-zero-to-hero-django-admin-set-up-part1-253cd3a5a723">这里</a>进入。在这个故事中，我们将继续尝试理解什么是<code class="du ju jv jw jx b">ModelAdmin</code>类以及我们如何使用它。另外，您可以从下面获取代码。</p><div class="jy jz ez fb ka kb"><a href="https://github.com/mebaysan/DjangoAdminForMedium" rel="noopener  ugc nofollow" target="_blank"><div class="kc ab dw"><div class="kd ab ke cl cj kf"><h2 class="bd hj fi z dy kg ea eb kh ed ef hh bi translated">GitHub-mebaysan/djangodadminformedium:为中型Django管理博客系列创建</h2><div class="ki l"><h3 class="bd b fi z dy kg ea eb kh ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="kj l"><p class="bd b fp z dy kg ea eb kh ed ef dx translated">github.com</p></div></div><div class="kk l"><div class="kl l km kn ko kk kp kq kb"/></div></div></a></div><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/621589dae0758c3f0ab73e538a132334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o22fbIZ82oppUXc8jHfeDQ.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated"><a class="ae jt" href="https://unsplash.com/@faisaldada?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Faisal </a>在<a class="ae jt" href="https://unsplash.com/@faisaldada?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="086f" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">介绍</h1><p id="d4b9" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">在这一节中，我将说明我们在阅读这个故事时将会做些什么。</p><ul class=""><li id="0a6e" class="md me hi iz b ja jb jd je jg mf jk mg jo mh js mi mj mk ml bi translated">扩展<code class="du ju jv jw jx b">Blog</code>模型</li><li id="6de5" class="md me hi iz b ja mm jd mn jg mo jk mp jo mq js mi mj mk ml bi translated">安装<code class="du ju jv jw jx b">Faker</code>包并创建虚拟条目</li><li id="5cd0" class="md me hi iz b ja mm jd mn jg mo jk mp jo mq js mi mj mk ml bi translated">基本<code class="du ju jv jw jx b">ModelAdmin</code>属性:<code class="du ju jv jw jx b">list_filter</code>、<code class="du ju jv jw jx b">list_display</code>、<code class="du ju jv jw jx b">list_per_page</code>、<code class="du ju jv jw jx b">ordering</code>、<code class="du ju jv jw jx b">search_fields</code>、<code class="du ju jv jw jx b">prepopulated_fields</code>、<code class="du ju jv jw jx b">readonly_fields</code></li></ul><h1 id="f2e4" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">扩展博客模型</h1><p id="dea8" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我将创建<code class="du ju jv jw jx b">models.py</code>文件，并将<code class="du ju jv jw jx b">is_published</code>和<code class="du ju jv jw jx b">slug</code>字段添加到<code class="du ju jv jw jx b">Blog</code>模型中。这些字段将帮助我们过滤数据，以确定blog是否已发布，并展示我们如何使用一些ModelAdmin属性。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="2f19" class="mv lh hi jx b fi mw mx l my mz">class Blog(models.Model):</span><span id="ea07" class="mv lh hi jx b fi na mx l my mz">   title = models.CharField(max_length=255)</span><span id="9ce6" class="mv lh hi jx b fi na mx l my mz">   content = models.TextField()</span><span id="30fe" class="mv lh hi jx b fi na mx l my mz">   added_date = models.DateTimeField(auto_now_add=True)</span><span id="ffff" class="mv lh hi jx b fi na mx l my mz">   updated_date = models.DateTimeField(auto_now=True)</span><span id="af2a" class="mv lh hi jx b fi na mx l my mz">   is_published = models.BooleanField(default=False,null=False,blank=False)    <br/> <br/>   slug = models.SlugField(null=True,blank=True)</span><span id="1e75" class="mv lh hi jx b fi na mx l my mz">   class Meta:</span><span id="3d55" class="mv lh hi jx b fi na mx l my mz">      verbose_name = 'My Blog'</span><span id="09a8" class="mv lh hi jx b fi na mx l my mz">      verbose_name_plural = 'My Blogs'</span><span id="b4fe" class="mv lh hi jx b fi na mx l my mz">   def __str__(self):</span><span id="e2fd" class="mv lh hi jx b fi na mx l my mz">      return self.title</span></pre><p id="32e5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我执行下面的命令将更改推送到数据库。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="9431" class="mv lh hi jx b fi mw mx l my mz">python manage.py makemigrations &amp;&amp; python manage.py migrate</span></pre><h1 id="fcfe" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">安装Faker并创建虚拟条目</h1><p id="d542" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我使用<code class="du ju jv jw jx b">pip install Faker</code>在我的虚拟环境中安装<code class="du ju jv jw jx b">Faker</code>包。然后，我使用<code class="du ju jv jw jx b">python manage.py shell</code>进入Django shell。我在打开的shell中执行下面的代码。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="e2ff" class="mv lh hi jx b fi mw mx l my mz">&gt;&gt;&gt; from blog.models import Blog<br/>&gt;&gt;&gt; from faker import Faker</span><span id="069a" class="mv lh hi jx b fi na mx l my mz">&gt;&gt;&gt; faker_instance = Faker()</span><span id="7c79" class="mv lh hi jx b fi na mx l my mz">&gt;&gt;&gt; for i in range(150):<br/>...     Blog(title = faker_instance.name(), content=faker_instance.paragraph(), is_published = True if i % 2 == 0 else False).save()</span></pre><p id="4b80" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过上面的代码，我们创建了151个<code class="du ju jv jw jx b">Blog</code>条目。这似乎是非常基本的Python代码，因此我不会深入研究上面的代码。</p><h1 id="98d9" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">ModelAdmin简介</h1><p id="994e" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">此后，我们将只处理<code class="du ju jv jw jx b">admin.py</code>文件。我们使用<code class="du ju jv jw jx b">ModelAdmin</code>类来创建模型的管理界面。然后，正如我们在前面的故事中所做的那样，我们将接口类和原始模型类一起推送到<code class="du ju jv jw jx b">admin.site.register</code>函数。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es nb"><img src="../Images/91c0dfa7758865bec9ec34904876b877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*jIylAL_6A1ERjiH1wxAYFA.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><p id="f729" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在什么都不会改变，因为尽管我们一起注册了接口类和模型类，但是我们没有编写任何<code class="du ju jv jw jx b">ModelAdmin</code>属性。</p><h1 id="80e8" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">模型管理属性</h1><h2 id="c574" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">列表_显示</h2><p id="ad41" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">如果你的代码和我的一样，当你进入<code class="du ju jv jw jx b">My Blogs</code>部分时，你应该会在屏幕上看到下面的内容。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/87d5a8925b20b97bfdf50daaeab24abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SeVS2C6_1jUWhIWPj8FfDw.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">图片作者。在您的计算机上，屏幕可能看起来发生了变化。我在Mac上使用了深色主题。</figcaption></figure><p id="f58f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们想在这个表中添加新的字段，我们需要使用<code class="du ju jv jw jx b">list_display</code>字段来管理接口类。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="47dc" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):</span><span id="ac86" class="mv lh hi jx b fi na mx l my mz">   list_display =    ['title','added_date','updated_date','is_published']</span></pre><p id="af54" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以在<code class="du ju jv jw jx b">My Blogs</code>部分看到表格上的字段。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/6e0f2e0d31acb037107aadeea9a7ffb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*da6pFcA7EjcLS4cKLlKpWQ.png"/></div></div></figure><h2 id="b775" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">每页列表</h2><p id="4283" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">默认情况下，管理应用程序每页显示100个条目。我们可以通过使用管理接口类中的<code class="du ju jv jw jx b">list_per_page</code>字段来改变每页显示的条目数。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="6702" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):<br/>   ...<br/>   list_per_page = 25</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/5cfc2adc80507b333186e36706cae14a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*orWiHgNgpYd2H5UgLUO3Dg.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><h2 id="f51b" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">搜索_字段</h2><p id="e23b" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我们可以通过添加这个字段来添加一个搜索栏。我们需要在这个字段中设置我们的搜索字段。当我们在条目中搜索一些关键字时，管理应用程序将根据我们在管理接口类的<code class="du ju jv jw jx b">search_fields</code>中设置的字段进行搜索。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="830f" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):<br/>   ...   <br/>   search_fields = ['title','content']</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/2aef6b14412b6809a2fe74b6ea293721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*naUIXLC0bgkUpX3e9nNjFA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><h2 id="fbec" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">排序</h2><p id="66c0" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我们可以改变表中的顺序。为此，我们需要在管理接口类中使用<code class="du ju jv jw jx b">ordering</code>字段。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="e28c" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):<br/>   ...<br/>   ordering = ['title', '-updated_date']</span></pre><p id="8db5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们按照A-Z和降序对条目进行排序<code class="du ju jv jw jx b">updated_date</code>。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/eb5695dc32a22710ccf859a89c11ccfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxA3ujaFE-69Y9K6CW-ENw.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><h2 id="0ce8" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">列表_过滤器</h2><p id="7357" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我们还可以在右边栏添加过滤器。为此，我们应该在管理接口类中使用<code class="du ju jv jw jx b">list_filter</code>字段。我们可以将它用于非布尔字段，但我们将在后面看到这一点。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="fb4a" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):<br/>   ...<br/>   list_filter = ['is_published']</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/0e1a6dc2ad59e6156e6d271dd3cd0e5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rFnwkUFjFA2BYI0neLxuxQ.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><h2 id="0be9" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">预填充_字段</h2><p id="9eb7" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我们用这个场同时操纵一些场。举个例子，我们有一个废料场。我们想在写标题的时候设置这个slug。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="85c0" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):<br/>   ...<br/>   prepopulated_fields = {'slug': ['title']}</span></pre><p id="fd2f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与上面提到的字段不同，我们应该将其设置为字典类型。字典的键必须反映被操作的字段，字典的值必须反映将操作键字段的字段。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/21f2040b8651305eddec46ee127eb3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uHXx-3JR5o-ZiggW29X3g.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><h2 id="93f0" class="mv lh hi bd li nc nd ne lm nf ng nh lq jg ni nj ls jk nk nl lu jo nm nn lw no bi translated">只读字段</h2><p id="5a60" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">如果有些字段我们不想让它们可编辑，我们可以使用<code class="du ju jv jw jx b">readonly_fields</code>字段只显示它们。</p><pre class="ks kt ku kv fd mr jx ms mt aw mu bi"><span id="1f6e" class="mv lh hi jx b fi mw mx l my mz">class BlogAdmin(admin.ModelAdmin):<br/>   ...<br/>   readonly_fields = ['added_date', 'updated_date']</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es np"><img src="../Images/7b628519740e6317ed6d45439dc11d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1rhitndNqm6FXSoQxtTtEw.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">作者图片</figcaption></figure><h1 id="a137" class="lg lh hi bd li lj lk ll lm ln lo lp lq io lr ip ls ir lt is lu iu lv iv lw lx bi translated">最后</h1><p id="7719" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">希望你在阅读的时候获得了一些信息，并且喜欢它。我喜欢写作，希望你也喜欢。您可以从下面访问GitHub repo。</p><div class="jy jz ez fb ka kb"><a href="https://github.com/mebaysan/DjangoAdminForMedium" rel="noopener  ugc nofollow" target="_blank"><div class="kc ab dw"><div class="kd ab ke cl cj kf"><h2 class="bd hj fi z dy kg ea eb kh ed ef hh bi translated">GitHub-mebaysan/djangodadminformedium:为中型Django管理博客系列创建</h2><div class="ki l"><h3 class="bd b fi z dy kg ea eb kh ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="kj l"><p class="bd b fp z dy kg ea eb kh ed ef dx translated">github.com</p></div></div><div class="kk l"><div class="nq l km kn ko kk kp kq kb"/></div></div></a></div><p id="ca1c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在官方<a class="ae jt" href="https://docs.djangoproject.com/en/3.2/ref/contrib/admin/" rel="noopener ugc nofollow" target="_blank">文档</a>中获得更多细节。</p><p id="ff63" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">亲切的问候。</p></div></div>    
</body>
</html>