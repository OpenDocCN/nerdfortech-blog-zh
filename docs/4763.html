<html>
<head>
<title>Implementing a life system | Unity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实施生命系统| Unity</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/implementing-a-life-system-unity-e2a9c6b44db5?source=collection_archive---------12-----------------------#2021-08-06">https://medium.com/nerd-for-tech/implementing-a-life-system-unity-e2a9c6b44db5?source=collection_archive---------12-----------------------#2021-08-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="5cbb" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">统一指南</h2><div class=""/><div class=""><h2 id="e124" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">如何用 Unity 实现生命系统的快速指南</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/7f6d173b53586d419ed3d72385e85da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*q9CfJD0gi1kHQjRtRTEqgA.gif"/></div></div></figure><p id="4960" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated"><strong class="ju hs">目标</strong>:实现一个系统来统一处理玩家的生活。</p><p id="a59b" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">在上一篇文章中，我介绍了<a class="ae ko" rel="noopener" href="/nerd-for-tech/dynamic-platforms-unity-28cfe83af90">如何用 Unity </a>创建动态平台。现在，是时候实现一种方法来处理玩家在我们平台游戏中的生活了。</p><h1 id="01ca" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">处理坠落</h1><p id="57a8" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">如果你看过<a class="ae ko" href="https://fas444.medium.com/" rel="noopener">我的上一篇帖子</a>，你会记得我们正在使用原始资产开始创建一个平台游戏。目前，在下一个场景中，我们有一个带有一些平台和收藏品的播放器:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/c9bde72e34aed3e362408633d7085437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QvXlukygTBAJKFBWOt6CJw.png"/></div></div></figure><p id="097e" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">因此，为了处理玩家摔倒的情况，让我们从创建一个空的游戏对象开始，它代表场景中让玩家重生的点:</p><div class="jh ji jj jk fd ab cb"><figure class="lm jl ln lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/d3b7b003efd020ee7317d11c7db851bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/1*uYZ-mLIPkdiAFRmcj_vHKw.gif"/></div></figure><figure class="lm jl ls lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/cff83888fcce792c0b43b349d3c8a5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1468/1*36TFKssvGXUybPClszeb7A.gif"/></div></figure></div><p id="f026" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">然后，让我们创建一个新的游戏对象，它包括一个盒子碰撞器组件，并启用了<strong class="ju hs"> <em class="lt"> Is Trigger </em> </strong>属性来表示玩家将失去一条生命的区域:</p><div class="jh ji jj jk fd ab cb"><figure class="lm jl lu lo lp lq lr paragraph-image"><img src="../Images/fd7c0e6ff7ace32c9f76fc73b36eb5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/1*qylVVTxUo0LuDEVoeR8ENw.gif"/></figure><figure class="lm jl lv lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/77abdf20c2ea8f1889cfdec637cea703.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/1*ILgCLXpAqBFbjTtIgA_BrQ.gif"/></div></figure></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/1b40a1e485ffd4f31a226c8a3b24a00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*L9wZT-oGlFhVL9ZD1xZpjg.gif"/></div></div></figure><p id="e033" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">一旦碰撞器实现了我们的目的，让我们将游戏对象移动到期望的区域:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/90b3d09214671e4686d3fd995365cb0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xLitxLFOzWrSQ5r7OVIuzg.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">当它掉落并触发碰撞器时，玩家将失去一条生命。</figcaption></figure><p id="cdd8" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">现在，让我们创建一个新的脚本并附加到游戏对象上，以便处理与玩家的触发冲突:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es ma"><img src="../Images/6526210e248ddf849002ed8fbb2f56d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/1*dKJX-SBo8kOUbimV29fcOQ.gif"/></div></figure><p id="0b01" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">然后，让我们打开脚本并在顶部包含<strong class="ju hs">系统</strong>名称空间:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mb"><img src="../Images/32400d4027e900b2c34774762c74723a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*XmmIpIW8ABxdhnFcNCimwQ.png"/></div></figure><p id="e4ad" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">接下来，让我们创建一个新的公共静态动作委托，它将代表玩家的每次摔倒:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mc"><img src="../Images/4bde84c4b98a641f8df12f660daeaaaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*ABCPDDF8Rgbl0IXwhBTgeQ.png"/></div></figure><p id="8a38" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">如果您想了解有关动作代表的更多信息，可以访问 Microsoft 文档:</p><div class="md me ez fb mf mg"><a href="https://docs.microsoft.com/en-us/dotnet/api/system.action?view=net-5.0" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hs fi z dy ml ea eb mm ed ef hr bi translated">动作委托(系统)</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">封装没有参数且不返回值的方法。公共委托 void Action()；公共…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">docs.microsoft.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jq mg"/></div></div></a></div><p id="936a" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">现在，让我们使用<strong class="ju hs"> OnTriggerEnter </strong>方法来触发与其他碰撞器的碰撞。在这个方法中，我们将通过比较另一个碰撞器的标签来检查碰撞是否发生在玩家身上。如果碰撞器属于玩家，我们将调用动作委托(如果不为空)在玩家摔倒时采取相应的动作:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mv"><img src="../Images/de180500e6dc1fb4105df75a3efffab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*wCYgB1gIYDYIwSNEsljIEA.png"/></div></figure><h1 id="fb44" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">生命系统</h1><p id="6de8" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">现在，为了处理生命系统，让我们打开玩家脚本并包含<strong class="ju hs">场景管理</strong>名称空间，因为我们将在玩家生命耗尽时重启关卡:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mw"><img src="../Images/51edfdca4edd6ac4ee8b3534b9fe6ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*V7OTD3Cy2JCJ1rje4ZcGQg.png"/></div></figure><p id="9369" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">然后，让我们创建:</p><ul class=""><li id="b873" class="mx my hi ju b jv jw jy jz kb mz kf na kj nb kn nc nd ne nf bi translated">一个私有变量存储玩家的总寿命。</li><li id="a98c" class="mx my hi ju b jv ng jy nh kb ni kf nj kj nk kn nc nd ne nf bi translated">返回私有变量的值的公共属性。</li><li id="61ca" class="mx my hi ju b jv ng jy nh kb ni kf nj kj nk kn nc nd ne nf bi translated">存储重生点引用的私有变量。</li></ul><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nl"><img src="../Images/ad32bcdb7aa11cbe1c3eb02b82e7cd35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*24cnoO7icdzOfUCz3SVHRA.png"/></div></figure><p id="1bbb" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">现在，让我们创建一个新的方法来处理玩家的伤害。当该方法被调用时，它将:</p><ul class=""><li id="e3c5" class="mx my hi ju b jv jw jy jz kb mz kf na kj nb kn nc nd ne nf bi translated">从相应的变量中减去一个生命。</li><li id="a2b9" class="mx my hi ju b jv ng jy nh kb ni kf nj kj nk kn nc nd ne nf bi translated">如果玩家生命耗尽，恢复等级。</li><li id="0e6d" class="mx my hi ju b jv ng jy nh kb ni kf nj kj nk kn nc nd ne nf bi translated">禁用角色控制器组件以平滑重生。</li><li id="b14d" class="mx my hi ju b jv ng jy nh kb ni kf nj kj nk kn nc nd ne nf bi translated">改变玩家的位置到重生点。</li><li id="5c6d" class="mx my hi ju b jv ng jy nh kb ni kf nj kj nk kn nc nd ne nf bi translated">在一定时间后启动一个协程来启用字符控制器。</li></ul><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nm"><img src="../Images/39bddc0348ae73134a5df17f065cb1ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*NUWXPvriqcQzzokxOGQhQA.png"/></div></figure><p id="9f9e" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">启用角色控制器的协程是下一个:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nn"><img src="../Images/42c18bc4f625f7782cd626e7f1b8d41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*wr-CtbqO6uRqZ08tBSgBpg.png"/></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">这样，我们将等待半秒钟，直到控制器再次启用。</figcaption></figure><p id="7957" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">最后，让我们将该方法添加到从死区开始的动作委托中的<strong class="ju hs"> Start </strong>方法中，以便在玩家摔倒时调用该方法。同样，作为一个好的实践，让我们使用<strong class="ju hs"> OnDestroy </strong>方法删除它，以避免在播放器被破坏时试图执行它:</p><div class="jh ji jj jk fd ab cb"><figure class="lm jl no lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/77517efe7b461eb09541fe1baa5824f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*m7qpJeCC-yxfVQJmkWZqjQ.png"/></div></figure><figure class="lm jl np lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/34cb70b56f735ef1d28475b0f946b5c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*6p7zUJGrmBUjBGmlDdSGfg.png"/></div></figure></div><p id="d1c8" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">保存脚本后，让我们将重生点拖到检查器中:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nq"><img src="../Images/3fb67c921165d95bd5e9bf05cb64634e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/1*5kgnKV5Smi6pebiCBN5Vag.gif"/></div></figure><h1 id="0ef0" class="kp kq hi bd kr ks kt ku kv kw kx ky kz ix la iy lb ja lc jb ld jd le je lf lg bi translated">展示生命</h1><p id="46df" class="pw-post-body-paragraph js jt hi ju b jv lh is jx jy li iv ka kb lj kd ke kf lk kh ki kj ll kl km kn hb bi translated">现在，为了显示剩余的生命，让我们在画布中使用一个文本元素，就像我们用来显示硬币的元素一样:</p><div class="jh ji jj jk fd ab cb"><figure class="lm jl nr lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/fc529782f1434e8a527ebe3e56bd122f.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/1*nOTQPW5V_cXezonCrF9QYg.gif"/></div></figure><figure class="lm jl ns lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/6d9b14a3e8fbef4ca20a97fc9a5fbcda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*VnCGIL5GmKZ5VeVCJUDUiQ.png"/></div></figure></div><p id="70d3" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">一旦我们有了文本元素，让我们打开 UI Manager 脚本并创建一个新变量来存储对它的引用:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nt"><img src="../Images/85edfc5a69b985387acd44a670a30814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LfGI3FgAf_rfl7fAJXRHzQ.png"/></div></figure><p id="58e0" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">然后，让我们创建一个新方法，通过更改 text 属性并从 player 类调用 lifes 属性来更新 lifes:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es nu"><img src="../Images/3845ffdd91a9bce065011c7f88ec15be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CrXFXjtMrBr68w5Lu8TsLA.png"/></div></div></figure><p id="734d" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">最后，让我们添加和删除动作委托中的方法，就像我们处理接收玩家类伤害的方法一样:</p><div class="jh ji jj jk fd ab cb"><figure class="lm jl nv lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/6a3ce6848298a3f91d17fdef03cdd868.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*pz5vXPXvf_Ktvk8xuwpMOA.png"/></div></figure><figure class="lm jl nw lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><img src="../Images/e14bc3311541eb3c24e8035bb09ca84d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*WQFXEm-nJJ4fTRVCDTFe4Q.png"/></div></figure></div><p id="86fa" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">不要忘记通过检查器将文本元素拖到相应的变量中:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nx"><img src="../Images/a09dbb3f43536463e50c56e86e0ee187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/1*f3hOjM2NZXj7kLeG4P9fMw.gif"/></div></figure><p id="1451" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">如果我们在 Unity 中运行游戏，我们会看到玩家每次倒下都会重生并失去一条生命:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/4ff3367cae0ee2f77979bf254571d1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fGPz4kVI34enhMD7eKsYlA.gif"/></div></div></figure><p id="3b67" class="pw-post-body-paragraph js jt hi ju b jv jw is jx jy jz iv ka kb kc kd ke kf kg kh ki kj kk kl km kn hb bi translated">就这样，我们用 Unity 为我们的平台游戏实现了一个生命系统！:d .下一篇文章再见，我将展示如何用 Unity 创建电梯。</p></div><div class="ab cl ny nz gp oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="hb hc hd he hf"><blockquote class="of og oh"><p id="4311" class="js jt lt ju b jv jw is jx jy jz iv ka oi kc kd ke oj kg kh ki ok kk kl km kn hb bi translated"><em class="hi">如果你想了解我更多，欢迎登陆</em><a class="ae ko" href="https://www.linkedin.com/in/fas444/" rel="noopener ugc nofollow" target="_blank"><strong class="ju hs"><em class="hi">LinkedIn</em></strong></a><strong class="ju hs"><em class="hi"/></strong><em class="hi">或访问我的</em> <a class="ae ko" href="http://fernandoalcasan.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hs"> <em class="hi">网站</em> </strong> </a> <em class="hi"> :D </em></p></blockquote></div></div>    
</body>
</html>