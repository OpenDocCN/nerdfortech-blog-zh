<html>
<head>
<title>Web scraping with a proxy pool (the cheap way)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用代理池的网络抓取(廉价方式)</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/web-scraping-with-a-proxy-pool-the-cheap-way-4c7d6fc9f859?source=collection_archive---------6-----------------------#2021-05-24">https://medium.com/nerd-for-tech/web-scraping-with-a-proxy-pool-the-cheap-way-4c7d6fc9f859?source=collection_archive---------6-----------------------#2021-05-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/50e08dd02b150d9cb85198236e598552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NuZkXi8NQI1zK-00Z044Cg.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">从<a class="ae hv" href="https://www.qep.com/products/floor-and-wall-scraper/" rel="noopener ugc nofollow" target="_blank">https://www.qep.com/products/floor-and-wall-scraper/</a>刮来的</figcaption></figure><div class=""/><div class=""><h2 id="4ac9" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">有了 AWS Lambda 功能，100 GB 只需 9 美元</h2></div><p id="5047" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">数据科学最难的事情可能是获取数据。公司愿意提供“免费”服务，以换取他们收集的关于你如何使用它们的数据，这给了他们相对于竞争对手的优势。因此，毫不奇怪，他们不会对那些无情地从他们的网站上抓取数据的人太友好，并采用许多复杂的检测算法来拒绝来自同一 IP 地址、过于相似或只是看起来可疑的请求。虽然下载不合理数量的数据是不道德的(有时是非法的)，但没有数据，模型的开发就会被垄断，从而被扼杀。我不会宽恕或谴责网络抓取，但我会告诉你一个有用的技巧。</p><h1 id="c1b1" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">代理池</h1><p id="9d87" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">当有人抓取你的数据时，最简单的方法是如果大量的请求来自一个特定的 IP 地址。出于这个原因，大量的服务涌现出来，让你可以访问大量的服务器，你可以用它们作为访问网站的代理。主要缺点是成本。</p><h1 id="eed8" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">输入 AWS Lambda 函数</h1><p id="4bd8" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">Lambda 函数是 FaaS(功能即服务)的一个例子，也是所谓的无服务器架构中最著名的组件之一。以前，您必须启动服务器来托管您的应用程序，包括从数据库返回值等任何功能。使用 Lambda 函数，您可以通过将所有组件(静态网页、数据库和其他功能)与 Lambda 函数连接起来，在不运行任何服务器的情况下构建一个相当复杂的系统。你为什么想这么做？因为通过这种方式，您只需为应用程序的使用付费，而不必通过全天候运行服务器来“开灯”。如果你期望零星或低容量，去无服务器更具成本效益。你可以一个月调用 100 万次 Lambda 函数，而不会产生任何成本，除了你从其中传输出来的数据，这些数据的收费与 EC2 实例的收费相同(目前是每 100 GB 9 美元)。作为比较，<a class="ae hv" href="https://oxylabs.io/products/residential-proxy-poolç" rel="noopener ugc nofollow" target="_blank"> oxylabs.io </a>每 GB 收费 15 美元。</p><p id="b48e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Lambda 函数可以用最流行的语言编写，但我将使用 Python，因为它仍然是数据科学家的首选语言。幸运的是，Lambda 函数不能保证保留它们的 IP 地址。我发现，如果他们超过 6 分钟没有被访问，他们的 IP 地址就会改变。此外，对你创建的 Lambda 函数的数量没有真正的限制。那么，为什么不创建尽可能多的网页，并以循环的方式浏览它们，以抓取您感兴趣的网页呢？这正是我们现在要做的。</p><h1 id="6fb7" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">将（行星）地球化（以适合人类居住）</h1><p id="8c91" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">使用 AWS 控制台是乏味的，有时令人困惑，所以我们需要一种自动的方法来创建我们需要的 Lambda 函数。Terraform 是一个很好的工具。一旦您安装了<a class="ae hv" href="https://learn.hashicorp.com/tutorials/terraform/install-cli" rel="noopener ugc nofollow" target="_blank"> Terraform </a>和<a class="ae hv" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank"> AWS CLI </a>并将其链接到您的 AWS 帐户，您就可以运行以下程序:</p><figure class="lg lh li lj fd hk"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="4353" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这将自动创建 10 个名为 proxy-0 到 proxy-9 的 Lambda 函数，我们可以用它们来访问网页，如下例所示:</p><figure class="lg lh li lj fd hk"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="8845" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">(您将需要<em class="lm"> pip 安装 bot O3</em>——用于编程式 AWS 控制的 Python 包装器。)如果运行此命令，您应该会看到 10 个唯一的 IP 地址在循环中重复出现。只需将 URL 替换为您感兴趣的网页，然后就可以离开了。您可以配置在文件<em class="lm"> variables.tf </em>中创建的 Lambda 函数的数量以及区域——这对于只能从世界上某些地方访问的网页非常有用。</p><p id="781d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然而，Lambda 函数确实有某些限制。特别是，响应有效负载的大小必须小于 6 MB。称 Lambda 函数为“代理”可能有点夸大其词，因为它只能处理 GET 请求，但对于使用 Beautiful soup 之类的东西从 HTML 页面抓取数据来说，这已经足够了。</p><div class="hh hi ez fb hj ln"><a href="https://github.com/teticio/lambda-scraper" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hz fi z dy ls ea eb lt ed ef hx bi translated">teticio/lambda 刮刀</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">使用 AWS Lambda 函数作为代理来获取 HTTP。有助于 teticio/lambda-scraper 的发展，创造一个…</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">github.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb hp ln"/></div></div></a></div></div></div>    
</body>
</html>