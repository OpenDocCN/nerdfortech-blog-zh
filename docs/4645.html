<html>
<head>
<title>Emitting Vue.js events in Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Typescript 中发出 Vue.js 事件</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/emitting-vue-js-events-in-typescript-d99d5ec9d15f?source=collection_archive---------3-----------------------#2021-07-31">https://medium.com/nerd-for-tech/emitting-vue-js-events-in-typescript-d99d5ec9d15f?source=collection_archive---------3-----------------------#2021-07-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="00b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何在<strong class="ih hj">类型脚本</strong>中发出一个事件并在<strong class="ih hj"> Vue.js </strong>中监听它</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/474e796df905eeab71278372edd5a9a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4lOdkNgq2y6utzbr.png"/></div></div></figure><p id="4cd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Vue.js </strong>允许用户<code class="du jp jq jr js b">emit</code>与子组件的事件，并通过<code class="du jp jq jr js b">this.$emit('event-name')</code>在父组件中对其做出反应。虽然这在组件中直接使用时很有魅力，但在使用<strong class="ih hj"> TypeScript </strong>时确实产生了一个问题。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="fa18" class="ka kb hi bd kc kd ke kf kg kh ki kj kk iq kl km kn iu ko kp kq iy kr ks kt ku bi translated"><strong class="ak">了解问题</strong></h2><p id="27df" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">让我们假设(基于我的私有代码)</p><ul class=""><li id="4cc1" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">有一个<code class="du jp jq jr js b">UserController.ts</code>类(前面的是<em class="lj">，它有一个方法<code class="du jp jq jr js b">invalidateTokenAndRedirectUser</code></em></li><li id="8bfb" class="la lb hi ih b ii lk im ll iq lm iu ln iy lo jc lf lg lh li bi translated"><code class="du jp jq jr js b">VueRouterGuard.ts</code>处理<code class="du jp jq jr js b">onRouteChange</code>逻辑的类，这是失效发生的地方，</li></ul><p id="74c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在—用户在大约 1 小时内不会做任何事情，最终令牌将失效。如果令牌已经过期，<code class="du jp jq jr js b">VueRouterGuard</code>就地检查(<em class="lj">在转到下一路线</em>之前)。</p><p id="fb92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果用户 get 无效，我想:</p><ul class=""><li id="34e3" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">将用户移至<code class="du jp jq jr js b">login</code>页面，</li><li id="a429" class="la lb hi ih b ii lk im ll iq lm iu ln iy lo jc lf lg lh li bi translated">隐藏<code class="du jp jq jr js b">logout</code>菜单元素——这就是问题所在，因为导航是由<strong class="ih hj"> Vue.js </strong>控制的，而 DOM 应该是<strong class="ih hj">而不是</strong>被直接用于此目的，</li></ul><p id="97f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个解决方案中<code class="du jp jq jr js b">VueRouterGuard</code>使用户无效，没有一个<strong class="ih hj"> Vue.js </strong>组件/视图会收到发生了什么的信息。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="708b" class="ka kb hi bd kc kd ke kf kg kh ki kj kk iq kl km kn iu ko kp kq iy kr ks kt ku bi translated"><strong class="ak">从类型脚本中发出事件</strong></h2><p id="9c05" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">通过检查<strong class="ih hj"> Vue.js </strong>的源代码来更好地理解事件发射是如何工作的，我发现:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/92a0e6d05f6849d9ebe3214aa75872be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*jTf1euE6RTdKBsHc958cVw.png"/></div></figure><p id="4807" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而这看起来就像是来自<strong class="ih hj"> Js </strong>的标准<code class="du jp jq jr js b">Event</code>。</p><p id="ea79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我个人想出了这个解决方案:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="4d5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jp jq jr js b">emitEventOnRouterView</code>方法将接受一个<code class="du jp jq jr js b">RouterView</code> DOM 元素和一个<code class="du jp jq jr js b">emit</code>事件。这样，提供的事件可以像标准的<code class="du jp jq jr js b">$emit('name')</code>一样被监听</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lq lr l"/></div></figure></div></div>    
</body>
</html>