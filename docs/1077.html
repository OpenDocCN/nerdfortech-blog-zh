<html>
<head>
<title>Installing Intel-based packages using Homebrew on the M1 Mac</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在M1 Mac上使用自制软件安装基于英特尔的软件包</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/installing-intel-based-packages-using-homebrew-on-the-m1-mac-3f88ede5d1f?source=collection_archive---------13-----------------------#2021-03-03">https://medium.com/nerd-for-tech/installing-intel-based-packages-using-homebrew-on-the-m1-mac-3f88ede5d1f?source=collection_archive---------13-----------------------#2021-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d87eb98eb0f518d6dca3d8fee82825a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Zj_642QKnsW5NZx_.jpg"/></div></div></figure><p id="e9e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我最近得到了新的苹果硅Mac(又名M1 mac)，这意味着必须处理购买第一代产品的痛点。虽然事情正在慢慢改善，但在使用第一代产品时，仍然有许多问题。对我来说，用自制软件在M1 mac上安装基于英特尔的软件包就是这样一种痛苦。</p><p id="dbac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我喜欢M1 mac的性能，但使用自制软件安装软件包和软件并不像我希望的那样简单。你可能知道，M1 MAC电脑运行的是64位ARM处理器，相对于旧的英特尔处理器。所以默认情况下，不支持ARM的包不能安装。幸运的是，苹果发布了Rosetta 2，它充当了为英特尔MAC电脑构建的应用程序的转换层，以便在新的苹果硅MAC电脑上运行。Rosetta 2是一个救星，因此我不会退还我的M1 Macbook Pro。</p><p id="3b3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这可能不是未来做事情的最佳方法，但这是生态系统目前的状态。在经历了相当多的Stackoverflow问题和Github问题后，这是我在M1 mac上安装基于英特尔的软件包的工作方式。</p><h1 id="f712" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">安装Rosetta 2</h1><p id="559c" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">遗憾的是，Rosetta 2没有预装，我们必须明确地安装它。安装基于英特尔的应用程序时，用户确实会收到安装Rosetta的提示。但是由于我大部分时间都在终端工作，所以没有得到这样做的提示。我用终端自己安装的。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c6e5" class="la jp hi kw b fi lb lc l ld le">/usr/sbin/softwareupdate --install-rosetta</span><span id="4853" class="la jp hi kw b fi lf lc l ld le">or, if you are lazy </span><span id="7449" class="la jp hi kw b fi lf lc l ld le">/usr/sbin/softwareupdate --install-rosetta agree-to-license (root permission required)</span></pre><h1 id="0366" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">在M1苹果电脑上安装自制软件</h1><p id="3dc1" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">虽然Homebrew已经针对ARM架构进行了更新，但它并不只是与fl架构以及英特尔仿真的Rosetta一起开箱即用。如果我没有这样做，当我尝试安装一个不支持M1体系结构的应用程序时，会在brew上出现以下错误:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8e45" class="la jp hi kw b fi lb lc l ld le">Error: Cannot install in Homebrew on ARM processor in Intel default prefix (/usr/local)!</span></pre><p id="e523" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这两个位置相互独立:对于rosetta模拟(Intel)代码为/usr/local，对于ARM64为/opt/homebrew。对于自制软件来说，这些都是硬编码的位置，我们对此无能为力。</p><p id="c1dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在M1 mac电脑上安装家酿软件从主页上看非常简单。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="cf77" class="la jp hi kw b fi lb lc l ld le">$ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</span></pre><h1 id="7a1e" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">为Rosetta仿真器安装自制软件</h1><p id="3443" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在M1 mac上安装了Homebrew之后，我们需要单独安装Rosetta仿真器。</p><p id="7a16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有几种方法可以做到这一点:为Rosetta相关的东西创建一个不同的终端，在同一个终端中完成，并添加一些别名。我更喜欢后者，但你选择做什么取决于你自己。</p><h1 id="ecfc" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">1.为Rosetta使用不同的终端</h1><p id="d31b" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在finder中，我们将右键单击Terminal(或iTerm)并创建应用程序的副本。我们将把它重新命名为类似“罗塞塔终端”的东西。</p><p id="0c66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将右键单击新终端并选择“获取信息”或按Command + I。</p><p id="e3dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在打开的窗口中，我们将选中“使用Rosetta打开”复选框，然后关闭窗口。</p><p id="6ad6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以像往常一样开始使用Rosetta终端，安装自制软件和其他应用程序。</p><p id="d50f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于某些原因，这个版本对我来说不能正常工作，但我没有深入研究它，因为我更喜欢有一个单一的终端应用程序。</p><h1 id="d4ba" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">2.在单终端中配置自制软件</h1><p id="2d47" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">拥有两个终端应用程序并不有趣。在一个应用程序中做所有事情是很棒的，谁喜欢加倍自己的工作呢？Rosetta让我们能够在命令前加上前缀<code class="du lg lh li kw b">arch -x86_64</code>,以模拟模式运行应用程序。这解决了我们的问题！</p><p id="1560" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我的下一步是使用:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="fddf" class="la jp hi kw b fi lb lc l ld le">$ arch -x86_64 /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"</span></pre><p id="eaca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，唉，这也不起作用。</p><p id="3645" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我使用了tar安装，首先手动安装Homebrew(知道它安装在/usr/local目录下)。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="843d" class="la jp hi kw b fi lb lc l ld le">$ arch -x86_64 zsh $ cd /usr/local &amp;&amp; mkdir homebrew $ curl -L https://github.com/Homebrew/brew/tarball/master | tar xz --strip 1 -C homebrew</span></pre><p id="ffdf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装完成后，我们就可以开始运行自制软件了，我们可以开始在我们的安装中使用架构标志了。</p><p id="a6cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要使用英特尔安装软件包，您现在可以使用:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="920d" class="la jp hi kw b fi lb lc l ld le">arch -x86_64 /usr/local/homebrew/bin/brew install &lt;package name&gt;</span></pre><p id="be07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于在M1 mac上使用自制软件:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ef4e" class="la jp hi kw b fi lb lc l ld le">/opt/homebrew/bin/brew install &lt;package name&gt;</span></pre><h1 id="2e30" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">其他可能的配置</h1><h1 id="31aa" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">1.别名</h1><p id="869a" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">为了方便起见，我将以上两个命令配置为别名:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="84e2" class="la jp hi kw b fi lb lc l ld le">ibrew='arch -x86_64 /usr/local/bin/brew'<br/>mbrew='arch -arm64e /opt/homebrew/bin/brew'</span></pre><p id="b699" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并根据需要将它们用作<code class="du lg lh li kw b">mbrew install</code>或<code class="du lg lh li kw b">ibrew install</code>来安装包。第一个偏好显然是mbrew。</p><p id="46a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我还在英特尔版本之前将它们添加到我的M1版本路径中，以便我使用本地包(如果可用)，否则我使用基于英特尔的仿真版本。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="838b" class="la jp hi kw b fi lb lc l ld le"># ~/.zshrc<br/>export PATH="/usr/local/bin:$PATH"<br/>export PATH="/opt/homebrew/bin:$PATH"</span></pre><h2 id="fba8" class="la jp hi bd jq lj lk ll ju lm ln lo jy jb lp lq kc jf lr ls kg jj lt lu kk lv bi translated">2.对于有Python问题的人来说，额外的步骤(&lt;3.9)</h2><p id="a2d3" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">Run:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="cb30" class="la jp hi kw b fi lb lc l ld le">arch -x86_64 pip install --upgrade pip setuptools</span></pre><h2 id="07a7" class="la jp hi bd jq lj lk ll ju lm ln lo jy jb lp lq kc jf lr ls kg jj lt lu kk lv bi translated">3. Alternative to opening Rosetta terminal</h2><p id="ffac" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated"><strong class="is hj">注意:</strong>你也可以使用</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ef27" class="la jp hi kw b fi lb lc l ld le">arch -x86_64 zsh</span></pre><p id="8ca4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">切换到Rosetta shell。</p><p id="78b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是这篇文章的全部内容。希望这篇文章能帮助你在你的M1机器上使用家酿啤酒，如果你有任何问题，欢迎在下面留言！</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="d603" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="md">原载于2021年3月3日</em><a class="ae me" href="https://www.wisdomgeek.com/development/installing-intel-based-packages-using-homebrew-on-the-m1-mac/" rel="noopener ugc nofollow" target="_blank"><em class="md">https://www.wisdomgeek.com</em></a><em class="md">。</em></p></div></div>    
</body>
</html>