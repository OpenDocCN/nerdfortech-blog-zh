<html>
<head>
<title>Implement Dark Mode with Zustand and Tailwind CSS in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中使用Zustand和Tailwind CSS实现黑暗模式</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/implement-dark-mode-with-zustand-and-tailwind-css-in-react-da3299e6e824?source=collection_archive---------4-----------------------#2021-03-14">https://medium.com/nerd-for-tech/implement-dark-mode-with-zustand-and-tailwind-css-in-react-da3299e6e824?source=collection_archive---------4-----------------------#2021-03-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a124" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">原力的黑暗面是通向许多被认为是非自然的能力的途径——达斯·普雷格斯</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/83c917c33d6af742daf71119763faf6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*DnuGbLLdElJrWB-O6zg_EQ.jpeg"/></div></figure><p id="bb03" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">是时候拥抱黑暗面了。</p><p id="7238" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">今天，我将向您展示如何使用<em class="kb"> zustand(德语)</em>和Tailwind CSS创建一个黑暗模式react应用程序。我们开始吧！</p><p id="c240" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">首先，什么是zustand？</p><blockquote class="kc kd ke"><p id="b10a" class="jf jg kb jh b ji jj ij jk jl jm im jn kf jp jq jr kg jt ju jv kh jx jy jz ka hb bi translated"><strong class="jh hj"> <em class="hi"> Zustand </em> </strong>是一个小型、快速、可伸缩的bearbones状态管理解决方案。有一个基于钩子的舒适的api，不是样板或固执己见，但仍然足够清晰和流畅。</p></blockquote><p id="f090" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你熟悉<code class="du ki kj kk kl b">redux</code>，这对你来说应该是小菜一碟。</p><p id="a5ed" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">对于这个应用程序，我将使用<a class="ae km" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> <strong class="jh hj">创建-反应-应用</strong> </a>。启动您的终端并运行以下命令</p><pre class="iy iz ja jb fd kn kl ko kp aw kq bi"><span id="9bd0" class="kr ks hi kl b fi kt ku l kv kw">npx create-react-app react-dark-mode</span></pre><p id="e3f9" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在我们开始酷的东西之前，我们需要安装我们的依赖项。</p><p id="e33e" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">运行<code class="du ki kj kk kl b">npm install zustand</code>安装zustand。</p><p id="3c54" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">用<code class="du ki kj kk kl b">create-react-app</code>设置顺风已经在顺风官方文档中有记录。导航到<a class="ae km" href="https://tailwindcss.com/docs/guides/create-react-app" rel="noopener ugc nofollow" target="_blank">这个页面</a>用我们的项目设置顺风CSS。</p><h2 id="e9af" class="kr ks hi bd kx ky kz la lb lc ld le lf jo lg lh li js lj lk ll jw lm ln lo lp bi translated">一旦你完成了，让我们开始吧！</h2><h1 id="bc2d" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">步骤1:设置顺风配置🔨</h1><p id="9dc5" class="pw-post-body-paragraph jf jg hi jh b ji mb ij jk jl mc im jn jo md jq jr js me ju jv jw mf jy jz ka hb bi translated">首先，我们需要设置一些<code class="du ki kj kk kl b">tailwind</code>配置。导航到项目根目录下的<code class="du ki kj kk kl b"><strong class="jh hj">tailwind.config.js</strong></code> <strong class="jh hj"> </strong>。如果您正确地遵循了这里的步骤<a class="ae km" href="https://tailwindcss.com/docs/guides/create-react-app" rel="noopener ugc nofollow" target="_blank">和</a>，文件应该已经在那里了。</p><p id="d14f" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">将以下内容添加到您的<code class="du ki kj kk kl b"><strong class="jh hj">tailwind.config.js</strong></code>:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="e25f" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">注意<code class="du ki kj kk kl b"><strong class="jh hj">darkMode</strong></code>键，这是直接来自顺风文件。添加<code class="du ki kj kk kl b"><strong class="jh hj">class</strong></code>作为值允许我们手动控制黑暗模式。您也可以使用<code class="du ki kj kk kl b"><strong class="jh hj">media</strong></code>根据您的操作系统主题切换主题。</p><p id="8c4d" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们继续吧。</p><h1 id="b6da" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">步骤2:构建用户界面🖥️</h1><p id="4889" class="pw-post-body-paragraph jf jg hi jh b ji mb ij jk jl mc im jn jo md jq jr js me ju jv jw mf jy jz ka hb bi translated">打开<code class="du ki kj kk kl b"><strong class="jh hj">App.js</strong></code>，更换内容如下:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="64e9" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们讨论一下这里发生了什么。使用Tailwind，我们需要做的就是添加前缀<code class="du ki kj kk kl b">dark</code>来实现黑暗模式样式。例如:</p><p id="6e16" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><code class="du ki kj kk kl b">dark:bg-black dark:text-white</code></p><p id="1cec" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你熟悉顺风，这个概念对你来说不会陌生。仅当您的应用程序处于黑暗模式时，<code class="du ki kj kk kl b">dark:</code>前缀后的样式才会被应用。你可以在这里了解更多。</p><h1 id="4706" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">步骤3:常量⚙</h1><p id="7ddd" class="pw-post-body-paragraph jf jg hi jh b ji mb ij jk jl mc im jn jo md jq jr js me ju jv jw mf jy jz ka hb bi translated">在我们继续切换函数之前，让我们在一个<strong class="jh hj">常量</strong>文件中声明我们的主题。在你的<code class="du ki kj kk kl b">src</code>目录下创建一个名为<code class="du ki kj kk kl b">constants</code>的新文件夹。我们就叫它<code class="du ki kj kk kl b"><strong class="jh hj">index.js</strong></code>。将下面的代码放在<code class="du ki kj kk kl b"><strong class="jh hj">src/constants/index.js</strong></code>中</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="de68" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这将有助于避免我们整个代码库的错别字。现在，我们需要一种方法来切换我们的黑暗模式。使用tailwind，我们需要将类<code class="du ki kj kk kl b">dark</code>添加到我们的<code class="du ki kj kk kl b">root</code>元素中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mi"><img src="../Images/ef1afb56a500d0f117d6182b523b86ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*y3WWOqZHCIar72cM-7yvaA.png"/></div></figure><h1 id="69e8" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">步骤4:编写我们的切换函数🌗</h1><p id="1c21" class="pw-post-body-paragraph jf jg hi jh b ji mb ij jk jl mc im jn jo md jq jr js me ju jv jw mf jy jz ka hb bi translated">现在，让我们来看看我们的<code class="du ki kj kk kl b"><strong class="jh hj">toggle</strong></code>函数。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="0335" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们讨论一下这里发生了什么。我们的<code class="du ki kj kk kl b">applyThemePreference</code>函数接受当前主题作为参数。基于当前主题，我们可以从<code class="du ki kj kk kl b">root</code>元素中添加/移除<code class="du ki kj kk kl b">dark</code>属性。</p><p id="f4e6" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">也就是说，如果当前主题是<code class="du ki kj kk kl b">light</code>，这将为我们的<code class="du ki kj kk kl b">root</code>元素添加一个<code class="du ki kj kk kl b">dark</code>类，反之亦然。现在，我们需要一种方法来持久化我们的主题，这样即使我们重新加载页面，我们的首选主题也应该持久化。输入<strong class="jh hj"> <em class="kb"> zustand。</em> </strong></p><p id="1a23" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Zustand 带有一个内置的中间件，允许我们将状态保存到<code class="du ki kj kk kl b">localStorage</code> <strong class="jh hj">。让我们来建造我们的主题商店。</strong></p><h1 id="82eb" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">步骤5:用Zustand管理全局状态💪</h1><p id="7768" class="pw-post-body-paragraph jf jg hi jh b ji mb ij jk jl mc im jn jo md jq jr js me ju jv jw mf jy jz ka hb bi translated">导航到<code class="du ki kj kk kl b">src</code>并创建一个名为<code class="du ki kj kk kl b">stores</code>的新文件夹。在<code class="du ki kj kk kl b">stores</code>中，我们将创建一个名为<code class="du ki kj kk kl b">useThemeStore</code>的新文件。将内容<code class="du ki kj kk kl b"><strong class="jh hj">src/stores/useThemeStore</strong></code>替换为以下内容:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="4e38" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们讨论一下这里发生了什么。我们有我们的<code class="du ki kj kk kl b">themeStore</code> <strong class="jh hj"> </strong>来展示我们应用程序的当前主题，还有一个<strong class="jh hj">函数</strong>来切换主题。这将把我们的<code class="du ki kj kk kl b">theme</code>变量从暗变亮，反之亦然，这取决于我们应用程序的当前主题。</p><p id="df66" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><code class="du ki kj kk kl b"><strong class="jh hj">persist</strong></code> <strong class="jh hj"> </strong> <code class="du ki kj kk kl b"><strong class="jh hj">middleware</strong></code> <strong class="jh hj"> </strong>将允许我们的状态通过<code class="du ki kj kk kl b">theme</code>键保存在<code class="du ki kj kk kl b">localStorage</code>中。我们可以将一个配置对象传递给我们的持久化中间件，以更改<code class="du ki kj kk kl b">localStorage</code>键的名称和其他属性。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mj"><img src="../Images/fb0935c148e271b4930bc8029bb169b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQj6UbSkFEalE1RcMkbGLg.jpeg"/></div></div></figure><h1 id="ba42" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">第六步:向黑暗面问好！🌚</h1><p id="423c" class="pw-post-body-paragraph jf jg hi jh b ji mb ij jk jl mc im jn jo md jq jr js me ju jv jw mf jy jz ka hb bi translated">头回到<code class="du ki kj kk kl b"><strong class="jh hj">App.js</strong></code> <strong class="jh hj"> </strong>，修改如下:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="cb1d" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们讨论一下这里发生了什么。</p><p id="297d" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Zustand 公开了一个钩子来将该状态消耗到我们的组件中。如果你还记得的话，我们将当前的<code class="du ki kj kk kl b">theme</code>和<code class="du ki kj kk kl b">toggleTheme</code>存储在我们的状态中。我们现在可以使用我们的<code class="du ki kj kk kl b">useThemeStore</code>钩子来消耗状态。</p><p id="93d6" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们传递一个<strong class="jh hj">选择器</strong>给我们的<strong class="jh hj">钩子</strong>，它为我们提取那些值。你可以在组件的外部声明你的选择器<strong class="jh hj">，以防止每次渲染时不必要的计算。但那是另一篇文章的内容了。</strong></p><p id="5ae4" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这里，我们将<code class="du ki kj kk kl b">theme</code>和<code class="du ki kj kk kl b">toggleTheme</code>放在组件中，我们可以用它们来管理应用程序的主题状态。我们将<code class="du ki kj kk kl b">toggleTheme</code> <strong class="jh hj"> </strong>传递给我们的<code class="du ki kj kk kl b">button onClick.</code>，这将负责为全局状态更改主题。</p><p id="50bc" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在，要改变主题并反映到你的UI上，我们需要使用我们的<code class="du ki kj kk kl b">applyThemePreference</code> <strong class="jh hj"> </strong>函数和我们的<code class="du ki kj kk kl b">useEffect</code> <strong class="jh hj">。</strong></p><blockquote class="kc kd ke"><p id="0df6" class="jf jg kb jh b ji jj ij jk jl jm im jn kf jp jq jr kg jt ju jv kh jx jy jz ka hb bi translated">你会问，我们为什么需要一个<code class="du ki kj kk kl b"><strong class="jh hj">useEffect</strong></code>？每当主题改变时，我们都需要从我们的<code class="du ki kj kk kl b"><em class="hi">root</em></code>元素中添加/移除<code class="du ki kj kk kl b"><em class="hi">dark</em></code>类。</p></blockquote><h2 id="41f8" class="kr ks hi bd kx ky kz la lb lc ld le lf jo lg lh li js lj lk ll jw lm ln lo lp bi translated">点击切换主题按钮，看看魔术！🧙</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mo"><img src="../Images/c04ee75ba7059842791561e0ae8ce0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4_dsrgUNnMbZwIWIukfjxw.gif"/></div></div></figure><h1 id="c787" class="lq ks hi bd kx lr ls lt lb lu lv lw lf io lx ip li ir ly is ll iu lz iv lo ma bi translated">还有…我们完了！！！​🥳​🎉​​💃🏻​</h1><blockquote class="kc kd ke"><p id="ea5c" class="jf jg kb jh b ji jj ij jk jl jm im jn kf jp jq jr kg jt ju jv kh jx jy jz ka hb bi translated">但是等等，我们可以做得更多一点。我们可以将这个功能提取到一个<strong class="jh hj">定制钩子中。</strong></p></blockquote><p id="857d" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在<code class="du ki kj kk kl b">src</code>里面新建一个文件夹<code class="du ki kj kk kl b">hooks</code>，命名为<code class="du ki kj kk kl b"><strong class="jh hj">useTheme.js</strong></code>。在您的<code class="du ki kj kk kl b"><strong class="jh hj">src/hooks/useTheme.js</strong></code>中，添加以下代码:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="9c36" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在你的<code class="du ki kj kk kl b"><strong class="jh hj">App.js</strong></code>T5、里面有一个可重复使用的挂钩！</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="6c3d" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">好了，我们完成了！！！！</p><p id="1d68" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">整洁！</p><p id="f91a" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">你可以在<a class="ae km" href="https://github.com/rohitpotato/" rel="noopener ugc nofollow" target="_blank"> Github </a>查看我的更多作品，如果你感兴趣，可以在<a class="ae km" href="https://twitter.com/rohitpotato" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我。</p><p id="762a" class="pw-post-body-paragraph jf jg hi jh b ji jj ij jk jl jm im jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><em class="kb">感谢阅读！！</em></p></div></div>    
</body>
</html>