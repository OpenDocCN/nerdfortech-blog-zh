<html>
<head>
<title>Cartoon Character Recognition using Deep Learning.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习的卡通人物识别。</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/cartoon-character-recognition-using-deep-learning-c1ece3dbd94c?source=collection_archive---------7-----------------------#2021-02-20">https://medium.com/nerd-for-tech/cartoon-character-recognition-using-deep-learning-c1ece3dbd94c?source=collection_archive---------7-----------------------#2021-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="8def" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">卡通人物，动画片中的人或动物，如米老鼠、汤姆和杰瑞等。卡通是每个童年必不可少的一部分。毫无疑问，它们是最受孩子们欢迎的娱乐方式，但远不止于此。在卡通的帮助下，孩子们可以了解我们周围的世界，了解新的情感，生活问题和其他重要的事情。因此，只是为了好玩，当前项目的目标是使用深度学习算法来识别卡通人物。</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es jh"><img src="../Images/6459a60d93be0052e26f586d392e501a.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/1*Mv651am7RXzmgM6KFNRdEw.gif"/></div></figure><p id="5dd2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jp iv iw ix jq iz ja jb jr jd je jf jg hb bi translated">因此，在本文中，我们将研究如何使用深度神经网络模型在 OpenCV 中执行卡通人物识别。</p><h1 id="0b92" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">目录</h1><ol class=""><li id="1a7a" class="kq kr hi il b im ks iq kt jp ku jq kv jr kw jg kx ky kz la bi translated">资料组</li><li id="6023" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated">深度学习算法</li><li id="67e4" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated">实验和结果</li><li id="9814" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated">下一步是什么？</li></ol><h2 id="385b" class="lg jt hi bd ju lh li lj jy lk ll lm kc jp ln lo kg jq lp lq kk jr lr ls ko lt bi translated">资料组</h2><p id="d764" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jp lu iw ix jq lv ja jb jr lw je jf jg hb bi translated">数据集中使用的图片收集自谷歌浏览器和各种网站，如<a class="ae lx" href="https://cartoon-clipart.co/" rel="noopener ugc nofollow" target="_blank">迪士尼</a>。截至目前，该数据集包含 4 个类别(米老鼠、唐老鸭、小黄人和小熊维尼)，总共包含 2215 张图像。数据集被转换为结构化格式(在一个地方收集并手动标记图像)，所有预处理(如调整图像大小、应用过滤器去除噪声等)都是使用 OpenCV-python 完成的。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/f988f005f72ead856279df5e77e96f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hiczksldxMH6itsXKedkMw.jpeg"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">数据集的样本图像</figcaption></figure><h2 id="b44f" class="lg jt hi bd ju lh li lj jy lk ll lm kc jp ln lo kg jq lp lq kk jr lr ls ko lt bi translated">深度学习算法</h2><ol class=""><li id="c634" class="kq kr hi il b im ks iq kt jp ku jq kv jr kw jg kx ky kz la bi translated"><strong class="il hj">模型架构</strong>:了解 CNN 模型，请浏览<a class="ae lx" rel="noopener" href="/analytics-vidhya/face-mask-detection-using-deep-learning-83f927654f1e">T5 篇 T7】。架构不同，有许多层、参数和超参数调整，但基本原理是相同的。</a></li><li id="8297" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj">计算 CNN 中的参数数量:</strong>如果你一直在玩 CNN，那么经常会遇到下图所示的参数汇总。我们都知道计算激活尺寸很容易，因为它仅仅是宽度、高度和该层中通道数量的乘积。</li></ol><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mj"><img src="../Images/426cab0b26e8b4c12296973f5c295b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*TLQTbzxGHg_2E2_DE1MbAg.jpeg"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">CNN 模型摘要</figcaption></figure><h2 id="7f44" class="lg jt hi bd ju lh li lj jy lk ll lm kc jp ln lo kg jq lp lq kk jr lr ls ko lt bi translated">首先，什么是参数？</h2><blockquote class="if ig ih"><p id="ceda" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><em class="hi">参数通常是在训练期间学习的重量。它们是有助于模型预测能力权重矩阵，在反向传播过程中会发生变化。谁来管理变革？嗯，你选择的训练算法，尤其是优化策略，会让它们改变自己的值。</em></p><p id="b293" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><em class="hi">现在你知道什么是“参数”,让我们开始计算我们在上面看到的示例图像中的参数数量。但是，我想在这里再次包含该图像，以避免您的滚动努力和时间。</em></p></blockquote><ol class=""><li id="5208" class="kq kr hi il b im in iq ir jp mk jq ml jr mm jg kx ky kz la bi translated"><strong class="il hj">输入层:</strong>输入层不需要学习什么，它的核心是提供输入图像的形状。所以这里没有可学习的参数。因此<strong class="il hj">参数的数量= 0 </strong>。</li><li id="992c" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated">CONV 层:这是 CNN 学习的地方，所以我们肯定会有权重矩阵。为了计算这里的可学习参数，我们所要做的就是将乘以形状的<strong class="il hj">宽度 m </strong>、<strong class="il hj">高度 n </strong>、<strong class="il hj">前一层的过滤器</strong> <strong class="il hj"> d </strong>，并考虑当前层中所有这样的过滤器<strong class="il hj"> k。不要忘记每个滤波器的偏置项。CONV 层中的参数数量将是:<strong class="il hj"> ((m * n * d)+1)* k) </strong>，由于每个滤波器的偏置项而增加 1。同样的表达式可以写成:<strong class="il hj">((滤镜宽度的形状*滤镜高度的形状*上一层滤镜数+1)*滤镜数)。</strong>其中术语“过滤器”指当前层中过滤器的数量。</strong></li><li id="3cab" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj">池层:</strong>它没有可学习的参数，因为它所做的只是计算一个特定的数字，不涉及反向传播学习！因此多个<strong class="il hj">参数= 0 </strong>。</li><li id="b6c6" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj">全连接层(FC): </strong>这当然有可学习的参数，事实上，与其他层相比，这类层有最多的参数，为什么？因为，每一个神经元都与其他神经元相连！那么，如何计算这里的参数个数呢？你可能知道，它是当前层的神经元数量<strong class="il hj"> c </strong>和前一层的神经元数量<strong class="il hj"> p </strong>的乘积，而且一如既往，不要忘记偏置项。因此这里的参数数量为:<strong class="il hj">((当前层神经元 c *前一层神经元 p)+1*c) </strong>。</li></ol><p id="3f47" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jp iv iw ix jq iz ja jb jr jd je jf jg hb bi translated">现在让我们跟着这些指针计算参数的个数，好吗？</p><ol class=""><li id="bf78" class="kq kr hi il b im in iq ir jp mk jq ml jr mm jg kx ky kz la bi translated">第一个<strong class="il hj">输入层</strong>没有参数。</li><li id="4d2e" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj"> </strong>第二个<strong class="il hj"> CONV1(滤镜形状=3*3，步距=1)层中的参数为:</strong> <strong class="il hj">((滤镜宽度的形状*滤镜高度的形状*上一层的滤镜个数+1)*滤镜个数)= (((3*3*3)+1)*32) = 896。</strong></li><li id="1051" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj"> </strong>第四个<strong class="il hj"> CONV2(滤镜形状=3*3，步距=1)层中的参数为</strong> : <strong class="il hj">((滤镜宽度形状*滤镜高度形状*上一层滤镜数量+1) *滤镜数量)= (((3*3*32)+1)*64) = 9248。</strong></li><li id="1bbf" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated">第三个<strong class="il hj"> POOL1 层</strong>没有参数。</li><li id="d908" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj"> </strong>中的参数第四个<strong class="il hj"> CONV3(滤镜形状=3*3，步距=1)层为</strong> : <strong class="il hj">((滤镜宽度形状*滤镜高度形状*上一层滤镜数量+1) *滤镜数量)= (((5*5*32)+1)*64) = 18496。</strong></li><li id="6d4f" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj"> </strong>中的参数第四个<strong class="il hj"> CONV4(滤镜形状=3*3，步距=1)层为</strong> : <strong class="il hj">((滤镜宽度形状*滤镜高度形状*上一层滤镜数量+1) *滤镜数量)=((3 * 3 * 64)+1)* 64)= 36928。</strong></li><li id="2bf5" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated">第五层<strong class="il hj"> POOL2 层</strong>没有参数。</li><li id="a241" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><strong class="il hj"> Softmax 层有((当前层 c *上一层 p)+1*c)个参数= 238144*4 + 1*4= 952580。</strong></li></ol><h1 id="f412" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">实验和结果</h1><p id="3e6f" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jp lu iw ix jq lv ja jb jr lw je jf jg hb bi translated">1.CNN 模型分析</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mn"><img src="../Images/0066fd272ebb0201c7366a55efa90a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*40MbqbR1Me4kq0Oz9xKDvg.png"/></div><figcaption class="md me et er es mf mg bd b be z dx translated">训练值数据曲线的模型精度和损失</figcaption></figure><p id="ffe9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jp iv iw ix jq iz ja jb jr jd je jf jg hb bi translated">2.图像卡通人物识别的实现。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mo"><img src="../Images/0b7f91ace33d8639f699e90cd9a81caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U8sYd-U-7yXOOGc_mXPCxg.jpeg"/></div></div></figure><p id="caaf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jp iv iw ix jq iz ja jb jr jd je jf jg hb bi translated">3.视频卡通人物识别的实现。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mp mi l"/></div></figure><h1 id="d9a2" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">下一步是什么？</h1><p id="fc57" class="pw-post-body-paragraph ii ij hi il b im ks io ip iq kt is it jp lu iw ix jq lv ja jb jr lw je jf jg hb bi translated">本文对卡通人物进行了准确的识别。我们已经使用了 4 个类别，这可以扩展到为更多类别训练模型，并且我们可以为对象检测创建数据集(将来将只为学习对象检测而做)。</p><h1 id="53bd" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">参考</h1><ol class=""><li id="1686" class="kq kr hi il b im ks iq kt jp ku jq kv jr kw jg kx ky kz la bi translated"><a class="ae lx" href="https://www.disneyclips.com/images/donaldduck9.html" rel="noopener ugc nofollow" target="_blank">数据集收集</a></li><li id="b13d" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><a class="ae lx" href="https://towardsdatascience.com/understanding-and-calculating-the-number-of-parameters-in-convolution-neural-networks-cnns-fc88790d530d" rel="noopener" target="_blank">CNN 参数的计算</a>。</li><li id="a07c" class="kq kr hi il b im lb iq lc jp ld jq le jr lf jg kx ky kz la bi translated"><a class="ae lx" rel="noopener" href="/analytics-vidhya/recognizing-real-time-creativity-of-user-using-deep-learning-786cbc5cd292"> CNN 架构。</a></li></ol><p id="cace" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jp iv iw ix jq iz ja jb jr jd je jf jg hb bi translated">该代码可在<a class="ae lx" href="https://github.com/Devashi-Choudhary/Cartoon-Character-Recognition" rel="noopener ugc nofollow" target="_blank"><strong class="il hj">github.com/Devashi-Choudhary/Cartoon-Character-Recognition</strong></a>获得。如有任何问题或疑问，请直接联系我，电话:<a class="ae lx" href="https://github.com/Devashi-Choudhary" rel="noopener ugc nofollow" target="_blank"><strong class="il hj">github.com/Devashi-Choudhary</strong>。</a></p></div></div>    
</body>
</html>