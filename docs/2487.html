<html>
<head>
<title>A Beginner’s Guide: file import and concatenation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者指南:Python中的文件导入和连接</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/a-beginners-guide-file-import-and-concatenation-in-python-eef853cc39f4?source=collection_archive---------10-----------------------#2021-05-08">https://medium.com/nerd-for-tech/a-beginners-guide-file-import-and-concatenation-in-python-eef853cc39f4?source=collection_archive---------10-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0c56" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">组合多个csv文件、xlsx文件和工作表</h2></div><p id="9df6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">组合大量具有相同结构和扩展名的文件可能是许多数据科学项目的第一步。这可以很容易地通过使用一种叫做连接的操作来完成。掌握文件导入和连接将节省您大量的时间，这就是为什么我们将看看三个流行的情况。假设您有一个包含多个逗号分隔值(csv)文件、多个Excel工作簿(xlsx)和一个包含多个工作表的Excel工作簿的目录。让我们看看如何使用Python组合文件！</p><p id="f88e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用于说明本指南的数据极其简单(参见<em class="jt">图1 </em>)，但所提供的解决方案显然是可扩展的！<strong class="iz hj">下面是我们的数据收集模式:</strong></p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/faf426c16470272020901810731ab08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gmI9XOIyXnnFdkKtDeq2Q.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">图一。数据收集架构。</figcaption></figure><p id="ced6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在所有情况下，我们都希望有一个包含6种产品及其价格的输出文件。手动执行这项任务不会有任何害处，但是这篇短文的主旨是提供一个适应性强、可伸缩的解决方案来连接大量复杂的文件。<strong class="iz hj">让我们用</strong><a class="ae kk" href="https://www.geeksforgeeks.org/how-to-use-google-colab/" rel="noopener ugc nofollow" target="_blank"><strong class="iz hj">Google Colab</strong></a><strong class="iz hj">:</strong></p><p id="7e9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">案例1:合并多个CSV文件</strong></p><p id="48d7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，你一定注意到了<em class="jt">图1 </em>中提到的<strong class="iz hj"> <em class="jt"> OS模块</em> </strong>。让我给你简单介绍一下OS模块。操作系统模块提供了几十个使用Python与操作系统交互的功能。我们可以访问、修改、移动、删除文件，还有许多其他功能。</p><p id="fdfe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大部分时间我们都在分析本地文件和文件夹并与之交互，以执行进一步的数据分析，现在您明白为什么操作系统模块会派上用场了。为了开始这个分析，如果您想继续，您可以从我的<a class="ae kk" href="https://github.com/cristianefragata/study-projects/tree/main/medium-content/file%20import%20and%20concatenation" rel="noopener ugc nofollow" target="_blank"> Github </a>库手动下载所有5个文件。一旦你做到了，我们就可以走了！</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="1375" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终输出应该是:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kn"><img src="../Images/55776a08034d6ae3c17205de78230c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jf5YNlbAGqCJvqxYiy54tQ.png"/></div></div></figure><p id="e627" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以看到目录相当乱。我们故意把所有文件上传到同一个文件夹。因为生活也是混乱的，所以我决定让它这样。如果您的文件夹中只有想要合并的文件，您可以跳过下一个代码片段。</p><p id="b51a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一方面，一个杂乱的目录也是学习一点关于<strong class="iz hj"> glob模块</strong>的好机会。glob模块根据Unix shell使用的规则找到所有与指定模式匹配的<strong class="iz hj">路径名，并以任意顺序将这个匹配作为一个列表返回。我们将使用glob模块只选择扩展名为csv的文件。</strong></p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="628b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设文件顺序很重要，我们使用了上面的排序函数，但是请记住，如果您有一个数字列，比如一个<em class="jt"> id </em>或一个<em class="jt">日期</em>，您总是可以使用pandas对整个数据帧进行排序。上面代码片段的最终输出是:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ko"><img src="../Images/9de0ae22136edfe3da45b2f7c6a149a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pJzznX7LPQqdp8ukZ3_Wg.png"/></div></div></figure><p id="2291" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们将使用list comprehension和pandas来读取名为result的列表中返回的所有csv文件。pandas concat函数用于获得最终的数据帧。再次导出到csv是快速和容易的！</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="11a0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">案例2:合并多个Excel工作簿(xlsx) </strong></p><p id="0267" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们希望使用多个Excel工作簿作为输入文件来获得相同的结果。我们将再次使用glob来指定扩展名，并从列表中排除多工作表文件(Excel Workbook.xlsx)。很快，我们将有一个结合了Excel1和Excel2的新Excel文件。</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="be41" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">案例3:合并单个Excel工作簿的多个工作表</strong></p><p id="1234" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们将使用一个包含多个工作表的Excel工作簿作为输入文件来执行相同的任务。这次我们不需要glob，因为我们只有一个文件。我们可以在read_excel函数中指定文件路径和参数“None”。此参数确保我们将一次导入所有工作表。输出是一个Python字典！您可以使用名称作为关键字来访问所有工作表。现在，我们只需要将这个dict_keys对象转换成一个列表，我们就可以开始了！</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="ace3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">让我们最后下载所有3个输出文件！</strong></p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="0ae9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将在下面嵌入我的笔记本，以防你想检查中间输出和评论！</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="9512" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">感谢阅读！回头见！</strong></p></div></div>    
</body>
</html>