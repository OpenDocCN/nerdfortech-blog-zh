<html>
<head>
<title>Kubernetes Cluster Federation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes 集群联盟</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/kubernetes-cluster-federation-c4c73ee058d6?source=collection_archive---------3-----------------------#2021-09-18">https://medium.com/nerd-for-tech/kubernetes-cluster-federation-c4c73ee058d6?source=collection_archive---------3-----------------------#2021-09-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/321970f808ba346b3b025e2a727dc7ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*U8zKz0Dyh6Vs0Aia.jpg"/></div></figure><h2 id="4843" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">描述</h2><p id="9a92" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke hb bi translated">Kubernetes 允许我们将多个集群关联成一个集群集群，作为一个端到端集群联盟。<a class="ae kf" href="https://www.technologiesinindustry4.com/" rel="noopener ugc nofollow" target="_blank">它允许客户通过在世界各地运行的多个集群部署和管理应用</a>。集群联合的目的不仅仅是为了保证高可用性，还要将多个异构集群组合成一个超级集群，通过一个管理界面进行管理。</p><p id="b500" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated"><strong class="jm hj">例 1 </strong></p><p id="4b2f" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">我们可以在本地运行应用系统的隐私敏感组件，将本地集群与运行在云提供商基础设施上的集群相结合，而非敏感部分可以在云中运行。</p><p id="b3e9" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated"><strong class="jm hj">例 2 </strong></p><p id="a48d" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">另一个例子主要是在一个小型的本地集群中运行我们的应用程序。当应用程序的计算供应超过集群的容量时，就会发生这种情况，从而允许应用程序转移到基于云的集群，该集群通常在云提供商的基础架构上进行调配。</p><h1 id="b073" class="kl in hi bd io km kn ko is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb bi translated">建筑理解</h1><p id="14cf" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke hb bi translated">什么是 Kubernetes 集群联盟？</p><p id="a260" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">群集的群集可能与稳定的群集相关，其中作为节点的替代，我们有整个群集。<a class="ae kf" href="https://www.technologiesinindustry4.com/" rel="noopener ugc nofollow" target="_blank">联合集群包含一个联合控制平面和多个 Kubernetes 集群，就像 Kubernetes 集群包含一个控制平面和多个工作节点一样</a>。联合控制平面做类似的实体，但是交叉一组集群而不是节点，就像 Kubernetes 控制平面如何通过一组工作节点实现应用一样。联合控制平面包括三个部分:</p><ul class=""><li id="33ef" class="lc ld hi jm b jn kg jr kh ix le jb lf jf lg ke lh li lj lk bi translated">用于存储联邦 API 对象的 etcd</li></ul><p id="2331" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">它存储了联邦 API 对象</p><ul class=""><li id="db66" class="lc ld hi jm b jn kg jr kh ix le jb lf jf lg ke lh li lj lk bi translated">联盟 API 服务器</li></ul><p id="b569" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">联合控制器管理器运行许多联合控制器，这些控制器执行基于我们在 API 服务器上创建的 API 对象的操作。</p><ul class=""><li id="1c57" class="lc ld hi jm b jn kg jr kh ix le jb lf jf lg ke lh li lj lk bi translated">联盟控制器管理器</li></ul><p id="9bfe" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">API 服务器是所有其他组件与之对话的 REST 端点。</p><p id="dbf9" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">用户接近联合 API 服务器来创建联合 API 对象。联邦控制器查看这些对象，然后与底层集群的 API 服务器对话，生成常规的 Kubernetes 资源。</p><h1 id="2d0f" class="kl in hi bd io km kn ko is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb bi translated">联合 API 对象</h1><p id="73d0" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke hb bi translated">我们了解到联邦 API 服务器允许我们创建联邦变体。Kubernetes 资源的联合版本</p><p id="00a2" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">我们必须查阅 Kubernetes 集群联合文档，以获得最新的受支持联合资源列表。通常支持以下联合资源:</p><ul class=""><li id="d6e0" class="lc ld hi jm b jn kg jr kh ix le jb lf jf lg ke lh li lj lk bi translated">名称空间</li><li id="afdb" class="lc ld hi jm b jn ll jr lm ix ln jb lo jf lp ke lh li lj lk bi translated">配置映射和机密</li><li id="4d09" class="lc ld hi jm b jn ll jr lm ix ln jb lo jf lp ke lh li lj lk bi translated">服务和入口</li><li id="09f6" class="lc ld hi jm b jn ll jr lm ix ln jb lo jf lp ke lh li lj lk bi translated">部署、复制集、作业和守护集</li><li id="7342" class="lc ld hi jm b jn ll jr lm ix ln jb lo jf lp ke lh li lj lk bi translated">水平自动标尺</li></ul><p id="4cba" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">联邦 API 服务器还关心代表底层 Kubernetes 集群的集群对象，就像节点对象表示稳定的 Kubernetes 集群中的工作节点一样。我们可视化联邦对象如何与底层集群中创建的对象相关联。</p><h1 id="3dfb" class="kl in hi bd io km kn ko is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb bi translated">联合资源做什么？</h1><p id="7b76" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke hb bi translated">运行在联邦控制器管理器中的控制器将在所有底层 Kubernetes 集群中生成稳定的集群范围的资源，并完成它们，直到我们在联邦 API 服务器中为联邦对象的一部分创建对象时联邦对象被删除。底层集群中形成的资源是固定联合资源类型的联合资源的精确副本。对于其他人来说，它们是相当变化的形式，尽管肯定联合资源根本不会导致所有东西都在底层集群中产生。副本与唯一的联合版本保持同步。这种组织只是从联合服务器到底层集群的单向组织。如果我们更改底层集群中的资源，这些更改将不会同步到联合 API 服务器。例如，如果我们在联邦 API 服务器中创建一个名称空间，那么将在所有底层集群中创建一个同名的名称空间。如果我们随后在该名称空间中创建一个联合配置映射，则具有该确切名称和内容的配置映射将在同一名称空间中的所有底层集群中形成。它太分散到秘密、服务和恶魔身上了。不同之处在于复制集和部署。它们不会被盲目地复制到底层集群，因为这不是用户通常需要的。最后，如果我们进行的部署需要 10 个副本，我们可能不希望在每个底层群集中运行 10 个 pod 副本。我们总共想要 10 个复制品。因此，当我们需要部署或副本集中的所需副本计数时，联合控制器生成底层部署/副本集，使得它们的所需副本计数之和等于联合部署或副本集中指定的所需副本计数。副本定期跨集群扩展，但默认情况下可能会被覆盖。</p><p id="0362" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated"><strong class="jm hj">注</strong></p><p id="c6ee" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">我们目前需要分别连接到每个集群的 API 服务器，以获取该集群中运行的 pods 列表。我们可能不会通过联邦 API 服务器列出所有集群的 pod。另一方面，联邦条目资源不会在底层集群中形成任何条目对象。常规入口需要联合入口控制器</p><p id="889e" class="pw-post-body-paragraph jk jl hi jm b jn kg jp jq jr kh jt ju ix ki jw jx jb kj jz ka jf kk kc kd ke hb bi translated">更多详情请访问:<a class="ae kf" href="https://www.technologiesinindustry4.com/2020/11/kubernetes-cluster-federation.html" rel="noopener ugc nofollow" target="_blank">https://www . technologiesinindustry 4 . com/2020/11/kubernetes-cluster-Federation . html</a></p></div></div>    
</body>
</html>