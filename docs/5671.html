<html>
<head>
<title>Yet Another Resource Negotiator(YARN): Internals, Architecture and REST APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">另一个资源协商者(YARN):内部、架构和REST APIs</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/yet-another-resource-negotiator-yarn-internals-and-architecture-af33da73e7a?source=collection_archive---------0-----------------------#2021-10-30">https://medium.com/nerd-for-tech/yet-another-resource-negotiator-yarn-internals-and-architecture-af33da73e7a?source=collection_archive---------0-----------------------#2021-10-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bd1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在2006年初，Apache Hadoop作为一个使用编程模型在计算机集群上分布式处理大型数据集的框架被引入。Hadoop是作为一种解决方案开发的，旨在以尽可能经济高效和最简单的方式处理大数据。Hadoop由存储层<strong class="ih hj"> Hadoop分布式文件系统(HDFS) </strong>和<strong class="ih hj"> map reduce </strong>引擎组成，用于跨集群的资源利用和作业执行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/28ba90badf5b915855aa87c8a391be80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*M2xgmGIBCRrjNl3VRjanXQ.png"/></div></div></figure><p id="405c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着数据开始变得越来越大，Hadoop文件系统能够存储它，但传统的map reduce批处理框架成为了一个性能瓶颈。</p><p id="9995" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> YARN </strong>是<strong class="ih hj">的首字母缩写，另一个资源协商器</strong>已经作为Hadoop的第二代资源管理框架推出。Yarn是作为Apache Hadoop下的子项目添加的。</p><p id="e603" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">纱线成分概述</strong></p><p id="e111" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Hadoop-1中，作业跟踪器和任务跟踪器作为<strong class="ih hj">主从架构</strong>工作。作业跟踪器负责资源管理、作业调度和作业监控。Yarn在<strong class="ih hj"> Resourcemanager </strong>和<strong class="ih hj"> Applicationmaster之间分配这些作业跟踪器任务。</strong></p><p id="bc1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代替<strong class="ih hj">任务跟踪器</strong> YARN使用<strong class="ih hj">节点管理器</strong>作为工人守护进程。<strong class="ih hj">资源管理器</strong>和<strong class="ih hj">节点管理器</strong>作为纱线的计算框架。Applicationmaster是一个用于应用管理的特定于应用的框架</p><p id="6a9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">资源经理</strong></p><p id="04ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Resourcemanager是一种基于群集的服务，它管理应用程序的计算资源调度，并优化群集利用率。</p><p id="6b35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Resourcemanager有两个组件</p><p id="4aa8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">调度器</strong>:调度器负责给应用分配资源。它不保证作业完成或作业监控，调度程序根据作业的性质和资源需求分配资源。</p><p id="437e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">应用程序管理器:</strong>为应用程序主机提供资源，监控应用程序进度，并在出现故障时重启应用程序。</p><p id="fb1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">节点管理器</strong></p><p id="ed72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Nodemanager是一个基于节点容量的容器执行的每节点工作服务。内存是根据安装的内存和CPU核心数计算的。它向资源管理器发送心跳信号以更新其健康状态。</p><p id="275d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">应用主</strong></p><p id="1412" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它是一个第三方应用程序框架库，管理<strong class="ih hj"> YARN </strong>中应用程序的每个实例。它是一个第三方库，负责与资源管理器调度程序协商资源，并与节点管理器一起执行任务。资源管理器将容器分配给应用程序主机，这些容器用于运行应用程序特定的进程。监控应用程序、容器和应用程序本身的状态。</p><blockquote class="jp jq jr"><p id="36fb" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">容器是一个资源逻辑包，包括内存、CPU、磁盘内存等等，都绑定到一个特定的资源。在完成一个应用程序后，application master将取消所有容器的注册，并取消自己的注册。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/25fde77b77c635ba2a72f63b7750bdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xYJ8pSZAWBfbOR-6qaONnA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">纱线结构</figcaption></figure><p id="c7ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">执行步骤</strong></p><ul class=""><li id="b4ef" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">客户提交申请。</li><li id="9830" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">资源管理器计划程序启动应用程序主机。</li><li id="9e38" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">资源管理器调度程序根据需要将容器分配给应用程序主机。</li><li id="5429" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">节点管理器向资源管理器发送心跳信号(健康状态更新)</li></ul><p id="e2b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">【YARN如何满足大数据需求</p><ul class=""><li id="70b1" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">可伸缩性和高集群利用率:</strong>可伸缩性是应用程序在不断扩展的工作负载下工作的能力，资源管理器调度器和管理器保存应用程序资源利用率信息，并根据需要分配资源。</li><li id="d073" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">组件的高可用性:</strong>应用主机处理容器的故障，资源管理器处理应用主机和节点管理器以及应用主机的故障。</li><li id="9de2" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">灵活的资源模型:</strong>与map reduce不同，在map reduce中，资源是根据可用的map和reduce槽来定义的。Yarn有一个基于内存和内核数量的通用资源请求定义。</li></ul><p id="4bdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">纱线生命周期管理</strong></p><p id="81fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为主服务，资源管理器服务对于与yarn相关的不同进程有自己的观点。</p><p id="1290" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源管理器的不同视图是。</p><ul class=""><li id="6038" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">节点视图:</strong>节点管理器的生命周期。</li><li id="e393" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">应用视图:</strong>应用的生命周期。</li><li id="8d57" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">应用尝试:</strong>与应用的执行相关联。</li><li id="b6b6" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">容器:</strong>提交申请的业务逻辑</li></ul><p id="66e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">视图-1节点</strong></p><p id="f40c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">资源管理器的节点视图管理集群中节点管理器节点的生命周期。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/0ac982af582ae6b462828aeeba338393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qTWwTQ5u4uRDudt2IqLt9w.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">节点视图</figcaption></figure><ul class=""><li id="44d8" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">每个节点管理器用状态<strong class="ih hj"> NEW </strong>注册自己</li><li id="c4f3" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">注册成功后状态更新为<strong class="ih hj">运行</strong></li><li id="d94a" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">基于来自节点管理器的心跳，最终状态将是<strong class="ih hj">退役/重启/丢失</strong></li></ul><p id="19a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">视图-2应用</strong></p><p id="816d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由资源管理器管理的应用程序的生命周期</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kq"><img src="../Images/3ebb968964f3b3b5ac9ee0847cf35a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jSwFC9wtm5jK5AMMq6-kJQ.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">应用视图</figcaption></figure><ul class=""><li id="3a18" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">初始状态:<strong class="ih hj">新</strong></li><li id="2738" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">最终状态:<strong class="ih hj">失败/完成/死亡</strong></li></ul><p id="9368" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> View-3应用尝试</strong></p><p id="5938" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用程序对纱线簇执行的每次尝试的生命周期。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kr"><img src="../Images/7b842c5bac82b8166e1a94ae08c17614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j532-Qunkyb5sckCAFrv3g.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">应用程序尝试生命周期</figcaption></figure><ul class=""><li id="44aa" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">开始状态:<strong class="ih hj">新</strong></li><li id="919b" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">最终状态:<strong class="ih hj">完成/过期/释放/杀死</strong></li><li id="d58f" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">完成了</strong></li></ul><p id="e6c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">视图-4容器</strong></p><p id="56e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有请求容器的生命周期</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/7ac53d0d06f97e6f5817456537ba0cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Es19YRWbAxwJ0wKzhiUd5A.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">集装箱生命周期</figcaption></figure><ul class=""><li id="0bb2" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">开始状态:<strong class="ih hj">新</strong></li><li id="4dbf" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">最终状态:<strong class="ih hj">完成/过期/释放/杀死</strong></li></ul><p id="5c66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">纱托API</strong></p><p id="a66f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">资源管理器REST API</strong></p><p id="dd7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由管理员用来获取</p><ul class=""><li id="4efa" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">集群摘要</li><li id="faf8" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">调度程序详细信息</li><li id="f038" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">节点</li><li id="176b" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">应用程序</li></ul><p id="2202" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">集群总结</strong></p><ul class=""><li id="0800" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">集群元数据:</strong>这个API提供了关于集群的整体信息。</li></ul><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="9552" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/info</span></pre><p id="4a40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方法:</strong>获取</p><ul class=""><li id="be87" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">集群指标:</strong>这个API提供了总体的集群指标。包含已提交、待定和正在运行的应用程序。</li></ul><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="b4e9" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/metrics</span></pre><p id="470e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">调度程序详细信息</strong></p><p id="8d0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提供有关为群集配置的调度程序和队列的信息。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="7ca3" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/scheduler</span></pre><p id="269e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">节点</strong></p><ul class=""><li id="aa11" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">获取所有节点列表的API。</li></ul><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="713f" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/nodes/</span></pre><ul class=""><li id="13d2" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">特定节点的信息</li></ul><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="9d64" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/nodes/{id}</span></pre><p id="28cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">应用</strong></p><p id="0d3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">应用列表:</strong>用于获取应用对象或特定应用的信息的API。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="93fd" class="ky kz hi ku b fi la lb l lc ld"><a class="ae le" href="http://localhost:8088/ws/v1/cluster/apps" rel="noopener ugc nofollow" target="_blank">http://localhost:8088/ws/v1/cluster/nodes/nbdm11c-011.prevalent.com:42235</a></span></pre><p id="95ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">支持的查询参数有。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/c4b0d4a9b13bd64783779095b973ab49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Urg_REqrJaWZlRqxXsxIng.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">查询参数</figcaption></figure><p id="8a43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用程序统计:提供在集群上执行的不同应用程序的计数。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="6b89" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/appstatistics</span></pre><p id="1e33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">单项申请信息:</strong></p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="b4af" class="ky kz hi ku b fi la lb l lc ld">http://localhost:8088/ws/v1/cluster/appstatistics/{id}</span></pre></div></div>    
</body>
</html>