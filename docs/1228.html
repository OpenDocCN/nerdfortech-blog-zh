<html>
<head>
<title>NodeJs &amp; Express with Typescript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有类型脚本的 NodeJs &amp; Express</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/nodejs-express-with-typescript-9cc5f4007fae?source=collection_archive---------2-----------------------#2021-03-10">https://medium.com/nerd-for-tech/nodejs-express-with-typescript-9cc5f4007fae?source=collection_archive---------2-----------------------#2021-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/852b31f1536fd2dfa9cf5447b749dbd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8gOG4SkO657mSnBv9GZFA.jpeg"/></div></div></figure><p id="9cb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大家好啊！！</p><p id="7091" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将讨论如何在你的<strong class="is hj"> NodeJs </strong>和<strong class="is hj"> Express </strong>项目中使用 typescript。到目前为止，Typescript 已经成为 JS 社区中使用最多的语言之一。</p><p id="3722" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随着整个行业使用 React 趋势的增加，typescript 在经验丰富的开发人员和新手中获得了很大的流行。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/d0c3a964277ba80c95bb0d8893b268e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZdEplZdc-1S5qra7"/></div></div></figure><p id="292f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的图表中可以看出，Typescript 自创建以来就越来越受欢迎。</p><h1 id="9bb4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么是 Typescript？</h1><p id="841a" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">Typescript 是微软开发的 Javascript 的超集。</p><blockquote class="kw kx ky"><p id="ef2f" class="iq ir kz is b it iu iv iw ix iy iz ja la jc jd je lb jg jh ji lc jk jl jm jn hb bi translated"><em class="hi"> Typescript 是一种建立在 Javascript 之上的开源语言，增加了静态定义类型。</em></p><p id="052b" class="iq ir kz is b it iu iv iw ix iy iz ja la jc jd je lb jg jh ji lc jk jl jm jn hb bi translated"><em class="hi"> —打字稿首页</em></p></blockquote><p id="e1d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦编译完成，TS 文件就被转换成等价的 Javascript 代码。那么出现的问题就是我们为什么要用它。</p><p id="41fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你仔细观察这个定义，它确实提到了“静态定义类型”这个短语。总的来说，Javascript 不是一种强类型语言，也就是说，有时脚本在执行时不会像预期的那样运行。调试代码并找出逻辑错误会让开发人员付出代价，并显著增加工作量。</p><p id="ece1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Typescript 让我们<strong class="is hj"> <em class="kz">用<strong class="is hj"> <em class="kz">强类型检查</em> </strong>写出整洁有序的代码</em> </strong>。这有助于开发人员成倍地减少调试时间。</p><p id="fa9e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我不打算深入研究 typescript 的基础知识，而是主要关注如何在我们的 node/express 项目中使用 Typescript。</p><h1 id="2e28" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">项目设置</h1><p id="809b" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">让我们先快速地为 express 设置项目。</p><p id="7eb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建新的 express 项目的过程与任何常规的 express 或 node 项目相同。</p><p id="5c11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动机器上的终端，执行以下命令进行设置。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="56e2" class="li ju hi le b fi lj lk l ll lm">npm init</span></pre><p id="33d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将在终端中弹出向导，允许我们定义一些基本设置。完成向导，这样，package.json 文件就会出现在您试图安装项目的文件夹中。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="7bf0" class="li ju hi le b fi lj lk l ll lm">{<br/>  "name": "nodets",<br/>  "version": "1.0.0",<br/>  "description": "Sample nodejs express and typescript project.",<br/>  "main": "server.js",<br/>  "scripts": {<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "author": "",<br/>  "license": "ISC"<br/>}</span></pre><p id="ae55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们继续安装项目的依赖项。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="97c5" class="li ju hi le b fi lj lk l ll lm">npm i -P express<br/>npm i -D nodemon</span></pre><p id="d9af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上语句将<strong class="is hj"> express </strong>以及<strong class="is hj"> nodemon </strong>包安装到您的项目中。我使用<strong class="is hj"> npm </strong>作为包管理器，但是如果你喜欢，你也可以使用<strong class="is hj"> yarn </strong>。Nodemon 允许我们在本地运行我们的项目，这就是我把它作为一个开发依赖项安装的原因。</p><h1 id="ae9c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">启用 Typescript</h1><p id="2fef" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">现在是时候在我们的项目中引入 typescript 了。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="3821" class="li ju hi le b fi lj lk l ll lm">node i -D typescript ts-node</span></pre><p id="b7e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述语句将 typescript 和 typescript 支持的 nodejs 包安装到项目中。</p><h1 id="6c68" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">安装声明文件</h1><p id="daef" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">这些文件具有特定的格式，并且包含您希望在项目中使用的库或模块的类型定义。</p><p id="0898" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您愿意，您可以编写自己的声明文件，但是对于常用的库，有一些预定义的文件可用。这里有这样做的指南— <a class="ae ln" href="https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html" rel="noopener ugc nofollow" target="_blank">如何编写声明文件？</a></p><p id="0c61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些通常以@types 名称空间开头，后跟库名。</p><p id="1387" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以根据需要在库名中浏览包，因为<a class="ae ln" href="https://github.com/DefinitelyTyped/DefinitelyTyped" rel="noopener ugc nofollow" target="_blank">是明确键入的</a>。一般来说，各自的定义可以在库名下找到。例如，节点将在@types/node 下可用。</p><p id="a16e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要安装带有 Node 类型定义的声明文件，请在终端中快速执行以下命令。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="4f29" class="li ju hi le b fi lj lk l ll lm">npm i -D @types/express @types/node</span></pre><h1 id="8935" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">TSConfig 定义</h1><p id="8210" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">TSConfig 只不过是一个 json 文件，由 typescript 编译器将要用来构建项目的编译器设置组成。它被命名为<strong class="is hj"> tsconfig.json </strong>，编译器会试图在你的项目的根目录下找到这个文件。</p><p id="1aa7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以手动创建此文件，或者如果您已经全局安装了 typescript，则可以使用以下内容</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="1292" class="li ju hi le b fi lj lk l ll lm">tsc --init</span></pre><p id="989b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将在项目的根目录下创建一个新的 tsconfig.json。将会有很多注释代码，您可以清除它们，并继续使用下面提供的选项。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="44e0" class="li ju hi le b fi lj lk l ll lm">{<br/>  "compilerOptions": {<br/>    "target": "es6",<br/>    "module": "commonjs",<br/>    "rootDir": "./",<br/>    "outDir": "./build",<br/>    "esModuleInterop": true,<br/>    "strict": true<br/>  }<br/>}</span></pre><ul class=""><li id="9fa7" class="lo lp hi is b it iu ix iy jb lq jf lr jj ls jn lt lu lv lw bi translated"><strong class="is hj">compile options</strong>—需要作为 tsconfig.json 的一部分提供的强制对象</li><li id="2e03" class="lo lp hi is b it lx ix ly jb lz jf ma jj mb jn lt lu lv lw bi translated"><strong class="is hj"> target </strong>:指定编译器应该编译代码的 javascript 版本。如果您想启用对旧浏览器的支持，可以选择较低版本。</li><li id="34de" class="lo lp hi is b it lx ix ly jb lz jf ma jj mb jn lt lu lv lw bi translated"><strong class="is hj">模块</strong>:设置项目的模块系统。“CommonJs”主要用于节点项目。</li><li id="6c25" class="lo lp hi is b it lx ix ly jb lz jf ma jj mb jn lt lu lv lw bi translated"><strong class="is hj"> rootDir </strong>:所有非声明输入文件的最长公共路径。它指定项目中文件的位置。</li><li id="977a" class="lo lp hi is b it lx ix ly jb lz jf ma jj mb jn lt lu lv lw bi translated"><strong class="is hj"> outDir </strong>:编译器输出所在的输出目录。</li><li id="6e3c" class="lo lp hi is b it lx ix ly jb lz jf ma jj mb jn lt lu lv lw bi translated"><strong class="is hj"> esModuleInterop </strong>:该选项允许编译器将 ES6 模块编译成 CommonJs 模块。</li><li id="6b00" class="lo lp hi is b it lx ix ly jb lz jf ma jj mb jn lt lu lv lw bi translated"><strong class="is hj">严格</strong>:启用严格类型检查选项</li></ul><p id="da0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了方便起见，您可以使用其他选项。你可以在这里阅读这些选项— <a class="ae ln" href="https://www.typescriptlang.org/tsconfig" rel="noopener ugc nofollow" target="_blank"> tsconfig.json 选项</a></p><p id="19b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">定义好之后，启动 package.json 文件，并将以下代码添加到脚本部分</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="7704" class="li ju hi le b fi lj lk l ll lm">"scripts": {<br/>  "dev": "nodemon server.ts"<br/>}</span></pre><p id="a42e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我之前确实安装了<strong class="is hj"> nodemon </strong>包来观察我们文件的变化。上述命令将只在本地服务器上运行代码。</p><h1 id="f5de" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用 Typescript 的基本服务器</h1><p id="9979" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">一旦您完成了以上所有步骤，您就可以在您的 express 项目中继续使用 typescript 了。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="edf1" class="li ju hi le b fi lj lk l ll lm">import express from 'express';</span><span id="8de8" class="li ju hi le b fi mc lk l ll lm">const app = express();<br/>app.use(express.json());</span><span id="bbb3" class="li ju hi le b fi mc lk l ll lm">const PORT = 5000;</span><span id="2dc9" class="li ju hi le b fi mc lk l ll lm">app.get('/',(req,res,next) =&gt; {<br/>    res.status(200).json({<br/>        'message': 'Running Node with Express and Typescript'<br/>    });<br/>});</span><span id="0b0a" class="li ju hi le b fi mc lk l ll lm">app.listen(PORT, () =&gt; {<br/>    console.log(<br/>        `Server running on ${PORT}.`<br/>    )<br/>});</span></pre><p id="3cb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到项目文件夹下的终端并运行</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="ac09" class="li ju hi le b fi lj lk l ll lm">npm run dev</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/43acea0a0af80f2975089f2ae7d23937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y2xx-eL-4bx7nyxj"/></div></div></figure><p id="8a3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到您的浏览器或任何 http 客户端，如 POSTMAN，并尝试访问以下 URL</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="fc08" class="li ju hi le b fi lj lk l ll lm"><a class="ae ln" href="http://localhost:5000" rel="noopener ugc nofollow" target="_blank">http://localhost:5000</a></span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/0ec31b0d7ac63cf23de9e41730e1eb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ij5X1_WQjVUHTF5j"/></div></div></figure><h1 id="307e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">构建您的项目</h1><p id="07e0" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">要构建您的项目，请将以下内容添加到您的 package.json 文件的脚本部分下。</p><pre class="jp jq jr js fd ld le lf lg aw lh bi"><span id="c8a9" class="li ju hi le b fi lj lk l ll lm">"build": "tsc --project ./"</span></pre><p id="a8ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将使用 typescript 构建您的项目，并将您的构建文件输出到您的<strong class="is hj"> tsconfig.json </strong>中配置的文件夹。在我们的例子中，这将是“<strong class="is hj">构建</strong>文件夹。</p><h1 id="ef04" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结束语</h1><p id="a43a" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">就是你。您的项目现在启用了 typescript，您可以将 typescript 中的所有功能作为项目的一部分来使用。</p><p id="baab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">记住，要为要与 typescript 一起使用的包安装声明文件。如果包的声明文件丢失了，当您试图运行您的项目时，编译器会抱怨包丢失了。</p><p id="9df2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">厉害！我希望你喜欢读我的文章。如果你有什么建议，请在下面留下评论。</p><p id="45dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">示例项目的完整源代码可以在— <a class="ae ln" href="https://github.com/cmgabriel/NodeTs/tree/main" rel="noopener ugc nofollow" target="_blank">链接到 GitHub 库</a>找到</p><p id="9569" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢谢大家！快乐编码:)</p></div></div>    
</body>
</html>