<html>
<head>
<title>How to downgrade Android Emulator on macOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在macOS上降级Android模拟器</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-downgrade-android-emulator-on-macos-6e611d2d2bcb?source=collection_archive---------2-----------------------#2021-03-27">https://medium.com/nerd-for-tech/how-to-downgrade-android-emulator-on-macos-6e611d2d2bcb?source=collection_archive---------2-----------------------#2021-03-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="6345" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">问题</h1><p id="1797" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在最近将Android Studio升级到4.1.3之后，我在尝试启动Android虚拟设备时遇到了一个问题。错误消息如下:<em class="kb"> AVD管理器AVD Pixel _ 2 _ API _ 29的仿真器进程被终止。</em></p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/53a545ff88ebba25dc84b7e265dc8238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkQefTGBFBdxCV1dHv9UhA.png"/></div></div></figure><p id="b9da" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">AVD在一天前测试React原生项目时工作得非常好，所以我知道升级很可能是错误的原因。在这篇文章中，我将介绍我解决这个问题的步骤，并提供我发现的解决方案，其中包括将Android模拟器降级到以前的版本。</p><h1 id="6f15" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">解决纷争</h1><p id="db84" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我尝试的第一件事是创建一个新的AVD，使用与前一天工作的相同的设置。我尝试使用API 29和30来查看它是否与API版本相关，但这并没有修复错误。</p><p id="da61" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">在堆栈溢出和其他论坛上搜索解决方案后，我偶然看到一个<a class="ae kt" href="https://stackoverflow.com/a/64981574" rel="noopener ugc nofollow" target="_blank">帖子</a>建议将图形模式设置为<em class="kb">软件</em>而不是<em class="kb">自动/硬件</em>。虽然这似乎对一些人有用，但对我没用。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ku"><img src="../Images/6a65293052eace9df1d6ca37f19e248c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vjd0tA2AM7i7fjdl4T2KSQ.gif"/></div></div></figure><p id="9359" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated"><a class="ae kt" href="https://stackoverflow.com/a/66136694" rel="noopener ugc nofollow" target="_blank">另一位用户解释说</a>在SDK工具菜单中卸载然后重新安装<em class="kb">英特尔x86模拟器加速器(HAXM安装程序)</em>已经解决了他们的问题，但不幸的是这对我也不起作用。</p><h2 id="e3dc" class="kv ig hi bd ih kw kx ky il kz la lb ip jo lc ld it js le lf ix jw lg lh jb li bi translated">越来越接近解决方案…</h2><p id="1963" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我采取的最后一个调试步骤是尝试从命令行手动启动模拟器。我使用这个命令列出了每个AVD的名称，并确保仿真器首先能够访问它们。</p><pre class="kd ke kf kg fd lj lk ll lm aw ln bi"><span id="2e01" class="kv ig hi lk b fi lo lp l lq lr">emulator -list-avds</span></pre><p id="2b76" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">一旦我得到了返回的模拟器列表，我就试着运行其中一个。</p><pre class="kd ke kf kg fd lj lk ll lm aw ln bi"><span id="631b" class="kv ig hi lk b fi lo lp l lq lr">emulator -avd Pixel_2_API_29</span></pre><p id="db2d" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这给了我一个新的错误，至少更具描述性。上面写着:</p><pre class="kd ke kf kg fd lj lk ll lm aw ln bi"><span id="4789" class="kv ig hi lk b fi lo lp l lq lr">emulator: Android emulator version 30.5.3.0 (build_id 7196367) (CL:N/A)<br/>dyld: Library not loaded: /System/Library/Frameworks/IOUSBHost.framework/Versions/A/IOUSBHost</span></pre><p id="432c" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">在使用这个新错误进行了更多搜索后，我发现了一个<a class="ae kt" href="https://stackoverflow.com/questions/66697645/cannot-start-android-emulator-library-not-loaded" rel="noopener ugc nofollow" target="_blank">帖子</a>解释说苹果已经在macOS 10.15中引入了<em class="kb"> IOUSBHost </em>，看起来最好的解决办法就是简单地降级到不需要这个框架的旧版本Android模拟器，至少在我可以升级我的操作系统之前。</p><p id="7c9b" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">在寻找了很多降级的方法后，我看到了这篇解释降级过程的文章。很难找到我试图安装的android模拟器旧版本的正确网址，但经过一些搜索后，我找到了<a class="ae kt" href="https://developer.android.com/studio/releases/emulator#30-4-5" rel="noopener ugc nofollow" target="_blank">以前稳定版本3.4.5 </a>的网址。</p><p id="06b1" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">我在下面概述了下载和降级Android模拟器的步骤。</p><h1 id="fa23" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">解决方案</h1><p id="14c5" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">你会在这里找到Android Emulator 3.4.5的网址:<a class="ae kt" href="https://dl.google.com/android/repository/emulator-darwin_x64-7140946.zip" rel="noopener ugc nofollow" target="_blank">https://dl . Google . com/Android/repository/Emulator-Darwin _ x64-7140946 . zip</a></p><p id="d821" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">一旦下载了这个文件，解压缩它，您应该会看到以下内容。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ls"><img src="../Images/7abc8da1edb934dd55bd2976a9cfdfa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yk_h_8O1V84iy4eq9Kge8g.png"/></div></div></figure><p id="2d39" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">当前安装在您计算机上的模拟器文件夹的位置应该在:</p><pre class="kd ke kf kg fd lj lk ll lm aw ln bi"><span id="66cd" class="kv ig hi lk b fi lo lp l lq lr">~/Library/Android/sdk/emulator</span></pre><p id="3063" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">但是，您可以在终端中键入以下内容，仔细检查您的终端可能安装在哪里:</p><pre class="kd ke kf kg fd lj lk ll lm aw ln bi"><span id="468d" class="kv ig hi lk b fi lo lp l lq lr">which emulator</span></pre><p id="c08c" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">下一步是用下载的模拟器文件夹中的文件替换当前安装的模拟器文件夹中的文件。我建议备份当前安装的模拟器，以防您需要快速恢复您的更改。</p><p id="398d" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">我通过简单的复制和粘贴做到了这一点，我可以覆盖任何名称匹配的文件。这很重要，因为您实际上希望将<em class="kb"> package.xml </em>文件保留在当前安装的模拟器文件夹中。这个文件会欺骗Android Studio，让它认为你已经安装了最新版本。</p><p id="f01b" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">如果你不保留这个文件，你将无法使用Android Studio UI启动你的AVD，相反，它会尝试自动将你升级到最初导致错误的那个版本。然而，从技术上讲，您仍然可以在没有<em class="kb"> package.xml </em>文件的情况下，通过使用命令行运行仿真器来启动AVD，但这并不理想。</p><p id="fed8" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">一旦你做到了这一点，你应该能够成功地再次启动你的AVD！如果你现在查看Android Studio中的SDK工具菜单，它仍然会认为你安装了最新版本的Android模拟器，在我的例子中是3.5.3。为了避免这个问题，我可以在<em class="kb"> package.xml </em>文件的第141行编辑<em class="kb"> revision </em>标签:</p><pre class="kd ke kf kg fd lj lk ll lm aw ln bi"><span id="d4f5" class="kv ig hi lk b fi lo lp l lq lr">&lt;revision&gt;&lt;major&gt;30&lt;/major&gt;&lt;minor&gt;4&lt;/minor&gt;&lt;micro&gt;5&lt;/micro&gt;&lt;/revision&gt;</span></pre><p id="678c" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这个错误很难弄清楚，但我希望这些步骤可以帮助任何有类似问题的人。如果有人找到了另一个修复方法，请告诉我！</p></div></div>    
</body>
</html>