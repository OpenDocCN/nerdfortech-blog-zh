<html>
<head>
<title>Olfactory Prediction — Unsupervised Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">嗅觉预测——无监督学习</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/olfactory-prediction-unsupervised-learning-f9a19f4154d1?source=collection_archive---------17-----------------------#2021-05-22">https://medium.com/nerd-for-tech/olfactory-prediction-unsupervised-learning-f9a19f4154d1?source=collection_archive---------17-----------------------#2021-05-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/0acf96a5c40300480c6e1887a361efc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/0*TNV_Z5cNUFeMoC3-.jpg"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">来源:Pinterest</figcaption></figure><div class=""/><p id="bbfe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们生活的世界里，我们可以通过音轨分享声音，通过照片分享视觉，通过移动设备内置的触觉分享某些身体感觉。但是气味呢？</p><p id="6abe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个棘手的领域，仅仅是因为气味本身的主观性。不同的人习惯于不同程度和种类的气味，因此他们对每种气味的感知不同或强度不同。这造成了一个很大的差距，在创造一个地面现实的化合物是“真的”联系在一起的气味。</p><p id="6255" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，好气味公司的专家(<a class="ae jo" href="http://www.thegoodscentscompany.com/allodor.html" rel="noopener ugc nofollow" target="_blank">气味类型列表(thegoodscentscompany.com)</a>)能够提出一套全面的气味类别，以及每个气味类别中的数百种化合物，可以作为推进研究的基础。这个源是创建数据集的好地方。我随机挑选了10个气味类别，每个类别中有10种化合物。这创建了一个包含近100种化合物的数据集。我们需要每种化合物的主要数据点是它的IUPAC名称、SMILE以及各自的气味和气味类别。为了更好地理解，我添加了一些数据值。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jp"><img src="../Images/b62e6244508da05048e2bb697a49207c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0iAD2YTeJN4jpfXPXKmBQ.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">图一。气味数据集</figcaption></figure><p id="a750" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了化合物的坚实基础，我们就可以深入问题陈述——如何从化合物的分子描述符中识别气味？</p><blockquote class="jy jz ka"><p id="7bf9" class="iq ir kb is b it iu iv iw ix iy iz ja kc jc jd je kd jg jh ji ke jk jl jm jn hb bi translated"><strong class="is hu">分子描述符</strong></p></blockquote><p id="5046" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于一个机器学习工程师来说，这只是一个简单的数学数字。它与化合物的不同物理属性有关，如原子数、原子量、电负性等。它有助于创建一种可量化的方法来衡量如何在数学空间中识别每种化合物，这使得训练模型或帮助计算机理解化学物质变得更容易。</p><p id="4f0f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于一个化学工程师来说，这有实际的物理意义，并且会告诉我们更多关于化合物的化学性质。</p><p id="1ac4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你对分子描述符不熟悉，在你继续之前先阅读一下这个<a class="ae jo" href="https://www.sciencedirect.com/topics/medicine-and-dentistry/molecular-descriptor" rel="noopener ugc nofollow" target="_blank">分子描述符——概述|科学直接主题</a>，并且阅读<a class="ae jo" href="https://www.sciencedirect.com/topics/computer-science/adjacency-matrix" rel="noopener ugc nofollow" target="_blank">邻接矩阵——概述|科学直接主题</a>来理解相关描述符的物理意义。</p><p id="7b33" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用名为<a class="ae jo" href="https://pypi.org/project/mordred/" rel="noopener ugc nofollow" target="_blank"> mordred PyPI </a>的python库，计算这些分子描述符变得极其简单。该软件包中提供了2D和3D描述符。2D描述符可以直接从化合物的微笑中计算出来，因此我只使用了2D描述符。SMILES是简化的分子输入行输入系统(SMILES)，用于使用短ASCII字符串描述化学物种的结构。我总共使用了48个描述符，你可以在代码中找到。</p><pre class="jq jr js jt fd kf kg kh ki aw kj bi"><span id="f20d" class="kk kl ht kg b fi km kn l ko kp"># Locate and load the data base file from the local machine<br/>df = pd.read_csv(r"C:\Documents\Olfaction Project\odor_data.csv")<br/><br/># Defining the columns required from the data frame<br/>features = [<em class="kb">'Common name', 'Odor Class', 'ABCIndex', 'Acidic Group Count', 'Basic Group Count', 'Adjacency Matrix', 'Aromatic Atom Count', 'Aromatic Bond Count', 'Atom Count', 'Autocorrelation ATS', 'Autocorrelation ATSC', 'BalabanJ', 'Barysz Matrix ','BCUT', 'BertzCT', 'BondCount', 'CarbonTypes', 'Chi', 'ConstitutionalSum', 'ConstitutionalMean','DistanceMatrix','EccentricConnectivityIndex','AtomTypeEState','EtaCoreCount','EtaShapeIndex','EtaVEMCount','FragmentComplexity','Framework','HBondAcceptor','HBondDonor','InformationContent','VMcGowan','LabuteASA','MID','PathCount','APol','Bpol','RingCount','nRot','SLogP','JGT10','Diameter','TopoShapeIndex','TopoPSA', 'Vabc', 'VAdjMat','MWC01', 'MW', 'WPath', 'Zagreb1'</em>]</span></pre><p id="5dbe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经在第一个数据库中添加了所有的描述符及其值，然后在这个更新的数据库上定义了这个特性数组。这样你就不必担心描述符是如何计算出来的。由于这个研究领域已经被隔离，没有任何可用的数据库。请随意使用我这里的综合数据集<a class="ae jo" href="https://www.kaggle.com/manyasingh0909/odour-listing?select=odor_data.csv" rel="noopener ugc nofollow" target="_blank">气味列表| Kaggle </a></p><blockquote class="jy jz ka"><p id="73bc" class="iq ir kb is b it iu iv iw ix iy iz ja kc jc jd je kd jg jh ji ke jk jl jm jn hb bi translated"><strong class="is hu">主成分分析</strong></p></blockquote><p id="3918" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我们知道有48个描述符或参数要处理，所以我们需要降低这个数字。一个简单的方法是，主成分分析(PCA)丁。主成分分析将有助于分析哪些参数的方差最大。有了这些分析，我们就可以只使用这4或5个主要成分作为关键参数来调整我们的模型。</p><p id="a7ea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你是PCA的新手，这里有一个全面解释的链接:<a class="ae jo" href="https://towardsdatascience.com/principal-component-analysis-with-python-an-example-for-beginners-by-a-beginner-ac052eff45c" rel="noopener" target="_blank">主成分分析</a></p><pre class="jq jr js jt fd kf kg kh ki aw kj bi"><span id="570d" class="kk kl ht kg b fi km kn l ko kp"># Defining input x as all 48 descriptors<br/>x = df.iloc[:, 6:53]<br/>x = StandardScaler().fit_transform(x)<br/># Defining output y as the odour class each compound belongs to<br/>y = df['Odor Class']</span><span id="68f6" class="kk kl ht kg b fi kq kn l ko kp"># Applying PCA<br/>pca = PCA()<br/>PC = pca.fit(x)<br/>pca = PCA(n_components=5)<br/>scores_pca = pca.transform(x)<br/>print(scores_pca)</span></pre><p id="e585" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">主成分分析的结果将给出一定数量(由您定义)的列，这些列中填充了每个化合物的数字。这些数字告诉你，对于特定的化合物，该成分的重量是多少。这些列被称为PCA得分。要查看主成分的名称，或显示最高方差的参数，使用以下代码。</p><pre class="jq jr js jt fd kf kg kh ki aw kj bi"><span id="bc1b" class="kk kl ht kg b fi km kn l ko kp"><br/>PCloadings = pca.components_.T * np.sqrt(pca.explained_variance_)<br/>components=df.columns.tolist()<br/>components=components[6:53]<br/>loadingdf=pd.DataFrame(PCloadings,columns=('PC1','PC2'))<br/>loadingdf["variable"]=components</span><span id="683b" class="kk kl ht kg b fi kq kn l ko kp"># The plot<br/>fig = ex.scatter(x=loadingdf['PC1'],y=loadingdf['PC2'],text=loadingdf["variable"])<br/>fig.update_layout( height=600,width=500, title_text='loadings plot')<br/>fig.update_traces(textposition='bottom center')<br/>fig.add_shape(type="line", x0=-0, y0=-0.5,x1=-0,y1=2.5, line=dict(color="RoyalBlue",width=3))<br/>fig.add_shape(type="line", x0=-1, y0=0,x1=1,y1=0, line=dict(color="RoyalBlue", width=3))<br/>fig.show()</span></pre><figure class="jq jr js jt fd hk er es paragraph-image"><div class="er es kr"><img src="../Images/85d7397ea2395bd5d6781f9db2b2e54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*4uVL_-3uP6qTZnKJrdOhmQ.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">图2分子描述符与它们的PCA分数</figcaption></figure><p id="1b57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从这里我们可以看出，芳族原子数、芳族键数、结构平均值和骨架是最大的方差，因此可以推断为主成分。这些在化学和气味研究领域具有物理意义，但我们将使用它来创建我们的预测模型。</p><blockquote class="jy jz ka"><p id="af39" class="iq ir kb is b it iu iv iw ix iy iz ja kc jc jd je kd jg jh ji ke jk jl jm jn hb bi translated"><strong class="is hu"> K表示聚类</strong></p></blockquote><p id="a278" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了更小的参数池，我们现在可以开始构建我们的模型了。正如我们所知，预测化合物的气味是一种无监督学习。这指导我们使用聚类算法来简化我们的问题。我在PCA的结果上使用K均值聚类来创建一个更好的模型。</p><p id="eb72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您不熟悉K-Means聚类，请阅读<a class="ae jo" href="https://towardsdatascience.com/machine-learning-algorithms-part-9-k-means-example-in-python-f2ad05ed5203" rel="noopener" target="_blank"> K-means聚类Python示例|作者Cory Maklin |走向数据科学</a></p><pre class="jq jr js jt fd kf kg kh ki aw kj bi"><span id="7bb1" class="kk kl ht kg b fi km kn l ko kp"># finding the k means clusters on the PCA score<br/><br/>kmeans_pca = KMeans(n_clusters=8, init='k-means++', random_state=42)<br/>kmeans_pca.fit(scores_pca)<br/><br/>df_new = pd.concat([df.reset_index(drop= True), pd.DataFrame(scores_pca)], axis=1)<br/>df_new.columns.values[-5:] = ['Component0','Component1','Component2','Component3','Component4']<br/>df_new['Segment K-means PCA'] = kmeans_pca.labels_<br/>df_new['Segment'] = df_new['Segment K-means PCA'].map({0:'first',<br/>                                                      1:'second',<br/>                                                      2:'third',<br/>                                                      3:'fourth',<br/>                                                      4:'fifth',<br/>                                                      5:'sixth',<br/>                                                      6:'seventh',<br/>                                                      7:'eighth'})</span></pre><p id="25b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">K均值聚类算法根据每个PCA分数值之间的距离对化合物进行分组。它创建相似PCA分数的聚类，并分离那些具有非常远的值的聚类。这使得具有相似值的化合物成簇，并且可以产生多个这样的簇。集群的数量可以由你在代码中控制。为了可视化聚类，我们绘制第一主成分与第二主成分的关系图。</p><pre class="jq jr js jt fd kf kg kh ki aw kj bi"><span id="3627" class="kk kl ht kg b fi km kn l ko kp"># Visualizing the clusters<br/><br/>x_axis = df_new['Component0']<br/>y_axis = df_new['Component1']<br/>plt.figure(figsize = (10,8))<br/>sns.scatterplot(x_axis, y_axis, hue = df_new['Segment K-means PCA'], palette=['g', 'r', 'c', 'm', 'k', 'orange', 'brown', 'orchid'])<br/><br/>plt.title("Clusters by PCA components")<br/>plt.show()</span></pre><figure class="jq jr js jt fd hk er es paragraph-image"><div class="er es ks"><img src="../Images/9f7a735edd213c19d1de17e5e4b2cac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*RQzpTVasKLkFNGZFt4IKXg.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">图3主成分1与主成分2</figcaption></figure><p id="a0a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">整个数据集上的聚类非常混乱，因此为了简化结果，我们可以将数据集分成更小的部分。每个部分都可以是整个数据集的一个更小的子集。这将在每个数据集上创建不同的聚类，并为每个数据集上的每个模型带来不同的准确性/效率。因此，我们需要一种方法来评估哪个数据集与哪个模型相结合会给我们带来最好的结果或最小的预测误差。</p><blockquote class="jy jz ka"><p id="2dff" class="iq ir kb is b it iu iv iw ix iy iz ja kc jc jd je kd jg jh ji ke jk jl jm jn hb bi translated"><strong class="is hu">集群评估</strong></p></blockquote><p id="0af7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">K- Fold交叉验证是评估任何线性模型性能的常用方法，但是将它应用于聚类算法可能会很棘手。首先，我把我的数据集分成5个更小的数据集，每个4或5个气味类别。这产生了更好的聚类图。在每个数据集上，我应用了一个简单的k倍验证来观察MAE和RMSE。RMSE值没有对错之分，但是将其应用于不同的数据集，产生最低值的数据集可以帮助我们专注于模型。这里有一个解释RMSE<a class="ae jo" href="https://towardsdatascience.com/what-does-rmse-really-mean-806b65f2e48e" rel="noopener" target="_blank">RMSE到底是什么意思</a>的链接</p><pre class="jq jr js jt fd kf kg kh ki aw kj bi"><span id="646a" class="kk kl ht kg b fi km kn l ko kp"># define predictor and response variables<br/>X = df_new[['target']]<br/>y = df_new['Segment K-means PCA']<br/><br/><br/># define cross-validation method to use<br/>cv = KFold(n_splits=10, random_state=1, shuffle=True)<br/><br/># build multiple linear regression model<br/>model = LinearRegression()<br/><br/># use k-fold CV to evaluate model<br/>scores = cross_val_score(model, X, y, scoring='neg_mean_absolute_error', cv=cv, n_jobs=-1)<br/><br/># view mean absolute error<br/><br/>print("MAE")<br/>print(mean(absolute(scores)))<br/>print("RMSE")<br/>print(sqrt(mean(absolute(scores))))</span></pre><p id="e096" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该代码可用于聚类模型，以帮助确定哪个数据集将给出最低的平均相对误差和RMSE值。一旦解决了这个问题，所有的分析和结果都可以从同一个地方得出。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div class="er es kt"><img src="../Images/0963a0b2af341f21e602f1d80cd431a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*xhN1-5HA89hPqB_A43Yo8Q.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">图4 8个聚类图的结果</figcaption></figure><p id="86b7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以清楚地看到这些簇，但是这回避了哪个簇对应于哪个气味类别的问题。这可以通过每个气味类别下的简单投票机制来解决，其中我们计算k均值聚类给出的最大投票。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ku"><img src="../Images/dcf74a68b2db8cc1ff095ed93845a08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-8ErGfRNbFb8NDm_EUstA.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx translated">图5将聚类映射到气味</figcaption></figure><p id="e00c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在GitHub存储库中找到用于构建这个项目的完整代码和所有数据集:</p><blockquote class="jy jz ka"><p id="b0eb" class="iq ir kb is b it iu iv iw ix iy iz ja kc jc jd je kd jg jh ji ke jk jl jm jn hb bi translated"><a class="ae jo" href="https://github.com/manya09singh/Odour-Prediction" rel="noopener ugc nofollow" target="_blank">manya 09 Singh/气味预测:根据化合物的分子描述符(github.com)进行气味预测的全长代码</a></p></blockquote><p id="80ec" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你遇到任何问题，请随时在评论区联系我！感谢您的阅读:)</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><p id="6113" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">资源和链接</p><ul class=""><li id="fdc7" class="lc ld ht is b it iu ix iy jb le jf lf jj lg jn lh li lj lk bi translated">【thegoodscentscompany.com T2】气味类型清单</li><li id="507a" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><a class="ae jo" href="https://www.kaggle.com/manyasingh0909/odour-listing" rel="noopener ugc nofollow" target="_blank">气味列表| Kaggle </a></li><li id="8108" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">莫德雷德·皮比</li><li id="0173" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><a class="ae jo" href="https://pubchem.ncbi.nlm.nih.gov/" rel="noopener ugc nofollow" target="_blank">公共化学(nih.gov)</a></li><li id="1a43" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><a class="ae jo" href="https://www.sciencedirect.com/topics/medicine-and-dentistry/molecular-descriptor" rel="noopener ugc nofollow" target="_blank">分子描述符—概述|科学直接主题</a></li><li id="866a" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">P <a class="ae jo" href="https://towardsdatascience.com/principal-component-analysis-with-python-an-example-for-beginners-by-a-beginner-ac052eff45c" rel="noopener" target="_blank">用python进行主成分分析</a></li><li id="cba4" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><a class="ae jo" href="https://towardsdatascience.com/machine-learning-algorithms-part-9-k-means-example-in-python-f2ad05ed5203" rel="noopener" target="_blank"> K-means聚类Python示例|作者Cory Maklin |走向数据科学</a></li><li id="76b6" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><a class="ae jo" href="https://link.springer.com/article/10.1007/s42979-020-00283-z#Sec6" rel="noopener ugc nofollow" target="_blank">评估聚类算法的交叉验证方法:使用多标签数据集的实验研究| SpringerLink </a></li><li id="89a2" class="lc ld ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><a class="ae jo" href="https://www.researchgate.net/publication/5984319_Predicting_Odor_Pleasantness_from_Odorant_Structure_Pleasantness_as_a_Reflection_of_the_Physical_World" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/publication/5984319 _ Predicting _ Odor _ pleasant ness _ from _ Odorant _ Structure _ pleasant ness _ as _ a _ Reflection _ of _ the _ Physical _ World</a></li></ul></div></div>    
</body>
</html>