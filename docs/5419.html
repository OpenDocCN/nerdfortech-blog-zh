<html>
<head>
<title>Face Features: From CoreImage To Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人脸特征:从核心图像到视觉</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/face-features-from-coreimage-to-vision-d45a36ccecb?source=collection_archive---------6-----------------------#2021-09-29">https://medium.com/nerd-for-tech/face-features-from-coreimage-to-vision-d45a36ccecb?source=collection_archive---------6-----------------------#2021-09-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1ab1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将考虑<strong class="ih hj">CoreImage</strong>&amp;<strong class="ih hj">Apple Vision</strong>主要用于面部跟踪和面部特征检测的可能性。</p><h2 id="b04d" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated"><strong class="ak"> CoreImage </strong></h2><p id="912c" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">令我惊讶的是，CoreImage能够像苹果视觉一样检测大部分特征。看一看<strong class="ih hj"> CIDetector。</strong> <strong class="ih hj"> Init </strong>方法接受探测器类型:</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kd"><img src="../Images/9617c78be037f765e6436f2ab08c3ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfZ_K5322rGTqKrtJ5yKKQ.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">CIDetector构造函数方法</figcaption></figure><pre class="ke kf kg kh fd kt ku kv kw aw kx bi"><span id="7589" class="jd je hi ku b fi ky kz l la lb">CIDetectorTypeFace // face detection<br/>CIDetectorTypeQRCode // qr code<br/>CIDetectorTypeText // text</span></pre><p id="5d18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他配置可以通过选项字典来完成。在我看来，有趣的设置是:</p><pre class="ke kf kg kh fd kt ku kv kw aw kx bi"><span id="aa64" class="jd je hi ku b fi ky kz l la lb">CIDetectorAccuracy // high or low accuracy<br/>CIDetectorTracking // feature tracking should be used<br/>CIDetectorMinFeatureSize // min feature size relative to image's size<br/>CIDetectorEyeBlink //detect blink<br/>CIDetectorSmile //detect smile<br/>CIDetectorMaxFeatureCount // # of features</span></pre><p id="7168" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一点，它主要在<strong class="ih hj"> CIImage上运行，</strong>幸运的是我们可以将像素缓冲区转换为核心图像。</p><p id="659c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关键的一点是，在视觉中你不能察觉眨眼和微笑，你有可能用于计算的点。下面是可以使用的过滤器:</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">CoreImage眨眼和眼睛检测器</figcaption></figure><p id="d8a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参见公共方法<strong class="ih hj"> detectFaceFeatures </strong>(在类上方的注释中提到)</p><blockquote class="le lf lg"><p id="9269" class="if ig lh ih b ii ij ik il im in io ip li ir is it lj iv iw ix lk iz ja jb jc hb bi translated"><em class="hi">还有跟踪的可能性</em> (CIDetectorTracking <em class="hi">)。它为找到的对象分配UDIDs，但是如果对象离开并在下一帧中返回，它将被认为是一个新的对象，对于突然跟踪也是如此。</em></p></blockquote><p id="bf9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我认为在跟踪的情况下，视觉效果更好一些:)</p><h2 id="713c" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">视力</h2><p id="f7ec" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">在苹果视觉的例子中，我们有请求处理器，它执行请求。</p><p id="1200" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请求可能有完成阻塞，或者在执行时可能有结果(甚至错误):</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ll"><img src="../Images/e6df3724e14e9613484a6f422228645a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FBpIVjxvNoeBw75K5w47lQ.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">用完成块检测FaceRectangle请求</figcaption></figure><p id="c09c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果请求被执行，那么它将包含结果</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ll"><img src="../Images/0b7496037461b6f8423e8a6910f7fa01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bo1izZ-oMxetdTlvuKYeJQ.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">处理请求，如果计划并执行，则返回布尔值</figcaption></figure><p id="5a86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">流程图</strong>:</p><figure class="ke kf kg kh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es lm"><img src="../Images/7fd8a9382f808e5cec26d93b736ed8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9zxMiUXGnU13xMjNZdrsA.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">人脸跟踪和地标检测</figcaption></figure><p id="758b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有面部检测请求(<strong class="ih hj">vndetectfaceretanglesrequest)，</strong>在完成我们定义的跟踪请求。以下帧允许我们跟踪以前检测到的对象。</p><p id="6a72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果置信水平低(在我们的情况下为<strong class="ih hj"> 0.3 </strong>，则跟踪将被停止(<strong class="ih hj">)。isLastFrame = true </strong> ) &amp;人脸检测应该重启。否则，在新的跟踪请求中，我们指定找到的人脸的ROI(感兴趣区域)并检测人脸标志。从面部标志中，我们可以检测到一些关键特征。例如，我们检测眨眼，但是因为在视觉的情况下，我们得到矩形，所以我使用一些等式(EAR)来检测眨眼。</p><p id="747c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想最好演示一些代码:</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">跟踪面部和阈值近似闪烁…</figcaption></figure><h2 id="3c3f" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated"><strong class="ak">检测人脸特征</strong></h2><p id="0094" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">瞬移是由<em class="lh"> </em> <strong class="ih hj">阿德里安</strong><a class="ae ln" href="https://www.pyimagesearch.com/2017/04/24/eye-blink-detection-opencv-python-dlib/" rel="noopener ugc nofollow" target="_blank">T5】罗斯布鲁克 </a> <strong class="ih hj">的大教程中的公式近似计算出来的。</strong>见上面的<strong class="ih hj">计算年</strong>。它使用6个点计算所谓的眼睛纵横比(EAR ),在iOS 12上我们得到8个点，但计算是以类似的方式完成的。为了获得更高的精度，我们可以使用上面的<strong class="ih hj">滤波器</strong>。但是与使用CIFilter检测面部特征相比，视觉“操作”父亲。只是不要忘记裁剪图像，以减少检测时间。</p><blockquote class="le lf lg"><p id="6905" class="if ig lh ih b ii ij ik il im in io ip li ir is it lj iv iw ix lk iz ja jb jc hb bi translated">当裁剪面部以过滤时，你必须包括整个头部。没有额头的脸是不够的: <strong class="ih hj"> <em class="hi">滤镜</em> </strong> <em class="hi">可能无法正常工作。</em></p></blockquote></div><div class="ab cl lo lp gp lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hb hc hd he hf"><p id="ac6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们已经考虑了如何使用视觉，或者除了CoreImage之外，还使用视觉来跟踪人脸并检测他们的特征。</p></div></div>    
</body>
</html>