<html>
<head>
<title>Getting our License</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">拿到我们的执照</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/getting-our-license-33379d0a49d3?source=collection_archive---------5-----------------------#2021-06-04">https://medium.com/nerd-for-tech/getting-our-license-33379d0a49d3?source=collection_archive---------5-----------------------#2021-06-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0272" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">设置与GitHub动作的持续集成—第2部分</h2></div><p id="4f25" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上次，我们看了什么是持续集成和持续交付，为我们的项目选择工具所涉及的一些因素，以及对GitHub Actions的简要介绍，GitHub Actions是我们决定使用的工具链。今天，我们将详细介绍在GitHub中设置CI/CD管道的CI部分的过程。</p><h2 id="4eb3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">设置工作流</h2><p id="ac34" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">昨天，我们通过陈述“<strong class="iz hj">工作流</strong>包含<strong class="iz hj">作业</strong>来定义<strong class="iz hj">工作流</strong>，作业包含<strong class="iz hj">步骤</strong>，这些步骤是要在虚拟化环境上运行的动作列表，为我们提供功能。”</p><ol class=""><li id="945e" class="kt ku hi iz b ja jb jd je jg kv jk kw jo kx js ky kz la lb bi translated">创造。项目根目录下的github文件夹(“.”)文件夹名称的开头很重要)</li><li id="ecbc" class="kt ku hi iz b ja lc jd ld jg le jk lf jo lg js ky kz la lb bi translated">在中创建一个名为workflows的文件夹。github文件夹(在这里命名也很重要，因为这是GitHub查找文件夹的方式)</li><li id="9bec" class="kt ku hi iz b ja lc jd ld jg le jk lf jo lg js ky kz la lb bi translated">在我们的文件夹activation.yml和main.yml中创建2个文件。这些文件将包含我们创建Unity许可证激活请求的工作流以及我们的主CI/CD工作流。</li></ol><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/aec9e83bc29a69e74d36eb0a85d6f257.png" data-original-src="https://miro.medium.com/v2/format:webp/1*fmFaF8lyNW9_wKzlCHAF6Q.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">使用GitHub操作设置工作流程的文件和文件夹</figcaption></figure><h2 id="f0aa" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">工作流文件的剖析</h2><p id="476b" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们的工作流程文件是在YAML写的。需要注意的是，制表符和空格在YAML中非常重要，如果使用不当，会导致结构无效。让我们快速浏览一下我们需要的结构的基本部分。</p><h2 id="f472" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">名字</h2><p id="9ee4" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">这是工作流的名称，当工作流运行时，它将显示在GitHub界面中，我们正在查看进度。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/44cc438e4ae799bb9a4cebd421e9d0c5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*rKYSigaeS7rKU1524ny1Kw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">名称属性</figcaption></figure><h2 id="5faa" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">在</h2><p id="b75d" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">关键字上的<strong class="iz hj">是我们设置事件触发器的地方，这些触发器将导致这个工作流运行。通常我们会将工作流设置为对特定分支的推或拉请求运行，如下所示</strong></p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/dba7f5a4fc0bbfcc4c61f7db6f633650.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HQv4j56PAUuJwxt06hyM7A.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">关于财产</figcaption></figure><h2 id="25ad" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">工作</h2><p id="470d" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><strong class="iz hj"> jobs </strong>关键字表示作业列表的开始，每个作业都运行在它们自己的虚拟化环境副本上，并且通常并行运行(除非指定了依赖关系)。每个作业都有一个<strong class="iz hj">标识符</strong>(在我们的例子中，sample-job是标识符)，您还可以指定一个<strong class="iz hj">名称</strong>(它在GitHub中显示为界面的一部分，就像上面的工作流名称一样)，以及一个<strong class="iz hj">run-on</strong>标识符，它允许我们指定我们希望在什么平台或映像上构建我们的虚拟化环境。这方面的一些选项是mac-latest、windows-latest和ubuntu-latest，尽管这肯定不是一个详尽的列表。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/912fb4f66aa1d2da05cc35f8f8688575.png" data-original-src="https://miro.medium.com/v2/format:webp/1*raSiKkLmYQ1MAvdr7lzBkA.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">作业属性</figcaption></figure><h2 id="1d97" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">步伐</h2><p id="9b58" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">作为<strong class="iz hj">作业</strong>定义的一部分，<strong class="iz hj">步骤</strong>关键字定义了大部分动作发生的起点。这是在作业运行期间执行的操作列表，包含获取最新版本的代码、构建代码和上传结果等操作。每个步骤都可以有一个名称，如<strong class="iz hj">作业</strong>和<strong class="iz hj">工作流</strong>部分。它们还可以包含一个<strong class="iz hj"> id </strong>属性，用于步骤之间的引用，如果您正在使用github提供的动作之一或另一个存储库的动作，那么<strong class="iz hj"> uses </strong>关键字会提供另一个动作文件的名称，我们将两者都使用。最后，使用键的<strong class="iz hj">开始输入一个参数列表，该列表将被传递到<strong class="iz hj">使用</strong>部分指定的函数中。</strong></p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/977df6e51b8bdc1c58dd3c887a3f6ddc.png" data-original-src="https://miro.medium.com/v2/format:webp/1*J0-QiwzUpwQW27GJtsH3Xw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">步骤属性</figcaption></figure><h2 id="d715" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">使用签出功能签出您的存储库。</h2><p id="ae1d" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们将在工作流中使用的最常见的操作之一是将我们的存储库的副本签出到虚拟化环境中，以便我们可以像执行构建一样对其执行操作。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/6152ed367ef72dca3b0590eee4751202.png" data-original-src="https://miro.medium.com/v2/format:webp/1*8VE5xxZTwD85rhbmkK8U1g.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">结帐动作</figcaption></figure><h2 id="77ea" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">贮藏</h2><p id="5f47" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">另一个非常常见的操作，特别是对我们来说，因为我们正在进行Unity构建，就是缓存一些文件，以便在一个作业的多次运行中使用。在我们的例子中，我们希望缓存Unity中的库文件夹，因为它可能非常大，并且通常在运行中是相同的。这可以而且将会提高效率，减少后续作业运行所需的运行时间。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/9564aa543c81eda20214d423d97ea8d5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Kl7NdvCEDvLiHrZqisC1jw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">具有缓存操作的签出操作</figcaption></figure><h2 id="0471" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">激活Unity的个人许可证</h2><p id="050b" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">Unity提供两种类型的许可证，个人版和专业版，申请许可证文件以便在我们将要使用的虚拟机上使用的过程对于每一种都略有不同。我使用Unity的免费版本和个人许可证，所以这就是我们将在本文中介绍的过程。如果你想了解更多关于如何用职业执照做到这一点，请参阅关于<a class="ae lt" href="https://game.ci/docs/github/activation#professional-license" rel="noopener ugc nofollow" target="_blank">游戏的优秀文档。CI </a>的网站。使用游戏构建Unity项目的虚拟机。CI的GitHub操作安装了一个Unity版本，它需要许可证文件才能运行，所有GitHub VM发出相同的HardwareId，就Unity的许可而言，本质上使它们成为同一台机器。</p><p id="7f12" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们打开在工作流文件夹中创建的activate.yml文件，并添加以下内容。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/79f2fc3432f17419c5d7a25d590f97e3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*9lBpfyNM8G2fQmtvoun4lA.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">激活工作流</figcaption></figure><p id="5253" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个文件有一些需要注意的地方。首先，<strong class="iz hj"> on </strong>步骤中的workflow_displatch设置允许我们从GitHub界面手动触发工作流。其次，我们正在上传由<a class="ae lt" href="https://game.ci" rel="noopener ugc nofollow" target="_blank">游戏提供的<em class="lu">游戏-ci/unity-request-activation-file @ v2</em>动作执行产生的文件。CI </a>作为工作中的工件，以便我们可以访问和下载它们用于下一步(这是手动的)。</p><p id="f6ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们签入我们的更改，并将它们推送到服务器。</p><h2 id="90d7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">手动运行激活工作流</h2><p id="b3ae" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">既然我们已经在GitHub存储库中建立了激活工作流文件，我们需要手动运行它。这个步骤对于每个存储库只需要一次，所以我们没有将它设置为在每次签入时运行。</p><p id="2f8a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">需要注意的是，GitHub只在默认分支(对我来说是Master)上的文件的Actions选项卡中选取和显示工作流。如果你正在使用一个特性/开发/主分支和合并策略，像我一样，你必须提交yml文件激活，直到主文件，它才会显示在Actions选项卡中。在其他源代码控制平台上，情况并非如此。</strong></p><p id="2339" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在“Actions”选项卡中访问工作流后，我们可以从屏幕左侧的列表中选择我们的工作流，然后选择屏幕右侧的“Run workflow”下拉菜单，选择我们要从中运行操作的分支，并单击“Run Workflow”按钮。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/03fa1063c49c47db22f5e2cdce736e68.png" data-original-src="https://miro.medium.com/v2/1*9LhQrDPdhctdZphY2FWbLw.gif"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">手动运行工作流</figcaption></figure><p id="c564" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">工作流运行完成后，单击工作流运行的名称以访问结果。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/23853214edaf84181b6f672cc9887292.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Pmp2OvbR3Ko0SPTOeuP_zw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">结果请求文件</figcaption></figure><p id="cf2b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们应该有一个名为Unity_v20XX格式的文件。X.XXXX.alf，我们将把它上传到Unity网站上以请求我们的许可证文件。点击。工件部分的alf文件来下载它。</p><p id="135e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该流程的官方文件可在https://game.ci/docs/github/activation<a class="ae lt" href="https://game.ci/docs/github/activation" rel="noopener ugc nofollow" target="_blank">找到。</a></p><h2 id="078f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">转换成许可证</h2><p id="3c3f" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">现在我们已经有了我们的请求文件，我们可以前往<a class="ae lt" href="https://license.unity3d.com" rel="noopener ugc nofollow" target="_blank">https://license.unity3d.com</a>，点击浏览按钮并导航到我们的。alf文件，单击上传，然后单击下一步。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/7ca4104f32168d225d2730c7ce36e427.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Xws9MmEHDVE7uO8M4xvegg.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">手动激活—步骤1</figcaption></figure><p id="908c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在下一页选择Unity个人版。然后选择最适合您情况的选项。对于这个项目，我选择“我不在专业领域使用Unity”然后单击下一步按钮。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/a34aaeb61f31e25ca93cd0d587ca5281.png" data-original-src="https://miro.medium.com/v2/format:webp/1*QGtR6GNSCkJAGAYF9T35lw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">手动激活—步骤2</figcaption></figure><p id="8983" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单击下一页上的“下载许可证文件”按钮，接收扩展名为. ulf的许可证文件。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/c5b897f999fbf3b24ca2cc67b1e03916.png" data-original-src="https://miro.medium.com/v2/format:webp/1*yvKNXWGCcHc-lug-LMkLNg.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">手动激活—步骤3</figcaption></figure><h2 id="c7a2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">存储我们的Unity许可证文件</h2><p id="641d" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们不希望任何人访问我们的Unity许可证文件，所以我们将把它作为一个秘密存储在我们的GitHub存储库中。</p><ol class=""><li id="3fc9" class="kt ku hi iz b ja jb jd je jg kv jk kw jo kx js ky kz la lb bi translated">导航到GitHub上的存储库</li><li id="a633" class="kt ku hi iz b ja lc jd ld jg le jk lf jo lg js ky kz la lb bi translated">选择设置</li><li id="24ec" class="kt ku hi iz b ja lc jd ld jg le jk lf jo lg js ky kz la lb bi translated">选择秘密</li><li id="3ed1" class="kt ku hi iz b ja lc jd ld jg le jk lf jo lg js ky kz la lb bi translated">点按“新存储库密码”按钮</li></ol><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/f2f9a8152748b98feecea23bc5fcb467.png" data-original-src="https://miro.medium.com/v2/format:webp/1*2QUKcU-MkkFciW_xq_63Ug.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">GitHub秘密</figcaption></figure><p id="3419" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建一个名为UNITY_LICENSE的秘密，并将许可证文件的<strong class="iz hj"> <em class="lu">内容</em> </strong>复制到其中。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/2b726a5c5eb09d60555c132f4830dcc5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HE7t5iEEcEEpk7-AItN1EQ.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">创造一个秘密</figcaption></figure><p id="a724" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们已经将Unity许可证存储为GitHub Secret，准备在我们的工作流程中引用。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="ab fe cl lm"><img src="../Images/8aa723e45ac5aa2ea286d54a89a2427a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*6bsUGJG6CazPIJQ0gnd4Dw.png"/></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">秘密已创建</figcaption></figure><h2 id="a1f9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">下次吧！</h2><p id="045f" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们已经完成了Unity许可证设置和我们的第一个工作流程！现在我们已经将我们的许可证存储为一个秘密，我们准备开始设置我们的主要工作流程！下一次，这正是我们要做的。如果你喜欢这篇文章，或者想在我的旅程中与我同行，请在gamedevchris.medium.com<a class="ae lt" href="#https://gamedevchris.medium.com" rel="noopener ugc nofollow">跟随我。</a></p></div></div>    
</body>
</html>