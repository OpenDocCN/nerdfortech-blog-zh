# CSS 中 z 索引的完整指南

> 原文：<https://medium.com/nerd-for-tech/complete-guide-to-z-index-in-css-9f09550ae886?source=collection_archive---------3----------------------->

![](img/a629ee7fb3e7893ec1947006ebf627b0.png)

在现代 web 开发中，使用 z 索引是非常常见的。但是很多人并不完全理解它的工作原理。正因为如此，开发人员偶尔会遇到一些他们难以解决的问题。让我们更深入地探讨这个话题。

z-index 一般是什么？这是一个 CSS 属性，指定元素重叠时的显示顺序。对吗？不，不是真的。事实上，重叠顺序取决于几个参数。看一下下面的代码示例:

代码示例

如你所见，父节点有位置:相对。子元素具有绝对定位和 z 索引，z 索引为-1。但是由于某种原因，子元素仍然在上面。再次查看代码，您可能会注意到一个奇怪的滤镜:模糊(0px)。我加这行是有原因的:)

让我们看看如果我们删除这条线会发生什么:

但是您可能会问:过滤器与 z 索引有什么关系？答案是语境。

关键是 z 索引只在其上下文中起作用。什么是堆叠上下文？它是沿空间 z 轴的一个区域，元素沿 z 轴排列。z-index 将在这样一个区域内工作。这意味着它不会在另一个！

以下是来自 MDN 的定义:

> **堆叠上下文**是沿着相对于用户的假想 z 轴的 HTML 元素的三维概念化，假设用户面对视口或网页。HTML 元素按照基于元素属性的优先级顺序占据这个空间。

好了，现在我们知道 z-index 只在上下文中起作用。但是它们是如何被创造出来的呢？
有一个选项对我们所有人来说都很直观明了，因为每个人都用过:

# 非静态定位和非自动 z 轴定位

父元素创建了一个新的上下文，这导致子元素现在在不同的上下文中使用 z-index: -1。因此，元素只是根据它们在 DOM 中的顺序显示。在此之前，父元素没有创建新的上下文，两个元素都使用 HTML 标记的上下文。

但还是有很多情况创造了新的语境。下面我们把每一个都分解一下，以便你在以后的布局中快速找到问题的原因。

在所有情况下，起始位置都是相同的:我将尝试通过在父元素上创建新的上下文来“打破”子元素的 z 索引逻辑。因此，在每个例子中，z-index: -1 不会像我们期望的那样默认工作。

# 元素的父级是 flex / grid 容器，元素的 z 索引不同于 auto

如您所见，因为父元素有自己的 z 索引，并且是 flex 容器的一部分，所以它创建了一个新的上下文。尝试从最顶层的元素中移除 display: flex，您将看到不会创建新的上下文，即使父元素的 z-index: 1。有意思…还有呢？

# 不透明度值小于 1 的元素

对我来说最违反直觉的例子。想象一下，透明度影响了元素沿 z 轴显示的顺序！事实上，将透明度更改为 1 以下只是创建了一个新的上下文。我曾经不能理解为什么一个子元素不会以任何方式低于父元素。我把 z-index 设置为-1000000，但无济于事:)是父级的透明性。

# 除正常模式之外的混合模式

要不要用勾兑？做好准备，它会破坏你的 z 索引。但是让我更让你难过…

# 具有除无之外的任何功能属性的元素，如变换、过滤、透视、剪辑路径、蒙版、蒙版图像、蒙版边框

现在，再看看文章中的第一个例子:)现在你明白这是怎么回事了吗？滤镜:模糊(0px)创建一个新的上下文。所以如果你想使用 CSS 的新的和酷的特性，请记住这个特性。有时你不得不使用框阴影来代替滤镜:例如，drop-shadow()。

# 其他情况

其他情况比较少见，所以我们会顺便提一下。
根据 MDN 规范:

> 隔离值为 isolate 的元素。
> 
> 带有-webkit-overflow-scrolling 值触摸的元素。
> 
> 具有 will-change 值的元素，该值指定将在非初始值上创建堆栈上下文的任何属性(参见本文)。
> 
> 具有布局或绘画的包含值，或者包括其中之一的复合值的元素(即，contain: strict，contain: content)。

# 但这还不是全部！

您知道吗，如果您同时设置(例如随机地)HTML 和 BODY 的背景颜色，所有 z-index 小于 1 的元素都会在背景后面“中断”和“失败”！事实上，并不是所有 z 索引小于 1 的元素都会出现这种情况。它发生在 HTML 上下文中的元素上(从 MDN 规范创建上下文的第一条规则)。通过改变 BODY 和 HTML 的背景，我们以某种方式“打破”了上下文。试着只给 HTML 或 BODY 分配一个背景——这很有效！
标准情况是，您已经使用 create-react-app 创建了一个 React 应用程序。在创建的样式文件中，您决定添加背景颜色。但是你把它添加到 HTML 的 BODY 块中，而不是 BODY 块。然后你就忘了。相信我，如果你试图找出为什么你的 z-index: -1 在未来不起作用，你会浪费很多时间。但是现在你知道问题可能是什么了；)

# 结论

乍一看，Z-index 是一个非常简单的属性。但是当与之相关的问题发生时，并不是每个人都明白为什么会发生。现在我们知道，它通常与使用 z 索引的上下文有关。

在 Linkedin 上加我:【https://www.linkedin.com/in/kirill-shelipov-b8ab461a2/ 