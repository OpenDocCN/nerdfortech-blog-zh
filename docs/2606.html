<html>
<head>
<title>Useful Kotlin Extensions for Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">适用于Android的Kotlin扩展</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/useful-kotlin-extensions-for-android-d8652f64bca8?source=collection_archive---------3-----------------------#2021-05-13">https://medium.com/nerd-for-tech/useful-kotlin-extensions-for-android-d8652f64bca8?source=collection_archive---------3-----------------------#2021-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f98f17a433c6c355b81c236d06d0b861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZPk78uYUVEpNk5ZZ.jpg"/></div></div></figure><p id="9c52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Kotlin有许多令人惊叹的特性，但其中最突出的是扩展。扩展用于向现有类添加功能。它们在帮助减少样板代码方面非常有用。好的一面是你可以把它们添加到任何类中，包括那些你不能修改的来自第三方库的类。大多数时候我们看到的是<em class="jo">扩展函数</em>，但是Kotlin也支持<em class="jo">扩展属性</em>。</p><h1 id="944c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">有用的扩展功能</h1><p id="69ae" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">让我们从一些使代码更容易阅读的扩展开始，这些扩展通过减少样板代码来提高代码质量。</p><h1 id="35f0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">语境</h1><p id="453b" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Android API会随着时间的推移而变化，像获取给定id的颜色这样简单的事情会变得不那么简单。下面的扩展有助于减少与检索给定ID的资源相关的样板代码。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="abf0" class="ky jq hi bd jr kz la lb jv lc ld le jz jb lf lg kd jf lh li kh jj lj lk kl ll bi translated">使用</h2><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="fa16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们都知道检查用户是否授予了应用程序所需的权限是多么的重复。下面的扩展可以帮助你做到这一点。它不能解决整个问题，但有助于减少代码量。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="b67c" class="ky jq hi bd jr kz la lb jv lc ld le jz jb lf lg kd jf lh li kh jj lj lk kl ll bi translated">使用</h2><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="a82e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">复制一些文本或网址到剪贴板应该是非常简单的事情。它只适用于纯文本，但这是我们大多数时候使用的，如果你需要支持其他格式，你可以改变它。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="9462" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你的app里有没有用户需要打开浏览器才能查看的网址？您是否正在处理浏览器或同等应用程序可能丢失的情况？下一个扩展抽象了大部分需要的东西。你只需要给它一个Uri，并做一些事情，比如如果没有应用程序来解析意图，就显示一个错误。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="09ce" class="ky jq hi bd jr kz la lb jv lc ld le jz jb lf lg kd jf lh li kh jj lj lk kl ll bi translated">使用</h2><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h1 id="abef" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">日期</h1><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="4fcf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您需要反复记录一个日期对象或者通过API调用发送它，这个扩展非常有用。这里需要注意的是，ISO格式是通用的，它不会因国家而异，稍后我将说明这一点的重要性。</p><h2 id="27ba" class="ky jq hi bd jr kz la lb jv lc ld le jz jb lf lg kd jf lh li kh jj lj lk kl ll bi translated">使用</h2><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="72e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其他一些可能有用的扩展</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/dc9da9d47a5bbf00087dfd9bcebd87c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tVj7PnFKylMilTTR5r3VpA.jpeg"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">照片由<a class="ae ly" href="https://unsplash.com/@arturtumasjan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿图尔·图马斯扬</a>在<a class="ae ly" href="https://unsplash.com/s/photos/bad-lego?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="9453" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">闪光的未必都是金子</h1><p id="b927" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">包括扩展在内的很多东西都可能被滥用。有些看起来不错，但实际上是伪装的代码气味。</p><p id="750e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从一个无用的扩展开始。前几天在看一篇关于扩展的文章，发现了这个。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><ol class=""><li id="3705" class="lz ma hi is b it iu ix iy jb mb jf mc jj md jn me mf mg mh bi translated">使用扩展不会减少代码。</li><li id="79b3" class="lz ma hi is b it mi ix mj jb mk jf ml jj mm jn me mf mg mh bi translated">通过使用扩展，编译器将认为这是一个正常的函数调用，并尽可能避免优化空情况。</li><li id="f2b5" class="lz ma hi is b it mi ix mj jb mk jf ml jj mm jn me mf mg mh bi translated">这是OOP的一个不好的用法，我们给对象添加方法来“询问”他们一些事情，null的定义就是缺少一些东西。一个对象从不为空，为空的是对一个对象的引用。</li></ol><h1 id="5c63" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">小心本地化</h1><p id="7e40" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">对我们大多数人来说，下面的扩展可能看起来很合理。它将双精度值格式化为十进制格式。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="2576" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种代码的危险之处在于，在世界范围内，货币的格式是不一样的。在一些国家，你会看到<strong class="is hj"> 1，200.00 </strong>(逗号在前，点号在后)，在其他国家<strong class="is hj"> 1，200，00 </strong>(点号在前，逗号在后)。如果该应用程序正在/将要在许多国家使用，这只是一个问题。</p><p id="229c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我的解决方案是将格式化模式添加到<code class="du mn mo mp mq b">strings.xml</code>中，并在<code class="du mn mo mp mq b">Context</code>上创建一个扩展来处理它。这样，您可以为每种语言定义货币格式，并且仍然使用相同的函数。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h1 id="6b4f" class="jp jq hi bd jr js mr ju jv jw ms jy jz ka mt kc kd ke mu kg kh ki mv kk kl km bi translated">扩展属性</h1><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="adfc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Kotlin还允许我们添加属性作为扩展。我还没有找到它们的用例，但是知道有可能使用它们是很有用的。</p><p id="1919" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢您的阅读。如果您有任何不同意的地方，请在下面留下评论，这样我们就可以讨论它并找到更好的解决方案。</p><h1 id="9d4d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">其他文章</h1><p id="768c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><a class="ae ly" href="https://victorbrandalise.com/android-lifecycle-scenarios-single-and-multi-activities/" rel="noopener ugc nofollow" target="_blank"> Android生命周期场景——单个和多个活动</a></p><p id="9cc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ly" href="https://victorbrandalise.com/android-lifecycle-revised/" rel="noopener ugc nofollow" target="_blank">安卓生命周期修改</a></p><p id="db49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由<a class="ae ly" href="https://unsplash.com/@fran_?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Fran Jacquier </a>在<a class="ae ly" href="https://unsplash.com/s/photos/lego?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的封面照片</p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><p id="1555" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">原载于2021年5月13日victorbrandalise.com</em><a class="ae ly" href="https://victorbrandalise.com/useful-kotlin-extensions-for-android/" rel="noopener ugc nofollow" target="_blank"><em class="jo"/></a><em class="jo">。</em></p></div></div>    
</body>
</html>