<html>
<head>
<title>CatBoost Quickstart — ML Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CatBoost快速入门— ML分类</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/catboost-quickstart-ml-classification-f1d7fb70fea8?source=collection_archive---------0-----------------------#2021-02-14">https://medium.com/nerd-for-tech/catboost-quickstart-ml-classification-f1d7fb70fea8?source=collection_archive---------0-----------------------#2021-02-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8a5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，我一直在利用<a class="ae jd" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank"> CatBoost </a> Python库来创建真正成功的分类模型。我想提供一些快速跟进指南，以掌握基本知识。</p><p id="d021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将描述三个使用CatBoost的例子，来制作:一个二元分类器；多项式分类器；最后是使用分类数据和数字数据的多项式分类器。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/58d8883d3d4f186d65eba49216f0a5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cCafusrU1Iey4flxrqbpRA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae jd" href="https://github.com/sk-t3ch/catboost-quickstart" rel="noopener ugc nofollow" target="_blank"> Github来源</a>。查看https://t3chflicks.org<a class="ae jd" href="https://t3chflicks.org" rel="noopener ugc nofollow" target="_blank"/>了解更多内容！</figcaption></figure><h1 id="eb1d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">分类</h1><p id="9aff" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">统计模型可以从具有已知分类的电子邮件数据中导出。然后，这些模型可用于对新的观察结果进行分类，并且该过程可以自动化。分类问题的一个常见例子是识别<em class="kx">垃圾邮件</em>与<em class="kx">非垃圾邮件</em>电子邮件。这就是所谓的<strong class="ih hj">二元分类</strong>。电子邮件数据包括许多功能，如收件人和，可用于帮助识别它是这些分类中的一种。</p><h1 id="9426" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">决策树</h1><p id="e331" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">决策树可用于创建分类模型:</p><blockquote class="ky kz la"><p id="e7d5" class="if ig kx ih b ii ij ik il im in io ip lb ir is it lc iv iw ix ld iz ja jb jc hb bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Decision_tree_learning" rel="noopener ugc nofollow" target="_blank">维基百科</a>:决策树<strong class="ih hj">是一个<strong class="ih hj">决策</strong>支持工具，它使用类似<strong class="ih hj">树</strong>的<strong class="ih hj">决策</strong>及其可能结果的模型，包括偶然事件结果、资源成本和效用。这是显示只包含条件控制语句的算法的一种方式。</strong></p></blockquote><p id="9140" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种技术虽然有用，但可以通过梯度增强变得更加精确:</p><blockquote class="ky kz la"><p id="60b9" class="if ig kx ih b ii ij ik il im in io ip lb ir is it lc iv iw ix ld iz ja jb jc hb bi translated"><a class="ae jd" href="https://en.wikipedia.org/wiki/Gradient_boosting" rel="noopener ugc nofollow" target="_blank">维基百科</a> : <strong class="ih hj">梯度推进</strong>是一种用于回归和分类问题的机器学习技术，它以弱预测模型的集合的形式产生预测模型，通常是决策树。</p></blockquote><h1 id="f6c4" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">CatBoost</h1><p id="619f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><a class="ae jd" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank"> CatBoost </a>是基于梯度推进决策树的开源算法。它支持数字、分类和文本特征。查看<a class="ae jd" href="https://catboost.ai/docs/features/categorical-features.html#dataset-processing" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><blockquote class="ll"><p id="d2fd" class="lm ln hi bd lo lp lq lr ls lt lu jc dx translated"><em class="lv">代码随笔记本一起:</em></p><p id="5434" class="lm ln hi bd lo lp lq lr ls lt lu jc dx translated"><a class="ae jd" href="https://github.com/sk-t3ch/catboost-quickstart" rel="noopener ugc nofollow" target="_blank">🔗Github上的CatBoost快速入门笔记本📔</a></p></blockquote><h1 id="8b13" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf lw kh ki kj lx kl km kn ly kp kq kr bi translated">#1二元分类</h1><p id="07ed" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在本节中，我们将在鸢尾植物数据集上创建一个二元分类器，该数据集包含三个物种，每个物种有四个参数(花瓣长度、花瓣宽度、萼片宽度、萼片长度)。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/ea19c27f9d1a4543b42d39ac21b4e4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyYdPhtXRUdbBzPgWbIc2g.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">熊猫数据帧中的鸢尾花数据集，随后是物种的值计数</figcaption></figure><p id="7d8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用CatBoost库创建一个二元分类模型，以区分<em class="kx">和</em>之间的差异。</p><h2 id="f7bc" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">获取数据</h2><p id="bd15" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">首先使用来自<a class="ae jd" href="https://scikit-learn.org/stable/user_guide.html" rel="noopener ugc nofollow" target="_blank"> sklearn库</a>的虹膜数据集:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="9320" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">看着这些数据</h2><p id="e068" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">使用<a class="ae jd" href="https://seaborn.pydata.org/introduction.html" rel="noopener ugc nofollow" target="_blank">海运库</a>，我们可以检查每个变量的配对图数据。Iris数据集包含三个物种的相同数据点。通过观察，可以看到<em class="kx">物种</em>和<em class="kx">目标</em>的图表显示了相等的三等分。这是一个确定分类器的简单数据集。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mq"><img src="../Images/f55d0a0923ae3ae1e2126f279bcab436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6YY2688-mcdBPrneVivdpg.png"/></div></div></figure><h2 id="5e94" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">训练模型</h2><p id="c131" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">这里的分类问题是区分<em class="kx">海滨锦葵</em>和<em class="kx">非海滨锦葵的样品。</em>此类问题的模型参数需要使用<em class="kx"> LogLoss </em>损失函数。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="2844" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">模型的结果</h2><p id="6ecd" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">提取评估数据集的预测结果，并与真实值进行比较，生成以下图表:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mr"><img src="../Images/332dbebea3aad7b938e5a397ff7a2201.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*4-gg5mhgdC5PIha2V8IUHQ.png"/></div></figure><p id="bac5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROC图显示了这个小数据集的近乎完美的分数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ms"><img src="../Images/ee6790b44c1de7a2b1f3d67f62952808.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*DnpzWBBf_MKopscweFU6Dg.png"/></div></figure><p id="31a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提取特征的相对重要性向我们表明，花瓣宽度比分类器中的任何其他特征重要两倍以上。</p><h1 id="3ee1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">#2多项式分类器</h1><p id="9d1c" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在我们可以区分一个<em class="kx">海滨锦葵</em>，我们将通过创建一个多项式分类器来区分多个物种。</p><h2 id="15be" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">训练模型</h2><p id="e3ab" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">CatBoost处理任何困难的工作，我们只需要更新损失函数来使用<em class="kx">多类:</em></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="3e95" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">模型的结果</h2><p id="39b7" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">提取评估数据集的预测结果，并与真实值进行比较，生成以下图表:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mt"><img src="../Images/6beff40344c7b8124386f1355cd6822c.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*5zjTbbu-TfAO04OYgkgz-A.png"/></div></figure><p id="ec87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些结果的混淆矩阵表明该模型是完全准确的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ms"><img src="../Images/ebacd7c79bf76c861864cbc5b52750d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*OWPFlg0sfD8Y1xOow8CHDQ.png"/></div></figure><p id="7b6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提取相对重要性，该图显示花瓣长度现在比分类器中的任何其他特征更重要。</p><h1 id="d7d9" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">具有分类特征的#3多项式分类器</h1><h2 id="ec4a" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">获取数据</h2><p id="8c1e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">另一个具有大量分类特征的数据集是来自<a class="ae jd" href="https://archive.ics.uci.edu/ml/index.php" rel="noopener ugc nofollow" target="_blank"> UCL机器学习</a>的汽车数据集。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mu"><img src="../Images/161294c7e22b9feece18dc4830fd0322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T58UtwDd8awYne7D9c4pgA.png"/></div></div></figure><h2 id="7101" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">训练模型</h2><p id="ddf9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在的分类问题是区分不同的汽车品牌，例如<em class="kx">阿尔法罗密欧</em>。我们必须定义我们的分类特征，例如CatBoost参数中的<em class="kx">引擎位置</em>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="0820" class="ma jv hi bd jw mb mc md ka me mf mg ke iq mh mi ki iu mj mk km iy ml mm kq mn bi translated">模型的结果</h2><p id="201b" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">提取评估数据集的预测结果，并与真实值进行比较，生成以下图表:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mv"><img src="../Images/b923def99ea493b30a265a0df6f142f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*nPJjnT_v4voSphNpRxvt8g.png"/></div></figure><p id="5913" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混淆矩阵显示，这个模型是最准确的，约74%的值正确预测。然而，对于这样一个小样本的数据，我们不能太确定。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ms"><img src="../Images/17769c5db3b503a34ce54ce4013c8661.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*WAb-Lkcl3y-im4MwbY4m6Q.png"/></div></figure><p id="ef55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从提取的特征重要性中得到的一个有趣的注意是，价格不能很好地预测汽车品牌。</p><h1 id="110d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">参数调谐</h1><p id="0c33" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">CatBoost声称有很好的默认值，我们已经看到它在两个不同的数据集上相当成功。为了最大限度地利用您的模型，您必须更改参数。我推荐看一下<a class="ae jd" href="https://catboost.ai/docs/concepts/parameter-tuning.html" rel="noopener ugc nofollow" target="_blank"> CatBoost网站的说明。</a></p></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><h1 id="4323" class="ju jv hi bd jw jx mw jz ka kb mx kd ke kf my kh ki kj mz kl km kn na kp kq kr bi translated">感谢阅读</h1><p id="8189" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我希望你喜欢这篇文章。如果你喜欢这种风格，就去看看<a class="ae jd" href="https://t3chflicks.org/" rel="noopener ugc nofollow" target="_blank">T3chFlicks.org</a>的更多科技教育内容吧(<a class="ae jd" href="https://www.youtube.com/channel/UC0eSD-tdiJMI5GQTkMmZ-6w" rel="noopener ugc nofollow" target="_blank"> YouTube </a>、<a class="ae jd" href="https://www.instagram.com/t3chflicks/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>、<a class="ae jd" href="https://www.facebook.com/t3chflicks" rel="noopener ugc nofollow" target="_blank">脸书</a>、<a class="ae jd" href="https://twitter.com/t3chflicks" rel="noopener ugc nofollow" target="_blank"> Twitter </a>)。</p></div></div>    
</body>
</html>