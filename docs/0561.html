<html>
<head>
<title>Getting hold of Confusion Matrix!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">获取混乱矩阵！！</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/getting-hold-of-confusion-matrix-1c8481a2107e?source=collection_archive---------2-----------------------#2021-01-17">https://medium.com/nerd-for-tech/getting-hold-of-confusion-matrix-1c8481a2107e?source=collection_archive---------2-----------------------#2021-01-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/c533f32dfcb3eef1412639757a59ed2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dx_hM4DKgsIks5e8E3U0ag.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">丹尼尔·利维斯·佩鲁西在<a class="ae hv" href="https://unsplash.com/s/photos/confusion?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><p id="e844" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">混淆矩阵是分类问题预测结果的列表摘要。这是一个预测值和实际值不同组合的表。下图总结了这些组合。<strong class="ix hz">此处行代表实际值，列代表预测值</strong>。</p><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/f68cd321eb4132c65a3c3a1f8581703e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VatH8Ym0EwAoKdRXfjefAQ.png"/></div></div></figure><p id="fa76" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的混淆矩阵显示了我们的分类模型在进行预测时被混淆的方式。因此命名为混乱矩阵。</p><p id="fa40" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用这个链接来玩混乱矩阵。</p><h2 id="070f" class="jy jz hy bd ka kb kc kd ke kf kg kh ki jg kj kk kl jk km kn ko jo kp kq kr ks bi translated">基本术语</h2><blockquote class="kt ku kv"><p id="5b45" class="iv iw kw ix b iy iz ja jb jc jd je jf kx jh ji jj ky jl jm jn kz jp jq jr js hb bi translated"><strong class="ix hz"> <em class="hy">真正</em> — </strong>预测类和实际类都为正。<br/> <strong class="ix hz"> <em class="hy">真阴性</em> — </strong>预测类和实际类均为阴性<br/> <strong class="ix hz"> <em class="hy">假阳性</em> — </strong>预测类为阳性但实际类为阴性<br/> <strong class="ix hz"> <em class="hy">假阴性</em> — </strong>预测类为阴性但实际类为阳性</p></blockquote><p id="54d9" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz"> <em class="kw">注:</em> </strong> <em class="kw">假阳性又称为</em><strong class="ix hz">I 型错误</strong> <em class="kw">。假阴性被称为</em><strong class="ix hz">II 型</strong> <em class="kw">错误。</em></p><p id="7df1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的术语中<strong class="ix hz">真|假</strong>告诉我们预测是对还是错。第二部分<strong class="ix hz">正|负</strong>告诉我们什么是<strong class="ix hz">预测</strong>。</p><p id="ca3d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">利用这些值，我们计算出以下比率</p><blockquote class="kt ku kv"><p id="a39c" class="iv iw kw ix b iy iz ja jb jc jd je jf kx jh ji jj ky jl jm jn kz jp jq jr js hb bi translated"><strong class="ix hz"> <em class="hy">准确率</em> </strong> <br/>错误率—(FP+FN)/(TP+TN)/(FP+FN)<br/><strong class="ix hz"><em class="hy">真阳性率(灵敏度或召回率)</em> </strong> <br/>假阳性率— (FP)/(FP+TN) <br/>真阴性率(特异性)— (TN)/(FP+TN) <br/> <strong class="ix hz"> <em class="hy">精度</em></strong></p></blockquote><p id="ab84" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将在这个博客中讨论准确度、召回率和精确度。</p><h2 id="6d57" class="jy jz hy bd ka kb kc kd ke kf kg kh ki jg kj kk kl jk km kn ko jo kp kq kr ks bi translated">准确(性)</h2><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es la"><img src="../Images/3ff6f6ede302abe0bfbf6b5461b8e2ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hICAMpbbYST38F7e1zU38A.png"/></div></div></figure><p id="603c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">仅仅准确性并不能很好地衡量模型的性能。它对类的不平衡很敏感，也不会告诉你一些类是否被一个模型忽略了。假设我们试图预测欺诈交易。如果我们的模型预测越来越多的非欺诈交易，它将具有合理的准确性，因为通常欺诈交易数据会更少。所以我们使用其他的度量标准，比如精确度，回忆..</p><h2 id="eb9b" class="jy jz hy bd ka kb kc kd ke kf kg kh ki jg kj kk kl jk km kn ko jo kp kq kr ks bi translated">精确</h2><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lb"><img src="../Images/7cf7e45aacf67154f434a4d286701b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbibDsvWvZgszf76EE183A.png"/></div></div></figure><p id="e983" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">精确，正如这个词所说，告诉我们的模型如何精确地识别阳性。它意味着在模型预测的所有阳性类别中，有多少部分实际上是阳性的。</p><blockquote class="lc"><p id="f5d0" class="ld le hy bd lf lg lh li lj lk ll js dx translated">在假阳性比假阴性更受关注的情况下，精确度是一个有用的指标。</p></blockquote><p id="e9b5" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated"><em class="kw">喜欢给孩子推荐安全的视频。这里需要精确。我们不想推荐任何不安全的视频。如果我们错误地将一个安全的视频归类为不安全的，那也没关系。但是不安全的视频要正确识别。</em></p><h2 id="d3ee" class="jy jz hy bd ka kb kc kd ke kf kg kh ki jg kj kk kl jk km kn ko jo kp kq kr ks bi translated">回忆</h2><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ls"><img src="../Images/a9db9ba2caf12a51b881fc3986914c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPwUavhZD9GMA_MNixCkRg.png"/></div></div></figure><p id="1784" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">回忆为我们提供了一种方法来衡量我们的模型能够正确分类为正面的正面类别的比例。</p><blockquote class="lc"><p id="afd4" class="ld le hy bd lf lg lh li lj lk ll js dx translated">当目标是<em class="lm">限制假阴性的数量</em> (FN)时，召回是有用的</p></blockquote><p id="5bd2" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">在我们是否发出假警报并不重要，但实际的阳性病例不应未被检测到的情况下，召回很重要！</p><blockquote class="kt ku kv"><p id="188f" class="iv iw kw ix b iy iz ja jb jc jd je jf kx jh ji jj ky jl jm jn kz jp jq jr js hb bi translated">很明显，精确度和召回率是反向关联的，我们不能同时获得高分——增加精确度会降低召回率，反之亦然。这被称为<em class="hy">精度/召回权衡</em>。</p></blockquote><p id="6b10" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了比较具有不同精度和召回值的模型，我们使用 F1 分数。F1 分数是精确度和召回率的调和平均值。我们使用调和平均值，因为与算术或几何平均值相比，它对较高值的惩罚更严重。</p><pre class="ju jv jw jx fd lt lu lv lw aw lx bi"><span id="f628" class="jy jz hy lu b fi ly lz l ma mb">precision = 0.9<br/>recall = 0.4</span><span id="7529" class="jy jz hy lu b fi mc lz l ma mb">For above value if we calculate AM, GM &amp; HM we get 0.65, 0.6 &amp; 0.55 respectively. And we see HM has penalized the higher value most.</span></pre><h2 id="4518" class="jy jz hy bd ka kb kc kd ke kf kg kh ki jg kj kk kl jk km kn ko jo kp kq kr ks bi translated">F1 分数</h2><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es md"><img src="../Images/9aa13a27f6ea52698c0fe1681bcb13cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QQvmREcXG21Pzp2lFLXyQQ.png"/></div></div></figure><h2 id="7c30" class="jy jz hy bd ka kb kc kd ke kf kg kh ki jg kj kk kl jk km kn ko jo kp kq kr ks bi translated"><strong class="ak"> ROC 曲线</strong></h2><p id="2d6b" class="pw-post-body-paragraph iv iw hy ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">ROC 曲线是真阳性率(y 轴)对假阳性率(x 轴)的曲线图，我们改变了将观察值分配给给定类别的阈值。</p><figure class="ju jv jw jx fd hk er es paragraph-image"><div class="er es mj"><img src="../Images/40002315e6248730a4c8f6efda730667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*huuin4vZsbZwHogL1Tv60g.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源<a class="ae hv" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/</a></figcaption></figure><p id="1350" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码示例:</p><pre class="ju jv jw jx fd lt lu lv lw aw lx bi"><span id="073a" class="jy jz hy lu b fi ly lz l ma mb">from sklearn.metrics import confusion_matrix<br/>from sklearn.metrics import classification_report<br/>from sklearn.metrics import roc_curve</span><span id="a30a" class="jy jz hy lu b fi mc lz l ma mb">actual = [1,0,0,1,0,0,1,0,0,1]<br/>predicted = [1,0,0,1,0,0,0,1,0,0]</span><span id="906a" class="jy jz hy lu b fi mc lz l ma mb">matrix = confusion_matrix(actual,predicted, labels=[1,0])<br/>print('Confusion matrix : \n', matrix)</span><span id="3dc7" class="jy jz hy lu b fi mc lz l ma mb">matrix = classification_report(actual, predicted, labels=[1,0])<br/>print('Classification report : \n', matrix)</span></pre><p id="898f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望你不要被混淆矩阵所迷惑！！</p></div></div>    
</body>
</html>