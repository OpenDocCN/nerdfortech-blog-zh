<html>
<head>
<title>React Native — Redux, the most simplest explanation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native — Redux，最简单的解释</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/react-native-redux-the-most-simplest-explanation-220ba72f6266?source=collection_archive---------4-----------------------#2021-02-14">https://medium.com/nerd-for-tech/react-native-redux-the-most-simplest-explanation-220ba72f6266?source=collection_archive---------4-----------------------#2021-02-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/49a9bd58e8628b10031c2c4d3418af0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fns3l_JVkTMtX6cO2wpSXA.jpeg"/></div></div></figure><p id="ab44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你正在阅读这篇文章，那么你想了解React Native中的Redux，并且已经阅读了一些博客和观看了一些youtube视频，但事情对你来说仍然不清楚！！</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="js jt l"/></div></figure><p id="48e3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">别担心，几个月前当我第一次尝试理解Redux时，我也在同样的地方，肯定这不是一个复杂的话题，但很难一下子掌握。对于初学者来说，网上的例子很难理解。所以我会创建一个最简单的例子，这样你会非常清楚地理解它。</p><p id="18e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先是术语</p><ol class=""><li id="bf48" class="ju jv hi is b it iu ix iy jb jw jf jx jj jy jn jz ka kb kc bi translated"><strong class="is hj">动作</strong> —您想要执行的动作，例如登录用户、从API获取帖子等。基本上它只是一个通常用const关键字创建的变量。例如:<strong class="is hj">const INCREMENT _ COUNTER = " INCREMENT _ COUNTER "。</strong></li><li id="f046" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj">动作创建器— </strong>创建动作的箭头功能。这是必需的，因为有时动作不仅仅是可变的，一些额外的细节可能与它相关联。</li><li id="eb64" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj"> Reducer — </strong>是一个纯函数，将当前状态和动作作为输入，返回更新后的状态。大多数状态管理逻辑都发生在这里。</li><li id="4fd8" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj"> Store — </strong>简单来说就是包含应用程序整个状态的容器。</li><li id="56cf" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj">use selector(Hook)——</strong>该钩子用于订阅状态变化，这些变化稍后可用于渲染或其他一些过程。</li><li id="2a9d" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj">useDispatch(Hook)——</strong>用于调度动作。您将与它一起传递操作创建者，以便可以执行所需的操作。例如:如果您调度<strong class="is hj">INCREMENT _ COUNTER</strong>action<strong class="is hj">，</strong>那么具有计数值的状态变量将被更新。</li></ol><p id="4973" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们开始，我上面解释的所有术语都将在下面的例子中使用。</p><ol class=""><li id="7f87" class="ju jv hi is b it iu ix iy jb jw jf jx jj jy jn jz ka kb kc bi translated"><strong class="is hj">创建项目(我假设您使用react-native CLI，如果您使用expo，只需参考expo文档</strong> <a class="ae ki" href="https://docs.expo.io/workflow/expo-cli/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">此处</strong> </a> <strong class="is hj">)，了解命令。)</strong></li></ol><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="e8fb" class="ko kp hi kk b fi kq kr l ks kt"><strong class="kk hj">react-native init Redux_pracice</strong> (execute this command on terminal at your convenient directory)</span></pre><p id="c540" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.将目录更改为新创建的项目</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="9ccc" class="ko kp hi kk b fi kq kr l ks kt">cd Redux_pracice</span></pre><p id="84c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2a。安装redux和react-redux，在react内部使用redux需要这2个包。</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="c106" class="ko kp hi kk b fi kq kr l ks kt">npm install redux react-redux</span></pre><p id="bfb2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.从App.js中删除所有默认内容，并保留如下所示的内容。</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="d1df" class="ko kp hi kk b fi kq kr l ks kt">import React from 'react';</span><span id="7d10" class="ko kp hi kk b fi ku kr l ks kt">import { createStore, combineReducers } from "redux";</span><span id="ac0a" class="ko kp hi kk b fi ku kr l ks kt">const store = createStore(rootReducer);</span><span id="3549" class="ko kp hi kk b fi ku kr l ks kt">export default App = () =&gt; {</span><span id="1fd9" class="ko kp hi kk b fi ku kr l ks kt">return (</span><span id="3228" class="ko kp hi kk b fi ku kr l ks kt">);</span><span id="3c27" class="ko kp hi kk b fi ku kr l ks kt">};</span></pre><p id="5af4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们从实际的redux实现开始。</p><p id="5137" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.在根目录下创建一个名为<strong class="is hj">的文件夹存储</strong>。</p><p id="db00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.创建一个名为<strong class="is hj"> actions，reducers </strong>的文件夹</p><p id="fb1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.在actions文件夹中创建一个名为<strong class="is hj"> modifyCounter.js、</strong>的文件，下面是action creator的内容。</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="3ba6" class="ko kp hi kk b fi kq kr l ks kt">export const INCREASE_COUNTER = "INCREASE_COUNTER"; <strong class="kk hj">//Action</strong></span><span id="68cc" class="ko kp hi kk b fi ku kr l ks kt">export const DECREASE_COUNTER = "DECREASE_COUNTER"; <strong class="kk hj">//Action</strong></span><span id="8ff9" class="ko kp hi kk b fi ku kr l ks kt">export const incrementCounter = () =&gt; { <strong class="kk hj">//Action Creator</strong></span><span id="59d4" class="ko kp hi kk b fi ku kr l ks kt">return {type: INCREASE_COUNTER}</span><span id="97a1" class="ko kp hi kk b fi ku kr l ks kt">}</span><span id="ec98" class="ko kp hi kk b fi ku kr l ks kt">export const decrementCounter = () =&gt; { <strong class="kk hj">//Action Creator</strong></span><span id="7e68" class="ko kp hi kk b fi ku kr l ks kt">return {type: DECREASE_COUNTER}</span><span id="76e5" class="ko kp hi kk b fi ku kr l ks kt">}</span></pre><p id="435e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上所述，这里有两个操作，一个是incrementCounter，另一个是DECREASE_COUNTER，还有两个名为incrementCounter、decrementCounter的操作创建者。在这种情况下，动作创建者只有类型属性，但是在您的实时项目中，您可能需要将许多属性与动作相关联。根据添加的属性。</p><p id="f9a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意:动作创建者不是必须的！！仅仅动作就足以执行状态管理，但是建议使用动作创建者，因为将来如果任何新的属性伴随着动作出现，变化将是最小的。</strong></p><p id="f344" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.在<strong class="is hj"> reducer </strong>文件夹中创建一个名为<strong class="is hj"> modifyCounter.js </strong>的文件，并添加以下代码。</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="07c2" class="ko kp hi kk b fi kq kr l ks kt">import { DECREASE_COUNTER, INCREASE_COUNTER } from "../actions/UpdateCounter";<br/>//<strong class="kk hj"> Previously created actions are imported here</strong></span><span id="65ef" class="ko kp hi kk b fi ku kr l ks kt">const initialState = {</span><span id="2b71" class="ko kp hi kk b fi ku kr l ks kt">count: 0</span><span id="d156" class="ko kp hi kk b fi ku kr l ks kt">}</span><span id="727e" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">//reducer named modifyCounterReducer is created below.</strong></span><span id="755e" class="ko kp hi kk b fi ku kr l ks kt">const modifyCounterReducer = (state = initialState, action) =&gt; {</span><span id="96bd" class="ko kp hi kk b fi ku kr l ks kt">         switch (action.type) {</span><span id="f7d1" class="ko kp hi kk b fi ku kr l ks kt">             case DECREASE_COUNTER:</span><span id="40f2" class="ko kp hi kk b fi ku kr l ks kt">                 let previousCount = state.count;</span><span id="e928" class="ko kp hi kk b fi ku kr l ks kt">                 previousCount--;</span><span id="cd4b" class="ko kp hi kk b fi ku kr l ks kt">                 return {...state, count: previousCount}</span><span id="0508" class="ko kp hi kk b fi ku kr l ks kt">             case INCREASE_COUNTER:</span><span id="f4e9" class="ko kp hi kk b fi ku kr l ks kt">                let nextCount = state.count;</span><span id="340a" class="ko kp hi kk b fi ku kr l ks kt">                nextCount++;</span><span id="da6c" class="ko kp hi kk b fi ku kr l ks kt">                return {...state, count: nextCount}</span><span id="c705" class="ko kp hi kk b fi ku kr l ks kt">           default:</span><span id="7b92" class="ko kp hi kk b fi ku kr l ks kt">              return state</span><span id="b784" class="ko kp hi kk b fi ku kr l ks kt">        }</span><span id="a64d" class="ko kp hi kk b fi ku kr l ks kt">}</span><span id="dc0a" class="ko kp hi kk b fi ku kr l ks kt">export default modifyCounterReducer</span></pre><p id="ee01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的modifyCounterReducer(一个Reducer函数)中，我们将当前状态和动作作为输入，并将新状态作为输出返回。这里我们切换action.type并根据它增加或减少计数。</p><p id="f2a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">仔细观察状态变化这里，我们从状态变量中读取当前状态，并增加或减少它，然后返回更新后的值。这里要注意的重要一点是，状态本身没有被修改，变量<strong class="is hj"> initialState </strong>是应用程序的实际状态。我们把它作为一个论点来发挥作用，并修改论点。因为这个<strong class="is hj">状态在redux中是不可变的。我们也可以使用</strong><a class="ae ki" href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">redux-dev tools</strong></a><strong class="is hj">chrome扩展来调试redux的状态变化，只是因为我们没有修改实际的状态。</strong></p><p id="da87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们已经完成了最重要的步骤，剩下的就是创建存储和修改应用程序的状态。</p><p id="96b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.在根层级创建一个名为<strong class="is hj"> screens/home.js </strong>的文件夹。下面应该是它的内容。</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="bfed" class="ko kp hi kk b fi kq kr l ks kt">import React from 'react'</span><span id="7f43" class="ko kp hi kk b fi ku kr l ks kt">import { View } from 'react-native'</span><span id="e63a" class="ko kp hi kk b fi ku kr l ks kt">function Home() {</span><span id="8709" class="ko kp hi kk b fi ku kr l ks kt">return (</span><span id="4d0a" class="ko kp hi kk b fi ku kr l ks kt">&lt;View&gt;</span><span id="8133" class="ko kp hi kk b fi ku kr l ks kt">&lt;/View&gt;</span><span id="f3f1" class="ko kp hi kk b fi ku kr l ks kt">)</span><span id="80e9" class="ko kp hi kk b fi ku kr l ks kt">}</span><span id="5aef" class="ko kp hi kk b fi ku kr l ks kt">export default Home</span></pre><p id="523e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">9.现在，在App.js中导入主页并创建商店和提供者，新的App.js文件如下所示。</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="73d3" class="ko kp hi kk b fi kq kr l ks kt">import React from 'react';</span><span id="5843" class="ko kp hi kk b fi ku kr l ks kt">import { createStore, combineReducers } from "redux";<br/>import Home from '../screens/home.js'</span><span id="fd82" class="ko kp hi kk b fi ku kr l ks kt">const rootReducer = combineReducers({ </span><span id="48c0" class="ko kp hi kk b fi ku kr l ks kt">modifyCount: modifyCounterReducer</span><span id="61c3" class="ko kp hi kk b fi ku kr l ks kt">});</span><span id="6fc4" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">// CreateStore takes reducer as argument, combineReducers is not //required in our case, but I'm keeping it, so that if you have //more than one reducer you would be using above syntax. </strong></span><span id="c710" class="ko kp hi kk b fi ku kr l ks kt">const store = createStore(rootReducer); </span><span id="79ba" class="ko kp hi kk b fi ku kr l ks kt">export default App = () =&gt; {</span><span id="31e7" class="ko kp hi kk b fi ku kr l ks kt">return (</span><span id="9bae" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">//Provider makes the store available to all the components across //which it is nested. In our case we had just home, so provider is // around it. If you have complex navigation then keep it at the top //of it.</strong></span><span id="b12e" class="ko kp hi kk b fi ku kr l ks kt">&lt;Provider store={store}&gt;</span><span id="6613" class="ko kp hi kk b fi ku kr l ks kt">   &lt;Home /&gt;</span><span id="3120" class="ko kp hi kk b fi ku kr l ks kt">&lt;/Provider&gt;</span><span id="b589" class="ko kp hi kk b fi ku kr l ks kt">);</span><span id="23ae" class="ko kp hi kk b fi ku kr l ks kt">};</span></pre><p id="d5ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">10.现在让我们访问Home组件中的商店。以下是Home.js的更新内容</p><pre class="jo jp jq jr fd kj kk kl km aw kn bi"><span id="ffab" class="ko kp hi kk b fi kq kr l ks kt">import { Text, View, TouchableOpacity, Alert } from 'react-native'</span><span id="e14c" class="ko kp hi kk b fi ku kr l ks kt">import { useSelector, useDispatch } from "react-redux";</span><span id="a2d4" class="ko kp hi kk b fi ku kr l ks kt">import { decrementCounter, incrementCounter } from '../../Store/actions/UpdateCounter';</span><span id="6693" class="ko kp hi kk b fi ku kr l ks kt">export default function Home() {</span><span id="52a2" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">// as said before useSelector hook is used to subscribe to state //changes, on RHS we have state.modifyCount here modifyCount is the //alias name of reducer that we have in store creation at app.js</strong>  <br/>// <strong class="kk hj">If you have not used combineReducer then just use state.count </strong></span><span id="b116" class="ko kp hi kk b fi ku kr l ks kt">const currentCount = useSelector(state =&gt; state.modifyCount.count)</span><span id="bf77" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">// This gives access to all the dispatch events available in the //store</strong><br/>const dispatch = useDispatch();</span><span id="8686" class="ko kp hi kk b fi ku kr l ks kt">return (</span><span id="0618" class="ko kp hi kk b fi ku kr l ks kt">&lt;View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}&gt;</span><span id="753c" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">// By default it will be zero. Because initialState is zero.</strong><br/>&lt;Text&gt;{currentCount}&lt;/Text&gt;</span><span id="8ac6" class="ko kp hi kk b fi ku kr l ks kt"><strong class="kk hj">// Here your dispatching the event by passing the action creator<br/>// Do not pass action itself !! as your switching the action.type<br/>// in reducer</strong></span><span id="18cf" class="ko kp hi kk b fi ku kr l ks kt">&lt;TouchableOpacity</span><span id="0cc8" class="ko kp hi kk b fi ku kr l ks kt">onPress={() =&gt; {</span><span id="31f3" class="ko kp hi kk b fi ku kr l ks kt">dispatch(incrementCounter())</span><span id="ba6f" class="ko kp hi kk b fi ku kr l ks kt">}}</span><span id="a3ce" class="ko kp hi kk b fi ku kr l ks kt">&gt;</span><span id="da01" class="ko kp hi kk b fi ku kr l ks kt">&lt;Text&gt;Increment&lt;/Text&gt;</span><span id="a0f0" class="ko kp hi kk b fi ku kr l ks kt">&lt;/TouchableOpacity&gt;</span><span id="9248" class="ko kp hi kk b fi ku kr l ks kt">&lt;TouchableOpacity</span><span id="5ba5" class="ko kp hi kk b fi ku kr l ks kt">onPress={() =&gt; {</span><span id="edbc" class="ko kp hi kk b fi ku kr l ks kt">dispatch(decrementCounter())</span><span id="3f19" class="ko kp hi kk b fi ku kr l ks kt">}}</span><span id="5ed0" class="ko kp hi kk b fi ku kr l ks kt">&gt;</span><span id="48af" class="ko kp hi kk b fi ku kr l ks kt">&lt;Text&gt;Decrement&lt;/Text&gt;</span><span id="fd70" class="ko kp hi kk b fi ku kr l ks kt">&lt;/TouchableOpacity&gt;</span><span id="7b25" class="ko kp hi kk b fi ku kr l ks kt">&lt;/View&gt;</span><span id="d1c3" class="ko kp hi kk b fi ku kr l ks kt">)</span><span id="c0bb" class="ko kp hi kk b fi ku kr l ks kt">}</span></pre><p id="18c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">遵循上面解释的简单步骤，您的react本机应用程序将获得Redux的功能。一旦你理解了这个例子，然后一步一步地将不同组件的状态转移到Redux store，在需要的地方创建多个动作创建者和减少者。</p><p id="03cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同一作者的其他文章</p><ol class=""><li id="0d67" class="ju jv hi is b it iu ix iy jb jw jf jx jj jy jn jz ka kb kc bi translated"><a class="ae ki" href="https://mevasanth.medium.com/how-everything-is-object-in-javascript-a4164d7e6a2d" rel="noopener">JavaScript中的一切如何都是对象？</a></li><li id="c86b" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><a class="ae ki" href="https://mevasanth.medium.com/how-to-use-local-images-dynamically-in-react-native-71b9f3b0db20" rel="noopener">如何在React Native中动态使用本地图像</a></li><li id="81ad" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><a class="ae ki" href="https://mevasanth.medium.com/event-bubbling-and-trickling-capturing-in-javascript-common-interview-question-8817238df70a" rel="noopener">JavaScript中的事件冒泡和涓滴/捕捉——常见面试问题</a></li></ol><p id="2d4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在mevasanth.medium.com<a class="ae ki" href="https://mevasanth.medium.com" rel="noopener">阅读更多信息</a></p></div></div>    
</body>
</html>