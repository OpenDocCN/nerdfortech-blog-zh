<html>
<head>
<title>Completion handlers-Simply explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">完成处理器——简单解释</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/completion-handlers-simply-explained-b9d70c72462c?source=collection_archive---------2-----------------------#2021-01-29">https://medium.com/nerd-for-tech/completion-handlers-simply-explained-b9d70c72462c?source=collection_archive---------2-----------------------#2021-01-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="6587" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">iOS编程指南</h2><div class=""/><figure class="ev ex ip iq ir is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/b7d2200ae49c48ce1704859b90adc670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96AbMgcCJtiHcMV3OIc1wA.jpeg"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx translated">由宏向量创建—<a class="ae jd" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">www.freepik.com</a></figcaption></figure><p id="e07a" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">完成处理程序是iOS-Swift/Obj-C中广泛使用的概念之一，有些人甚至每天都在使用它，或者至少每天都会看到它。我喜欢它的工作方式。它封装了复杂/繁琐的实现方式，只给你好的一面。</p><p id="3ab8" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">但在我早期iOS开发的日子里却不是这样。学习它们就像训练一条龙。你先是讨厌他们，然后你会一直爱着他们。相信对于新手来说还是一样的情况。</p><figure class="kd ke kf kg fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es kc"><img src="../Images/32fe689e2baa353d2fb1bcad294314e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hBWPHorxWvU_dDEKxwU7A.jpeg"/></div></div></figure><p id="5c82" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">来吧伙计们，让我们驯服他们…</p><p id="559f" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">在使用完成处理程序之前，您需要知道两件事。</p><ol class=""><li id="dddb" class="kh ki hi jg b jh ji jl jm jp kj jt kk jx kl kb km kn ko kp bi translated">关闭</li><li id="236d" class="kh ki hi jg b jh kq jl kr jp ks jt kt jx ku kb km kn ko kp bi translated">阻碍</li></ol><h1 id="25d5" class="kv kw hi bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">什么是闭包？</h1><blockquote class="lt lu lv"><p id="0b07" class="je jf lw jg b jh ji jj jk jl jm jn jo lx jq jr js ly ju jv jw lz jy jz ka kb hb bi translated"><em class="hi">"闭包</em>是自包含的功能块，可以在代码中传递和使用。Swift中的闭包类似于C和Objective-C中的块，以及其他编程语言中的lambdas。”— <a class="ae jd" href="https://docs.swift.org/swift-book/LanguageGuide/Closures.html" rel="noopener ugc nofollow" target="_blank"> <em class="hi"> Swift docs </em> </a></p></blockquote><p id="8546" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">在这里了解更多关于闭包的信息。</p><h1 id="5881" class="kv kw hi bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">什么是积木？</h1><blockquote class="lt lu lv"><p id="fc8d" class="je jf lw jg b jh ji jj jk jl jm jn jo lx jq jr js ly ju jv jw lz jy jz ka kb hb bi translated">“您可以使用块来组成函数表达式，这些表达式可以传递给API，可以选择存储，并由多个线程使用。块作为回调特别有用，因为块既包含回调时要执行的代码，也包含执行过程中需要的数据。— <a class="ae jd" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Blocks/Articles/00_Introduction.html" rel="noopener ugc nofollow" target="_blank"> <em class="hi">苹果开发文档</em> </a></p></blockquote><p id="b8de" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated"><a class="ae jd" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Blocks/Articles/bxGettingStarted.html" rel="noopener ugc nofollow" target="_blank">点击此处了解更多街区信息。</a></p><h1 id="ef64" class="kv kw hi bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">什么是完成处理程序？</h1><blockquote class="lt lu lv"><p id="76cd" class="je jf lw jg b jh ji jj jk jl jm jn jo lx jq jr js ly ju jv jw lz jy jz ka kb hb bi translated">“TL；DR:完成处理程序是一个闭包(<a class="ae jd" href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Closures.html" rel="noopener ugc nofollow" target="_blank">“一个自包含的功能块，可以在你的代码中传递和使用”</a>)。它作为参数传递给一个函数，然后在该函数完成时被调用。- <a class="ae jd" href="https://grokswift.com/completion-handler-faqs/" rel="noopener ugc nofollow" target="_blank"> Grok Swift </a></p></blockquote><p id="1c94" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">要点是在所有的工作完成后，如果需要的话，它会给我们状态，有时有数据或错误。</p><p id="a358" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">我强烈建议在深入学习之前学习一些关于闭包和块的基础知识。</p><p id="cb91" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">记住这一点。</p><p id="4be2" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated"><em class="lw">完成处理程序</em>只不过是一种使用块/闭包实现回调功能的方法或技术。</p></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><p id="c318" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated"><strong class="jg hs">是时候看一些代码示例了。</strong></p><figure class="kd ke kf kg fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es mh"><img src="../Images/bf448abbf300bd04611628d11196c9c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6wks5jyOxt_OrQBn87rYw.jpeg"/></div></div></figure><p id="42a6" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">创建一个带有两个参数的函数:一个用于传递一个布尔值，它将帮助我们完成主要操作，另一个用于完成处理程序。</p><pre class="kd ke kf kg fd mi mj mk ml aw mm bi"><span id="c467" class="mn kw hi mj b fi mo mp l mq mr">func yourFunction(withArg arg: Bool, completion: (Bool) -&gt; ())</span><span id="3a15" class="mn kw hi mj b fi ms mp l mq mr">print(“Gets executed first”)</span><span id="828a" class="mn kw hi mj b fi ms mp l mq mr">// Perform the operations and get the boolean result</span><span id="8d27" class="mn kw hi mj b fi ms mp l mq mr">var localValue:Bool</span><span id="cc61" class="mn kw hi mj b fi ms mp l mq mr">if arg {                // |</span><span id="dfdb" class="mn kw hi mj b fi ms mp l mq mr">localValue = true       // | Our major operation 😂</span><span id="371d" class="mn kw hi mj b fi ms mp l mq mr">} else{                 // |</span><span id="5a4e" class="mn kw hi mj b fi ms mp l mq mr">localValue = false      // |</span><span id="50c5" class="mn kw hi mj b fi ms mp l mq mr">}                       // |</span><span id="e7cd" class="mn kw hi mj b fi ms mp l mq mr">// Send the result to the other end</span><span id="4db6" class="mn kw hi mj b fi ms mp l mq mr">completion(localValue)</span><span id="ecd7" class="mn kw hi mj b fi ms mp l mq mr">}</span></pre><p id="ead9" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">在需要的地方调用函数。如果你看下面，你将看不到我们主要操作的任何部分。您只是获得了布尔成功结果。现在就看你如何明智地使用它了。</p><pre class="kd ke kf kg fd mi mj mk ml aw mm bi"><span id="7461" class="mn kw hi mj b fi mo mp l mq mr">yourFunction(withArg: true, completion: { (success) -&gt; Void in</span><span id="ee54" class="mn kw hi mj b fi ms mp l mq mr">    print("Gets executed second")   </span><span id="8d78" class="mn kw hi mj b fi ms mp l mq mr">    if success { // Use the value send from the other end  <br/>              <br/>        label.text = "True"          </span><span id="be4f" class="mn kw hi mj b fi ms mp l mq mr">    } else {     <br/>       <br/>        label.text = "False"    <br/>     <br/>    }       <br/> <br/>})</span></pre></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><p id="bf5f" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated"><strong class="jg hs">让我们看看一些Objective-C代码。</strong></p><p id="93c0" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">创建一个有三个参数的函数，两个用于传递输入值，这将有助于我们的数学运算，另一个用于完成处理程序。</p><pre class="kd ke kf kg fd mi mj mk ml aw mm bi"><span id="b12e" class="mn kw hi mj b fi mo mp l mq mr">-(<strong class="mj hs">void</strong>)addValues:(<strong class="mj hs">int</strong>)inputA withNumber:(<strong class="mj hs">int</strong>)inputB andCompletionHandler:(<strong class="mj hs">void</strong> (^)(<strong class="mj hs">int</strong> result))completionHandler{</span><span id="1f7e" class="mn kw hi mj b fi ms mp l mq mr"><strong class="mj hs">int</strong> result = inputA + inputB;     // |- Our math operation😁</span><span id="3887" class="mn kw hi mj b fi ms mp l mq mr">completionHandler(result);</span><span id="8edd" class="mn kw hi mj b fi ms mp l mq mr">}</span></pre><p id="36a0" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">在需要的地方调用函数。</p><pre class="kd ke kf kg fd mi mj mk ml aw mm bi"><span id="250f" class="mn kw hi mj b fi mo mp l mq mr">[<strong class="mj hs">self</strong> addValues:1 withNumber:2 andCompletionHandler:^(<strong class="mj hs">int</strong> result) {</span><span id="90c4" class="mn kw hi mj b fi ms mp l mq mr"><em class="lw">// Log the result</em></span><span id="0aa4" class="mn kw hi mj b fi ms mp l mq mr"><strong class="mj hs">NSLog</strong>(@"The result is %d", result);</span><span id="c025" class="mn kw hi mj b fi ms mp l mq mr">}];}</span></pre><p id="0c52" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">如果你看上面，你不会看到我们数学运算的任何部分。你只是得到了答案作为结果。你想怎么用就怎么用吧。</p></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><p id="4560" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">就这样，伙计们。我该离开了。</p><figure class="kd ke kf kg fd is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es mt"><img src="../Images/7777dfed840e4d55f1f87c0897b524e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCBbmWBo_fSQl8twPTsvzQ.jpeg"/></div></div></figure><p id="0246" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">多读书。多练习。否则你很快就会被淘汰。</p><p id="887f" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">Swift示例练习场地:</p><p id="f012" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated"><a class="ae jd" href="https://github.com/Rajaikumar-iOSDev/Simple-Completion-Handler-Example" rel="noopener ugc nofollow" target="_blank">https://github . com/Rajaikumar-IOs dev/Simple-Completion-Handler-Example</a></p><div class="mu mv ez fb mw mx"><a href="https://github.com/Rajaikumar-iOSDev/Simple-Completion-Handler-Example" rel="noopener  ugc nofollow" target="_blank"><div class="my ab dw"><div class="mz ab na cl cj nb"><h2 class="bd hs fi z dy nc ea eb nd ed ef hr bi translated">rajaikumar-IOs dev/简单完成处理程序-示例</h2><div class="ne l"><h3 class="bd b fi z dy nc ea eb nd ed ef dx translated">🏺这是一个在iOS中使用完成处理程序(Closures)的例子——Swift Permalink未能加载最新提交…</h3></div><div class="nf l"><p class="bd b fp z dy nc ea eb nd ed ef dx translated">github.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ix mx"/></div></div></a></div><p id="e138" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hb bi translated">如果您需要Objective-C的示例项目，请告诉我。</p></div></div>    
</body>
</html>