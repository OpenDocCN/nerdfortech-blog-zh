<html>
<head>
<title>Next.js | SWR (Stale While Revalidate) — Introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Next.js | SWR(重新验证时失效)-简介</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/next-js-swr-stale-while-revalidate-introduction-de73d243f5b1?source=collection_archive---------0-----------------------#2020-07-02">https://medium.com/nerd-for-tech/next-js-swr-stale-while-revalidate-introduction-de73d243f5b1?source=collection_archive---------0-----------------------#2020-07-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8229799b4273601a71e7c37c99714f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0keAvEWXBhAAbJnfmg4IA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">黑暗标志由<a class="ae iu" href="https://vercel.com/design/nextjs" rel="noopener ugc nofollow" target="_blank">https://vercel.com/design/nextjs</a></figcaption></figure><p id="667d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> State While重新验证</strong>是React Hooks库，用于远程数据获取，由Zeit创建。它用于:</p><ul class=""><li id="4c7d" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">从缓存中返回数据(陈旧)</li><li id="a6a5" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">发送获取请求(重新验证)，然后</li><li id="9bf4" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">又有了最新的数据。</li></ul><p id="9d4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">谷歌谈论SWR的概念:</strong></p><blockquote class="kh ki kj"><p id="84e7" class="iv iw kk ix b iy iz ja jb jc jd je jf kl jh ji jj km jl jm jn kn jp jq jr js hb bi translated"><em class="hi">“它帮助开发人员在即时性(立即加载缓存内容)和新鲜性(确保缓存内容的更新在未来使用)之间取得平衡。如果您维护一个定期更新的第三方web服务或库，或者您的第一方资产往往具有较短的生命周期，那么stale-while-revalidate可能是对现有缓存策略的一个有用的补充。”</em></p></blockquote><p id="2763" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">包含stale-while-revalidate的缓存控制响应头也应该包含max-age，并且通过max-age指定的秒数是确定陈旧性的因素。任何比max-age新的缓存响应都被认为是新的，而旧的缓存响应是陈旧的。简而言之，只要从缓存中呈现数据，SWR就会自动从原点重新验证数据，这将使页面呈现速度更快，并且在呈现页面后，数据会更新为最新数据。</p><p id="9975" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">SWR的优势:</strong>除了自定义API调用&amp;Zeit的SWR自带的REST API集成如下所述。</p><ul class=""><li id="b65f" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><strong class="ix hj">焦点重新验证:</strong>当您重新聚焦一个页面或在浏览器中的选项卡之间切换时，SWR会自动重新验证数据。</li><li id="9c8f" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">快速导航</strong>:一旦缓存中的数据被渲染，SWR会自动从原点重新验证数据。</li><li id="71fb" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">间隔</strong>重取:SWR将为您提供自动提取数据的选项，其中预取将仅发生在与屏幕上的挂钩相关联的组件上。</li><li id="9c0b" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">局部突变</strong>:将变化应用于局部数据，即总是更新到最新数据。</li><li id="4a27" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><strong class="ix hj">依赖获取</strong> : SWR允许你获取依赖于其他数据的数据。它确保了最大可能的并行性(避免瀑布)，以及在下一次数据提取需要动态数据时的串行提取。</li><li id="8d6d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">可扩展的 : SWR的可扩展性非常好，因为它只需要很少的努力就可以编写应用程序，自动并最终汇聚到最新的远程数据。</li></ul><p id="785d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">SWR的缺点:</strong></p><ul class=""><li id="498a" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">使用SWR的一个主要缺点是，它可能会导致用户查看陈旧的数据，这可能是因为缺少API的正确实现、更新显示信息时的错误以及其他许多原因造成的。</li><li id="718c" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">除了创造糟糕的用户体验，这也可能是一个公司遭受挫折的唯一原因！想象一下，一家在金融领域声誉卓著的公司，他们能让用户查看陈旧的数据吗？？不，这就是为什么需要准确实现和使用SWR的原因。</li></ul><p id="4d74" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">next . js简介:</strong></p><p id="ad73" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Next.js是一个基于react的框架。这是基于react，W<strong class="ix hj">ebpack</strong>T20】通天塔。它以自动代码分割、热代码重载(即一旦保存了更改就重载)&amp;而闻名，最重要的是服务器端渲染。这将该框架置于React文档中推荐的工具链之上。</p><p id="40d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设一个人的设备上安装了node &amp; npm，我们已经采取了步骤来设置您的<strong class="ix hj"> next.js </strong>项目。</p><p id="dd3c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤1: </strong>通过运行以下命令检查节点&amp; npm版本</p><ul class=""><li id="0e87" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">$node -v &amp;&amp; npm -v</li></ul><p id="3964" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤2: </strong>创建一个目录，并在终端中到达目标目录后执行</p><ul class=""><li id="9e4a" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">$ npm安装—保存下一个反应反应对象</li></ul><p id="c51b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第三步:</strong>在pages文件夹的<strong class="ix hj"> index.js </strong>中创建一个文件(基本上是pages/index.js)，添加下面的代码，运行npm start来看看它的作用！</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/92b850297d01e6aef087c8eb1cd991ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*2sqg-BqtyMWJEvGU9oEe0g.png"/></div></figure><p id="0757" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">使用Next.js和SWR获取API: </strong></p><p id="10d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用强大的<strong class="ix hj"> Next.js </strong>、需要安装的两个依赖项(代码中给出的命令)使用SWR &amp;同构取消提取来执行数据提取。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/835491b458c7e3e092f3468488b666ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dt-WowuPl8OHEn2NadX_zQ.png"/></div></div></figure><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/74d2f469925120863b630a9716697af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*sZN4_HYm93nmi2uHgAow5g.png"/></div></figure><p id="a6e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kp kq kr ks fd kv kw kx ky aw kz bi"><span id="2cba" class="la lb hi kw b fi lc ld l le lf">Hello Andaman and Nicobar Islands!</span></pre><p id="4686" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不断获取越来越多的信息！这就是我现在所拥有的。希望这有所帮助！</p></div></div>    
</body>
</html>