<html>
<head>
<title>Handling Imbalanced Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理不平衡数据</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-handle-imbalanced-data-4fdceb8bbe04?source=collection_archive---------4-----------------------#2021-04-21">https://medium.com/nerd-for-tech/how-to-handle-imbalanced-data-4fdceb8bbe04?source=collection_archive---------4-----------------------#2021-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="9dff" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="6bed" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">不平衡</strong>数据是指类别分布不均匀的分类数据集。这意味着类在数据集中的分布是不均匀的。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/ea888c2a29ea3942d57031f048dbf579.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aqg0Hp5t0p57m1hFhzTwFA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">不平衡数据</figcaption></figure><p id="88b8" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">例如，您有一个包含1000条记录和2个类的数据集(是/否)。在1000条记录中，只有50条属于“是”类，其余950条属于“否”类。记录在“是”和“否”两个等级中的分布是不相等的。</p><h1 id="47b9" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">为什么我们需要处理不平衡数据？</h1><p id="1d4d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在不平衡数据上训练模型可以使模型<strong class="jf hj">偏向</strong>多数类，而完全忽略少数类。</p><p id="c55f" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">假设你的老板让你训练一个模型，将产品分类为‘有缺陷’或‘无缺陷’。给你的数据集有99.3%的记录是“无缺陷”产品，只有0.7%是“有缺陷”产品。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kw"><img src="../Images/127b8e695d66848d4713d0c115c4593b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SG1WHLSUvkp8Lb6VK36-Cw.jpeg"/></div></div></figure><p id="f705" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">您以98%的准确率训练了模型并部署了它。几天后，你的老板找到你，说这个模型不正确，因为它把“有缺陷”的产品归类为“无缺陷”。</p><p id="c608" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">现在你很困惑，因为准确度和精度比问题的实际情况要好。</p><p id="1c69" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">问题是，您根据不平衡数据训练模型，导致模型偏向业务，而您的模型将产品分类到有更多记录的类别。</p><h2 id="3faa" class="kx ig hi bd ih ky kz la il lb lc ld ip jo le lf it js lg lh ix jw li lj jb lk bi translated">解决方法是什么？</h2><p id="d0ad" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">解决方案是你必须<strong class="jf hj">让数据平衡。</strong></p><p id="015c" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">通过使用以下技术，我们可以平衡我们的数据。</p><ol class=""><li id="f284" class="ll lm hi jf b jg kr jk ks jo ln js lo jw lp ka lq lr ls lt bi translated">对训练集进行重新采样</li><li id="3596" class="ll lm hi jf b jg lu jk lv jo lw js lx jw ly ka lq lr ls lt bi translated">正确的评估指标</li><li id="2636" class="ll lm hi jf b jg lu jk lv jo lw js lx jw ly ka lq lr ls lt bi translated">k倍交叉验证</li><li id="993d" class="ll lm hi jf b jg lu jk lv jo lw js lx jw ly ka lq lr ls lt bi translated">群集丰富的类</li></ol><p id="2710" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">但是这里我们只讨论重采样技术。</p><h1 id="672d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">重采样技术</h1><p id="d988" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">重采样基本上是一种可以平衡不平衡类的方法，它提供了一种使用标准分类器处理不平衡学习问题的方便有效的方法，因为它改变了原始训练集而不是修改学习算法。</p><p id="4271" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">重采样有两种类型。</p><ol class=""><li id="f18d" class="ll lm hi jf b jg kr jk ks jo ln js lo jw lp ka lq lr ls lt bi translated">欠采样</li><li id="6eb1" class="ll lm hi jf b jg lu jk lv jo lw js lx jw ly ka lq lr ls lt bi translated">过采样</li></ol><h2 id="8b93" class="kx ig hi bd ih ky kz la il lb lc ld ip jo le lf it js lg lh ix jw li lj jb lk bi translated">欠采样</h2><p id="c1ad" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">欠采样技术降低了多数类的频率。通过这样做，我们丢失了可能对模型准备有用的大部分数据。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lz"><img src="../Images/a0d15e33eac5cba0dff94ae2705c959b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfpeT17uWe3EHpQ71HR3iQ.png"/></div></div></figure><p id="f30c" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">在下面的例子中，我们在0和1类频率之间有很大的差异。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ma"><img src="../Images/fe3ffee9f949fe1f8f6cee7434f527e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*OxoH8OXBK-Qn9wUlC7nzKQ.jpeg"/></div></figure><p id="97f4" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">让我们应用欠采样。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mb"><img src="../Images/976e1b4918958fbec78bc6d89e42a21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*4rnwl7WwpDbogoShW8cjNQ.jpeg"/></div></figure><p id="6670" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">结果</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mc"><img src="../Images/355dcfd9f557e318e6adf900ae77033a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*M70bcJGTbI8eZaBr1eMhPQ.jpeg"/></div></figure><p id="fb63" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">我们可以看到它减少了多数类0等于1的频率。</p><h2 id="4da9" class="kx ig hi bd ih ky kz la il lb lc ld ip jo le lf it js lg lh ix jw li lj jb lk bi translated">过采样</h2><p id="df45" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这种技术增加了少数类的频率。这种方法的缺点是由于它制作少数类的精确副本而导致数据过拟合。此外，训练集的规模增大，从而增加了构建模型的时间。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lz"><img src="../Images/f5825f19035f6ac6fcc6e61f3f0de9e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0tjLjEsXrYEeoide8d6Bw.png"/></div></div></figure><p id="d39c" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">让我们应用过采样。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es md"><img src="../Images/f88436543bab0dd256a4796573bc48ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*naUOJZQS94ZR8ojx9sX1GQ.jpeg"/></div></figure><p id="dc19" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">结果</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es me"><img src="../Images/fa9e5bf3ae15e47fa65f2ddc63572bd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*Weo3ZAsjXzNR7m6NiNnOKA.jpeg"/></div></figure><p id="3bfc" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">我们可以看到，过采样技术增加了少数类1的实例。</p><p id="2483" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">那是平衡不平衡数据的随机抽样技术。</p></div></div>    
</body>
</html>