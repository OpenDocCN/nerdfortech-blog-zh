<html>
<head>
<title>Ways to build Keras Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建 Keras 模型的方法</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/ways-to-build-keras-models-198f6a643944?source=collection_archive---------4-----------------------#2021-10-13">https://medium.com/nerd-for-tech/ways-to-build-keras-models-198f6a643944?source=collection_archive---------4-----------------------#2021-10-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6ad4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很高兴在长时间的休息后回来，我有很多并行的事情要做，所以我从这个系列中休息一下，但是我又带着一个基本但超级重要和有趣的主题回来了。</p><p id="71b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们已经了解了<a class="ae jd" href="https://sid-kalla99.medium.com/deep-learning-5fa04e493a7f" rel="noopener">深度学习</a>，我们如何使用<a class="ae jd" rel="noopener" href="/nerd-for-tech/neural-networks-68531432fb5">神经网络</a>，算法背后的直觉和数学来实现它，但现在一个重要的问题出现了，我们是否有一个规定的结构或任何特定的模式来构建神经网络模型？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c7624aee2b3b48234874e0d1b7c9ba7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*8jI3wB41kYxP-Wo5rO_Yvg.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">来源:gfycat.com<a class="ae jd" href="https://gfycat.com/gifs/search/deep+neural+network" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="3ff1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">答案是肯定的，在构建神经网络时，有一些模式需要遵循，任何从事神经网络工作的人都知道这些模式，如果没有，他们绝对应该阅读这篇博客。</p><p id="3940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Keras 是一个开源库，用于构建神经网络和深度学习。它允许我们建立、训练和评估模型。构建模型的两种基本模式是顺序 API 和功能 API 模型。</p><h2 id="8194" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">顺序 API 模型:</h2><p id="a4ea" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">这是可以使用 keras 建立和评估的最基本和最容易的模型。顾名思义，它允许我们以一种连续的形式、一层又一层的风格来构建模型。在这里，我们为模型创建了一个合适的单元，它包含了我们想要的模型中的所有层。该模型不能用于随机输入层和随机输出层格式，它遵循完全连续的构建顺序。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="c366" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是如何构建顺序模型的一个片段。这是我在上一篇博客<a class="ae jd" rel="noopener" href="/nerd-for-tech/classification-on-cifar-10-32abe456302">中为 cifar-10 数据集训练的同一个模型。你们都可以看到在构建这种类型的模型时遵循的模式，从导入</a><a class="ae jd" href="https://docs.python.org/3/library/" rel="noopener ugc nofollow" target="_blank">库</a>开始，如<a class="ae jd" href="https://www.tensorflow.org/api_docs/python/tf" rel="noopener ugc nofollow" target="_blank"> tensorflow </a>和 keras，并调用<a class="ae jd" href="https://keras.io/api/models/sequential/" rel="noopener ugc nofollow" target="_blank"> tf.keras.Sequential </a>。然后，我们必须使用我们的层来构建所需的模型，例如在本例中，我们使用了输入层，其图像大小为 32x32，以<a class="ae jd" href="https://www.mathworks.com/help/matlab/creating_plots/image-types.html" rel="noopener ugc nofollow" target="_blank"> rgb 格式</a>作为输入，然后是完整的架构。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kw"><img src="../Images/45bf1f40f8d5f6731fabedebc89f0d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*56MCAk7LOTwGixoAmf3MZA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">顺序模型摘要</figcaption></figure><p id="fb40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们可以看到所有层一层一层地堆叠在一起，并遵循规定的顺序，并将根据给定的数据进行相应的训练。</p><h2 id="e0d3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">功能 API 模型:</h2><p id="3ae0" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在这种类型的模型中，所有输入都可以直接连接到输出层。在这种类型中，我们简单地构建具有不同层的网络，并且可以手动声明输入和输出层，不需要最后一层必须是输出层，并且训练将根据我们的输入和输出层的指示进行，而不管架构如何。</p><p id="8ed8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种类型的模型主要用于<a class="ae jd" href="https://chroniclesofai.com/transfer-learning/" rel="noopener ugc nofollow" target="_blank">转移学习</a>的情况，如果我们不想进行到最后一层并恢复之前的值，以便可以在另一个模型中使用，我们不需要再次经历完整的模型，我们可以简单地转移权重。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="687c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个例子，说明我们如何使用与上述相同的架构，在相同的数据集<a class="ae jd" href="https://www.cs.toronto.edu/~kriz/cifar.html" rel="noopener ugc nofollow" target="_blank"> cifar-10 </a>上使用<a class="ae jd" href="https://keras.io/guides/functional_api/" rel="noopener ugc nofollow" target="_blank">功能 API </a>构建模型。您可以清楚地看到，在编写代码时，我们将前一层的输出作为下一层的输入，这导致了一系列类似图案的形成，其中各层一个接一个地堆叠。在顺序上没有限制，你可以固定任何你想要你的网络工作的顺序。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kw"><img src="../Images/45bf1f40f8d5f6731fabedebc89f0d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*56MCAk7LOTwGixoAmf3MZA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">串联网络功能模型</figcaption></figure><p id="ccf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是另一个函数式 API 模型的例子，它将很容易解释多输入多输出模型的含义。我们可以很容易地看到，这个模型包含两个不同的输入层和两个输出层，中间还有连接两个不同层的<a class="ae jd" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Concatenate" rel="noopener ugc nofollow" target="_blank">连接层</a>。请注意，进入连接层的两个层的形状应该相同，这样它们才能被连接。最后，当我们定义模型时，我们在不同的列表中声明了输入和输出。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="0acc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个成型的模型，它很容易向我们展示包括所有连接在内的架构。功能模型有着巨大而重要的作用，而构建模型允许复杂网络所需的多个输入和输出，这有助于我们优化我们的问题。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kx"><img src="../Images/38ff7e9a745459d5db1d287143c556d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVE11QK0qG6uEwy78BaPbw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">多输入多输出功能模型</figcaption></figure><p id="8f24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我希望现在你们理解了顺序和功能 API 的概念，现在你们可以根据自己的要求构建自己的神经网络模型，但正如我一直建议每个人适当阅读官方文档以获得任何概念的完整知识一样，我在这里再次提出同样的建议，并将删除<a class="ae jd" href="https://keras.io/api/models/" rel="noopener ugc nofollow" target="_blank"> keras.io </a>的链接，在那里您可以阅读这些类型模型的文档并深入了解它们。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="881e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这是有用的，让你了解不同的方式建立模型。请留下你的回答，祝你学习愉快！！</p></div></div>    
</body>
</html>