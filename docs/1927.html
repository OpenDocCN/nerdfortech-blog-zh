<html>
<head>
<title>How To Use Model Factories And Database Seeders In Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Laravel中使用模型工厂和数据库Seeders</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/faking-it-till-you-make-it-a6b9b1bb82cf?source=collection_archive---------3-----------------------#2021-04-13">https://medium.com/nerd-for-tech/faking-it-till-you-make-it-a6b9b1bb82cf?source=collection_archive---------3-----------------------#2021-04-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/d2f17471273c200fb355935d9c0b8e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*g3FzReqgz9JifWmWF0jJEA.jpeg"/></div></figure><div class=""/><p id="c9b6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，您将了解到:</p><ul class=""><li id="afcc" class="jk jl hp io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">什么是数据库种子</li><li id="6f9d" class="jk jl hp io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">为什么使用数据库种子</li><li id="36df" class="jk jl hp io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">如何使用数据库种子</li></ul><blockquote class="jy jz ka"><p id="2648" class="im in kb io b ip iq ir is it iu iv iw kc iy iz ja kd jc jd je ke jg jh ji jj hb bi translated">如果你正在阅读这篇文章，假设你知道基本的PHP。这很可能是您的第一篇Laravel文章，但是PHP知识会非常有用。</p></blockquote><h1 id="2c9e" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">入门指南</h1><p id="7412" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">大多数时候，当我们必须用虚拟数据开发应用程序时，我们自己键入它们或者使用<a class="ae li" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a> to <a class="ae li" href="https://zubairidrisaweda.medium.com/routing-in-laravel-8-e8e373413b8f#7aa5" rel="noopener"> POST </a>到我们的数据库。这个有用，但是很烂。😢</p><p id="e917" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">其他时候，在完成我们的应用程序后，我们需要它们有一些数据作为开始。我们仍然可以输入这些，或者再次使用Postman。它有效，但仍然很糟糕。😢 😩</p><p id="8eec" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae li" href="https://laravel.com/" rel="noopener ugc nofollow" target="_blank">Laravel</a>——专为开发人员打造——提供测试应用程序或启动应用程序所需的数据。Laravel为您提供了数据库种子，这是在您的应用程序中轻松获取数据的方法。这可能是一些真实的数据，你不想强调自己输入，或者只是假数据，以测试你的API。</p><p id="0ca1" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在深入研究如何使用之前，这里有一些您想要使用数据库种子的原因:</p><ul class=""><li id="f508" class="jk jl hp io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">Seeders非常容易使用，比你自己输入数据要容易得多</li><li id="cb61" class="jk jl hp io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">Seeders让您不费吹灰之力就可以启动并运行，只需对数据库进行一次播种，就可以创建数百行数据</li><li id="6144" class="jk jl hp io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">seeder可以在多个服务器上重用，这意味着部署到一个新的服务器只意味着再次运行seeder并再次获取数据库中的数据</li></ul><p id="8c15" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用播种机还有很多原因，但让我们开始使用它们吧。😆</p><h1 id="c750" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">让我们开始吧</h1><p id="0c0f" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">像这样轻松地创建一个新的Laravel项目:</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lj"><img src="../Images/ecea9bd29e8997672a8d09f11fbbd65b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqWdoK-4oavYw571lReSOg.png"/></div></div></figure><h1 id="ddb6" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">设置您的数据库</h1><p id="aeda" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">创建应用程序后，我们继续设置要使用的数据库。您应该创建一个MySQL数据库(或者您喜欢的任何其他数据库)并更新<em class="kb">。env </em>文件来反映这个变化。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ls"><img src="../Images/db7a07e0e2f397b855020d2e891c79d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_qb1CbXVEIMq1DFYQoifA.png"/></div></div></figure><p id="483f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里，我的数据库名与我的项目名相同。更新<code class="du lt lu lv lw b">DB_USERNAME</code>和<code class="du lt lu lv lw b">DB_PASSWORD</code>以匹配您的数据库凭证。</p><p id="8831" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，数据库已经准备好了，我们可以为我们的数据制作表格<em class="kb">和模型</em>。</p><h1 id="66fc" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">制作模型和迁移</h1><p id="2ad5" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">我们制作了一个<code class="du lt lu lv lw b">Post</code>模型和一个与之配套的迁移。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ls"><img src="../Images/e56740b5a544b52d994c5d04cc02a24a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uF8h1_eZYCzDw3ixtrbBQA.png"/></div></div></figure><p id="9560" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">运行此命令将创建两个新文件，一个模型文件和一个迁移文件。</p><p id="1273" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在<code class="du lt lu lv lw b">Post.php</code>文件中，我们看到这个类使用了<code class="du lt lu lv lw b">HasFactory</code>特征。这意味着数据创建可以是自动化的，或者可以使用工厂来模拟(稍后将详细介绍)。</p><p id="aa55" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们编辑迁移文件，通常命名为<em class="kb">2021 _ 04 _ 12 _ 235242 _ create _ posts _ table</em>，以具有<em class="kb">标题</em>、<em class="kb">正文、</em>和<em class="kb">作者</em>字段。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lx"><img src="../Images/fe28da0a500aadf181a2c68c63ab415f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUiUg8kKN61VzA7jtkF26Q.png"/></div></div></figure><p id="9e00" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后的数据库设置是运行迁移，这样我们的表就创建好了，并准备好保存我们的数据。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ls"><img src="../Images/4f645703925f8b2b16fa9933cc73f02a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4d4gIcvDXLmCL7nuU4NHQ.png"/></div></div></figure><h1 id="0243" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">创建种子</h1><p id="360a" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">就像我们到目前为止所做的其他事情一样，创建一个播种器也不难。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ly"><img src="../Images/daabaa4cb6c94a1dcc4135e3e4e0da40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K_719wzctHAE5sdZPjnSqg.png"/></div></div></figure><p id="b42b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">运行这个命令会在我们的<code class="du lt lu lv lw b">database</code>文件夹的<code class="du lt lu lv lw b">seeders</code>文件夹中创建一个新文件。默认情况下，该文件如下所示:</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lz"><img src="../Images/66cf78c9e4e3973ec652bfd79142a387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnhjioJ3EmiV-plRIeAvCg.png"/></div></div></figure><p id="df27" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们的大部分代码都在run方法中。但在此之前，我们引进了<code class="du lt lu lv lw b">Post</code>模式。然后我们可以创造一些职位。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ma"><img src="../Images/5e3553213bb8454f01ef608629b0f1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWgDYikWxFBaRV20WvFI6Q.png"/></div></div></figure><p id="8e38" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们已经创建了一些希望在应用程序中使用的数据。那么我们实际上在哪里把它添加到我们的数据库中呢？</p><p id="ca91" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们告诉我们的<code class="du lt lu lv lw b">DatabseSeeder</code>使用我们刚刚创建的<code class="du lt lu lv lw b">PostsTableSeeder</code>。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es mb"><img src="../Images/6a805f4e0b8f8ffaf9fe82a20439b45d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eMXcjSLLLCpEyRbnlM0cpg.png"/></div></div></figure><blockquote class="jy jz ka"><p id="75a0" class="im in kb io b ip iq ir is it iu iv iw kc iy iz ja kd jc jd je ke jg jh ji jj hb bi translated"><code class="du lt lu lv lw b">DatabaseSeeder</code>文件由Laravel自动创建。</p></blockquote><h2 id="8b27" class="mc kg hp bd kh md me mf kl mg mh mi kp ix mj mk kt jb ml mm kx jf mn mo lb mp bi translated">使用模型工厂</h2><p id="8b03" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">现在让我们学习如何使用Laravel获得虚拟数据。为此，我们创建了一个工厂来生成假数据。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es mq"><img src="../Images/c1d70af8f905a1007e4534cd8667b203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rpb48Sxq7jq5Lwz1LAOatg.png"/></div></div></figure><p id="e2fd" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">运行这个命令会在我们的工厂文件夹中创建一个<code class="du lt lu lv lw b">PostFactory</code>文件。默认情况下，这个文件应该和我这里的一样。</p><p id="6ab0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正是在这个文件中，我们定义了要创建的数据的结构——我们设置了我们想要的字段。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es mr"><img src="../Images/a70bdc4cfdb97fc4d9a63e4a2a35c0a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lFDWvzMjPOmUpek8yfVZg.png"/></div></div></figure><p id="2273" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">更新<code class="du lt lu lv lw b">PostFactory</code>的<code class="du lt lu lv lw b">definition</code>方法，创建<em class="kb">标题</em>、<em class="kb">正文、</em>和<em class="kb">作者</em>结果为:</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ms"><img src="../Images/1d38ce3dd046f2e22492410c9586a466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ql2wYajmsAhon3driNTDHQ.png"/></div></div></figure><p id="e15f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用这个工厂非常简单，我们在<code class="du lt lu lv lw b">PostsTableSeeder</code>文件中调用模型的工厂方法。</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es lz"><img src="../Images/1b541d3a973abdba810197a26ba95014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HlXR_WOXIaZfHZYFdIvxnA.png"/></div></div></figure><p id="77d6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当数据库最终被播种时，这将创建50个随机的帖子。</p><h1 id="8e19" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">运行播种机</h1><p id="6cfd" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">我们确实写了相当多的代码，但我们仍然有一个空的数据库。好了，这即将改变，运行下面的命令来运行我们的seeders，并用我们与Laravel一起创建的这些帖子填充我们的数据库。😄</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ls"><img src="../Images/6789564bfc37237865c9e5bf3554d674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dd6LEoAvnLox9mmadiRreQ.png"/></div></div></figure></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><blockquote class="jy jz ka"><p id="3464" class="im in kb io b ip iq ir is it iu iv iw kc iy iz ja kd jc jd je ke jg jh ji jj hb bi translated">这篇文章的代码可以在<a class="ae li" href="https://github.com/Zubs/seedersArticle" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></blockquote><h1 id="446c" class="kf kg hp bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">结束了</h1><p id="b58e" class="pw-post-body-paragraph im in hp io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">如果你有任何问题或相关的好建议，请在评论区留下。</p><p id="176d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要阅读更多我的文章或关注我的作品，您可以在<a class="ae li" href="https://www.linkedin.com/in/idris-aweda-zubair-5433121a3/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae li" href="https://twitter.com/AwedaIdris" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系。又快又简单，还免费！</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es na"><img src="../Images/16afe11816a7b73933c941ef5109fc85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hWHaJKQ-6W8xm8ig"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">豪伊·R在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div></div>    
</body>
</html>