<html>
<head>
<title>Koa.js — RESTful APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KOA . js—RESTful API</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/koa-js-restful-apis-36f28eca1138?source=collection_archive---------1-----------------------#2021-04-04">https://medium.com/nerd-for-tech/koa-js-restful-apis-36f28eca1138?source=collection_archive---------1-----------------------#2021-04-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4779878335e75630f87c72451b0d99a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_lwoQ9IlCJmzxgI5e0kiA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1: Koa.js徽标</figcaption></figure><p id="f975" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我将讨论<strong class="iw hj">KOA . js</strong>&amp;<strong class="iw hj">REST API。使用这些东西，我们可以用<strong class="iw hj"> Node.js </strong>构建一个<strong class="iw hj">服务器端API </strong>作为运行时环境。</strong></p><h1 id="57e9" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">KOA . js是什么？</strong></h1><p id="b36d" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">Koa也是ExpressJS背后的团队设计的开源Node.js web框架。他们的主要目标是为web应用程序和API建立一个更小、更有表现力、更健壮的基础。Koa是一个用于node.js的富于表现力的HTTP中间件框架。</p><p id="4a48" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Koa有这么多函数叫，</strong></p><ul class=""><li id="4e81" class="kv kw hi iw b ix iy jb jc jf kx jj ky jn kz jr la lb lc ld bi translated"><em class="le"> app.callback() </em></li><li id="ce19" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><em class="le"> app.context() </em></li><li id="a411" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><em class="le"> app.keys = </em></li><li id="ecef" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><em class="le"> app.listen() </em></li><li id="4519" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><em class="le"> app.use() </em></li><li id="2156" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><em class="le">请求&amp;响应</em> s(这两个也有这么多功能)</li></ul><p id="566c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这些特性用于处理API的异步调用。这意味着Koa有助于消除回调的需要，并显著改进错误处理。</p><h2 id="ceab" class="lk jt hi bd ju ll lm ln jy lo lp lq kc jf lr ls kg jj lt lu kk jn lv lw ko lx bi translated">Koa.js的特点</h2><p id="3199" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">Koa.js有自己的特性，这些特性使它成为一个更具表现力、对开发人员更友好、更健壮的基础。以下是它的特点:</p><ul class=""><li id="9bba" class="kv kw hi iw b ix iy jb jc jf kx jj ky jn kz jr la lb lc ld bi translated"><strong class="iw hj"> ES6生成器:</strong>用于异步编程，控制代码执行。</li><li id="a22e" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><strong class="iw hj">现代且经得起未来考验:</strong> Koa.js构建基于ES6。因此，它通过提供新的类和模块使复杂的应用程序变得更简单。利用这一点，开发人员可以构建更易维护的应用程序。</li><li id="3f71" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><strong class="iw hj">占用空间小:</strong>与其他Node.js框架相比，Koas占用空间小。这有助于编写更薄的中间件。它使web应用程序和API编写起来更加愉快。</li><li id="0f07" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><strong class="iw hj">设计为Node.js的轻量级灵活框架:</strong>这为开发web应用和API提供了一个最小的接口。</li><li id="8e1b" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><strong class="iw hj">识别并理解所有HTTP方法:</strong>HTTP方法这么多。Koa可以识别这些方法，这将有助于开发人员更可靠地构建他们的应用程序。</li><li id="52db" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><strong class="iw hj">有一个内置的捕获器:</strong>这将有助于错误处理。</li><li id="0427" class="kv kw hi iw b ix lf jb lg jf lh jj li jn lj jr la lb lc ld bi translated"><strong class="iw hj">使用上下文对象:</strong>是请求和响应对象的封装。</li></ul><h1 id="b02b" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是Rest APIs？</h1><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/4a57bb0daf21b5c55db072dc9eb98187.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*P412MgexQ42ZnNR6iqIw-A.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2: Rest API</figcaption></figure><p id="17b6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Rest APIs是由计算机科学家罗伊·菲尔丁创建的。<strong class="iw hj"> RESTful API </strong>或<strong class="iw hj">REST API</strong>是一个应用编程接口(API或web API)。它允许与RESTful web服务进行交互。“REST”代表<strong class="iw hj">具象状态转移。</strong></p><blockquote class="md me mf"><p id="132c" class="iu iv le iw b ix iy iz ja jb jc jd je mg jg jh ji mh jk jl jm mi jo jp jq jr hb bi translated">API是一组用于构建和集成应用软件的定义和协议。它有时被称为信息提供者和信息用户之间的契约—建立消费者所需的内容(调用)和生产者所需的内容(响应)。</p></blockquote><h1 id="be03" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">Koa.js怎么安装？</h1><p id="e4be" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">首先，我们必须启动一个npm项目。我们可以用<strong class="iw hj"><em class="le"/></strong><em class="le"/>作为我们的IDE。为所有与项目相关的文件创建一个目录。</p><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="2f06" class="lk jt hi mk b fi mo mp l mq mr">$ npm init</span></pre><p id="da16" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这将生成一个<code class="du ms mt mu mk b">package.json</code>文件，保存我们添加到项目中的所有依赖项。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/634c22e956e31742655cf52bfa6ae13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_IAxX39kugJLx1dLKHLdQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3: Package.json文件</figcaption></figure><p id="252e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后将Koa添加到本地依赖项中。Koa要求<strong class="iw hj"> node v7.6.0 </strong>或更高版本支持ES2015和异步功能。</p><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="a5c0" class="lk jt hi mk b fi mo mp l mq mr">$ npm i koa --dev -- save</span></pre><h2 id="750e" class="lk jt hi bd ju ll lm ln jy lo lp lq kc jf lr ls kg jj lt lu kk jn lv lw ko lx bi translated">Koa应用</h2><p id="188e" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">创建一个名为server.js的文件。(需要对它的“koa”依赖)</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/90182771d288926d38e4cb9877267fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u8k-i6Mx6WmawrHFag4ZQQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4: server.js</figcaption></figure><p id="da12" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，打开<strong class="iw hj">终端或您的浏览器</strong>并运行以下命令；</p><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="a6e2" class="lk jt hi mk b fi mo mp l mq mr"><a class="ae mw" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></span></pre><p id="b425" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，您可以在浏览器中看到“Hello World”消息。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/5487f82c24a42b2ab4c4235c3e06753c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkG5zxJqaALAIvrTzPl3eA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5:“Hello World”</figcaption></figure></div><div class="ab cl my mz gp na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="hb hc hd he hf"><h2 id="5fe3" class="lk jt hi bd ju ll lm ln jy lo lp lq kc jf lr ls kg jj lt lu kk jn lv lw ko lx bi translated">构建REST API</h2><p id="4e58" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">将“@koa/router”安装到您的项目中。</p><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="070b" class="lk jt hi mk b fi mo mp l mq mr">$ npm i @koa/router</span></pre><p id="4925" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后创建一个名为<strong class="iw hj"> routes </strong>的目录，并在其中创建一个名为“<em class="le">home . router . js”</em>的文件。并导入“@koa/router”。</p><p id="797b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后<strong class="iw hj">根据下图导出</strong>路由器对象。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/69a5adc85b72966cb4847ad5581a680a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uRCKnOY1GnTlr8OLn2ReCg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图6:“home . router . js”</figcaption></figure><p id="16c6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">将此文件导入您的server.js文件。(注意:这将根据您的文件名而有所不同)</p><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="bb74" class="lk jt hi mk b fi mo mp l mq mr">$ <!-- -->const HomeRoutes = require('./routes/home.router');</span></pre><p id="fab2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，您需要您的服务器理解JSON类型，这可以通过使用body-parser来实现。为此，您需要安装一个koa-body解析器，并将其注册到您的koa应用程序中。</p><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="0355" class="lk jt hi mk b fi mo mp l mq mr">$ <!-- -->const bodyParser = require('koa-bodyparser');</span><span id="bbf7" class="lk jt hi mk b fi nf mp l mq mr">app.use(bodyParser()); //register this with your koa application</span></pre><p id="6c70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，允许HTTP方法。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/ff6de2c3352f57478a974ea53cea2cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VsLsjbtNfHrDH7dtnzToVQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图7:“KOA主体解析器”</figcaption></figure><p id="2182" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您还可以使用GET、POST方法来改进您的应用程序。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/74d107af6c95e6eebff931cf8b5cedfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X84-ezPAYxhI_mgDB3Qw6Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图8: POST方法</figcaption></figure><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/c9ff1b2524ad4d92d099af14ce8d273e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gH9pzyvj-xPeHnsV3j18Uw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图9: Post.route.js</figcaption></figure></div><div class="ab cl my mz gp na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="hb hc hd he hf"><p id="7dfd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是对koa.js和REST APIs的一点介绍。您可以关注更多文档和文章了解更多详情。</p><h2 id="7c0e" class="lk jt hi bd ju ll lm ln jy lo lp lq kc jf lr ls kg jj lt lu kk jn lv lw ko lx bi translated">参考</h2><pre class="lz ma mb mc fd mj mk ml mm aw mn bi"><span id="4421" class="lk jt hi mk b fi mo mp l mq mr"><a class="ae mw" href="https://koajs.com/" rel="noopener ugc nofollow" target="_blank">https://koajs.com/</a><br/><a class="ae mw" href="https://www.redhat.com/en/topics/api/what-is-a-rest-api" rel="noopener ugc nofollow" target="_blank">https://www.redhat.com/en/topics/api/what-is-a-rest-api</a><br/><a class="ae mw" href="https://www.tutorialspoint.com/koajs/koajs_restful_apis.htm" rel="noopener ugc nofollow" target="_blank">https://www.tutorialspoint.com/koajs/koajs_restful_apis.htm</a></span></pre></div></div>    
</body>
</html>