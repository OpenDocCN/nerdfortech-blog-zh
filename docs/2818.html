<html>
<head>
<title>URL Feature Engineering and Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">URL特征工程和分类</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/url-feature-engineering-and-classification-66c0512fb34d?source=collection_archive---------0-----------------------#2021-05-21">https://medium.com/nerd-for-tech/url-feature-engineering-and-classification-66c0512fb34d?source=collection_archive---------0-----------------------#2021-05-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="90e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将通过Streamlit和Tensorflow神经网络到微处理器和物联网设备的更轻和可移植模型的转换，在简单深度学习模型的辅助下，开发一个成熟的URL分类GUI。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7753727eb083d9fba118c6c1c44a0ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vnDGobRCIWsaUfOs"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">杰佛森·桑多斯在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="c8b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">网络安全是一个行话，自从万维网发展以来，它的使用一直在稳步增长。它可以被定义为保护连接到互联网的设备免受恶意攻击的实践。随着网络攻击的<a class="ae jt" href="https://digitalguardian.com/blog/biggest-incidents-cybersecurity-past-10-years-infographic" rel="noopener ugc nofollow" target="_blank">数量和复杂性的增长</a>，公司和组织，尤其是那些负责保护与国家安全、健康或财务记录相关的信息的公司和组织，需要采取措施来保护其敏感的业务和个人信息。早在2013年3月，美国最高情报官员就警告称，网络攻击和数字间谍活动是国家安全的最大威胁，甚至超过了恐怖主义。</p><p id="cb4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">恶意网站是现代网络威胁的罪魁祸首。它们是传播病毒、特洛伊木马和各种恶意代码的前沿阵地，这些病毒和代码可能会感染用户，导致数据失窃和洗钱。这些URL通常通过电子邮件链接、弹出广告和嵌入式下载进行传播。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="e269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要开发Deel学习神经网络模型，第一步是开发一个特征提取管道，该管道基于URL的字符串、域和页面特征，基于许多独特的特征来区分URL。将从训练获得的每个URL中提取N个特征，产生一个M×N矩阵，M是收集的URL的数量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/3cb77a01246c91025212741ce5835d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vdxtOa6KJib1q4dd"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">由<a class="ae jt" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="18c6" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">关于数据</h1><p id="8107" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">用于此分析的数据收集自https://www.unb.ca/cic/datasets/url-2016.html<a class="ae jt" href="https://www.unb.ca/cic/datasets/url-2016.html" rel="noopener ugc nofollow" target="_blank">的</a>。</p><ul class=""><li id="deb8" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated"><strong class="ih hj">良性网址</strong>:从Alexa顶级网站收集了超过35，300个良性网址。这些域名已经通过Heritrix网络爬虫提取网址。大约有50万个唯一的URL最初被抓取，然后被传递以删除重复的和只有域名的URL。后来，提取的网址已通过病毒总检查，以过滤良性网址。</li><li id="4c7b" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><strong class="ih hj">垃圾网址</strong>:从公开的WEBSPAM-UK2007数据集中收集了大约12，000个垃圾网址。</li><li id="016c" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><strong class="ih hj">网络钓鱼网址</strong>:大约10，000个网络钓鱼网址来自OpenPhish，这是一个活跃的网络钓鱼网站库。</li><li id="36c8" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><strong class="ih hj">恶意软件网址</strong>:从DNS-BH获得了超过11，500个与恶意软件网站相关的网址，这是一个维护恶意软件网站列表的项目。</li><li id="6a95" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><strong class="ih hj">污损URL</strong>:超过45，450个URL属于污损URL类别。他们是Alexa排名可信的网站托管欺诈或隐藏的网址，其中既包含恶意网页。每一类URL都是分开的，因此对每个文件的提取都是单独进行的，并累积在一起用于最终的训练。</li></ul><blockquote class="lt lu lv"><p id="5c46" class="if ig lw ih b ii ij ik il im in io ip lx ir is it ly iv iw ix lz iz ja jb jc hb bi translated"><em class="hi">参考资料部分提到了概述数据集细节及其基本原则的完整研究论文。</em></p></blockquote><h1 id="9a0c" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">从URL中提取特征</strong></h1><p id="1a3f" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">URL(统一资源定位器的首字母缩写)只不过是Web上给定的唯一资源的地址。理论上，每个有效的URL指向一个唯一的资源。这种资源可以是HTML页面、CSS文档、图像等。实际上，也有一些例外，最常见的是URL指向不再存在或已经移动的资源。因为由URL表示的资源和URL本身是由Web服务器处理的，所以由Web服务器的所有者来仔细管理该资源及其相关联的URL。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/6f40591050a43d232f85f7cccca58dcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHylTd9wjy7-lE9uTi0XlQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图片致谢:<a class="ae jt" href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Learn/Common _ questions/What _ is _ a _ URL</a></figcaption></figure><p id="c23d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些解剖特征中的每一个都在区分URL中起着至关重要的作用。</p><p id="edcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi mb translated">存在多种用于恶意/垃圾邮件/网络钓鱼URL检测的技术，包括黑名单和人工智能辅助技术。黑名单是维护已知恶意域数据库并将新URL的主机名与数据库中的主机名进行比较的过程。这种系统的主要缺点是它检测新的和看不见的恶意URL的能力，只有当它被观察为来自受害者的恶意URL时，它才会被添加到黑名单中。人工智能辅助的机器/深度学习方法提供了一种可跨平台推广的预测方法，并且不依赖于已知签名的先验知识。给定恶意和良性恶意软件样本的样本，ML技术将提取已知好的和坏的URL的特征，并概括这些特征以识别新的和看不见的好的或坏的URL。</p><p id="b40b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于提取的外部库是<a class="ae jt" href="https://pypi.org/project/python-whois-extended/" rel="noopener ugc nofollow" target="_blank"> whois </a>、<a class="ae jt" href="https://pypi.org/project/pyquery/" rel="noopener ugc nofollow" target="_blank"> PyQuery </a>和<a class="ae jt" href="https://pypi.org/project/interruptingcow/" rel="noopener ugc nofollow" target="_blank"> interruptingcow </a></p><p id="5116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用whois包，我们可以提取自注册和到期以来的天数等特征。PyQuery可用于从网页本身提取特征，包括但不限于链接数量、标题数量、图片数量等。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/deb979fdede45ca26c102e8e62f67ff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*MNYb5o472rN9bQ4dmLDjTA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">提取的特征</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="ce54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述代码将从单个URL中提取特性，并返回一个特性名称字典作为键和相应的值。这个处理器将遍历不同的CSV文件。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="320e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终特征提取的数据连同类别标签可以在<a class="ae jt" href="https://github.com/Rohith-2/url_classification_dl/blob/main/FinalDataset/feature.csv" rel="noopener ugc nofollow" target="_blank"> <em class="lw">这里找到</em> </a>。</p><p id="8488" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提取要素的过程极其耗时，由于数据集的庞大性质，运行时间大约为96小时*。</p><h1 id="f1bb" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">开发预测模型</h1><p id="f2e6" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">基于提取的特征，可以开发预测模型，该模型将能够对看不见的URL进行分类。深度学习模型的方法有很多，为了简单起见，将训练一个只有密集层的顺序模型。欢迎您尝试各种技术。密集的<strong class="ih hj"> </strong>层是规则的深度连接神经网络层。这是最常见和最常用的层。密集层对输入进行大量加权运算，并返回输出。</p><h2 id="e4b2" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">什么是神经网络？</h2><p id="6336" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">这是一种构建从数据中学习的计算机程序的技术。它非常松散地基于我们对人脑工作方式的思考。首先，软件“神经元”的集合被创建并连接在一起，允许它们相互发送消息。接下来，网络被要求解决一个问题，它试图一遍又一遍地解决这个问题，每次都加强导致成功的联系，减少导致失败的联系。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/a4999784f807d423b8bf37b2dba00304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Ye1aYbDrQ7j1PBVRvVn1w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="https://playground.tensorflow.org/#activation=tanh&amp;batchSize=21&amp;dataset=spiral&amp;regDataset=reg-plane&amp;learningRate=0.01&amp;regularizationRate=0&amp;noise=0&amp;networkShape=8,6,4,3,2&amp;seed=0.63950&amp;showTestData=false&amp;discretize=false&amp;percTrainData=50&amp;x=true&amp;y=true&amp;xTimesY=true&amp;xSquared=true&amp;ySquared=true&amp;cosX=false&amp;sinX=false&amp;cosY=false&amp;sinY=false&amp;collectStats=false&amp;problem=classification&amp;initZero=false&amp;hideText=false" rel="noopener ugc nofollow" target="_blank">https://playground.tensorflow.org/</a></figcaption></figure><h2 id="65d7" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">Keras序列模型</h2><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="3674" class="mn kd hi nd b fi nh ni l nj nk">model = Sequential()    <br/>model.add(Dense(256, input_dim = input_dim , activation = 'relu'))    model.add(Dense(128, activation = 'relu'))    <br/>model.add(Dense(64, activation = 'relu'))    <br/>model.add(Dense(32, activation = 'relu'))    <br/>model.add(Dense(16, activation = 'relu'))    <br/>model.add(Dense(5, activation = 'softmax'))<br/>model.compile(loss = 'categorical_crossentropy' ,optimizer='adam' , metrics = 'accuracy' )</span></pre><p id="dc64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有许多排列和组合来创建神经网络，该网络随后被微调以获得更好的性能。该实现仅用于教育目的，并不针对任何指标进行微调。我们的模型将预测5种不同的标签——良性、恶意软件、网络钓鱼、垃圾邮件和污损。多类分类模型将输入给定的数据，并预测上述定义的标签作为输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nl"><img src="../Images/dd63c4d4422e1942d105f1ad3bb387f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dl_yxRxp1tTH0Eyi"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">由<a class="ae jt" href="https://unsplash.com/@lukechesser?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢克·切瑟</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="21ff" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">准备数据</h2><p id="be2d" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">机器或深度学习的最佳实践之一是在每个特征具有不同范围时对数据进行归一化。规范化的目标是将数据集中的数值列的值更改为通用比例，而不扭曲值范围的差异。</p><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="e03c" class="mn kd hi nd b fi nh ni l nj nk">data = pd.read_csv("feature.csv")<br/>data.replace(True,1,inplace = True)    <br/>data.replace(False,0,inplace = True)<br/>    <br/>y = data["File"]    <br/>data = data.drop(columns = "File")<br/>     <br/>encoder = LabelEncoder()    <br/>encoder.fit(y)    <br/>Y = encoder.transform(y)  <br/>   <br/>scaler = MinMaxScaler(feature_range=(0, 1))    <br/> <br/>X = pd.DataFrame(scaler.fit_transform(data))</span></pre><p id="8ccd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习和深度学习模型，如Keras中的模型，要求所有输入和输出变量都是数字。所有非数字值如True和False都被转换为二进制，至于类标签，LabelEncoder将字符串标签转换为数字范围。例如，良性:0，恶意软件:1，网络钓鱼:2，垃圾邮件:3，污损:4。我们可以从tensorflow.keras.utils导入to _ categorical()来做同样的事情。</p><blockquote class="lt lu lv"><p id="ca20" class="if ig lw ih b ii ij ik il im in io ip lx ir is it ly iv iw ix lz iz ja jb jc hb bi translated">良性:00001 <br/>恶意:00010 <br/>网络钓鱼:00100 <br/>垃圾邮件:01000 <br/>污损:10000</p></blockquote><p id="8cd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以开始用80%的原始样本和20%的样本训练模型，以评估模型在新数据上的性能。</p><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="5c3b" class="mn kd hi nd b fi nh ni l nj nk">X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=42)</span></pre><h2 id="d55b" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">训练模型</h2><p id="40c8" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">使用之前定义的顺序密集网络，我们现在将拟合(训练模型)X_train和y_train。</p><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="edce" class="mn kd hi nd b fi nh ni l nj nk">model.fit(X_train,to_categorical(y_train),epochs = 50,validation_split=0.3, batch_size = 128)</span></pre><p id="c0ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是相对较轻的训练，可以在CPU或GPU上执行。所有测试都是在运行OSX版本11.3.1的2.4 GHz四核英特尔酷睿i5和8 GB 2133 MHz LPDDR3上进行的，培训运行时间约为3分钟。</p><h2 id="15e1" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">测试模型</h2><p id="4a58" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">有许多统计方法可以测试任何给定的机器/深度学习模型的性能。几个值得注意的例子包括:</p><h2 id="f632" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">准确(性)</h2><p id="0b8e" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">准确性是衡量模型所做的预测有多少是真实的指标。准确度越高越好。然而，在评估性能时，这并不是唯一重要的指标。</p><h2 id="fb80" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">精确</h2><p id="8f50" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">精度度量标志着在识别正面结果时模型正确的频率。例如，模型多久向真正患有癌症的患者诊断一次癌症。</p><h2 id="f671" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">回忆</h2><p id="5cb4" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">此指标衡量正确预测的数量除以本应正确预测的结果数量。它指的是被你的算法正确分类的相关结果总数的百分比。</p><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="a65a" class="mn kd hi nd b fi nh ni l nj nk">y_pred = model.predict(X_test)    <br/>predicted = np.argmax(y_pred, axis=1)    <br/>target_names = ['Benign','Defacement','Malware','Phishing','Spam']    print(classification_report(y_test, predicted, target_names=target_names))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nm"><img src="../Images/5751540c2bf6847c2aff8c8f71c92d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*XATxsYOmqTlv8rgWvKXZUw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">每个类别的性能指标</figcaption></figure><p id="8afe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图由每个类的归一化值的平均值组成，描绘了每个要素的每个类中的不同值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nn"><img src="../Images/baa2ad9b55a7c03009231edce4986d80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pf5Li9r80R0iZmVM08TSCg.png"/></div></div></figure><h2 id="0f28" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">张量流精简模型</h2><p id="0cb1" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">TensorFlow Lite是一个用于设备上推理的开源深度学习框架，由一些工具组成，这些工具通过帮助开发人员在移动、嵌入式和物联网设备上运行他们的模型来实现设备上的机器学习。</p><p id="9ff3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是转换到TF-Lite的优点:</p><ol class=""><li id="628c" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc no ll lm ln bi translated"><strong class="ih hj">轻量:</strong>边缘设备在存储和计算能力方面资源有限。深度学习模型是资源密集型的，因此我们在边缘设备上部署的模型应该是轻量级的，具有较小的二进制大小。</li><li id="ecb8" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc no ll lm ln bi translated"><strong class="ih hj">低延迟:</strong>边缘的深度学习模型应该做出更快的推断，而不管网络连接性如何。由于推断是在边缘设备上进行的，因此将消除从设备到服务器的往返行程，从而使推断更快。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es np"><img src="../Images/a20ee14c47c949234faf3663568da214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0XYoDkGvCww0bWbX1gVag.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:https://www.tensorflow.org/lite/convert/index<a class="ae jt" href="https://www.tensorflow.org/lite/convert/index" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="50b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转化的过程比你想象的要简单，</p><ul class=""><li id="f5f6" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">加载先前训练的模型</li><li id="d338" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">选择优化方法</li><li id="bdbc" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">瞧，一个建兴(。tflite)诞生了</li></ul><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="d206" class="mn kd hi nd b fi nh ni l nj nk">#Loading the Model<br/>model = ts.keras.models.load_model('Model_v2.h5') <br/>converter = ts.lite.TFLiteConverter.from_keras_model(model)</span><span id="5e66" class="mn kd hi nd b fi nq ni l nj nk">#Optimisation Constraints <br/>converter.optimizations = [ts.lite.Optimize.DEFAULT] </span><span id="01f8" class="mn kd hi nd b fi nq ni l nj nk">#Conversion and creation<br/>tflite_quant_model = converter.convert()<br/>tflite_model_file = pathlib.Path('tflite_quant_model.tflite')<br/>tflite_model_file.write_bytes(tflite_quant_model)</span></pre><p id="9586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种转换确实提供了一个更轻的框架，但没有什么是免费的，这种<strong class="ih hj"> <em class="lw">可能会以模型的性能为代价。</em></strong></p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="6849" class="kc kd hi bd ke kf nr kh ki kj ns kl km kn nt kp kq kr nu kt ku kv nv kx ky kz bi translated">用于URL分类的GUI</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nw"><img src="../Images/fb98a8a01b8d30b9b0585f26558c607c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IzKH2fFidHRaaz4o"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@tirzavandijk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Tirza van Dijk </a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="7465" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi mb translated">我们人类使用我们的感官获取关于我们周围世界的信息。我们的视觉是我们与周围事物交流的最重要的部分之一。人类一生都在学习与不同的物体互动:对他们中的一些人来说，只需要几秒钟就能学会(就像门铃旋钮)，有些人需要更多的时间(就像开车)。</p><p id="b940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是对于计算机，我们有一个问题——人们被迫进行抽象思考，他们被迫处理大量他们甚至记不住的命令。</p><p id="438b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，图形用户界面(GUI)是以最简单的方式使计算机和人之间的交互成为可能的最受欢迎的方法。</p><blockquote class="lt lu lv"><p id="8115" class="if ig lw ih b ii ij ik il im in io ip lx ir is it ly iv iw ix lz iz ja jb jc hb bi translated"><a class="ae jt" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="hi">Streamlit</em></strong></a>是面向机器学习和数据科学团队的开源app框架。在数小时内而不是数周内创建漂亮的数据应用。全是纯Python。</p></blockquote><p id="0c84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Streamlit提供了许多API，这对于在不了解CSS和JavaScript等后端编程语言的情况下构建和部署应用程序非常有益。</p><p id="7d6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是开发一个python脚本来接受URL字符串并预测其类别。</p><p id="0541" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样的伪代码应该是，</p><ul class=""><li id="4130" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">从用户输入URL字符串</li><li id="c9a6" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">加载Keras模型、缩放器和标签编码器</li><li id="46d6" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">对给定的URL应用特征提取和标准化</li><li id="0f5c" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">预测班级</li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">基于命令行参数的输入</figcaption></figure><p id="80e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述代码将URL作为命令行参数，并显示URL的类，如下所示。</p><pre class="je jf jg jh fd nc nd ne nf aw ng bi"><span id="09ed" class="mn kd hi nd b fi nh ni l nj nk">&gt;&gt;&gt; $ python predict_args.py -i <a class="ae jt" href="http://astore.amazon.co.uk/allezvinsfrenchr/detail/1904010202/026-8324244-9330038" rel="noopener ugc nofollow" target="_blank">http://astore.amazon.co.uk/allezvinsfrenchr/detail/1904010202/026-8324244-9330038</a></span><span id="0794" class="mn kd hi nd b fi nq ni l nj nk">Output : Spam</span></pre><blockquote class="lt lu lv"><p id="44f6" class="if ig lw ih b ii ij ik il im in io ip lx ir is it ly iv iw ix lz iz ja jb jc hb bi translated">这将作为我们通过Streamlit实现GUI的框架。</p></blockquote><p id="2b40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用几个Streamlit APIs:</p><ul class=""><li id="0c23" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">streamlit.text("高输出")</li><li id="0a84" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">streamlit . Title(" Title ")/streamlit . Header(" Header ")/streamlit . Subheader(" Subheader ")</li><li id="951c" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">streamlit.image( Image.open(loc))</li></ul><p id="a94d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Streamlit在其输出GUI中由两部分组成- <em class="lw">侧栏、</em>和<em class="lw">主</em>屏幕。“streamlit . text()”API将在主屏幕上打印输出，而“streamlit.sidebar.text()”将在侧边栏窗口中显示相同的内容。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">简单的Streamlit GUI实施</figcaption></figure><p id="9c40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以使用命令streamlit run <name>在网络上本地运行上述脚本。py，下图是生成的GUI。</name></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nx"><img src="../Images/9d466d7fece7ec511065f90693cc3d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQK6jG4-LOUxGuWW_55Dww.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">细流</figcaption></figure><p id="035f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的GUI代码是上述简单实现的扩展，加上一些if-else条件来显示URL类型的更多信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ny"><img src="../Images/777385126603733362c5e41d21e87bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o7RIvX-RPFbgOe7kLQsarA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终图形用户界面</figcaption></figure><blockquote class="lt lu lv"><p id="d9d0" class="if ig lw ih b ii ij ik il im in io ip lx ir is it ly iv iw ix lz iz ja jb jc hb bi translated">链接到GUI:<a class="ae jt" href="https://share.streamlit.io/rohith-2/url_classification_dl/main/GUI/gui.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/rohith-2/URL _ class ification _ dl/main/GUI/GUI . py</a></p><p id="f349" class="if ig lw ih b ii ij ik il im in io ip lx ir is it ly iv iw ix lz iz ja jb jc hb bi translated">以上代码都可以在我的Github <a class="ae jt" href="https://github.com/Rohith-2/url_classification_dl" rel="noopener ugc nofollow" target="_blank"> <em class="hi">资源库</em> </a> <em class="hi">中找到。</em></p></blockquote></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h2 id="6f62" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">合著者:<a class="nz oa ge" href="https://medium.com/u/1ee3802d5d20?source=post_page-----66c0512fb34d--------------------------------" rel="noopener" target="_blank">阿尼鲁德·巴斯卡尔</a>和<a class="nz oa ge" href="https://medium.com/u/c463efdba322?source=post_page-----66c0512fb34d--------------------------------" rel="noopener" target="_blank">斯里坎特·安卡姆</a></h2><h2 id="918f" class="mn kd hi bd ke mo mp mq ki mr ms mt km iq mu mv kq iu mw mx ku iy my mz ky na bi translated">参考资料:</h2><ul class=""><li id="b99a" class="lf lg hi ih b ii la im lb iq ob iu oc iy od jc lk ll lm ln bi translated">Mohammad Saiful Islam Mamun、Mohammad Ahmad Rathore、Arash Habibi Lashkari、Natalia Stakhanova和Ali A. Ghorbani，“使用词法分析检测恶意网址”，《网络和系统安全》，Springer International Publishing，P467–482，2016年。</li></ul></div></div>    
</body>
</html>