<html>
<head>
<title>Deep Face Recognition in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的深度人脸识别</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/deep-face-recognition-in-python-41522fb47028?source=collection_archive---------2-----------------------#2021-06-12">https://medium.com/nerd-for-tech/deep-face-recognition-in-python-41522fb47028?source=collection_archive---------2-----------------------#2021-06-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/38db657df3ea709cac9c3685ecaf3e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g9VfnyF41NFxRHwP"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">阿曼达·达尔比约恩在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><ul class=""><li id="96c9" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ix hj">什么是深沉的脸？</strong></li></ul><p id="a249" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated">Deepface是一个针对python的轻量级人脸识别和面部属性分析(年龄、性别、情感和种族)框架。</p><p id="fa89" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated">这是一个混合人脸识别框架，包含了最先进的模型:VGG脸，谷歌脸网，开放脸，脸书脸，DeepID，ArcFace和Dlib。库主要基于<strong class="ix hj"> Keras </strong>和<strong class="ix hj"> TensorFlow </strong>。</p><ul class=""><li id="ce84" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ix hj">使用的模块:</strong></li></ul><ol class=""><li id="142f" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji kc jk jl jm bi translated">深脸</li><li id="c029" class="iv iw hi ix b iy kd ja ke jc kf je kg jg kh ji kc jk jl jm bi translated">OpenCV -(读取输入图像)</li><li id="85f4" class="iv iw hi ix b iy kd ja ke jc kf je kg jg kh ji kc jk jl jm bi translated">Matplotlib -(用于可视化)</li></ol><p id="51df" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated"><strong class="ix hj">我们来看看实现:</strong></p><ul class=""><li id="a2e1" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">首先，您需要将必备库安装到您的python环境中</li></ul><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="c904" class="kr ks hi kn b fi kt ku l kv kw">pip install deepface<br/>pip install opencv-python<br/>pip install matplotlib</span></pre><ul class=""><li id="bb13" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">安装后，让我们导入已安装的库</li></ul><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="4dbf" class="kr ks hi kn b fi kt ku l kv kw">from deepface import DeepFace<br/>import cv2<br/>import matplotlib.pyplot as plt</span></pre><ul class=""><li id="f6ec" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">现在创建一个函数来读取和验证图像</li></ul><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="f30f" class="kr ks hi kn b fi kt ku l kv kw">def verify(img1_path,img2_path):<br/>    img1= cv2.imread(img1_path)<br/>    img2= cv2.imread(img2_path)<br/>    <br/>    plt.imshow(img1[:,:,::-1])<br/>    plt.show()<br/>    plt.imshow(img2[:,:,::-1])<br/>    plt.show()</span><span id="2e35" class="kr ks hi kn b fi kx ku l kv kw">    output = DeepFace.verify(img1_path,img2_path)<br/>    print(output)<br/>    verification = output['verified']</span><span id="2d3d" class="kr ks hi kn b fi kx ku l kv kw">    if verification:<br/>       print('They are same')<br/>    else:<br/>       print('The are not same')</span></pre><ul class=""><li id="7cd8" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">让我们调用验证函数</li></ul><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="e38f" class="kr ks hi kn b fi kt ku l kv kw">verify('img36.jpg','img37.jpg')</span></pre><ul class=""><li id="46dd" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">以下是输出:</li></ul><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/0b8c1bf3fcaefc7be294b208c0ee470d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5vRccPs88zT-bSPtNanqA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">输出结果</figcaption></figure><p id="7807" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated">在上面的输出结果中，你可以看到两幅图像是相同的，我们的模型也预测相同。</p><ul class=""><li id="8484" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">现在让我们看看另一个例子，两个不同的图像。</li></ul><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/cf925e4ab10a0f98cbd0a03d54c531d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZoXpaoAa9wKwODljFUJdDQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">他们不一样</figcaption></figure><ul class=""><li id="da47" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">正如我在上面已经提到，Deepface模型支持几种人脸识别模型。默认情况下，它使用VGG脸模型。现在让我们看看另一个模型及其结果:</li></ul><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="4d38" class="kr ks hi kn b fi kt ku l kv kw">def verify(img1_path,img2_path,model_name):<br/>    img1= cv2.imread(img1_path)<br/>    img2= cv2.imread(img2_path)</span><span id="7d19" class="kr ks hi kn b fi kx ku l kv kw">    plt.imshow(img1[:,:,::-1])<br/>    plt.show()<br/>    plt.imshow(img2[:,:,::-1])<br/>    plt.show()<br/>   output=DeepFace.verify(img1_path,img2_path,model_name=model_name)</span><span id="7860" class="kr ks hi kn b fi kx ku l kv kw">   print(output)</span><span id="25d2" class="kr ks hi kn b fi kx ku l kv kw">   verification = output['verified']<br/>   <br/>   if verification:<br/>      print('They are same')<br/>   else:<br/>     print('The are not same')</span></pre><ul class=""><li id="22af" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">以下是<strong class="ix hj"> Facenet模型</strong>的输出结果</li></ul><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/9531a5a5e76895e11bc1335bb3a52b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fxj3iRVnKK3UNZzZlr-sRQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">面网模型</figcaption></figure><p id="5d78" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated"><strong class="ix hj">注意:</strong>在这里你可以尝试不同的型号，你可以看到精度差异。</p><ul class=""><li id="dd75" class="iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ix hj">使用DeepFace进行面部属性分析</strong></li></ul><p id="1f6e" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated">使用DeepFace你还可以做人脸的分析，下面用一个例子来了解一下。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="2008" class="kr ks hi kn b fi kt ku l kv kw">from deepface import DeepFace</span><span id="7401" class="kr ks hi kn b fi kx ku l kv kw">img = cv2.imread('img12.jpg')</span><span id="4c7b" class="kr ks hi kn b fi kx ku l kv kw">imgplot = plt.imshow(img)</span><span id="8c61" class="kr ks hi kn b fi kx ku l kv kw">obj = DeepFace.analyze(img_path = "img12.jpg", actions = ['age', 'gender', 'race', 'emotion'])<br/></span><span id="2677" class="kr ks hi kn b fi kx ku l kv kw">print(obj["age"]," years old ",obj["dominant_race"]," ",obj["dominant_emotion"]," ", obj["gender"])</span></pre><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/2ebe0d625a04b18c97b24f6bcea2e38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*JU_VMhKb-qCv0rY8b4sjVg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">面部分析</figcaption></figure><p id="d8eb" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated">如果你想了解更多关于Deepface的信息，你可以探索deepface github repo。</p><div class="lc ld ez fb le lf"><a href="https://github.com/serengil/deepface" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dw"><div class="lh ab li cl cj lj"><h2 class="bd hj fi z dy lk ea eb ll ed ef hh bi translated">serengil/deepface</h2><div class="lm l"><h3 class="bd b fi z dy lk ea eb ll ed ef dx translated">Deepface是一个轻量级的人脸识别和面部属性分析(年龄，性别，情感和种族)框架…</h3></div><div class="ln l"><p class="bd b fp z dy lk ea eb ll ed ef dx translated">github.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt io lf"/></div></div></a></div></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><p id="63f2" class="pw-post-body-paragraph jn jo hi ix b iy iz jp jq ja jb jr js jc jt ju jv je jw jx jy jg jz ka kb ji hb bi translated">感谢您的阅读。试试吧，分享你的宝贵建议。感谢您的诚实反馈！</p></div></div>    
</body>
</html>