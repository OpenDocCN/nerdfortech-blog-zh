<html>
<head>
<title>Build a CI/CD Pipeline on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 AWS 上构建 CI/CD 管道</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/build-a-ci-cd-pipeline-on-aws-f806e427db22?source=collection_archive---------1-----------------------#2022-08-16">https://medium.com/nerd-for-tech/build-a-ci-cd-pipeline-on-aws-f806e427db22?source=collection_archive---------1-----------------------#2022-08-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6527776b827fdae17e506542918f9d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*XZoKF98IhgWRzf22sZ7Vuw.png"/></div></figure><h1 id="fee7" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">什么是 CI/CD 管道？</h1><p id="2bb9" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">CI 和 CD 代表持续集成和持续交付/持续部署。CI/CD 管道<strong class="jm hj">自动化了软件交付过程</strong>。它构建代码，运行测试，并帮助您安全地部署软件的新版本。通过自动化过程，目标是最小化人为错误，并保持软件发布过程的一致性。</p><p id="6773" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">本文的目标是通过一个实际的例子来指导您使用 AWS CodePipeline 构建、测试和部署应用程序。</p><h1 id="242e" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak">目标</strong></h1><p id="1d08" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">您的团队要求您为开发人员创建一种自动化应用部署的方式。目前，您的开发人员必须手动通过构建过程来测试他们代码的每个新更新。您需要向开发人员提供静态站点 URL，并修改 GitHub repo 中的代码，以验证管道是否正常工作。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="39d8" class="im in hi bd io ip ku ir is it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj bi translated">我们开始吧！</h1><h2 id="3860" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">步骤 1:创建 S3 时段</h2><p id="178a" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">使用您的凭证登录到<a class="ae ln" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS 管理控制台</a>，并从搜索栏导航到 S3。</p><p id="27c2" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">要创建 S3 存储桶，点击“<em class="lo">创建存储桶</em>，如下所示:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lp"><img src="../Images/a7344768bc483385cfc4256a52eb9747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6uunbVPzSvm-PwYR5S1Aw.jpeg"/></div></div></figure><p id="9cd9" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">输入一个“<em class="lo">桶名</em>，选择要创建桶的“<em class="lo">区域</em>”。在<em class="lo">阻止该桶段</em>的公共访问设置中，<strong class="jm hj">取消选中</strong>阻止所有公共访问<strong class="jm hj">的复选框。</strong>将其他设置保留为<strong class="jm hj"> </strong>，点击<em class="lo">“创建桶”创建桶。</em></p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/c8449a45ebe3713ec7c05e27b4bfb1b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*pEuz7uUSx1h6o1yABNZaLQ.jpeg"/></div></figure><h2 id="e276" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">步骤 2:为 S3 桶配置静态<strong class="ak">网站托管</strong></h2><p id="e767" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">导航到新创建的存储桶，然后单击<em class="lo">“属性”</em>选项卡。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lz"><img src="../Images/32706647889efc746f4b2b000a872684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0k7ttD07emXBjYBOiAgWg.jpeg"/></div></div></figure><p id="ffc9" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">滚动到底部，在<em class="lo">“静态网站托管”</em>部分选择编辑</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ma"><img src="../Images/401815171d575b916876954fefb7dc63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SH4Ort2nROmC0UBvCdQd8Q.jpeg"/></div></div></figure><p id="6357" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">选择“<em class="lo">启用</em>，填写“<em class="lo">index . html”</em>和“<em class="lo">error.html</em>”字段，点击<em class="lo">“保存更改”</em>，如下图所示:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/c0ff5f4d827ffcd0381b8862ebb31947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*nqJ2V9msUnchrGCyPuHsKQ.jpeg"/></div></figure><h2 id="28f0" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">步骤 3:授予权限</h2><p id="85ed" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">导航到 S3 存储桶的“权限”选项卡。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mc"><img src="../Images/5e466127e78799a70827e94539c9f0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dr5sEpCz6pcogUYiE6GYNA.jpeg"/></div></div></figure><p id="acfd" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在 Bucket Policy 下，点击“<em class="lo"> Edit </em>，然后点击“<em class="lo">Policy Generator”</em>，找到“<em class="lo">GetObject”</em>的动作，点击“<em class="lo">Generate Policy”</em>，将会生成以下代码:</p><pre class="lq lr ls lt fd md me mf mg aw mh bi"><span id="e5ea" class="kz in hi me b fi mi mj l mk ml">{<br/>  "Id": "Policy1659540315262",<br/>  "Version": "2012-10-17",<br/>  "Statement": [<br/>    {<br/>      "Sid": "Stmt1659540307023",<br/>      "Action": [<br/>        "s3:GetObject"<br/>      ],<br/>      "Effect": "Allow",<br/>      "Resource": "arn:aws:s3:::new-bucket-cicd-july22/*",<br/>      "Principal": "*"<br/>    }<br/>  ]<br/>}</span></pre><p id="120e" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">再次单击<em class="lo">“Permissions”</em><strong class="jm hj"/>选项卡，删除当前策略并用上面的代码替换它。*注意:如果您正在跟进这个项目，请将 ARN 替换为您的铲斗的名称<em class="lo">。不要忘记在您的存储桶名称后添加/*！点击<em class="lo">“保存更改”</em></em></p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mm"><img src="../Images/c89baef241d56a63246bc97d7e817491.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUo-g18CoUbN2jeQ08BPgw.jpeg"/></div></div></figure><p id="3f90" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">您将看到该存储桶现在可以公开访问。我们可以继续建立我们的管道！</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mn"><img src="../Images/b19725e745c28be9fe9b1261b777fb98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t89vjx03gjBpxbdhjOlbyQ.jpeg"/></div></div></figure><h2 id="96ae" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">第四步:将<strong class="ak">连接到 GitHub: </strong></h2><p id="3343" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">登录 AWS 管理控制台，打开<a class="ae ln" href="https://console.aws.amazon.com/codesuite/settings/connections" rel="noopener ugc nofollow" target="_blank">https://Console . AWS . Amazon . com/code suite/settings/connections</a>的开发者工具控制台。</p><p id="ab42" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">要创建到 GitHub 的连接，请在选择提供商下，选择“<em class="lo">GitHub”</em></p><p id="fb75" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在 GitHub 连接设置下，您的连接名称会出现在连接名称中。选择“连接到 GitHub”。“访问请求”页面如下所示:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mo"><img src="../Images/38aed277e671da9deefe32970c58016d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEbbiJiWqvBEaatqVMPMpg.jpeg"/></div></div></figure><h2 id="ddc6" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">步骤 5:创建 CI/CD 管道</h2><p id="96af" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">导航到 AWS 管理控制台中的<em class="lo">“代码管道”</em> <strong class="jm hj"> </strong>。点击<em class="lo">【创建管道】</em> <strong class="jm hj"> <em class="lo">，</em> </strong>输入新管道的名称，点击【下一步】，如下图所示:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mp"><img src="../Images/78d6e045a5998b4db9a2f0714372029d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txtGj0h7R72fPkCRkpcAgQ.jpeg"/></div></div></figure><p id="26a5" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在源代码提供者下，选择<em class="lo">“GitHub(版本 2)”</em><strong class="jm hj">。</strong>在下拉菜单中选择您现有的 GitHub 连接。在你的 GitHub 账号中选择“<em class="lo">库名</em><strong class="jm hj">”</strong>。选择<em class="lo">“分行名称”</em>，点击<em class="lo">下一步</em>，如下图所示。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/327f960425f1cdcc5a9a2c0e8a57e6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*PrfbY8F5p-RGKZHZ1BCVxA.jpeg"/></div></figure><p id="9c31" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">选择<em class="lo">“AWS code build”</em>作为构建提供者，并点击<em class="lo">创建项目</em>。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mp"><img src="../Images/d5f2e37f45810e81cbac6c40e9acaee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_oivE1HvIfCqib18MpHMA.jpeg"/></div></div></figure><p id="a2bb" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在项目创建下，命名您的项目，在环境下选择<em class="lo">“托管镜像”</em>，选择运行时为“<em class="lo">标准”</em>，选择镜像的最新版本，选择一个“<em class="lo">新服务角色</em>”。在“<em class="lo"> BuildSpec </em>”下选择默认设置，然后继续流水线。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/4008d7ae56afb429f191df57ad8cda03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*PfvwIlPyOk_IUZuJ4AdJKw.jpeg"/></div></figure><p id="f924" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">点击<em class="lo">“下一步”</em>继续，如下图所示:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ms"><img src="../Images/33ff9c78d5a9455bea1842fb34509dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jeYNi2wIYZfWDfsqwDxA9A.jpeg"/></div></div></figure><p id="b942" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">对于部署阶段，选择您的 S3 存储桶，如下图所示:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mt"><img src="../Images/244fa78bcfdc854b30393008f3f091fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PtIWLwI8RD7Gt_ElQsHFWg.jpeg"/></div></div></figure><p id="0acb" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">点击<em class="lo">下一步</em><strong class="jm hj"><em class="lo"/></strong>查看你的管道，最后点击<em class="lo">创建管道</em> <strong class="jm hj"> <em class="lo">。</em>T53】</strong></p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/5448baddcde7cae8d17c4ba59a8c7989.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*m2KZ093GzCoXZB0h_8vmjw.jpeg"/></div></figure><h2 id="9482" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">步骤 6:验证静态网站是否可访问</h2><p id="4a97" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">在新的浏览器标签中导航至 S3。点击 S3 木桶名称，“<em class="lo"> new-bucket-cicd-july22 </em>”。点击<em class="lo">属性</em>。滚动到页面底部，在“<em class="lo">静态网站托管</em><strong class="jm hj">”</strong>下，点击斗网站端点 URL。</p><p id="ba14" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">当您单击 URL 时，应该会看到以下屏幕:</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mv"><img src="../Images/c4820566c1b8fb4b9aaa70d1883fdbc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eWpAa73pDnsQlaFB.png"/></div></div></figure><h2 id="0d07" class="kz in hi bd io la lb lc is ld le lf iw jv lg lh ja jz li lj je kd lk ll ji lm bi translated">步骤 7:当您对源代码进行更改时，验证代码管道是否被触发</h2><p id="aa35" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">现在是时候测试我们的 CI/CD 渠道了。应该通过对任何文件进行更改来自动部署更改。为此，导航到您的 GitHub 并编辑 index.html。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es mw"><img src="../Images/ad3e3ff0ff539c41ecfe957f40a5fc8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4XVtdS6J-v9VQgRNz_1WpQ.jpeg"/></div></div></figure><p id="58bb" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">将代码提交并推回您的 GitHub 库</p><p id="6b53" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">验证代码管道被触发并更新您的静态网站！</p><p id="4618" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj"> <em class="lo">恭喜恭喜！您刚刚使用 GitHub 和 CodePipeline 构建了第一个 CI/CD 管道。</em>T3】</strong></p></div></div>    
</body>
</html>