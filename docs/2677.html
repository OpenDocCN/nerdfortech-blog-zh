<html>
<head>
<title>Android WebView, a study case using remoteworker.id | Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android WebView，使用remoteworker.id的研究案例|第1部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/android-webview-a-study-case-using-remoteworker-id-part-1-7cd1efe678cb?source=collection_archive---------4-----------------------#2021-05-16">https://medium.com/nerd-for-tech/android-webview-a-study-case-using-remoteworker-id-part-1-7cd1efe678cb?source=collection_archive---------4-----------------------#2021-05-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4277" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一下，你有一个网站，需要创建一个android应用程序，而你不需要花费额外的时间或金钱来构建它。你可以用WebView来处理。</p><p id="2796" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">WebView的主要用途是显示网站。这里的web术语并不是唯一已经部署在互联网上的远程网站。还包括您在本地拥有的自定义HTML/CSS/javascript。</p><p id="5205" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我将教你如何使用Kotlin语言在Android Studio上使用WebView功能，并在其上添加一些提示和技巧。最终的应用程序将如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="7b3f" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">创建一个简单的WebView</h1><p id="cb68" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">首先，您需要用一个新的空活动创建一个新项目。然后在“activity_main.xml”中定义“WebView ”,不要忘记为它添加一个id。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="7686" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，在Kotlin文件上，“MainActivity.kt”获取WebView并加载您的第一个网站。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="69f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，在清单文件上添加Internet权限。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="fa35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行您的应用程序和viola。您的第一个WebView已加载。恭喜你！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/0e993babec7e1a34fbec78480723d3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-jzZLlsyy_Y22Tbg7ktYA.png"/></div></div></figure><h1 id="78ea" class="jr js hi bd jt ju lc jw jx jy ld ka kb kc le ke kf kg lf ki kj kk lg km kn ko bi translated">提示:使用viewBinding</h1><p id="213c" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在编写视图代码时，您将会弄乱“findViewById”函数。使用viewBinding特性可以消除这种情况。要启用该功能，请打开模块的“build.gradle”文件。并将此添加到“android”块中:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="0208" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要忘记同步你的Gradle文件并使用Ctrl+F9构建你的应用程序。</p><p id="02b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，在“MainActivity.kt”上，您可以将代码更改为:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="41d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">构建您的应用程序并运行。没有变化，但它比多次调用' findViewById '更简洁。</p><h1 id="3905" class="jr js hi bd jt ju lc jw jx jy ld ka kb kc le ke kf kg lf ki kj kk lg km kn ko bi translated">激活Javascript</h1><p id="cb50" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在，当你点击页面顶部的汉堡包按钮时，菜单并没有展开。这是因为如果启用了javascript，菜单将会展开。</p><p id="5602" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开主活动文件，并添加</p><p id="9c2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">binding . webview . settings . JavaScript enabled = true</p><p id="3231" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的“loadUrl”调用。</p><p id="3edc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，主要的活动是这样的</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="5105" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了！您的页面现在是交互式的，您可以展开菜单，一个浮动按钮将会出现。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/2496b24107fdf9752f8982b4a000a9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*724gZLg--kS48A2n-Dbtzw.png"/></div></div></figure></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="59b4" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">添加进度条</h1><p id="806d" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在，当页面第一次加载时，您将看到一个白色页面。我知道这不是你和你的委托人需要的。你想通知用户，页面仍在加载。</p><p id="224c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，是时候给你的应用程序添加一个进度条了。</p><p id="0879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开“activity_main.xml ”,并添加ProgressBar。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="0e9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个名为“MyWebViewClient”的文件。扩展“WebViewClient”并重写某些方法。添加progressBar作为构造函数参数。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="5483" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当页面已经显示时，将调用“onPageFinished”。所以，这是隐藏进度条的地方。</p><p id="30c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，在MainActivity文件中添加</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/efd2c16ba34d9bbec4afef29bff2b1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yncOrkQwYc6Cur-4aBaYgQ.png"/></div></div></figure><h1 id="4f3a" class="jr js hi bd jt ju lc jw jx jy ld ka kb kc le ke kf kg lf ki kj kk lg km kn ko bi translated">一些重构</h1><p id="71a4" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">您可以看到带有“binding.webview.xxx”的三行代码，我们可以使用kotlin的“with”子句重构它。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="9c8f" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">修复错误方案错误</h1><p id="1c03" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">让我们深潜。尝试单击浮动操作按钮。你看到了什么？完全没有动作。</p><p id="43f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以看到运行控制台，您会看到这样的错误</p><p id="05cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> chromium: [INFO:CONSOLE(0)]"混合内容:</strong>页面</p><p id="5409" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过添加来修复它</p><p id="fa00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">settings . mixedcontentmode = web settings。混合内容兼容模式</strong></p><p id="c0b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行应用程序。啊，你仍然得到一个错误。网页不可用。<strong class="ih hj"> net::ERR_UNKNOWN_URL_SCHEME。</strong></p><p id="14c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">若要修复该错误，您应该重写shouldOverrideUrlLoading方法。检查URL是否匹配，您应该覆盖它，覆盖它，并返回true。</p><p id="effe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着webview不会处理它。</p><p id="f5ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的问题，URL方案是从` intent://`开始的</p><p id="3b44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们处理它。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="68d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的MyWebViewClient是这样的</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="7848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要忘记修改MyWebViewClient初始化。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="5943" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">覆盖onReceivedError</h1><p id="6682" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在，试着关闭你的网络连接。然后，打开您的应用程序。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/4e15d74ae6a3f0b786bc1fcf061b05fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJlveuhDAR4E2YvdKpJzrg.png"/></div></div></figure><p id="c9d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，这不是你想要的，对吗？你需要向你的用户展示更多信息。</p><p id="d7df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的要点是从“WebViewClient”中覆盖“onReceivedError”方法。然后，显示错误信息或动画，你决定。并显示另一页，以便不显示默认错误页。</p><h1 id="ba5f" class="jr js hi bd jt ju lc jw jx jy ld ka kb kc le ke kf kg lf ki kj kk lg km kn ko bi translated">安装洛蒂</h1><p id="e820" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">将洛蒂添加到您的依赖项中</p><p id="a80f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实现' com . Airbnb . Android:Lottie:3 . 7 . 0 '</strong></p><p id="e09a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有，同步。</p><p id="bf60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，是时候添加一些布局代码了。打开您的“activity_main.xml”。添加以下内容:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="e46b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们让Lottie自动播放，永远在线循环，并将文件名定义为error.json。</p><p id="eb04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">error.json在哪里？你可以在这里下载<a class="ae lh" href="https://lottiefiles.com/38463-error" rel="noopener ugc nofollow" target="_blank">https://lottiefiles.com/38463-error</a>。下载洛蒂JSON。并将其放置在“资产”文件夹中。重命名为“error.json”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es li"><img src="../Images/a15eb84192714dd92afbf8187b0e0c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*dLVGhzkmq8WS2IkjAR9p7g.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">error.json位置</figcaption></figure><p id="505a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，向MyWebViewClient添加一个名为errorAnim的新参数。当您收到错误主机查找时显示它。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure><p id="e4f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要忘记修改MyWebViewClient初始化。运行它。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/4416735ca2e43a8503070b84462923fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bl-YP_sXKijvfBmABuRPmA.png"/></div></div></figure></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="65b0" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">处理历史记录</h1><p id="e4e9" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">让我们试试后退按钮。点击链接。然后点击后退按钮。遗憾的是，当你需要返回文章列表时，应用程序关闭了。我们如何解决这个问题？？</p><p id="1c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开MainActivity文件，覆盖onBackPressed方法。检查webview是否可以返回，然后返回。否则，打电话给超级。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ku jj l"/></div></figure></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="c76c" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">摘要</h1><p id="25c1" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">恭喜你！您可以创建一个webview应用程序，并在webview上做一些小把戏。以下是你目前为止学到的东西:</p><ul class=""><li id="a2a1" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">创建简单的webview</li><li id="928d" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">在webview中启用javascript</li><li id="6d7a" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">处理混合内容</li><li id="9f4b" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">当用户点击浮动按钮时，通过重写shouldOverrideUrlLoad来处理打开的fb-messenger</li><li id="5b79" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">处理简单的webview错误</li><li id="6929" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">用户按back时的句柄。</li><li id="8eb0" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">并将洛蒂动画添加到您的应用程序中</li></ul><p id="a9a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一部分再见。您将在片段的顶部学习webview，并处理它的背面压力。</p><p id="629b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里看到完整的代码</p><div class="mb mc ez fb md me"><a href="https://github.com/ihfazhillah/rwid-tutorial-webview" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hj fi z dy mj ea eb mk ed ef hh bi translated">ihfazhillah/rwid-教程-网络视图</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">github.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms la me"/></div></div></a></div></div></div>    
</body>
</html>