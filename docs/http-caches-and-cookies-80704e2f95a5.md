# HTTP 缓存和 Cookies

> 原文：<https://medium.com/nerd-for-tech/http-caches-and-cookies-80704e2f95a5?source=collection_archive---------2----------------------->

## Cookies:

HTTP 是一种无状态协议。这意味着它独立处理每个请求，而不知道以前的请求。

> *在同一连接上连续执行的两个请求之间没有链接*

当你在一个电子商务网站上时，这种无国籍的概念就成了问题。这是因为一旦你登录了亚马逊或者 Flipkart，你就被要求登录，直到你的交易结束。直到你的交易完成，你不会改变你的浏览器(比如说 Chrome)。记住**这个词*浏览器。***

***饼干来了。*** *它帮助服务器记住它从客户端获得的请求是否来自同一个浏览器。*

因此，HTTP cookie 是服务器发送给 web 浏览器的一小段数据。浏览器存储 cookie 并为每个后续请求发回它。

## **cookie 是如何工作的？**

当收到请求时，服务器发送一个带有****‘Set-Cookie’**HTTP 头的响应。**

```
Set-Cookie: <cookie-name>=<cookie-value> 
Set-Cookie: hello=user
```

**浏览器保存 cookie 并将其与' **Cookie'** 标头一起发送。**

```
Cookie:hello=user
```

**这样，服务器就知道请求来自同一个浏览器。**

## **饼干的一生**

```
Set-Cookie: <cookie-name>=<cookie-value>; Expires=<date> 
Set-Cookie: <cookie-name>=<cookie-value>; Max-Age=<number>
```

**这里的到期日期(日期格式)是针对客户端的，最大期限以秒为单位。**

**由于 cookies 存储在浏览器中，因此可以通过 JavaScript[document]访问它们。cookie API]，这就产生了漏洞。因此我们只用 ***httponly。*****

```
Set-Cookie: hello=user ***HttpOnly***
```

**缓存的基本发展点是减少请求消息和响应消息之间的时间。**

## **HTTP 缓存:HTTP**

**缓存的基本发展点是减少请求消息和响应消息之间的时间。**

**提高了对用户的快速响应时间。**

## **场景？**

**很简单，只要服务器的响应不变(可以是同一个静态网页，同一个 JSON，等等。).**

**不同的请求，但相同的回应。**

**它可以在*浏览器*、*中间*服务器(代理服务器)以及*服务器*本身中实现。**

**所有 HTTP 请求都首先通过浏览器缓存，不管特定请求是否有有效的缓存响应。这减少了网络时间和数据成本。**

**当响应被像网飞和亚马逊这样的服务提供商缓存在中间服务器中以减少用户等待时间时，它就成为了 CDN(至少是 CDN 的基础)。**

**如果存储的响应应该只在浏览器中，我们应该添加一个 HTTP 头。**

```
Cache-Control: **private**
```

**实现代理缓存(中间服务器缓存)是为了减少服务器的网络流量。这些是缓存服务器。**

**但是，*的请求和响应都是加密的。因此，代理服务器不能用作缓存服务器。***

***为了减少用户等待时间和原始服务器的网络负载，服务开发人员发现了许多缓存策略。这些被称为**托管缓存**。例如 CDN。***

***您可以深入阅读这些 MDN 文档。***

***存储/缓存的响应有两种状态— **新鲜**和**陈旧。*****

*****新鲜—** 存储的响应有效***

*****陈旧—** 存储响应无效。***

****如何判断响应是* ***陈旧*** *还是* ***新鲜*** *？****

***两种情况-***

***1)具有共享缓存(中间服务器缓存)***

***2)没有共享缓存***

```
*Cache-Control: max-age=604800 --> 1 week in seconds --> from response generated time*
```

***如果超过 1 周→响应*失效*。***

***如果少于 1 周→响应为*新鲜*。***

***如果来自原始服务器的响应在中间或**代理**服务器中存储了一天，则需要通知这个*一天。*这就是**年龄**头来的原因。***

```
*Cache-Control: max-age=604800 
**Age: 86400 --> One day in seconds***
```

***因此，604800–86400 = 518400 用于确定陈旧或新鲜。***

*****记住:*****

***HTTP 缓存的工作是基于头部和它们之间的链接的集合。***

***一些标题是，***

****缓存控制****

****最后修改****

****如果-修改-自****

****如果不匹配****

****Etag 等。****

****最初发表于 2022 年 8 月 15 日*[*https://www.pansofarjun.com*](https://www.pansofarjun.com/post/http-caches-and-cookies)*。****