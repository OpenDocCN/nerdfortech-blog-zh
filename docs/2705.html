<html>
<head>
<title>Synthetically generate datasets using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习综合生成数据集</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/synthetically-generate-datasets-using-deep-learning-c1f6ee7a0990?source=collection_archive---------4-----------------------#2021-05-17">https://medium.com/nerd-for-tech/synthetically-generate-datasets-using-deep-learning-c1f6ee7a0990?source=collection_archive---------4-----------------------#2021-05-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6fa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个故事将探索如何使用<a class="ae jd" href="https://sdv.dev/SDV/index.html" rel="noopener ugc nofollow" target="_blank">综合数据仓库(SDV) </a>综合生成相关的关系数据集。这篇文章的Python笔记本可以在<a class="ae jd" href="https://colab.research.google.com/drive/1QszDzp7vGSVleQdAGpVCyLUe4UlGrfvN?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab这里</a>找到。</p><h1 id="2910" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">介绍</h1><p id="1c8b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">如今，数据驱动型企业常常会发现自己陷入困境。虽然对创新和创建新的数据产品有巨大的需求，但同时他们必须限制/管理对生产数据的访问，以供数据科学家和工程师访问。数据科学家需要真实的数据集来验证他们的模型，测试工程师需要高质量的数据来进行系统测试，以交付高质量的产品。</p><p id="de0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像<a class="ae jd" href="https://faker.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Faker </a>这样的库对于生成简单的数据集非常方便，这些数据集对于单元级测试非常有用，但是对于系统测试一个相当复杂的现代企业应用程序来说，它们的局限性太大了。企业应用程序涉及来自多个<a class="ae jd" href="https://martinfowler.com/bliki/BoundedContext.html" rel="noopener ugc nofollow" target="_blank">有界上下文</a>的数据集，具有复杂的相互关系。此外，企业数据在本质上通常是多模态的，涉及关系、时间序列和基于文档的数据集。企业数据产品的数据生成将需要完全不同的策略。这就是像SDV这样的工具来拯救我们的地方。</p><p id="18b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SDV是在Kalyan Veeramachaneni 的监督下，麻省理工学院人工智能数据实验室<a class="ae jd" href="https://dai.lids.mit.edu/" rel="noopener ugc nofollow" target="_blank">辛勤工作和数年研究的成果。</a></p><p id="efd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://sdv.dev/" rel="noopener ugc nofollow" target="_blank"> SDV </a>是一个Python库的集合，用于基于不同模态(时间序列、关系和表格)的深度学习模型生成合成数据。在引擎盖下，SDV使用了几种概率建模和基于深度学习的技术来递归迭代表(数据和元数据)并生成模型。然后，生成的模型可用于综合生成新的数据集。</p><p id="5baa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于不同的模态，如关系、时间序列和表格，SDV有其他几种算法。它还提供了对生成的数据进行基准测试的工具。在本文中，我们将探索使用SDV为多表关系模型综合生成数据。</p><p id="4738" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Kaggle竞赛的数据集—<a class="ae jd" href="https://www.kaggle.com/frtgnn/dunnhumby-the-complete-journey" rel="noopener ugc nofollow" target="_blank">dunhumby—完整旅程</a>。使用这个数据集，我们将使用SDV来训练一个多表模型。根据训练好的模型，我们将生成一个样本数据集，评估并比较生成的数据集和源数据集。</p><p id="fd19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SDV工作流程包括以下步骤，这些步骤将在此处进行。完整的Python笔记本可以在<a class="ae jd" href="https://colab.research.google.com/drive/1QszDzp7vGSVleQdAGpVCyLUe4UlGrfvN?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab这里</a>找到。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/eb118513cef441386ed4424633e4e99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J9oUjka_6ADABNN-.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated"><em class="kx">SDV工作流程(来源:</em><a class="ae jd" href="https://dai.lids.mit.edu/wp-content/uploads/2018/03/SDV.pdf" rel="noopener ugc nofollow" target="_blank"><em class="kx"/></a><em class="kx">)</em></figcaption></figure><h1 id="71c6" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">组织</h1><p id="1aea" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这一步包括下载Kaggle数据集，并为我们的实验做准备。该数据集包含来自2500个家庭的家庭级交易，这些交易与他们的人口统计信息有关。对于这个实验，我们将只涉及三个表——产品、交易和人口统计表</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ky"><img src="../Images/6559baeb53bd82227a43bf217cdeed38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O06TgOV8XKGcebSqQtzLlA.png"/></div></div></figure><p id="a7c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Pandas将三个表加载到Dataframes中，还删除了不属于实验的列。</p><h1 id="3d2f" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">指定结构</h1><p id="384c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">下一步是确定表的结构和表之间的关系。按照SDV元数据<a class="ae jd" href="https://sdv.dev/SDV/user_guides/relational/relational_metadata.html" rel="noopener ugc nofollow" target="_blank">规范</a>以JSON格式捕获该结构。</p><p id="814c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看数据，我们可以看到Product和Transaction表通过PRODUCT_ID关联，Demographics和Transaction表通过household_key链接。其他字段和其他关系的数据类型如这里的<a class="ae jd" href="https://colab.research.google.com/drive/1QszDzp7vGSVleQdAGpVCyLUe4UlGrfvN#scrollTo=_nuYOFksZgj8&amp;line=1&amp;uniqifier=1" rel="noopener ugc nofollow" target="_blank">所示</a>。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kz"><img src="../Images/d7eabed938110b77c37d6e59df4ba362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PPp78nD5g7YrvBuhgiIvTQ.png"/></div></div></figure><p id="3649" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">元数据库有一个很酷的可视化功能，可以直观地显示表和关系。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es la"><img src="../Images/3695a8b3db520e46d05d1981427fe3e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMmkDQ0AtZQkrd0WCHz2Gw.png"/></div></div></figure><p id="565d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然源数据集和元数据已经准备好，那么就进入下一步，从数据集训练模型。</p><h1 id="ae32" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">学习模型</h1><p id="aee9" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">对于这一步，我们将利用在SDV实现的称为<strong class="ih hj"> HMA1 </strong>的分层建模算法。</p><p id="c126" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该算法递归遍历关系数据集中的所有表，并在所有表中应用表格模型，然后根据所有表中的所有字段的相关程度来训练模型。</p><p id="93da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">培训API使用起来非常简单。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lb"><img src="../Images/dc9e79ac606f55af0a02e24adcbd0838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*NDqKM8LvFW7bpk0U4WCRdw.png"/></div></figure><p id="28a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然模型已经定型，我们就可以开始从模型中创建合成数据，这些数据应该在统计上与源数据集紧密一致。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lc"><img src="../Images/82af77a303cdbeb5f305012a2e9f20bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*7W0JgXQGf918cpGi51vKYQ.png"/></div></figure><p id="911d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以将模型保存到pickle文件中，这是生成合成数据集所需的全部内容。模型可以从pickle文件中加载回来，而不需要原始数据集。</p><h1 id="a452" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">合成数据</h1><p id="f679" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">既然SDV已经完成了所有的艰苦工作，从我们的源数据集训练一个模型，我们可以简单地从模型中创建一个样本，就像这样容易地生成一个样本数据集。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es ld"><img src="../Images/134a7ba8cd45d6ad90c23c0dfd34bf9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*T66rjka5r6BLmdCnutFv8w.png"/></div></figure><h1 id="0283" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">评估生成的数据</h1><p id="a2c7" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们将使用<a class="ae jd" href="https://baukebrenninkmeijer.github.io/table-evaluator/" rel="noopener ugc nofollow" target="_blank"> TableEvaluator </a>库将生成的数据与我们开始使用的源数据集进行统计比较，并显示我们生成的假数据有多真实。</p><p id="ba72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是一些关于比较的见解。</p><p id="2fb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">产品</strong>表有两个分类列，这两列的分布比较如下所示。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es le"><img src="../Images/3b07761b9b10719ad99c0c74772f2b7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLXplhwQ09CLMwDKbjGZYg.png"/></div></div></figure><p id="8781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">交易表有三个数值:销售额、交易时间和数量。虽然原始数据集和合成数据集之间的销售、交易时间列相似，但数量有所不同。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lf"><img src="../Images/8c431a0049eefb68baeaa831d36e9a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*46_x1dDepPVnMHANSKAGYw.png"/></div></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es le"><img src="../Images/995db1ed2c0e8eab24362e616e78d5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJbNXF0z5eIVsH0ZS9VZTw.png"/></div></div></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lg"><img src="../Images/06c55cb07d77af5795f2d9d650d712eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*kxwyj5jYwmhEGyjc5pBZzw.png"/></div></figure><p id="366a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj">人口统计</strong>表上生成的合成数据与源表上的分布非常相似。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lh"><img src="../Images/4e302677c92a4cb93ea5717c14907d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqamYcfiWZ6gqUmXK-dUFw.png"/></div></div></figure><h1 id="2c97" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论</h1><p id="184d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">随着GDPR、CCPA和其他隐私法锁定和保护客户数据，组织如何创新并成为数据驱动型企业，实现以客户为中心的数字化转型？合成数据工具和框架使得生成与实际数据非常相似的具有高度代表性的数据成为可能。</p><p id="232b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SDV为数据工程师和数据科学家提供了广泛的工具来生成真实的假数据。这些工具仍在发展和改进，但已经有一套很好的工具可以投入使用。</p></div></div>    
</body>
</html>