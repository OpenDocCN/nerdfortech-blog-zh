<html>
<head>
<title>DNS analysis in a nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简而言之，DNS 分析</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/dns-analysis-in-a-nutshell-cbf4ce1926a7?source=collection_archive---------1-----------------------#2021-12-02">https://medium.com/nerd-for-tech/dns-analysis-in-a-nutshell-cbf4ce1926a7?source=collection_archive---------1-----------------------#2021-12-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="61e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> DNS </strong>或域名系统被认为是互联网的电话簿，它是一个以记录形式存储域设置的地方，在这里您可以管理域在 IP 解析、别名、电子邮件服务器和更多高级功能方面的行为。</p><p id="2d47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您不熟悉<strong class="ih hj"> DNS </strong>，您可以在访问服务时看到它们的运行。大多数情况下，会进行递归请求(反向 DNS 查找),因为您很少在浏览器搜索栏中键入 IP 地址。</p><blockquote class="jd je jf"><p id="e357" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">写 davidlares.com 比打 76.76.21.21 容易</p></blockquote><p id="ffef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，许多事件在内部执行，只是为了弄清楚如何访问互联网上的特定服务器。浏览器必须找到哪个是资源的 IP 地址，然后执行适当的<strong class="ih hj"> HTTP </strong>请求。</p><p id="9276" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> DNS </strong>解析可以出现在很多地方。下面是浏览器如何解决你的请求。</p><p id="f28f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，浏览器检查对应于该特定域的 IP 地址是否存储在<strong class="ih hj">本地缓存</strong>中。</p><p id="609f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其次，浏览器检查对应于该特定域的 IP 地址是否存储在<strong class="ih hj">系统主机表</strong>中，以防存在静态映射。</p><p id="0adc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jg">请参考</em> <a class="ae jk" href="https://en.wikipedia.org/wiki/Hosts_(file)#Location_in_the_file_system" rel="noopener ugc nofollow" target="_blank"> <em class="jg">这个</em> </a> <em class="jg">资源，它列出了那个主机的表在你的 OS 中的位置。</em></p><p id="4a0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果什么也没找到，它向<strong class="ih hj">本地 DNS 服务器、</strong>和<strong class="ih hj"> </strong>生成一个递归请求。如果还是什么也没找到，该请求将转到一个根服务器，根服务器将该请求递归地重定向到一个更高的服务器，直到找到一个响应。</p><p id="2fde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当找到响应时，会临时缓存在请求流程中交互的每个<strong class="ih hj"> DNS </strong>服务器实例中。所有可能的<strong class="ih hj"> DNS </strong>记录也是如此，如:<code class="du jl jm jn jo b">AAAA</code>、<code class="du jl jm jn jo b">CNAME</code>、<code class="du jl jm jn jo b">NS</code>、<code class="du jl jm jn jo b">MX</code>、<code class="du jl jm jn jo b">TXT</code>等。</p><p id="8f27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面解释的过程只是一个简单的 web 请求的例子。但是比这更复杂的是，在安全方面,<strong class="ih hj"> DNS </strong>流量以纯文本形式传输。</p><p id="8640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> DNS </strong>流量在<strong class="ih hj"> OSI </strong>模型的传输层中使用<strong class="ih hj"> UDP </strong>协议，但在应用层中被发现为<strong class="ih hj"> DNS </strong>流量，可通过端口 53 访问。因为是 UDP<strong class="ih hj">没有会话，所以不考虑该层，数据包是独立的。</strong></p><h2 id="ce75" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">快速动手演示</h2><p id="5b61" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">请下载、安装并打开<a class="ae jk" href="https://www.wireshark.org/" rel="noopener ugc nofollow" target="_blank"> Wireshark </a>。</p><ol class=""><li id="58ab" class="kp kq hi ih b ii ij im in iq kr iu ks iy kt jc ku kv kw kx bi translated">选择您想要的实例</li><li id="bc1e" class="kp kq hi ih b ii ky im kz iq la iu lb iy lc jc ku kv kw kx bi translated">在过滤栏中设置一个 DNS 过滤:添加<code class="du jl jm jn jo b">dns</code>作为标准。类似这样的东西</li></ol><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es ld"><img src="../Images/c59b58cf29c5702e5437b84ea872d835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fP88DTW2BHNEIaj0oCZ9A.png"/></div></div></figure><p id="38db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析数据包细节部分，你会发现有一个用户数据报协议部分。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lp"><img src="../Images/fdf144813229457195ca43b13adc4d0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*4-2SbF-1vRsD1JFxO4OKSA.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">UDP 数据包信息</figcaption></figure><p id="2216" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和上面一样，你可以找到 Ipv4 找到通讯细节。下面，是 DNS 查询的详细信息。</p><p id="6caf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种解决了解 DNS 记录的方法是执行一个<code class="du jl jm jn jo b">nslookup</code>命令。您可以执行以下操作:</p><p id="5820" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jl jm jn jo b">nslookup gmail.com</code>或者:</p><pre class="le lf lg lh fd lu jo lv lw aw lx bi"><span id="c9d8" class="jp jq hi jo b fi ly lz l ma mb">nslookup<br/>&gt; gmail.com</span></pre><p id="d19e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者:</p><pre class="le lf lg lh fd lu jo lv lw aw lx bi"><span id="7533" class="jp jq hi jo b fi ly lz l ma mb">nslookup<br/>&gt; set type=MX gmail.com</span></pre><h2 id="7de6" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">由此可以得出什么结论？</h2><p id="0f4b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">如果由于任何原因，一个 DNS 服务器暴露在互联网上，很容易看到流量表，导致任何可能的攻击或记录注入(DNS 中毒)。</p><p id="589d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保护 DNS 服务器是必需的，它们不是为安全连接设计的。</p><p id="d467" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐编码:)</p></div></div>    
</body>
</html>