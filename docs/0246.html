<html>
<head>
<title>Image Classifier — Standford Car make, model and year Classification using the MonkAi Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像分类器—使用 MonkAi 库对斯坦福汽车品牌、型号和年份进行分类</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/image-classifier-car-make-model-and-year-classification-using-the-monkai-library-cb49ae121263?source=collection_archive---------2-----------------------#2020-08-10">https://medium.com/nerd-for-tech/image-classifier-car-make-model-and-year-classification-using-the-monkai-library-cb49ae121263?source=collection_archive---------2-----------------------#2020-08-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7697" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嘿，伙计们..！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/0acaec9fa44ee7bffb4c7e5570a9f627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lNwT1lqNrU514VlR"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae ju" href="https://unsplash.com/@fabioha?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法比奥</a>在<a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，你将学习如何使用 Monk 库建立一个图像分类模型。</p><h1 id="074a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">关于数据集</strong></h1><p id="687b" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated"><em class="jd">汽车</em>数据集包含 196 类汽车的 16，185 张图片。数据被分成 8，144 个训练图像和 8，041 个测试图像，其中每个类别被大致分成 50-50 个部分。类别通常处于<em class="jd">品牌、型号、年份</em>的水平，例如 2012 款 Tesla Model S 或 2012 款宝马 M3 Coupe。这个数据是斯坦福大学开源的。你在这里下载数据集<a class="ae ju" href="http://ai.stanford.edu/~jkrause/cars/car_dataset.html" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="ee6b" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">关于和尚图书馆</h1><ul class=""><li id="cf75" class="ky kz hi ih b ii kt im ku iq la iu lb iy lc jc ld le lf lg bi translated">使用 Monk，您可以编写更少的代码并创建端到端的应用程序。</li><li id="3bdc" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">只学习一种语法，使用任何深度学习库——py torch、Mxnet、Keras、TensorFlow、Gluon 等，创建应用。</li><li id="e3d7" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">免费的、本地的、开源的 Monk AI 是一个既能迎合初学者又能迎合计算机视觉专家的工具</li><li id="d30f" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">用几行代码进行多个实验，轻松管理整个项目。</li></ul><p id="54f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是在 Kaggle、Hacker Earth、Codalab 等平台举行的比赛中使用的最佳工具。</p><p id="d1fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">好了好了，我们开始吧！</em></p><h1 id="7414" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">所需工具和库</strong></h1><p id="c1dd" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">在 collab 中安装 monk 库</p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="ae21" class="lr jw hi ln b fi ls lt l lu lv">!git clone <a class="ae ju" href="https://github.com/Tessellate-Imaging/monk_v1.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Tessellate-Imaging/monk_v1.git</a></span><span id="3538" class="lr jw hi ln b fi lw lt l lu lv">!cd monk_v1/installation/Misc &amp;&amp; pip install -r requirements_colab.txt</span></pre><p id="c2b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面两行代码将把所需的库从 GitHub 安装到您的本地工作区。</p><h1 id="ad59" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">下载数据集</h1><p id="9d6e" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">现在使用<a class="ae ju" href="https://chrome.google.com/webstore/detail/curlwget/jmocjfidanebdlinpbcdkcmgdifblncg?hl=en" rel="noopener ugc nofollow" target="_blank"> curlWget </a>工具从服务器下载数据集。</p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="d557" class="lr jw hi ln b fi ls lt l lu lv">!wget — header=”Host: imagenet.stanford.edu” — header=”User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36" — header=”Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9" — header=”Accept-Language: en-US,en;q=0.9" “http://imagenet.stanford.edu/internal/car196/car_ims.tgz" -c -O ‘car_ims.tgz’</span></pre><p id="2aff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下载文件后，解压缩 zip 文件</p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="b8cc" class="lr jw hi ln b fi ls lt l lu lv">tar -xvf '/content/cars_ims.tgz' -C '/content/'</span></pre><p id="4a20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入图像分类问题所需的其他库</strong></p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="fa56" class="lr jw hi ln b fi ls lt l lu lv"><strong class="ln hj">import</strong> <strong class="ln hj">os</strong><br/><strong class="ln hj">import</strong> <strong class="ln hj">sys<br/>from</strong> <strong class="ln hj">monk.gluon_prototype</strong> <strong class="ln hj">import</strong> prototype<br/><strong class="ln hj">from</strong> <strong class="ln hj">pytorch_prototype</strong> <strong class="ln hj">import</strong> prototype</span></pre><p id="d0fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用任何深度学习框架创建原型。这里我用的是<strong class="ih hj"> monk.gluon_prototype </strong></p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="b4d0" class="lr jw hi ln b fi ls lt l lu lv">monk_gln = prototype(verbose=1);</span><span id="8313" class="lr jw hi ln b fi lw lt l lu lv">#name the prototype with the model you want to use<br/>monk_gln.Prototype("Task", "resnet50");</span></pre><p id="20b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">初始化预训练的 Resnet-50 作为图像分类器模型和其他参数。</p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="cf46" class="lr jw hi ln b fi ls lt l lu lv">monk_gln.Default(dataset_path="/content/car_data/train", <br/>            model_name="resnet50", <br/>            freeze_base_network=<strong class="ln hj">True</strong>,<br/>            use_gpu=True,<br/>            num_epochs=20);</span></pre><p id="6dd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在训练模型</p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="0c2a" class="lr jw hi ln b fi ls lt l lu lv">monk_gln.Train();</span></pre><p id="9c3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在模型的训练之后，我们使用训练的模型进行预测。</p><pre class="jf jg jh ji fd lm ln lo lp aw lq bi"><span id="30a9" class="lr jw hi ln b fi ls lt l lu lv">img_name="/content/car_data/test/00262.jpg"<br/>pred = monk_eval.Infer(img_name=img_name);<br/><strong class="ln hj">from</strong> <strong class="ln hj">IPython.display</strong> <strong class="ln hj">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lx"><img src="../Images/226f5f9ccf63072458bc0236bedfbeb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZCnsVGnFS8TVPPmxxwVKw.png"/></div></div></figure><p id="b9f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码可以在<a class="ae ju" href="http://github.com/ratnasankeerthanreddy/monkai-cars-model-classification" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。如果这篇文章对你有所帮助，请鼓掌或分享！</p><h1 id="071e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">参考</h1><ol class=""><li id="3952" class="ky kz hi ih b ii kt im ku iq la iu lb iy lc jc ly le lf lg bi translated"><a class="ae ju" href="https://ai.stanford.edu/~jkrause/cars/car_dataset.html" rel="noopener ugc nofollow" target="_blank">ai.stanford.edu/~jkrause/cars/car_dataset.html</a>为数据集</li></ol><p id="06fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.https://monkai.org/<a class="ae ju" href="https://monkai.org/" rel="noopener ugc nofollow" target="_blank"/></p><p id="7058" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.【https://www.tessellateimaging.com/ T4】</p></div></div>    
</body>
</html>