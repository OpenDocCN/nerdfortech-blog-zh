<html>
<head>
<title>WSO2 Identity Server with CA-Signed Certificate to Connect with Office365</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WSO2 Identity Server使用CA签署的证书与Office365连接</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/wso2-identity-server-run-with-ca-signed-certificate-for-office365-4cba32c60896?source=collection_archive---------2-----------------------#2021-01-04">https://medium.com/nerd-for-tech/wso2-identity-server-run-with-ca-signed-certificate-for-office365-4cba32c60896?source=collection_archive---------2-----------------------#2021-01-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1bd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要使用本地IAM提供程序(如WSO2 Identity Serer)连接到office365帐户，我们需要一个CA签名的证书。但是在阅读本文之前，您需要为自己创建一个域，并将该域添加到Office365域中。所以要在Office365中添加你的域名先遵循这个<a class="ae jd" href="https://maneeshaindrachapa.medium.com/add-domain-to-office-365-865ec65943af" rel="noopener"> <strong class="ih hj"> <em class="je">链接</em> </strong> </a>。</p><p id="a3be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您运行WSO2 identity server时，您将获得一个URL '<em class="je">https://localhost:9443/carbon '</em>，当您尝试使用浏览器访问它时，您必须浏览如下页面。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/eff81ca3cc3d812303d18783a2f5e6de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMgaDvHG4akAOw7R4cgyHA.png"/></div></div></figure><p id="0c94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，当身份服务器试图通过<em class="je"> HTTPS </em>浏览器访问<em class="je">本地主机</em>时，需要验证身份服务器是否拥有本地主机，浏览器将要求身份服务器提供一些证明，然后身份服务器将提供其拥有的公共证书，但问题是公共证书是自签名证书。因为它是自签名浏览器，所以会警告用户，如果用户信任身份服务器，访问站点是不安全的。因此，我们可以在浏览器中转至“高级”,并访问identity server admin登录页面。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jr"><img src="../Images/6548c22bc4d5dda09d7deaed5dc331b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVJkbCcU3H_byq-0Rr4frA.png"/></div></div></figure><p id="a547" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但问题是，当我们试图从我们的<em class="je"> localhost </em>认证一个微软登录时，微软无法将<em class="je"> localhost </em>视为一个可信的<em class="je"> URL </em>，因为它只会信任证书，而不会提示用户信任<em class="je"> localhost。所以登录最终会失败。为了避免这种情况，我们需要一个CA签名的证书。</em></p><h1 id="a1dd" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">在WSO2身份服务器中配置CA签名的证书</h1><h2 id="53c3" class="kq jt hi bd ju kr ks kt jy ku kv kw kc iq kx ky kg iu kz la kk iy lb lc ko ld bi translated">生成新的密钥库</h2><p id="61c7" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">因此，要用自签名公共证书创建一个新的密钥库，让我们创建一个文件夹，然后继续，我在这里使用的文件夹将被称为<ca_keystore/></p><pre class="jg jh ji jj fd lj lk ll lm aw ln bi"><span id="a78a" class="kq jt hi lk b fi lo lp l lq lr">keytool -genkey -alias wso2carbon -keyalg RSA -keysize 2048 -keystore newkeystore.jks -dname "CN=&lt;your_domain_name&gt;, OU=Home,O=Home,L=SL,S=WS,C=LK" -storepass wso2carbon -keypass wso2carbon</span></pre><p id="eb5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的命令将创建一个名为<code class="du ls lt lu lk b"><em class="je">newkeystore.jks</em></code> <em class="je">的密钥库。</em>如果keytool命令在ubuntu中不起作用，您需要检查是否正确设置了<em class="je"> $PATH </em>和<em class="je"> $JAVA_HOME </em>环境变量。如果我们偷偷看一下我们执行的keytool命令，就会发现</p><ul class=""><li id="0432" class="lv lw hi ih b ii ij im in iq lx iu ly iy lz jc ma mb mc md bi translated"><em class="je">CN-Common name</em>:Common name是服务器身份，因此在某种程度上这个密钥库告诉我们，“我代表这个域”。所以这是你想放域名的地方。</li><li id="2f59" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated"><em class="je"> storepass - </em>该密钥库的密码。</li><li id="8dc8" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated"><em class="je"> keypasss - </em>私钥的密码。</li><li id="c4de" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated">别名是将你的私钥和公钥绑定在一起的东西</li><li id="b7f0" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated"><em class="je"> 2048 </em> -这意味着私钥长度为2048个字符</li></ul><p id="65fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所见，我使用了<em class="je"> wso2carbon </em>作为<em class="je">别名</em>、<em class="je"> keypass、</em>和<em class="je"> storepass </em>。这是为了轻松地更新我们的WSO2 IS Keystore证书。如果您想对<em class="je"> keypass </em>和<em class="je"> storepass </em>使用不同的密码，请<a class="ae jd" href="https://is.docs.wso2.com/en/5.9.0/administer/configuring-keystores-in-wso2-products/#!" rel="noopener ugc nofollow" target="_blank">参考本文</a>。</p><h2 id="dc33" class="kq jt hi bd ju kr ks kt jy ku kv kw kc iq kx ky kg iu kz la kk iy lb lc ko ld bi translated">生成证书签名请求(CSR)</h2><p id="02d7" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">所以现在我们有了一个包含公钥和私钥-值对的密钥库。对于域名，我用我的域名<strong class="ih hj"><em class="je">CN = maneeshatest 39 . tk</em></strong><em class="je">指定了<strong class="ih hj"><em class="je">CN =&lt;your _ domain _ name&gt;</em></strong>。你可以看到我们为我们的CN添加了任何名称。我甚至可以为我的CN添加“<a class="ae jd" href="https://www.facebook.com/" rel="noopener ugc nofollow" target="_blank"><em class="je"/></a>”字样，但是没有人会相信我们拥有这个域名，对吗？所以问题是我们如何向每个人表明我们才是这个域名的真正拥有者？</em></p><p id="6dfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">答案是我们需要从创建的密钥库中获取一个公共证书。这将包含安全通信所需的加密公钥，以及CN名称。然后我们证明我们拥有这个CN给一个著名的家伙，并让他在这个证书上签名。用技术术语来说，这个著名的家伙被称为认证中心(CA)。</p><p id="06da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了首先对证书进行签名，我们需要为我们的密钥库创建一个证书签名请求(CSR)。这将提交给CA以获得签名证书。为此，请在终端中运行以下命令。它将要求密钥库密码提供您在创建密钥库时使用的密码。</p><pre class="jg jh ji jj fd lj lk ll lm aw ln bi"><span id="8fc1" class="kq jt hi lk b fi lo lp l lq lr">keytool -certreq -alias wso2carbon -file newcertreq.csr -keystore newkeystore.jks</span></pre><h2 id="abb6" class="kq jt hi bd ju kr ks kt jy ku kv kw kc iq kx ky kg iu kz la kk iy lb lc ko ld bi translated">从证书颁发机构(CA)获取签名证书</h2><p id="3b5a" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">现在我们需要向CA展示我们的CSR，并获得CA签名的证书。有像许多CA，你需要支付金钱，并得到一个CA签名的证书，也有一些免费的。我尝试了https://www.sslforfree.com的<a class="ae jd" href="https://www.sslforfree.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="je"/></strong></a><strong class="ih hj"><em class="je"/></strong>，它将免费提供一个90天的CA签名证书。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jr"><img src="../Images/6c9e5b21651b78409867878275c45e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*snO3WpFi0L7Igx43WbQcrQ.png"/></div></div></figure><p id="e10c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请转到这里，输入您的域并单击“创建免费SSL证书”,然后您需要创建一个帐户，然后他们会提示您进入您的控制面板，在那里您可以完成证书签名过程。但是在签署域名之前，你实际上需要为你自己拥有那个域名。有一个叫<a class="ae jd" href="https://www.freenom.com/en/index.html?lang=en" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="je"> freenom </em> </strong> </a>的网站在那里可以有一个<em class="je">。tk域名</em>免费。您需要将该域添加到Office365域中，因为我们将使用该域连接到Office365。因此，要将域添加到Office365，请遵循此<a class="ae jd" href="https://maneeshaindrachapa.medium.com/add-domain-to-office-365-865ec65943af" rel="noopener"> <strong class="ih hj"> <em class="je">链接。</em> </strong> </a></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mj"><img src="../Images/d7b21087f10fff96c1c13361c4614800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Orqy_5kSu_WNF8CJQK1ZvQ.png"/></div></div></figure><p id="3afe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Ok在<a class="ae jd" href="https://www.sslforfree.com" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="je">SSL forfree</em></strong></a><strong class="ih hj"><em class="je"/></strong>您可以通过提供您拥有的域名继续CA请求。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mk"><img src="../Images/e4fbf8c8635293b364ec26eea4a8542b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cVGFKgcAAhwj3_19yADcQ.png"/></div></div></figure><p id="580e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后他们会给你看那个证书的有效期。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ml"><img src="../Images/52416bf71929a7035c7510b1948b0399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-VU9ailRE7poKZFWgtxEbA.png"/></div></div></figure><p id="b92b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后对于CSR和联系人，需要选择<strong class="ih hj"> <em class="je">粘贴已有的CSR </em> </strong>选项。我们需要在文本框中输入“pem”格式的CSR。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mm"><img src="../Images/c9e0701084b99318bbf3a09842d2db1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A82ENNldEL-SkstJHx-C6g.png"/></div></div></figure><p id="a211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里开始，我将切换到<a class="ae jd" href="https://keystore-explorer.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="je"> Keytool GUI版本</em> </strong> </a>。对于其余的任务，与命令行键工具相比，它是一个更容易的工具。使用Keytool GUI打开上面创建的<code class="du ls lt lu lk b"><em class="je">newcertreq.csr</em></code> <em class="je"> </em>文件。现在点击<em class="je"> PEM </em>按钮。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mn"><img src="../Images/4cb5be6b14e5e70710914be9f90b4698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38_enmp4bok8mqtsneYFLA.png"/></div></div></figure><p id="abaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将该值粘贴到请求CSR的文本框中，然后单击下一步。然后，他们会要求您的计划再次选择免费的90天版本，并单击完成。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mo"><img src="../Images/4dd083656ba90f15e2b9b16f8130da45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*087DyrZNBoxIHzdcJ26LTg.png"/></div></div></figure><p id="a7bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后他们会要求你验证你的域名。因为他们实际上想知道你真的拥有这个域名。所以他们会要求你验证你的域名。最简单的方法是将CNAME记录添加到您的DNS中。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mp"><img src="../Images/7a72878f360c8b5c59f7efc26c899832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*evd102nmSwGnm-BoUiLhpQ.png"/></div></div></figure><p id="3833" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们将这个<strong class="ih hj"><em class="je">maneeshatest 39 . tk</em></strong>作为域名添加到我们的Office365中，并将我们的freenom域名服务器改为微软域名服务器。因此，要添加记录，您需要登录Office365管理面板，转到“域”部分，选择该域，然后单击“添加记录”，然后添加CNAME记录。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/310c95f9793e0309213a3861a37fdbd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYHpg8xuv5Myuq2aJWpApA.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mq"><img src="../Images/9baf26bb5ebe07c04710bf4776bb5ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5OLpkvvMRDfhRKTqfO4qXg.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ml"><img src="../Images/e85ddfd4e0012cf720102667daafb1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PhooZ1fZTSF98KjhahQPgA.png"/></div></div></figure><p id="b9f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一切顺利，并且您等待了足够的时间来使用我们添加的DNS属性，服务器将会意识到该域实际上是由您拥有的，并给您CA签名的证书。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mr"><img src="../Images/50b1323bb66a358900eeba9c5e105fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HVOkXioZhy2IRTAe7gcsHA.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ms"><img src="../Images/48d0cd7cedfe29eb8f417b78fd6268e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9NAsUuDDkrq466QYaFuGA.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mt"><img src="../Images/045a60b7e4a0d9dc1288c2e9beaed0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5Xy6BDb9a6Fgr1BY8jYxQ.png"/></div></div></figure><p id="c5c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">证书已经颁发，可以安装了。现在，您可以下载您的CA签名证书，我们解压缩zip文件，查看其中的文件，将有两个文件。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mu"><img src="../Images/028f0dba096741416987460ec8f4f4e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xyPgzoSkrHDrOu6GsbokhA.png"/></div></div></figure><ul class=""><li id="742f" class="lv lw hi ih b ii ij im in iq lx iu ly iy lz jc ma mb mc md bi translated">ca_bundle.crt - CA签名的证书</li><li id="a915" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated">certificate.crt -一组中间证书</li></ul><p id="e6a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在带着这些文件回到<ca_keystore>文件夹。使用Keytool GUI打开<code class="du ls lt lu lk b"><em class="je">newkeystore.jks</em></code> <em class="je"> </em>文件，导入上面收到的<code class="du ls lt lu lk b"><em class="je">ca_bundle.crt</em></code> <em class="je"> </em>文件，使用<strong class="ih hj"> <em class="je">工具</em> - &gt; <em class="je">导入可信证书</em> </strong> <em class="je">。使用不同于<em class="je"> wso2carbon的别名。</em></em></ca_keystore></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mv"><img src="../Images/fd812aabb8c24a69fc8baab79f80c111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4YmtVUzXI65KKBoFmrv_zg.png"/></div></div></figure><p id="e60b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您可以在密钥库中看到一个名为wso2carbon的密钥对。在新添加的证书旁边。这是私钥+自签名公钥对。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mw"><img src="../Images/a4fdbfb397eaf93b26e1c87caab0da7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fd8xNINlqlg-MF8W3nbEOg.png"/></div></div></figure><p id="a614" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要添加我们的CA签名证书。它将替换该密钥对中的现有公钥。为此，右击<em class="je"> wso2carbon </em>并点击<em class="je"> Import CA reply。选择从FreeSSL接收的CA签名证书。</em></p><p id="eb46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经成功地向<code class="du ls lt lu lk b">newuserstore.jks </code>密钥库中添加了一个CA签名的证书。双击WSO 2碳密钥对。它将显示公共证书的详细信息。上面写着这是由<strong class="ih hj">用户信任RSA认证机构</strong>签署的。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mx"><img src="../Images/e528568d7c63b899a832eeb2aef74f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7iZKFZg6AB94Dy9sF_NU9w.png"/></div></div></figure><p id="3b1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们将这个公共证书添加到WSO2身份服务器的信任存储中。首先，导出公共证书。再次右键单击wso2carbon密钥对。选择<em class="je">导出</em>-&gt;-<em class="je">导出证书链。</em>获取导出的<strong class="ih hj"> <em class="je"> x.509.cer </em> </strong>文件。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/06e8ae8b73b2118be9bf254da2d7aebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIB5tA8e8s4AA5sQRd_H2g.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es my"><img src="../Images/7b7aee79d998e4d416270a3b4ba78ea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RR5XoCs6SF3S1T86o6ZUqg.png"/></div></div></figure><h2 id="40eb" class="kq jt hi bd ju kr ks kt jy ku kv kw kc iq kx ky kg iu kz la kk iy lb lc ko ld bi translated">替换WSO2身份服务器密钥库</h2><p id="ee54" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">现在转到<code class="du ls lt lu lk b"><em class="je">&lt;IS_HOME&gt;/repository/resources/security/</em></code> <em class="je"> </em>你会看到下面的文件。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mz"><img src="../Images/52c8fc7cd9e9adfccccebc2949bc3ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBJRvBnkxO5bRHPk6wTucA.png"/></div></div></figure><p id="b257" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">移除<code class="du ls lt lu lk b"><em class="je">&lt;IS_HOME&gt;/repository/resources/security/wso2carbon.jks</em></code>文件并将<code class="du ls lt lu lk b"><em class="je">&lt;CA_KEYSTORE&gt;/newkeystore.jks</em> file there. Rename <em class="je">newkeystore.jks</em></code>复制为<em class="je"> wso2carbon.jks </em>。</p><p id="194b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用keytool GUI打开<code class="du ls lt lu lk b"><em class="je">&lt;IS_HOME&gt;/repository/resources/security/client-truststore.jks</em></code> <em class="je"> </em>，通过<em class="je">工具- &gt;导入可信证书，导入我们之前从<code class="du ls lt lu lk b"><em class="je">newkeystore.jks</em></code> <em class="je"> </em>导出的x.509公共证书。</em></p><p id="1d5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且还打开<code class="du ls lt lu lk b"><em class="je">&lt;IS_HOME&gt;/repository/conf/deployment.toml</em></code> <em class="je"> </em>文件并将<code class="du ls lt lu lk b"><em class="je">&lt;HostName&gt;</em></code> <em class="je"> </em>值更改为<em class="je"> maneeshatest39.tk. </em>，因为这将是WSO2身份服务器的主机名。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es na"><img src="../Images/844e3a7698f0030278837652d17ccac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G6aoRD4rfqXAxDTQYhtmJg.png"/></div></div></figure><p id="dd31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在一切都完成了，启动您的WSO2 IS实例(如果它已经在运行，您需要重启它)</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nb"><img src="../Images/230e54679eab7b8507c06a3d43258e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MxYdO9p_lHmq4UL382jvQ.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nc"><img src="../Images/e95b1d0d26ae2b3e0d8c5c857c3fd015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p6r9dvMx1dHAgNyjF4eKIQ.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nc"><img src="../Images/2bebfc0e9f90df46f6a50148410a3ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exO0zVFrmu2yAQVrHN4cuQ.png"/></div></div></figure><p id="c207" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们通过浏览器查看证书，它会显示我们现在有一个可信的证书。</p><p id="e4e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从<a class="ae jd" href="https://wso2.com/identity-and-access-management/" rel="noopener ugc nofollow" target="_blank">https://wso2.com/identity-and-access-management/</a>了解更多关于WSO2身份服务器的信息</p></div></div>    
</body>
</html>