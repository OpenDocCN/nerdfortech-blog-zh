<html>
<head>
<title>Building Cucumber BDD API Testing Framework from scratch: Part 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始构建黄瓜 BDD API 测试框架:第 5 部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/building-cucumber-bdd-api-testing-framework-from-scratch-part-5-c4e7445d4eec?source=collection_archive---------7-----------------------#2021-07-31">https://medium.com/nerd-for-tech/building-cucumber-bdd-api-testing-framework-from-scratch-part-5-c4e7445d4eec?source=collection_archive---------7-----------------------#2021-07-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/ebd1acbf3c69350e83b02cfebdbc1995.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*a16sAn-W-YYtoPZNO53xOA.jpeg"/></div></figure><p id="daff" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上一部分中，我们看到了如何动态驱动数据。在这一部分，我们将看到如何用多个数据集来参数化我们的测试。</p><p id="237b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">每当您构建一个自动化测试时，您应该使用多个数据集来测试它，以确保它是工作还是失败。</p><p id="c58a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们需要在<strong class="io hj"> <em class="jl">例子下再添加一行</em> </strong>关键字。</p><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jm"><img src="../Images/8c1ad394e9f3aedf0077cc45c85b9b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mtzegq0MypLOR3umY-eENA.png"/></div></div></figure><p id="53de" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，一般来说，当你想通过 excel 实现同样的事情时，你必须编写大量的代码来扫描每一行，从每一行中，它必须挑选数据并触发测试，但这不是黄瓜的情况。</p><p id="3775" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，如果您运行这个测试，它将自动使用两个不同的数据集运行两次。确保您更改了 ISBN 和过道信息，否则它会在控制台输出中抛出 404 错误。</p><p id="5bc7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们用 Test Runner 类来运行测试</p><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jv"><img src="../Images/ee15560859f82774962bd45e817ac021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPoFrKmYz2ecI_VZZ-Tj9g.png"/></div></div></figure><p id="95ac" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您还可以看到它给出了两个 id，因为我们从特征文件传递了两组信息。</p><p id="62b5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们看看日志文件中的测试用例细节。</p><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jw"><img src="../Images/6b6f0d123bc6ccaf774aba591bfc3750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qucru3DJJHHYyjjOPIb2WQ.png"/></div></div></figure><p id="6247" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如您所见，我们的日志文件只显示了一组数据的信息，它用<strong class="io hj"> <em class="jl">代替了</em> </strong>第二组数据信息。</p><p id="3ed8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了防止数据替换，我们需要在<strong class="io hj"> <em class="jl"> Utils 类</em> </strong>中提供<strong class="io hj"> <em class="jl"> if 条件</em> </strong>，我们也将所有信息记录在日志文件中。</p><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jx"><img src="../Images/e2e414f7b98403efe6457db65e85fe5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wGcdgNU5MqExOUBAKsY4sQ.png"/></div></div></figure><p id="979c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还要求将请求规范变量设为静态，这样它就不会创建另一个实例，而是在整个类中使用同一个实例，以防止在<strong class="io hj"> <em class="jl"> if 条件中出现空指针错误。</em> </strong></p><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jy"><img src="../Images/447a34d836573ff6b4dc869e2e8e79c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EA1oJ8d7kAXjrBoUce06Gw.png"/></div></div></figure><p id="4a4f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们再运行一次测试用例，检查日志文件中是否记录了所有内容。在您运行测试用例之前，确保更改了<strong class="io hj"> <em class="jl"> ISBN 和过道</em> </strong>信息。</p><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jz"><img src="../Images/4de44dcfe997d19b2aa82f285bb6c46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VDzzdW1CkJFsbyR2_SLjrg.png"/></div></div></figure><p id="0249" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面，我粘贴了日志文件和特征文件图像中的所有信息，以验证数据是否匹配。</p><pre class="jn jo jp jq fd ka kb kc kd aw ke bi"><span id="cb45" class="kf kg hi kb b fi kh ki l kj kk">Request method: POST</span><span id="d3de" class="kf kg hi kb b fi kl ki l kj kk">Request URI: http://216.10.245.166/Library/Addbook.php</span><span id="002c" class="kf kg hi kb b fi kl ki l kj kk">Proxy: &lt;none&gt;</span><span id="0027" class="kf kg hi kb b fi kl ki l kj kk">Request params: &lt;none&gt;</span><span id="22ac" class="kf kg hi kb b fi kl ki l kj kk">Query params: &lt;none&gt;</span><span id="eaec" class="kf kg hi kb b fi kl ki l kj kk">Form params: &lt;none&gt;</span><span id="e0ba" class="kf kg hi kb b fi kl ki l kj kk">Path params: &lt;none&gt;</span><span id="8f5d" class="kf kg hi kb b fi kl ki l kj kk">Headers: Accept=*/*</span><span id="67d6" class="kf kg hi kb b fi kl ki l kj kk">Content-Type=application/json</span><span id="c7fa" class="kf kg hi kb b fi kl ki l kj kk">Cookies: &lt;none&gt;</span><span id="802d" class="kf kg hi kb b fi kl ki l kj kk">Multiparts: &lt;none&gt;</span><span id="0096" class="kf kg hi kb b fi kl ki l kj kk">Body:</span><span id="13a1" class="kf kg hi kb b fi kl ki l kj kk">{</span><span id="362c" class="kf kg hi kb b fi kl ki l kj kk">“name”: “Geography”,</span><span id="da4c" class="kf kg hi kb b fi kl ki l kj kk">“isbn”: “pordf”,</span><span id="6334" class="kf kg hi kb b fi kl ki l kj kk">“aisle”: 2567,</span><span id="56f7" class="kf kg hi kb b fi kl ki l kj kk">“author”: “Prem”</span><span id="dc55" class="kf kg hi kb b fi kl ki l kj kk">}</span><span id="d844" class="kf kg hi kb b fi kl ki l kj kk">HTTP/1.1 200 OK</span><span id="33c1" class="kf kg hi kb b fi kl ki l kj kk">Date: Sat, 31 Jul 2021 18:47:02 GMT</span><span id="6fc7" class="kf kg hi kb b fi kl ki l kj kk">Server: Apache</span><span id="6f82" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Allow-Origin: *</span><span id="5ba3" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Allow-Methods: POST</span><span id="f463" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Max-Age: 3600</span><span id="64fa" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With</span><span id="ec9d" class="kf kg hi kb b fi kl ki l kj kk">Keep-Alive: timeout=5, max=100</span><span id="6836" class="kf kg hi kb b fi kl ki l kj kk">Connection: Keep-Alive</span><span id="ee3e" class="kf kg hi kb b fi kl ki l kj kk">Transfer-Encoding: chunked</span><span id="fd1f" class="kf kg hi kb b fi kl ki l kj kk">Content-Type: application/json;charset=UTF-8</span><span id="14d5" class="kf kg hi kb b fi kl ki l kj kk">{</span><span id="b31c" class="kf kg hi kb b fi kl ki l kj kk">“Msg”: “successfully added”,</span><span id="1146" class="kf kg hi kb b fi kl ki l kj kk">“ID”: “pordf2567”</span><span id="7bd9" class="kf kg hi kb b fi kl ki l kj kk">}</span><span id="f86a" class="kf kg hi kb b fi kl ki l kj kk">Request method: POST</span><span id="7d96" class="kf kg hi kb b fi kl ki l kj kk">Request URI: http://216.10.245.166/Library/Addbook.php</span><span id="16e2" class="kf kg hi kb b fi kl ki l kj kk">Proxy: &lt;none&gt;</span><span id="0c85" class="kf kg hi kb b fi kl ki l kj kk">Request params: &lt;none&gt;</span><span id="15ca" class="kf kg hi kb b fi kl ki l kj kk">Query params: &lt;none&gt;</span><span id="24f1" class="kf kg hi kb b fi kl ki l kj kk">Form params: &lt;none&gt;</span><span id="99c6" class="kf kg hi kb b fi kl ki l kj kk">Path params: &lt;none&gt;</span><span id="acc1" class="kf kg hi kb b fi kl ki l kj kk">Headers: Accept=*/*</span><span id="29a8" class="kf kg hi kb b fi kl ki l kj kk">Content-Type=application/json</span><span id="696a" class="kf kg hi kb b fi kl ki l kj kk">Cookies: &lt;none&gt;</span><span id="e6b2" class="kf kg hi kb b fi kl ki l kj kk">Multiparts: &lt;none&gt;</span><span id="129f" class="kf kg hi kb b fi kl ki l kj kk">Body:</span><span id="7a11" class="kf kg hi kb b fi kl ki l kj kk">{</span><span id="a5e2" class="kf kg hi kb b fi kl ki l kj kk">“name”: “Biology”,</span><span id="6e4a" class="kf kg hi kb b fi kl ki l kj kk">“isbn”: “strty”,</span><span id="6d1d" class="kf kg hi kb b fi kl ki l kj kk">“aisle”: 2389,</span><span id="afa2" class="kf kg hi kb b fi kl ki l kj kk">“author”: “Rahul”</span><span id="499d" class="kf kg hi kb b fi kl ki l kj kk">}</span><span id="c357" class="kf kg hi kb b fi kl ki l kj kk">HTTP/1.1 200 OK</span><span id="7b51" class="kf kg hi kb b fi kl ki l kj kk">Date: Sat, 31 Jul 2021 18:47:03 GMT</span><span id="a79e" class="kf kg hi kb b fi kl ki l kj kk">Server: Apache</span><span id="4967" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Allow-Origin: *</span><span id="6d0a" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Allow-Methods: POST</span><span id="58eb" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Max-Age: 3600</span><span id="fc45" class="kf kg hi kb b fi kl ki l kj kk">Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With</span><span id="470a" class="kf kg hi kb b fi kl ki l kj kk">Keep-Alive: timeout=5, max=100</span><span id="d965" class="kf kg hi kb b fi kl ki l kj kk">Connection: Keep-Alive</span><span id="5b10" class="kf kg hi kb b fi kl ki l kj kk">Transfer-Encoding: chunked</span><span id="50dd" class="kf kg hi kb b fi kl ki l kj kk">Content-Type: application/json;charset=UTF-8</span><span id="6fbc" class="kf kg hi kb b fi kl ki l kj kk">{</span><span id="bcec" class="kf kg hi kb b fi kl ki l kj kk">“Msg”: “successfully added”,</span><span id="c366" class="kf kg hi kb b fi kl ki l kj kk">“ID”: “strty2389”</span><span id="6d44" class="kf kg hi kb b fi kl ki l kj kk">}</span></pre><figure class="jn jo jp jq fd ij er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es km"><img src="../Images/4c2f3bcb7c63f85b8415cce026b53646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zCu32qzp0ZCBJyLcl2gMVg.png"/></div></div></figure><p id="f5ca" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在一切都在按预期工作。因此，我们已经通过优化<strong class="io hj"> <em class="jl"> Utils 类</em> </strong>中的代码修复了数据替换问题，同时，我们看到了如何使用多个数据集运行测试用例。</p><p id="14bf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">并且，<a class="ae jk" href="https://github.com/Premsing/LibraryAPIFramework" rel="noopener ugc nofollow" target="_blank"> <em class="jl">这里的</em> </a> <em class="jl">是到 GitHub 仓库下载代码的链接。</em></p><p id="42be" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>