<html>
<head>
<title>ElasticSearch (ELK) for database people</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向数据库人员的ElasticSearch (ELK)</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/elasticsearch-elk-for-database-people-e28ce5e77610?source=collection_archive---------3-----------------------#2021-09-23">https://medium.com/nerd-for-tech/elasticsearch-elk-for-database-people-e28ce5e77610?source=collection_archive---------3-----------------------#2021-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9a2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ElasticSearch是google针对企业的搜索。它是一个“数据库”，被拥有面向客户的应用程序的企业广泛使用，这些应用程序需要较短的响应时间来搜索<em class="jd">结构化</em>企业数据和<em class="jd">文本</em>数据。</p><p id="ec81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">其他数据库没有解决的问题<br/></strong>SQL和NoSQL数据库都需要特殊的设计考虑，以允许对它们保存的数据进行快速搜索。所有这些归结为两个解决方案:索引和分区。索引支持<em class="jd">大海捞针</em>类型的搜索。分区使<em class="jd">能够存储</em>以缩小搜索范围。许多产品允许以有趣的方式结合这两种技术。</p><p id="b3c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Amazon Redshift实现了一种叫做Zone Map的东西，在实现上有点类似于索引，但在逻辑上更接近于分区修剪。当请求搜索时，区域映射跳过所请求的记录不存在的数据库记录块。Redshift通过存储按区域映射列排序的记录来做到这一点，这使它能够跟踪每个数据库块上该列的上限和下限，然后可以用于跳过。</p><p id="4753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据库搜索—缺点和解决方法<br/> </strong>这些技术中的每一种，索引和分区，都有自己基于数据库产品的衍生物，但是所有这些都指向一个限制:<em class="jd">必须预先知道哪些列有更高的机会被搜索</em>。<em class="jd"> </em>在SQL和NoSQL系统中，数据库都是根据这些知识精心设计的。所以新的搜索标准需要设计上的改变，这有时是不可行的。</p><p id="dd51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些常用的解决方法可以缓解这种情况。一种方法是根据搜索列的需要创建尽可能多的索引。另一种类似的方法是根据需要创建尽可能多的表来进行窄搜索。第三种也是web应用中最主要的方法是将数据缓存到离应用服务器更近的地方(比如Coherence、内存扩展等产品)。).</p><p id="87c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这些解决方法的缺点是需要保持额外的数据结构同步，这会影响每个数据库写操作的响应时间。</p><p id="ba8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">elastic search<br/></strong>elastic search是一款无时无刻索引所有领域的产品。没有表或约束，只有索引。</p><p id="3e99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有一个应用程序需要搜索任意数量的字段，有大量的数据，甚至可能包含文本数据，ElasticSearch提供了一个很好的解决方案。</p><p id="aae3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，弹性搜索就是这样——一种弹性的搜索方式。我们期望从数据库中得到的与事务一致性或数据完整性相关的所有其他东西都不存在。通常提供搜索的web应用程序有两个数据库系统，一个(或多个)用于应用程序的数据，另一个是ElasticSearch数据库。一个Logstash过程保持ElasticSearch中的数据与主数据库同步。</p><p id="83fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个简单的搜索示例是，当用户键入城市名称的前几个字母时，UI会自动填充以这些字符开头的潜在城市列表。该应用程序使用ElasticSearch来完成这项工作。所有其他数据请求都发送到主数据库。</p><p id="4e89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">麋栈</strong> <br/>麋栈由</p><ul class=""><li id="c57b" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">ElasticSearch服务器将数据记录(文档)保存在索引中，以便应用程序可以通过http请求进行搜索(非HTTP请求也可以通过ElasticSearch开发的专有二进制协议来支持)</li><li id="23c4" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">LogStash是一个用于es的ETL接口，它从MySQL等外部数据源获取数据，并在ES上执行CRUD操作</li><li id="7282" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">Kibana是一个可视化工具，让您可以在ES上查询和执行手动或临时的CRUD操作。</li></ul><p id="10ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AWS ElasticSearch(现在的OpenSearch)自带es和Kibana。您必须在另一个服务器(EC2或其他地方)上单独安装LogStash，或者使用AWS Lambda进行自动加载。</p><p id="7af6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">示例ES查询运行于Kibana</strong><br/>GET _ search<br/>{<br/>" query ":{<br/>" match ":{<br/>" first _ name ":" Tom "<br/>}<br/>}<br/>}</p><p id="673d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">示例log stash config</strong><br/><strong class="ih hj">input</strong>{<br/>JDBC {<br/>JDBC _ connection _ string =&gt;" JDBC:MySQL://1189-webservr-Drupal-01 . mince . com:3306/rsys？use SSL = false "<br/>JDBC _ user =&gt;" test "<br/>JDBC _ password =&gt;" E！test @ "<br/>JDBC _ driver _ library =&gt;"/usr/share/log stash/driver/MySQL-connector-Java-5 . 1 . 42-bin . jar "<br/>JDBC _ driver _ class =&gt;" com . MySQL . JDBC . driver "<br/>schedule =&gt;* * * * * * "<br/>statement =&gt;" SELECT * FROM city WHERE updated _ at&gt;:SQL _ last _ value "<br/>tracking _ at</p><p id="14ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出</strong> {</p><p id="899f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">if[type]= = " city " {<br/>elastic search {<br/>user =&gt;" estest "<br/>password =&gt;" test %&amp;es "<br/>hosts =&gt;" elastic search:9200 "<br/>index =&gt;" cities "<br/>document _ type =&gt;" document "<br/>document _ id =&gt;" " { rx _ ipid }。</p><p id="270f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">输入</em>配置指定从哪里读取，读取什么记录等。<em class="jd">输出</em>配置有输出设置，即写入ES。这个配置文件可以在ES install的主文件夹中用任何文件名(例如:config.txt)创建，例如/etc/logstash/bin/config.txt。它通常是ElasticSearch中“代码”的内容，是应用程序代码管道的一部分。</p></div></div>    
</body>
</html>