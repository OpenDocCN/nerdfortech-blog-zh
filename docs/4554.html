<html>
<head>
<title>Making Video Calls Using Vonage Video and Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Vonage Video和Flutter进行视频通话</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/making-video-calls-using-vonage-video-and-flutter-9bcda59249e7?source=collection_archive---------7-----------------------#2021-07-26">https://medium.com/nerd-for-tech/making-video-calls-using-vonage-video-and-flutter-9bcda59249e7?source=collection_archive---------7-----------------------#2021-07-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/339628c2eb272247c8bed6099866d7f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*63ZrESb7T_meIRgtn9Gyng.png"/></div></div></figure><p id="4c0b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Flutter越来越受欢迎，所以我们决定构建一个简单的应用程序，允许在两个设备之间进行视频通话。用于构建该应用的两项技术是Flutter和Vonage视频SDK。让我们快速回顾一下这些技术:</p><ul class=""><li id="9724" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae jx" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a> —开源UI软件开发套件，用于开发Android、iOS、Linux、Mac的跨平台应用。主要的编程语言是<a class="ae jx" href="https://dart.dev/" rel="noopener ugc nofollow" target="_blank"> Dart </a>。</li><li id="6fc8" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae jx" href="https://tokbox.com/developer/sdks/android/" rel="noopener ugc nofollow" target="_blank"> Vonage Video </a> —用于在各种设备之间建立视频通话。使用的编程语言是Android平台的<a class="ae jx" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>和iOS平台的<a class="ae jx" href="https://www.swift.com/" rel="noopener ugc nofollow" target="_blank"> Swift </a>。</li></ul><p id="dbc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这款应用相当于基本视频聊天应用(<a class="ae jx" href="https://github.com/opentok/opentok-android-sdk-samples/tree/main/Basic-Video-Chat" rel="noopener ugc nofollow" target="_blank">基本视频聊天Android </a> / <a class="ae jx" href="https://github.com/opentok/opentok-ios-sdk-samples/tree/main/Basic-Video-Chat" rel="noopener ugc nofollow" target="_blank">基本视频聊天iOS </a>)。以下是该应用程序的主要功能:</p><ul class=""><li id="2b4d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">连接到Vonage视频会话</li><li id="d8a2" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">向会话发布音频-视频流</li><li id="d092" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">订阅另一个客户端的音频-视频流</li></ul><blockquote class="kd ke kf"><p id="ab94" class="iq ir kg is b it iu iv iw ix iy iz ja kh jc jd je ki jg jh ji kj jk jl jm jn hb bi translated">注意:应用程序源代码可在<a class="ae jx" href="https://github.com/opentok/opentok-flutter-basic-video-chat" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p></blockquote><p id="4e4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">颤振是这里的主要技术。它是用于构建运行在Android和iOS上的移动应用程序的基础。它将负责管理和显示UI，并且包含应用程序逻辑。这样，应用程序逻辑只需为两个平台编写一次。</p><p id="41a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在引擎盖下，这个Flutter应用程序将使用<a class="ae jx" href="https://tokbox.com/developer/sdks/android/" rel="noopener ugc nofollow" target="_blank"> Android Vonage视频SDK </a>和<a class="ae jx" href="https://tokbox.com/developer/sdks/ios/" rel="noopener ugc nofollow" target="_blank"> iOS Vonage视频SDK </a>(通过Android/iOS原生项目):</p><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/c6af03bdb57646d822688314ec574d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8244jCMpG4rRNRgzDJoc5g.png"/></div></div></figure><p id="abe8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">平台(Android，iOS)本机代码通过使用Flutter <a class="ae jx" href="https://api.flutter.dev/flutter/services/MethodChannel-class.html" rel="noopener ugc nofollow" target="_blank">方法通道</a>与Flutter通信，该方法通道使用方法调用。MethodChannel作为Flutter和原生代码之间发送消息的桥梁(加入原生Android项目和原生iOS项目)。这允许我们登录用户并设置视频会话以进行视频通话:</p><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/de39bb6af2b6cafd14c4c642cc03a3b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X95hjst44p7ZDBCC01ZbIA.png"/></div></div></figure><p id="9077" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Flutter可以向应用程序的本机(Android / iOS)部分发送消息，应用程序的本机部分可以向Flutter发回消息。Flutter调用<code class="du kp kq kr ks b">initSession</code>方法，并将<code class="du kp kq kr ks b">apiKey</code>、<code class="du kp kq kr ks b">sessionId</code>和<code class="du kp kq kr ks b">token</code>传递给本地代码，以启动Vonage视频会话。本机代码将通知应用程序的Flutter部分成功登录(或出错)，Flutter端代码将更新UI。</p><blockquote class="kd ke kf"><p id="e4ec" class="iq ir kg is b it iu iv iw ix iy iz ja kh jc jd je ki jg jh ji kj jk jl jm jn hb bi translated">注意:Flutter应用程序可以打包成Android或iOS应用程序，但不能同时打包成两种应用程序。当目标平台设置为Android时，MethodChannel与Android原生应用程序代码进行通信。当目标平台设置为iOS时，MethodChannel与iOS原生应用程序代码进行通信。</p></blockquote><p id="129e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要运行<a class="ae jx" href="https://github.com/opentok/opentok-flutter-basic-video-chat" rel="noopener ugc nofollow" target="_blank">应用程序</a>，你必须安装Flutter。这因平台而异，你可以在<a class="ae jx" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank">详细说明</a>中看到。</p><blockquote class="kd ke kf"><p id="1674" class="iq ir kg is b it iu iv iw ix iy iz ja kh jc jd je ki jg jh ji kj jk jl jm jn hb bi translated">注意:确保运行<code class="du kp kq kr ks b">flutter doctor</code>来验证你的本地颤振设置。</p></blockquote><p id="08df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要登录Vonage视频会话，您需要一个<a class="ae jx" href="https://tokbox.com/account/#/" rel="noopener ugc nofollow" target="_blank"> Vonage视频帐户</a>，并生成<code class="du kp kq kr ks b">initSession</code>、<code class="du kp kq kr ks b">apiKey</code>和<code class="du kp kq kr ks b">sessionId</code>。您可以在<a class="ae jx" href="https://tokbox.com/account/#/" rel="noopener ugc nofollow" target="_blank"> Vonage视频仪表盘</a>中获取这些值。现在打开<code class="du kp kq kr ks b">main.dart</code>文件，并在相应的变量中使用这些值:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kt ku l"/></div></figure><p id="2e14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动手机应用程序开始视频通话。</p><blockquote class="kd ke kf"><p id="d892" class="iq ir kg is b it iu iv iw ix iy iz ja kh jc jd je ki jg jh ji kj jk jl jm jn hb bi translated">注意:您可以使用<a class="ae jx" href="https://tokbox.com/developer/tools/playground/" rel="noopener ugc nofollow" target="_blank"> Developer playground </a>连接到运行Flutter应用程序的移动设备的同一个会话。</p></blockquote><h1 id="c1ff" class="kv kw hi bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">摘要</h1><p id="51ee" class="pw-post-body-paragraph iq ir hi is b it lt iv iw ix lu iz ja jb lv jd je jf lw jh ji jj lx jl jm jn hb bi translated">还有几个<a class="ae jx" href="https://github.com/opentok/opentok-flutter-basic-video-chat#known-issues" rel="noopener ugc nofollow" target="_blank">弊端</a>，但是旋舞和Vonage视频的整体整合还是比较流畅的。即使没有原生的Flutter包，也可以快速创建一个完全成熟的Flutter应用程序，该应用程序在引擎盖下利用Vonage视频移动SDK，并在Android和iOS设备上运行。</p></div><div class="ab cl ly lz gp ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="hb hc hd he hf"><p id="0304" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kg">原载于</em><a class="ae jx" href="https://learn.vonage.com/blog/2021/07/06/making-video-calls-using-vonage-video-and-flutter/" rel="noopener ugc nofollow" target="_blank"><em class="kg">https://learn . vonage . com/blog/2021/07/06/making-video-calls-using-vonage-video-and-flutter/</em></a></p></div></div>    
</body>
</html>