<html>
<head>
<title>Understanding Consistency</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解一致性</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/understanding-consistency-37156d9f4608?source=collection_archive---------6-----------------------#2021-03-29">https://medium.com/nerd-for-tech/understanding-consistency-37156d9f4608?source=collection_archive---------6-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="82f3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">什么是一致性？</h1><p id="c4d9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">一致性是指不能写入违反有效数据规则的数据。如果某个操作试图引入不一致的数据，则整个操作会回滚并向用户返回一个错误，一致性有多种类型，如强一致性和最终一致性</p><h1 id="2508" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">什么是强一致性？</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/ddda1e093b7f9214572e6d478599580d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mi0_Wc2kyAe01C9yzajfYA.jpeg"/></div></div></figure><p id="ff5a" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">强一致性简单地说就是一旦一个写请求到达数据库的一个副本，数据将被传递到所有副本，以使世界上的所有节点都应该包含相同的值<br/>,实现这种行为的唯一方法是在更新时锁定节点，就像在关系数据库中一样。</p><p id="0f04" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">例如，想象你去自动取款机，从你的账户上取一些钱，然后你取了钱，检查你的账户余额，看到取款成功地从你的账户上扣除</p><p id="1032" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">在我们的案例中，我们看到:</p><ul class=""><li id="650d" class="ks kt hi jf b jg kn jk ko jo ku js kv jw kw ka kx ky kz la bi translated">自动取款机被堵住了，告诉我们拿钱和收据</li><li id="8a8c" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">钱立即被扣除</li></ul><h1 id="bc3e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">什么是最终的一致性？</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lg"><img src="../Images/96211ba90e04cff86d4d9120142eb699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*tBnltlWmMLIAvy1rvS06qg.png"/></div></figure><p id="4987" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">最终一致性确保数据库中每个节点的数据始终保持一致。数据库的节点获得一致性所花费的时间可以像在非关系数据库中那样定义，也可以不定义。</p><p id="066d" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">例如，假设你去一家商店订购了两种产品。收银员接受你的订单，你付款，然后等着订单准备好</p><p id="e790" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">当你走到下一个窗口等待拿起你的订单准备好</p><p id="a0d2" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">在我们的案例中，我们看到:</p><ul class=""><li id="54c9" class="ks kt hi jf b jg kn jk ko jo ku js kv jw kw ka kx ky kz la bi translated">收银员可以接受您的订单，并给您一张交易收据</li><li id="4b90" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">你可以保证你最终会<em class="lh"/>拿到你的订单，但是你不知道确切的时间</li></ul><h1 id="931a" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据库系统的一致性</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es li"><img src="../Images/db0e19eec136617bfbf51d43a1086ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-QDfvZT5TKX4zlhZk7pK5Q.png"/></div></div></figure><p id="6378" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">在数据库系统中，一致性确保数据库状态在任何事务发生后都有效，维护数据库不变量:根据所有定义的规则，包括约束、级联、触发器及其任何组合，写入数据库的任何数据都必须有效。</p><p id="10db" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">关系数据库具有<strong class="jf hj"> ACID </strong>属性，这种属性旨在保证数据的有效性，即使出现错误、断电和其他灾难，也能确保强一致性</p><p id="1923" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">NoSQL数据库有<strong class="jf hj">基础</strong>,数据库试图平衡一致性和数据可用性，而不是做出酸性保证。当给定数据库群集中的节点充当数据库一部分的主管理器，而其他节点持有只读副本时，通常会出现这种情况。</p><h1 id="74f6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">与CAP定理的一致性</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lj"><img src="../Images/a72d16551520378b3a612a04cd290d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*cQKxbXly2Twd9qW8Vt0X0w.jpeg"/></div></figure><p id="eb74" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">CAP有时表现为一致性、可用性、分区容差三选二。</p><p id="ffb3" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">不幸的是，这样说是有误导性的，因为网络分区是一种错误，所以它们不是你可以选择的事情:不管你喜欢与否，它们都会发生。当网络正常工作时，系统可以提供一致性和可用性。</p><p id="69b4" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">但是如果网络不能正常工作，你应该设计你的系统有一定程度的一致性(强，弱，最终，等等..)而你的选择会影响可用性</p><h1 id="8fe7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">分布式系统中的一致性</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lk"><img src="../Images/119b65dc1b43fa40d24b25026e7ce902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lS9C295gVQF2ZZ8qx8__1Q.png"/></div></div></figure><p id="2ccc" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">分布式系统通常具有提供读写的多节点，以确保高可用性和可扩展性，但这可能会带来一些问题:</p><ul class=""><li id="02e6" class="ks kt hi jf b jg kn jk ko jo ku js kv jw kw ka kx ky kz la bi translated">消息异步(asynchronous):真实的网络不是一个可靠的通道，存在消息延迟或丢失</li><li id="8232" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">节点故障停止:节点继续崩溃，并且不会恢复</li><li id="5c63" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">节点故障恢复(一段时间后的节点恢复，在分布式系统中最常见</li><li id="4bd6" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">网络分区:网络链接有问题，将N个节点分成多个部分</li></ul><p id="4451" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">因此，大多数试图确保一致性的分布式系统最终使用(2pc、3pc、sages等)</p><h1 id="bdfa" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="b857" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这篇文章的最后，是一些阅读和获取更多知识的资源</p><ul class=""><li id="8a53" class="ks kt hi jf b jg kn jk ko jo ku js kv jw kw ka kx ky kz la bi translated"><a class="ae ll" href="https://en.wikipedia.org/wiki/ACID" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">阿西德</strong> </a></li><li id="3642" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae ll" href="https://en.wikipedia.org/wiki/Consistency_(database_systems)#:~:text=Consistency%20in%20database%20systems%20refers,triggers%2C%20and%20any%20combination%20thereof." rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">一致性(数据库系统)</strong> </a></li><li id="9016" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae ll" href="https://en.wikipedia.org/wiki/Consistency_model" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">一致性_模型</strong> </a></li><li id="cc5e" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">E <a class="ae ll" href="https://link.springer.com/referenceworkentry/10.1007%2F978-0-387-39940-9_1366" rel="noopener ugc nofollow" target="_blank">库存一致性</a></li></ul></div></div>    
</body>
</html>