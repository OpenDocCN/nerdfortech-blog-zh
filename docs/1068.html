<html>
<head>
<title>Optimistic UI with React and Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有 React 和 Redux 的乐观用户界面</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/optimistic-ui-with-react-and-redux-c6fbcf320571?source=collection_archive---------4-----------------------#2021-03-03">https://medium.com/nerd-for-tech/optimistic-ui-with-react-and-redux-c6fbcf320571?source=collection_archive---------4-----------------------#2021-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="2de4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">经典的方式</h1><p id="d99d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">当您学习如何使用 Redux 执行异步操作时，这是它通常的工作方式。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/fd0377c6788da5e7976f8b1802f8436f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1fErlSu3aVCcwHci.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">Redux Thunk/Saga 经典工作流程</figcaption></figure><p id="edf1" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">用户与触发<strong class="jf hj"> <em class="kw">假动作</em> </strong>的 UI 交互，假动作不更新存储，它充当针对服务器的某种异步操作的<strong class="jf hj">发起者</strong>，如果操作成功，我们<em class="kw">更新存储以反映这种成功</em>，相反，如果操作失败，我们<em class="kw">显示错误，如果需要，我们更新存储以反映错误</em>。</p><p id="b323" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">与此同时，用户会盯着一些微调器或加载指示器，直到整个操作完成或失败，UI 才会反映出任何其他变化，当通过 2G 或 3G 网络连接时，或者当服务器忙于执行另一项任务时，这可能需要很长时间。</p><p id="cacb" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">作为用户，我们知道在使用移动应用程序或网站时，查看加载指示器并不有趣，也不是一种有趣的体验。</p><h1 id="e0d6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">具有 Redux 的经典异步流</h1><p id="1de3" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这就是我们在典型的计数器 reducer 示例中处理异步操作的方式。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kx"><img src="../Images/2ebfc4e574f6dd7c5bd04b4fb0251ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*CSTJXjA0-5w4hZPNVtR4bQ.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">使用 Redux Thunk</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ky"><img src="../Images/93f94fe76253645478b51109c782435f.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*azwdDvjMldIeGkgEs843Yg.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">使用 Redux Saga</figcaption></figure><p id="b26b" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">如您所见，用户需要等待异步操作完成，然后才能注意到 UI 中的变化。我们可以说这种方法是一种悲观的方法，因为 UI 并不认为操作会成功，而是会等到确定操作成功完成或失败后再更改 UI。</p><h1 id="3b67" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">乐观 UI </strong></h1><p id="26b7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">乐观 UI 的概念来自于 UI 显示对用户操作的即时响应，好像它知道操作将会成功，并且在失败的情况下，它将恢复其状态并通知用户操作失败。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kz"><img src="../Images/549df05ee124a09339dd83cf0b45955c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kOMc1hcYZl5xm1eU.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">脸书喜欢使用乐观的用户界面</figcaption></figure><p id="85aa" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">多年来，我们一直在不知不觉中使用实现这些功能的应用程序，其中最受欢迎的一个例子是脸书像按钮计数器。当你按下脸书应用程序中的 like 按钮时，即使在 2G 网络中，计数器也会立即上升，这让你觉得应用程序超级快，给用户带来了很好的体验，而不是盯着旋转器或加载指示器，直到 Like 到达脸书的服务器。</p><h1 id="e468" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">处理失败</h1><p id="fa26" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">实现乐观 UI 所需的特性之一是能够处理底层异步操作的失败。这个想法是<strong class="jf hj"> <em class="kw">恢复一个被分派的</em> </strong>动作，并让 UI 进入<strong class="jf hj">有效状态</strong>，就像操作从未存在过一样，同时通知用户失败(并可能给出重试的选项)。</p><p id="8c34" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">这就是如何使用 Thunk 或 Saga 实现<em class="kw">乐观计数器</em></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kx"><img src="../Images/f061bd71a815729c0e73440faa78abab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*zBqy3IhVncVmreIaiEL79A.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">乐观计数器 Thunk</figcaption></figure><p id="e9a2" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">如前所述，如果对服务器的调用失败，我们<strong class="jf hj">会调度减量</strong>操作，将状态恢复到乐观更新之前的状态。这种方法适用于简单的情况，但是在我们的 reducer 中为每个动作创建一个相反的动作在编程上不是很有效。理想的场景应该是能够撤销一个特定的动作，而不依赖于另一个具有明显相反效果的动作。</p><h2 id="3324" class="la ig hi bd ih lb lc ld il le lf lg ip jo lh li it js lj lk ix jw ll lm jb ln bi translated">撤消操作</h2><p id="8e06" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了能够撤销一个特定的动作，而不是必须分派一个具有相反效果的动作，我们将使用<a class="ae lo" href="https://www.npmjs.com/package/redux-undo-action" rel="noopener ugc nofollow" target="_blank"> redux-undo-action </a>包。</p><blockquote class="lp lq lr"><p id="72d9" class="jd je kw jf b jg kr ji jj jk ks jm jn ls kt jq jr lt ku ju jv lu kv jy jz ka hb bi translated">npm i 还原-撤消-操作</p></blockquote><p id="03ea" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">现在我们需要用<em class="kw">可撤销的缩减增强器</em>来包装我们的顶级缩减器。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lv"><img src="../Images/5dce6fd7801c5c802b62ce4887e1a88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*5e8XOfkddWPZdsIbfcx66g.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">使用可撤销的增强器包装顶级缩减器</figcaption></figure><p id="3d16" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">现在，我们可以撤销发送到我们商店的任何操作。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kx"><img src="../Images/4d42b93e16d69df88112131249ba973d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*_-3pap-8HCyYfH2Av6-Mag.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">可撤销操作 Thunk</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lw"><img src="../Images/0da8698cd69f75274d2e1be4ff7ff708.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*LkMVERiW-ghhUGHbtSdzKA.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">不可撤销的动作传奇</figcaption></figure><p id="87bd" class="pw-post-body-paragraph jd je hi jf b jg kr ji jj jk ks jm jn jo kt jq jr js ku ju jv jw kv jy jz ka hb bi translated">现在我们<strong class="jf hj">不再需要分派减量动作</strong>，因为我们的存储知道如何撤销增量。</p><h1 id="554a" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="e8ef" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Optimisitc UI 技术提供了改进的用户体验，这在高延迟或低速网络中非常明显，应该考虑用于每个应用程序，尤其是移动优先的网站或移动应用程序。<br/>有了 Redux，这种 UI 模式实现起来非常简单明了，将大大提高用户的参与度，以及我们在使用应用程序时都喜欢的<strong class="jf hj">快速响应</strong>的整体感觉。</p></div></div>    
</body>
</html>