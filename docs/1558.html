<html>
<head>
<title>How to Get Macro Info from a DOCX File in PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在PHP中从DOCX文件中获取宏信息</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-get-macro-info-from-a-docx-file-in-php-3ad18f49eee8?source=collection_archive---------15-----------------------#2021-03-25">https://medium.com/nerd-for-tech/how-to-get-macro-info-from-a-docx-file-in-php-3ad18f49eee8?source=collection_archive---------15-----------------------#2021-03-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c3ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">宏本质上是可以构建到应用程序或文档中的代码，可以自动执行重复的任务，有助于提高生产率和简化流程。宏的唯一缺点之一是，如果不是您自己构建的，它们会带来安全风险。利用PHP中的以下API，您可以检索关于DOCX文件中定义的宏的信息，使您能够评估文件的安全性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f1eef823b68d09a3b0a841d529dca120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HiS7bvZYyAGJMewpJvocrw.jpeg"/></div></div></figure><p id="106d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要使用API，首先运行以下命令来安装SDK:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="0545" class="ju jv hi jq b fi jw jx l jy jz">composer require cloudmersive/cloudmersive_document_convert_api_client</span></pre><p id="1028" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装完成后，我们就可以调用get宏函数了:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="1d93" class="ju jv hi jq b fi jw jx l jy jz">&lt;?php<br/>require_once(__DIR__ . '/vendor/autoload.php');</span><span id="d9d4" class="ju jv hi jq b fi ka jx l jy jz">// Configure API key authorization: Apikey<br/>$config = Swagger\Client\Configuration::getDefaultConfiguration()-&gt;setApiKey('Apikey', 'YOUR_API_KEY');</span><span id="4e52" class="ju jv hi jq b fi ka jx l jy jz">$apiInstance = new Swagger\Client\Api\EditDocumentApi(<br/>    <br/>    new GuzzleHttp\Client(),<br/>    $config<br/>);<br/>$input_file = "/path/to/inputfile"; // \SplFileObject | Input file to perform the operation on.</span><span id="8da6" class="ju jv hi jq b fi ka jx l jy jz">try {<br/>    $result = $apiInstance-&gt;editDocumentDocxGetMacroInformation($input_file);<br/>    print_r($result);<br/>} catch (Exception $e) {<br/>    echo 'Exception when calling EditDocumentApi-&gt;editDocumentDocxGetMacroInformation: ', $e-&gt;getMessage(), PHP_EOL;<br/>}<br/>?&gt;</span></pre><p id="dc52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果操作成功运行，您将获得Word文档中任何已识别宏的信息。</p></div></div>    
</body>
</html>