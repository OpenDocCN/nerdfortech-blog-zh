<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/lvm-logical-volume-manager-f7c73c3444a3?source=collection_archive---------20-----------------------#2021-03-14">https://medium.com/nerd-for-tech/lvm-logical-volume-manager-f7c73c3444a3?source=collection_archive---------20-----------------------#2021-03-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/1c28a205ef0daf1d3018621ad391d4e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*c3QFrFhcKxC4pjjq5s2GHg.jpeg"/></div></figure></div><div class="ab cl hn ho gp hp" role="separator"><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs"/></div><div class="hb hc hd he hf"><h1 id="7ae5" class="hu hv hw bd hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is bi translated">将Hadoop与LVM集成</h1><p id="6e6d" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">朋友们好，我又回到了另一篇博客。在这篇博客中，我们讨论了Hadoop、LVM和弹性存储，如增加、减少和合并存储设备，以及相同的LVM，即与LVM的集成。</p><p id="0822" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated">在开始实践之前，让我们讨论一些基本词汇。</p><h1 id="dc66" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">Hadoop是什么？</h1><p id="a243" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi kb translated">pache Hadoop是一个软件，它是一个开源软件实用程序的集合，有助于使用许多计算机的网络来解决涉及大量数据和计算的问题。它使用MapReduce编程模型为大数据的分布式存储和处理提供了一个软件框架。</p><p id="4f16" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated">在Linux中，逻辑卷管理器是一个设备映射器框架，为Linux内核提供逻辑卷管理。大多数现代Linux发行版都支持LVM，能够将它们的根文件系统放在一个逻辑卷上。在这种情况下，我们可以扩展两个存储设备，增加和减少大小，这是主要优势。</p><p id="d252" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">点击图片了解</strong> <a class="ae kl" href="https://vinodhakumara2681997.medium.com/automating-hadoop-using-ansible-e50b48f5303c" rel="noopener"> <strong class="iv kk"> Hadoop </strong> </a></p><figure class="kn ko kp kq fd hk er es paragraph-image"><a href="https://vinodhakumara2681997.medium.com/automating-hadoop-using-ansible-e50b48f5303c"><div class="er es km"><img src="../Images/cef80b9e3ae4a4c6c501a4bfd95e5b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*s0dsO33N551Tt-63-w-sew.png"/></div></a></figure><h1 id="222a" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">什么是LVM？</h1><p id="9dde" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在Linux中，逻辑卷管理器是一个设备映射器框架，为Linux内核提供逻辑卷管理。大多数现代Linux分布式文件系统都支持LVM，能够将它们的根文件系统放在一个逻辑卷上。在这种情况下，我们可以扩展两个存储设备，增加和减少大小，这是主要优势。</p><p id="b19f" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">点击图片了解</strong> <a class="ae kl" href="https://vinodhakumara2681997.medium.com/lvm-logical-volume-manager-173938ab4724" rel="noopener"> <strong class="iv kk"> LVM </strong> </a></p><figure class="kn ko kp kq fd hk er es paragraph-image"><a href="https://vinodhakumara2681997.medium.com/lvm-logical-volume-manager-173938ab4724"><div class="er es kr"><img src="../Images/c6408fdcacb31675d9e219757833b91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*5PBbTy-SSZJLnm1hWtYIXQ.png"/></div></a></figure><h1 id="0539" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">hadoop的弹性存储是什么？</h1><p id="6528" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">存储将是灵活的，我们可以增加、减少和合并存储到一个数据节点。这使得我们可以轻松维护灵活/弹性存储。</p></div><div class="ab cl hn ho gp hp" role="separator"><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs"/></div><div class="hb hc hd he hf"><blockquote class="ks"><p id="30c4" class="kt ku hw bd kv kw kx ky kz la lb jq dx translated">让我们开始实际工作吧</p></blockquote><h1 id="c8e1" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig lc ii ij ik ld im in io le iq ir is bi translated">创建HDFS Hadoop集群:</h1><p id="fcd7" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv kk">点击此图片设置</strong> <a class="ae kl" href="https://vinodhakumara2681997.medium.com/automating-hadoop-using-ansible-e50b48f5303c" rel="noopener"> <strong class="iv kk"> Hadoop集群</strong> </a></p><figure class="kn ko kp kq fd hk er es paragraph-image"><a href="https://vinodhakumara2681997.medium.com/automating-hadoop-using-ansible-e50b48f5303c"><div class="er es lf"><img src="../Images/ef6d948718690b15c345a63ced0c55fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*atB4OkTXMKGmMReQ.png"/></div></a></figure><h1 id="ff79" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">Hadoop集群</h1><p id="00cd" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">我已经建立了一个Hadoop集群，你们可以通过点击这个来完成</p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lg"><img src="../Images/ffefe847c5b4782e775c1c038768ce07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IAtTCWDORUhV1sRRezYSBw.gif"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">Hadoop集群</figcaption></figure><blockquote class="lp lq lr"><p id="e849" class="it iu ls iv b iw jr iy iz ja js jc jd lt jt jg jh lu ju jk jl lv jv jo jp jq hb bi translated">在Hadoop集群设置之后，如果一切正常，我们就可以开始与LVM合作了</p></blockquote><h1 id="e6b6" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">创建一个LVM</h1><p id="5b24" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">向我的虚拟机添加两个存储设备</p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lg"><img src="../Images/b87caaca46d1ba8f28e75e98175134eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BWBTI90VqZXZOE1TWyf_ng.gif"/></div></div></figure><h2 id="4f79" class="lw hv hw bd hx lx ly lz ib ma mb mc if je md me ij ji mf mg in jm mh mi ir mj bi translated">在创建LVM之前，我们可以看到未装载的新设备。</h2><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="9b50" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; df -Th</span></pre><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mt"><img src="../Images/209da18965fb5bd6618ac76af1f593dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fuBYOEbwhMj5B_3uYz_qig.png"/></div></div></figure><h1 id="679c" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated"><strong class="ak">创建PV、卷组和逻辑卷</strong></h1><p id="6954" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><strong class="iv kk">创建了两个物理卷</strong></p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="b922" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; pvcreate /dev/sdh<br/>&gt;&gt; pvcreate /dev/sdi</span></pre><p id="81a9" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">创建卷组</strong></p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="f093" class="lw hv hw ml b fi mp mq l mr ms">vgcreate hadoopLVM /dev/sdh /dev/sdi</span></pre><p id="878b" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">创建逻辑卷</strong></p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="0b25" class="lw hv hw ml b fi mp mq l mr ms">lvcreate --size 40G --name hadoopLV hadoopLVM</span></pre><p id="e24a" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">显示逻辑卷</strong></p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mu"><img src="../Images/3848c2fd89f9dab77daca91657b7d49a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*epaDNxqlMW0c_rZjMIIbzA.png"/></div></div></figure><p id="85e3" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">使用</strong>命令格式化存储</p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="b219" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; mkfs.ext4 /dev/hadoopLVM/hadoopLV</span></pre><p id="49e7" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">挂载到数据节点存储目录</strong></p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="c8bd" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; mount /dev/hadoopLVM/hadoopLV  /datanode/</span></pre><p id="60ec" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">显示下面的存储安装，我们可以看到安装了35G</strong></p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mt"><img src="../Images/3922458920b9dcad38a0d39589606a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XR7PPVYB4BySiookTDofFw.png"/></div></div></figure><p id="8bc0" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk">Datanode的存储</strong></p><p id="7bcb" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated">datanode下面有着35GiB</p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mv"><img src="../Images/79d06422c51cc0ebdf775faac75cb6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AJ1k1J1_jqF3hMGc49fV4w.png"/></div></div></figure></div><div class="ab cl hn ho gp hp" role="separator"><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs"/></div><div class="hb hc hd he hf"><h1 id="9561" class="hu hv hw bd hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is bi translated">增加Datanode大小</h1><p id="339b" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在这里，我们可以看到存储从35GiB增加到50Gib</p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="0d6e" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; lvextend --size +&lt;Size_to_increase&gt;G /dev/&lt;group_name&gt;/&lt;LV_name&gt;<br/>&gt;&gt; resize2fs /dev/&lt;group_name&gt;/&lt;LV_name&gt;</span></pre><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mt"><img src="../Images/808f684ca467636a3992b955a99e52db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sOp4yfwsoWANxbj5.png"/></div></div></figure><p id="4ab6" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk"> Hadoop数据节点Stora </strong> ge</p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mv"><img src="../Images/332f752d2473606124f1562e5b556303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GsUVFlQ1_JZUIybaa3vq_A.png"/></div></div></figure></div><div class="ab cl hn ho gp hp" role="separator"><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs ht"/><span class="hq bw bk hr hs"/></div><div class="hb hc hd he hf"><h1 id="1f25" class="hu hv hw bd hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is bi translated">减小逻辑卷的大小</h1><p id="a1d3" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated">在减少之前，请确保您的存储已卸载</p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="18c3" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; umount &lt;mounted_path&gt;</span></pre><p id="cd91" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated">从元数据中移除</p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="fa33" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; e2fsck  -f /dev/&lt;group_name&gt;/&lt;LV_name&gt;</span></pre><p id="d357" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated">仅重新格式化缩减的数据</p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="6f55" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; resize2fs /dev/&lt;group_name&gt;/&lt;LV_name&gt; &lt;sizeToFormat&gt;G</span></pre><p id="be1e" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated">现在我们可以安全地减少存储，减少逻辑卷</p><pre class="kn ko kp kq fd mk ml mm mn aw mo bi"><span id="c499" class="lw hv hw ml b fi mp mq l mr ms">&gt;&gt; lvreduce -L &lt;sizeToReduce&gt;G /dev/&lt;group_name&gt;/&lt;LV_name&gt;</span></pre><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mt"><img src="../Images/1a9868a32e7ce30aa02051414144e4f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qPVqHH0Z51EzNrnS.png"/></div></div></figure><p id="489b" class="pw-post-body-paragraph it iu hw iv b iw jr iy iz ja js jc jd je jt jg jh ji ju jk jl jm jv jo jp jq hb bi translated"><strong class="iv kk"> Hadoop数据节点Stora </strong> ge</p><figure class="kn ko kp kq fd hk er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mv"><img src="../Images/637b8c53012ca8d0c6b1ad9832a45969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fvQ0Teao8cTPYjCmgjs-Tg.png"/></div></div></figure><h1 id="1c48" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">感谢阅读！！</h1><h1 id="c6d8" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">继续学习！！继续分享！！</h1><h1 id="0578" class="hu hv hw bd hx hy jw ia ib ic jx ie if ig jy ii ij ik jz im in io ka iq ir is bi translated">你可以通过以下方式联系我😅：</h1><p id="ff4e" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq hb bi translated"><a class="ae kl" href="https://www.linkedin.com/in/vinodha-kumara-8a00bb1a8/" rel="noopener ugc nofollow" target="_blank"><em class="ls">LinkedIn</em></a><em class="ls"/><a class="ae kl" href="mailto:vinodhakumara2681997@gmail.com" rel="noopener ugc nofollow" target="_blank">emailme</a></p></div></div>    
</body>
</html>