<html>
<head>
<title>Predicting Price of Smart Phones by Technical Specs: Random Forest &amp; Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">根据技术规格预测智能手机价格:随机森林和逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/predicting-price-of-smart-phones-by-technical-specs-random-forest-logistic-regression-48ddc0cdeb0c?source=collection_archive---------6-----------------------#2021-04-29">https://medium.com/nerd-for-tech/predicting-price-of-smart-phones-by-technical-specs-random-forest-logistic-regression-48ddc0cdeb0c?source=collection_archive---------6-----------------------#2021-04-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b5cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">理解数据、逻辑回归、随机森林、混淆矩阵和网格搜索cv。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7151b790711a21cca13c5349493379d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cuGnHXc2Y6Obhi6o"/></div></div></figure><h1 id="018b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">介绍</h1><p id="ba1f" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">这个月，我学到了很多关于不同模型和超参数的知识。今天，我们将在一个数据框架上研究线性模型和分类模型之间的差异，以预测手机的价格范围。我们将看到正在构建的模型、它们的性能，以及如何通过对它们使用超参数来改进模型。今天你将看到的一切将主要在python、NumPy和sklearn上。</p><h1 id="3094" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据准备和信息</h1><p id="d3ba" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我正在使用一个在Kaggle上找到的数据集，根据手机的功能来预测手机的价格范围。我做的第一件事是加载数据框，检查NaN值，并检查数据框中价格范围之间的相关性。</p><p id="54d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是数据字典，所以我们可以看到和理解每一列到底代表什么。</p><ul class=""><li id="f79d" class="ks kt hi ih b ii ij im in iq ku iu kv iy kw jc kx ky kz la bi translated"><strong class="ih hj"> battery_power </strong> =电池一次可以存储的总能量，以mAh为单位。</li><li id="7ebe" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj">蓝色</strong> =有无蓝牙。| 1:有，0:没有</li><li id="ef26" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> clock_speed </strong> =微处理器执行指令的速度。</li><li id="927c" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> dual_sim </strong> =是否支持双卡| 1:支持，0:不支持</li><li id="73d5" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> fc </strong> =前置摄像头百万像素。</li><li id="e834" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj">四_g </strong> =有无4G。| 1:有，0:没有</li><li id="303c" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> int_memory </strong> =以千兆字节为单位的内部存储器。</li><li id="1be2" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> m_dep </strong> =移动深度，单位为厘米。</li><li id="d09b" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> mobile_wt </strong> =手机重量。</li><li id="7bfe" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> n_cores </strong> =处理器的内核数量。</li><li id="d5e2" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> pc </strong> =主摄像头百万像素。</li><li id="61be" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> px_height </strong> =像素分辨率高度。</li><li id="651f" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> px_width </strong> =像素分辨率宽度。</li><li id="f545" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">ram =以兆字节为单位的随机存取存储器。</li><li id="d9ff" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> sc_h </strong> =手机屏幕高度，单位为厘米。</li><li id="1082" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> sc_w </strong> =手机屏幕宽度，单位为厘米。</li><li id="d6dc" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> talk_time </strong> =单次电池充电持续的最长时间。</li><li id="248b" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj">三_g </strong> =有没有3G。| 1:有，0:没有</li><li id="1408" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj">触摸屏</strong> =有无触摸屏。| 1:有，0:没有</li><li id="e928" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> wifi </strong> =有无wifi。| 1:有，0:没有</li><li id="240e" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> price_range </strong> =这是目标变量。| 3:非常高的成本，2:高成本，1:中等成本，0:低成本</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/fa97f10180dbcb07c692628009d05c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6LWJtwTE2cwgNpJl2fdP-A.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/ec4f91169814f4b6904f5646b49fc081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P98kBVQ2qru8czA6"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/3e57588e5f3f53a2a2022600c809948c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RPeWuF1WijxY8Yur"/></div></div></figure><h1 id="0244" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据可视化</h1><p id="6ea5" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">然后我做了一个箱线图，展示了价格区间和电池电量之间的比较。从下图中可以看出，价格区间和电池电量之间有一些比较。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lj"><img src="../Images/48762cf8ddcbf7c373ad33b10ae50139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C7QDlz_ojjTpivDH"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">箱形图</figcaption></figure><p id="c9b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们看到ram和价格区间之间的巨大相关性，我们决定让自己成为一个联合地块。我们用我的X作为ram，用我的Y作为电池电源。然后，我们把我的色调作为价格范围，看看这两者是否会对手机价格产生重大影响。从下图可以看出ram对价格范围的巨大影响。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/3658e4029b52372109166128299f27c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*foklslTjr7qiObYz"/></div></div></figure><h1 id="d34e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">将数据分成测试集和验证集</h1><p id="499d" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在确保我的数据框看起来正确后，我开始分割数据。由于已经有一个测试CSV文件，我们决定将训练数据帧分成训练集和验证集。我用30%进行验证，因为这是一个小的数据帧。最终，训练集有1400行，验证集有600行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lp"><img src="../Images/f9e10e60b7068ab7bb00161ec9057839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-BnOhdEZKZZ13kDf"/></div></div></figure><h1 id="1673" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">线性回归</h1><p id="b22f" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">对于第一个模型，我使用了一个标准的缩放器来缩放数据方差和逻辑回归。然后，我们将X_train和Y_train拟合到第一个模型。当您查看模型中训练和验证的准确度分数时，我们可以看到许多过度拟合。这可能是由于数据帧中的数据泄漏。我还查看了一份分类报告，并绘制了一个混淆矩阵。</p><p id="ce82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们已经从混淆矩阵中获得了低成本的所有必要指标，现在我们可以计算低成本的性能度量。例如，低成本类具有:</p><ul class=""><li id="681f" class="ks kt hi ih b ii ij im in iq ku iu kv iy kw jc kx ky kz la bi translated"><strong class="ih hj"> 0.96 </strong>是低成本的<strong class="ih hj">精度分数</strong>。<strong class="ih hj"> 144/(144 + 7) </strong>是我们如何得到精度分数的</li><li id="253f" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> 0.97 </strong>是低成本的<strong class="ih hj">召回分数</strong>。<strong class="ih hj"> 144/(144 + 4) </strong>就是我们如何得到召回分数的。</li><li id="30ea" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> 0.48 </strong>是低成本的<strong class="ih hj">F1-分数</strong>。<strong class="ih hj"> (.96 * .97)/(.96 + .97) </strong>就是我们低成本得到F1分数的方法。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/513618d54d8bdc430377e1e13f3150f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AYrk7bWBZX9MkwJg"/></div></div></figure><h1 id="c40e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">随机森林分类器</h1><p id="6f48" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在第二个模型中，我使用了标准的缩放器和随机森林分类器。我们将随机状态设为42，n个作业设为-1。当我们查看精确度分数时，我们可以发现训练集的精确度分数为1，精确度分数为0.86。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/e21291b47fda2fa770fac70fc3a3ef1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j_e9U1NSRBbXydD6"/></div></div></figure><h1 id="cf50" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">提高线性回归的性能</h1><p id="ef15" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我们现在开始调整我们的逻辑回归模型，因为它有最好的结果。我将使用网格搜索简历，并将我们的模型放入bagging回归方程中。我们正在使用装袋回归器，希望有助于过度拟合。对于参数，我们选择简单一些。我们正在计算模型的最佳n估计量和最大特征，以帮助改进它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/bec461f91a82344f1d42ed9a01aa5fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AgRJ3FAQmvnLJvJS"/></div></div></figure><p id="31f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们发现19是最大特征的最佳值，150是n估计值的最佳值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/d949400344fa34f420316e67d65447b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qZ0hT9_UCHPUpYfD"/></div></div></figure><p id="c1ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练准确度的结果比分数低一点，但是我们确实将验证准确度提高了0.16。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/27b2fa73f388f7c5c9a14d0f3e9527f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DQybSXDQEA6_vJxT"/></div></div></figure><h1 id="c95f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论。</h1><p id="ba89" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">比较两个模型的准确性，我们可以看到逻辑回归今天更好。尽管取决于您使用的数据框，但每种模型都有利弊。</p></div></div>    
</body>
</html>