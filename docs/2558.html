<html>
<head>
<title>Matt’s Tidbits #95 — Defining constants in TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Matt的花絮#95 —在TypeScript中定义常数</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/matts-tidbits-95-defining-constants-in-typescript-1a74d00b08a1?source=collection_archive---------7-----------------------#2021-05-11">https://medium.com/nerd-for-tech/matts-tidbits-95-defining-constants-in-typescript-1a74d00b08a1?source=collection_archive---------7-----------------------#2021-05-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/38aac84142469fb3e19295382d341213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emarK1xFUj42xdKh6D2nAA.jpeg"/></div></div></figure><p id="bc1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" rel="noopener" href="/nerd-for-tech/matts-tidbits-94-writing-safe-enums-in-typescript-2955706a1e5c">上次我写了如何在TypeScript中编写安全的枚举。</a>本周的花絮也和TypeScript有关——如何定义常数！</p><p id="3dbe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在TypeScript中定义一个常量可能非常简单——您只需编写类似于<code class="du jp jq jr js b">const SOME_CONSTANT="FOO";</code>的代码。然而，<code class="du jp jq jr js b">const</code>关键字只有在文件范围或函数内部定义变量时才有效。如果你想把你的常量放在某种命名的对象下(这在其他语言如Java、C++等中很常见),该怎么办？)</p><p id="ebcc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最明显的方法(也是我开始所做的)，就是简单地定义一个对象来包含我的常量，就像这样:</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="1948" class="kb kc hi js b fi kd ke l kf kg">const NamedVariables = {<br/>  SOME_CONSTANT_1: "FOO",<br/>  SOME_CONSTANT_2: 42,<br/>  DEFAULT_FONT_WEIGHT: "700",<br/>};</span></pre><p id="0391" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这允许我这样使用这个:<code class="du jp jq jr js b">NamedVariables.SOME_CONSTANT_1</code>。太好了！</p><p id="59d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，有一个小问题。这在某些情况下很好，但是在TypeScript需要一个属于联合类型的值的情况下，比如指定一个<code class="du jp jq jr js b">TextStyle</code>的<code class="du jp jq jr js b">fontWeight</code>属性，您可能会看到这样的错误:</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="4f82" class="kb kc hi js b fi kd ke l kf kg">Type 'string' is not assignable to type '"normal" | "bold" | "100" | "200" | "300" | "400" | "500" | "600" | "700" | "800" | "900" | undefined'.</span></pre><p id="0f56" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你像我一样，你可能会为此挠头好一阵子。直到你意识到(做一些狂热的谷歌搜索)对象属性在默认情况下不是恒定的。</p><p id="53ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的<code class="du jp jq jr js b">const NamedVariables</code>中的<code class="du jp jq jr js b">const</code>意味着对该对象的引用是不变的——所以在它已经被定义之后做类似于<code class="du jp jq jr js b">NamedVariables = &lt;something else&gt;</code>的事情是非法的。这很好——我们绝对不希望有人重新分配我们的constants对象。但是怎么才能把它的性质定义为常数呢？</p><p id="51dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我发现的第一件事是使用<code class="du jp jq jr js b"><a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze" rel="noopener ugc nofollow" target="_blank">Object.freeze()</a></code>——它返回一个属性为只读的对象。所以，如果我们用我们的例子来试一下:</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="5a29" class="kb kc hi js b fi kd ke l kf kg">const NamedVariables = Object.freeze({<br/>  SOME_CONSTANT_1: "FOO",<br/>  SOME_CONSTANT_2: 42,<br/>  DEFAULT_FONT_WEIGHT: "700",<br/>});</span></pre><p id="ca23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不幸的是，如果我们试图在联合类型中使用<code class="du jp jq jr js b">DEFAULT_FONT_WEIGHT</code>，这仍然不起作用。这是为什么呢？据我所知，这是因为TypeScript不认为这是一个真正的常量——object . freeze()使用了一些有点疯狂的运行时检查，如果您试图修改它，就会抛出错误。所以，把这个归因于一个限制(也许是暂时的？也许是永久的？)的打字稿。</p><p id="7cd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么…有什么办法可以实现这个呢？好消息是，是的！</p><p id="37a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我们如何将一个对象的所有属性都视为常量:</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="6e5e" class="kb kc hi js b fi kd ke l kf kg">const NamedVariables = {<br/>  SOME_CONSTANT_1: "FOO",<br/>  SOME_CONSTANT_2: 42,<br/>  DEFAULT_FONT_WEIGHT: "700",<br/>} <strong class="js hj">as const</strong>;</span></pre><p id="0c9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就是这样——结尾的两个小关键字<code class="du jp jq jr js b"><a class="ae jo" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html#const-assertions" rel="noopener ugc nofollow" target="_blank">as const</a></code> —是一个附加的类型脚本(不是JavaScript的一部分),它指示类型检查器对象的所有属性都应该被视为常量。</p><p id="6ae7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我强烈建议将它添加到您想要成为常量的所有对象中。让类型系统帮助你！</p><p id="2c6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你对常数的定义不同吗？我很想在评论中听到你的意见！</p><p id="9543" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有兴趣和我一起在埃森哲出色的数字产品团队工作吗？<a class="ae jo" href="https://www.intrepid.io/careers" rel="noopener ugc nofollow" target="_blank">我们正在招聘！</a></p></div></div>    
</body>
</html>