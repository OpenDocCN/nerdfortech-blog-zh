<html>
<head>
<title>Do MMA fighters with longer arms win more fights? (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">手臂越长的 MMA 拳手是否会赢得更多的打斗？(第三部分)</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/do-mma-fighters-with-longer-arms-win-more-fights-part-3-4cbbf8003fd1?source=collection_archive---------8-----------------------#2021-03-18">https://medium.com/nerd-for-tech/do-mma-fighters-with-longer-arms-win-more-fights-part-3-4cbbf8003fd1?source=collection_archive---------8-----------------------#2021-03-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="204d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">分析干净的数据</h1><p id="6e4d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在三部曲的第一部分<a class="ae kb" href="https://thomas-richie-richardson.medium.com/do-mma-fighters-with-longer-arms-win-more-fights-part-1-963dfca02a3a" rel="noopener">，我向你展示了如何从 UFCstats.com 收集 MMA 战斗机的数据。</a><a class="ae kb" href="https://thomas-richie-richardson.medium.com/do-mma-fighters-with-longer-arms-win-more-fights-part-2-d08dbf13e5ca" rel="noopener">在第 2 部分中，我向您展示了我将如何清理它</a>，使它适合于分析。最后，在第 3 部分中，我们将开始分析。</p><p id="56f6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">在我们开始之前:如果你从一开始就遵循了，你将已经收集了你自己的 MMA 数据。因为你会在不同的一天刮到我，你会有稍微不同的数据:一些战士会赢得战斗，其他人会失败。一些新的战士将被添加到表中，一些可能已经被删除。你的数字会和我的略有不同。如果它们完全不同，很可能是你做错了什么。如果你<em class="kh">确定</em>你已经做得很好，并且仍然得到完全不同的结果，我想知道！MMA 随着时间而变化，所以它最终很可能会发生。</p><h1 id="aeab" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">我们开始吧</h1><p id="8e28" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">首先，加载包</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="14e6" class="kr ig hi kn b fi ks kt l ku kv">library(‘ggplot2’)<br/>library(‘magrittr’)<br/>library(‘tidyr’)<br/>library(‘dplyr’)<br/>library(‘broom’)<br/>library(‘modelr’)<br/>library(‘purrr’)<br/>library(‘GGally’)</span></pre><p id="4e45" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这可是好多包啊！ggplot2 可生成报告图表，magrittr 为我们提供了管道(%&gt;%)，tidyr 和 dplyr 用于方便的数据操作，broom 允许我们将多个回归输出转换为易于阅读的表格，modelr 允许我们从回归模型输出中轻松提取残差，purrr 用于绘制多个直方图的代码，而 GGally 用于制作相关图。</p><p id="cf23" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">使用以下代码读入您的数据:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="2f2b" class="kr ig hi kn b fi ks kt l ku kv">data = read.csv(‘UFC_data_cleaned.csv’)<br/>data %&lt;&gt;% select(-X)<br/>data %&gt;% str()<br/>data %&gt;% head(20)</span></pre><p id="3fc7" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj"> str() </strong>告诉我我们有 12 个变量，3598 个战士，<strong class="jf hj"> head(20) </strong>让我们快速看一下数据是什么样子的。</p><h2 id="ca0f" class="kr ig hi bd ih kw kx ky il kz la lb ip jo lc ld it js le lf ix jw lg lh jb li bi translated">探索性分析:直方图</h2><p id="1e8b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">接下来我们使用几年前我在网上找到的一些代码，并且一直使用至今。它为数据集中的所有数值变量制作直方图。它非常灵活，可以复制并粘贴到任何项目中，并且可能会工作。我在所有的数据探索中使用了它。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="78f3" class="kr ig hi kn b fi ks kt l ku kv">data %&gt;% <br/> keep(is.numeric) %&gt;% <br/> gather() %&gt;%<br/> ggplot(aes(value))+<br/> facet_wrap(~key,scales=’free’)+<br/> geom_histogram(fill=’navy’)</span></pre><p id="3261" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们获取数据，保留数字变量，将所有这些变量收集到一个列中，然后调用 ggplot，告诉它为每个方面制作一个单独的直方图。在这种情况下，我们所说的面是指变量。如果有人有更简单的方法，我很想看看！</p><figure class="ki kj kk kl fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/93405e52d9824f17eb013dd0ddd479f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6T2mZ3x4HSWhs9Ppb-xDsg.png"/></div></div></figure><p id="eb92" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">因此，看起来非常大的值给我们看起来奇怪的直方图！似乎有少数拳手有很高的胜率、败率，结果是总的战斗次数。让我们看看这些:</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="68f3" class="kr ig hi kn b fi ks kt l ku kv">data %&gt;% filter(total_fights &gt;= 100)</span></pre><p id="2dcd" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们过滤所有拥有 100 场或以上战斗的战士。</p><figure class="ki kj kk kl fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lr"><img src="../Images/63eb2697a8ff6b40213f194bcc106b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DZI4NTcCrjBBAUdur5AkjQ.png"/></div></div></figure><p id="815c" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">有些拳手的战斗次数非常多！</p><h2 id="29aa" class="kr ig hi bd ih kw kx ky il kz la lb ip jo lc ld it js le lf ix jw lg lh jb li bi translated">探索性分析:相关性分析</h2><p id="dd3e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">让我们探索我们的变量如何与相关图相关联</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="e6b3" class="kr ig hi kn b fi ks kt l ku kv">data %&gt;% <br/>  select(height_inches, weight_lb, armspan_inches, losses, wins) %&gt;% <br/>  ggcorr(label = T, label_size = 6, label_round = 2,<br/>    low = 'red', high = 'green',<br/>    method = c('pairwise','spearman'),<br/>    name = 'r', legend.size = 12)</span></pre><p id="c992" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们<strong class="jf hj">只选择()</strong>我们想要的变量，然后用<strong class="jf hj"> ggcorr() </strong>做一个相关图。<strong class="jf hj"> Label = T </strong>表示增加相关系数，设置<strong class="jf hj"> label_size </strong>为 6 给了我一个好看的图(不同的数字可能对你更好),而<strong class="jf hj"> label_round </strong> = 2 表示我们希望相关系数精确到小数点后两位，这是通常的标准。<strong class="jf hj">低</strong>和<strong class="jf hj">高</strong>指定我们希望负相关和正相关采用的颜色；我把负相关设为红色，正相关设为绿色，因为这对我来说很直观。<strong class="jf hj">方法</strong>参数有两个部分，其中第二部分非常重要:我们告诉它绘制 Spearman 相关性，而不是默认的 Pearson 相关性。这是因为皮尔逊相关性受极端值的影响更大(就像我们在第 2 部分看到的 770 磅战斗机！).斯皮尔曼的相关性可以处理极值。<strong class="jf hj"> Name </strong>设置图例的标题，<strong class="jf hj"> legend.size </strong>不言自明。这里有很多可以玩的东西，所以我鼓励你改变一些东西，看看它们如何影响剧情！</p><figure class="ki kj kk kl fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/902be95708480025be6b734338981495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_e31gCh0Qepet2V5J259g.png"/></div></div></figure><p id="437b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">两件事引起了我的注意:</p><p id="6ea3" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">首先，身高、体重和臂展都是高度相关的。这是有道理的:更高、更重的人有更长的手臂。这些都是某种“大”的量度。这意味着，如果我们想知道臂展是否会影响获胜的数量，这种相关性并不是一个好的衡量标准，因为臂展与身高和体重之间存在 T21。我们需要建立模型来观察臂展的影响，同时消除身高和体重的影响，我们在下面用多元回归来做。</p><p id="9493" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">第二，赢的次数和输的次数在 r = 0.63 时高度相关。这是因为大部分打架次数多的拳手，随着时间的推移，输赢都会累积。这可能会给我们的分析带来一个问题:战士们可能会因为打了很多场比赛而获得很多胜利。我们想看看胜利的数量，同时考虑战斗的数量。</p><h2 id="304a" class="kr ig hi bd ih kw kx ky il kz la lb ip jo lc ld it js le lf ix jw lg lh jb li bi translated">特征工程:创建 win_percentage 作为战斗能力的度量</h2><p id="86f7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">一种方法是计算获胜的百分比。我们定义了一个叫做<em class="kh"> win_percentage </em>的新变量，它是赢的次数+平局次数的一半，除以总的比赛次数。这样平局也算半个赢。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="932e" class="kr ig hi kn b fi ks kt l ku kv">data$win_percentage &lt;- <br/>(data$wins +(0.5*data$draws)) / data$total_fights</span><span id="056e" class="kr ig hi kn b fi ls kt l ku kv">data%&gt;% ggplot(aes(x = win_percentage))+ geom_histogram(fill = 'navy')</span></pre><figure class="ki kj kk kl fd lk er es paragraph-image"><div class="er es lt"><img src="../Images/901df3491eefac8ce4d732376d5699eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*6wBwFj3bCrfe6r67-raK3w.png"/></div></figure><p id="f009" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">看起来获胜的百分比大部分是正态分布的，但有 0(即输掉所有战斗的战士)和 1(赢得所有战斗的战士)的起伏。</p><h2 id="309b" class="kr ig hi bd ih kw kx ky il kz la lb ip jo lc ld it js le lf ix jw lg lh jb li bi translated">臂展、身高和体重</h2><p id="50a9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">从上面的相关性中我们可以看出，臂展、身高和体重都是相互关联的。我们可能想知道的一件事是身高和体重是否与臂展唯一相关。可能身高和臂展有联系，身高和体重有联系，但是臂展和体重没有联系。我不清楚为什么更重也意味着更长的手臂。也许体重和臂展之间的相关性是<em class="kh">虚假的</em>，仅仅是因为它们与身高的共同关系。为了区分这些，我们进行了多重回归测试，看身高和体重是否能预测臂展。</p><p id="87d1" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">对于 r 中的线性和多元回归，我们使用<strong class="jf hj"> lm() </strong>函数，并用<strong class="jf hj"> summary() </strong>显示结果。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="2ff8" class="kr ig hi kn b fi ks kt l ku kv">lm(armspan_inches~ height_inches + weight_lb, data = data) %&gt;% summary()</span></pre><p id="40ee" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们得到这个(我用黄色突出了重要的部分):</p><figure class="ki kj kk kl fd lk er es paragraph-image"><div class="er es lu"><img src="../Images/d877982b290b96674312260543ee38ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*wZUldzc10lNfhAZxeU8kRg.png"/></div></figure><p id="e26b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">p 值表明身高和体重都与臂展有唯一的关系。这意味着，如果我们让所有的人都一样高，较重的人可能会有更长的手臂，如果我们让一群体重相同的人，较高的人会有更长的手臂。正如系数所示:身高增加 1 英寸，臂展增加 0.92 英寸。体重每增加 1 磅，臂展就会增加 0.017 英寸。调整后的 R 平方告诉我们，身高和体重一起解释了臂展变化的 79%，这是一个很大的数字！如果我们知道某人的身高和体重，我们就能相当准确地说出他们的臂展。</p><p id="1830" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这个分析也告诉我们，要确定臂展真的与战斗能力有关，我们需要控制身高和体重。否则，我们可能会得出结论，臂展与战斗能力有关，而实际上是身高和/或体重造成了这种影响。</p><h1 id="27fa" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">手臂较长的拳手会赢得更多比赛吗？</h1><p id="1a42" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们准备解决我们的主要问题。我们拟合多元回归，其中响应变量(或因变量，它们的意思基本相同)是<em class="kh"> win_percentage </em>，我们的预测因子(或自变量)是<em class="kh">臂展、身高</em>和<em class="kh">体重。</em></p><p id="79b6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们必须控制体重的另一个原因是因为拳手在重量级比赛。如果康纳·麦格雷戈有 81%的胜率，那只能告诉我们，与同等重量的拳手相比，他是个好拳手。不知道他是否有能力对抗重量级选手。因此，将战斗机与和他们体重相近的其他战斗机进行比较才有意义。控制体重使得臂展的效果代表了更长手臂的效果<em class="kh">假设所有拳手体重相等</em>(嗯，有点复杂)。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="d6b8" class="kr ig hi kn b fi ks kt l ku kv">main_model = <br/>lm(win_percentage ~ armspan_inches + height_inches + weight_lb, <br/>data = data)</span><span id="391c" class="kr ig hi kn b fi ls kt l ku kv">tidy(main_model, conf.int = T) %&gt;% <br/>   select(-statistic) %&gt;%  <br/>   rename(Predictor = term, <br/>         Coefficient = estimate, <br/>         `Standard error` = std.error<br/>          )</span></pre><p id="5dc9" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这一次，不仅仅是用<strong class="jf hj"> summary()，</strong>打印我们的模型，让我们用… <strong class="jf hj"> tidy() </strong>来整理它！这将我们的回归表变成了一个数据框架，因此我们可以很容易地操作它。conf.int = T 意味着我们希望我们的系数有 95%的置信区间。我们使用<strong class="jf hj"> rename() </strong>来重命名列，使表格更容易阅读。</p><figure class="ki kj kk kl fd lk er es paragraph-image"><div class="er es lv"><img src="../Images/ee908de841f32ad19b58a107763a6c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*40f8WoMvN5_XY19Z4BMe2w.png"/></div></figure><p id="062a" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">你应该得到这样的东西。我们查看 p 值部分，发现只有臂展的影响是&lt; 0.05. The others are not. This suggests that only armspan has a statistically significant effect on win percentage: height and weight do not have independent effects on the percentage of fights a fighter wins. You can also see this in that the confidence intervals for the effect of armspan do not contain 0, whereas the confidence intervals for the other effects do contain 0.</p><p id="9ced" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">However, looking at the coefficient, it seems that the effect of armspan is small. Increasing armspan by 1 inch increases the percentage of fights won by 0.005 or 0.5%. Still, that might be big if fighter vary by 10 or 20 inches in their armspan. To get a feel for the real world size of the effect, let’s take all the fighters with a weight of 155lb and find the longest and shortest armspan.</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="854d" class="kr ig hi kn b fi ks kt l ku kv">data %&gt;% <br/>filter(weight_lb == 155) %&gt;% <br/>summarise( max(armspan_inches, na.rm = T),    <br/>           min(armspan_inches, na.rm = T)<br/>          )</span></pre><p id="d8db" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">summarise allows us to apply multiple functions to a dataset, in this case, <strong class="jf hj"> max() </strong>和<strong class="jf hj"> min() </strong>。因为有些拳手的臂展是 na，所以我们必须告诉 max 和 min 在他们行动时移除这些 NA，我们用<strong class="jf hj"> na.rm = T. </strong>来做</p><p id="306d" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们发现 155 磅的人最长的臂展是 80 英寸，最短的是 64 英寸，差别相当大。我们预计长臂战斗机的胜率为 16 x 0.005 = 0.08 或高 8%！因此，虽然对于大多数拳手来说，臂展的影响很小，但在一些极端情况下，它可能会产生很大的影响。</p><h1 id="f4dc" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="e6b9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">所以看起来手臂更长的拳手确实赢得了更多的比赛！这不仅仅是因为它们更大。事实上，看起来高个子战士赢得更多战斗的唯一原因是因为他们的手臂更长:当臂展也在模型中时，身高对胜率没有独特的影响。</p><p id="eb6c" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">谢谢你跟了我这么久！我希望你已经从这三部曲中学到了一些东西，无论是网络抓取、数据清理、数据分析还是制作图表。如果你对这些数据做了其他分析，请告诉我！我很想看看你在做什么。谢谢！</p></div></div>    
</body>
</html>