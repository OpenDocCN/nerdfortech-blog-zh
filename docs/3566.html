<html>
<head>
<title>JavaScript: this and Arrow Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript: this 和箭头函数</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/javascript-this-and-arrow-functions-215a90973a05?source=collection_archive---------15-----------------------#2021-06-14">https://medium.com/nerd-for-tech/javascript-this-and-arrow-functions-215a90973a05?source=collection_archive---------15-----------------------#2021-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f3ff1775fc4d09446c94c18b2814fad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HxrfQLoYz_C01rOCdORHWQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由<a class="ae iu" href="https://unsplash.com/@lazycreekimages" rel="noopener ugc nofollow" target="_blank">迈克尔·泽兹奇</a>通过<a class="ae iu" href="https://unsplash.com/photos/ir5gC4hlqT0" rel="noopener ugc nofollow" target="_blank">unsplash.com</a>拍摄</figcaption></figure><p id="ea23" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">关于 JavaScript 介绍性面试主题的迷你系列的第 2 部分。</em> </strong></p><p id="a940" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我上一篇帖子，<a class="ae iu" rel="noopener" href="/nerd-for-tech/what-is-this-javascripts-this-keyword-23cc6fab741a">这是什么？</a>，试图澄清什么是<code class="du ju jv jw jx b">this</code>，为什么它在 JavaScript 中如此令人困惑。这篇文章将继续深入箭头函数以及它们如何影响<code class="du ju jv jw jx b">this</code>所指的东西，从而理解<code class="du ju jv jw jx b">this</code>。</p><blockquote class="jy jz ka"><p id="2f6e" class="iv iw jt ix b iy iz ja jb jc jd je jf kb jh ji jj kc jl jm jn kd jp jq jr js hb bi translated">在开始之前，如果你需要复习一下 arrow 函数，你可以看看我的第一篇文章<a class="ae iu" rel="noopener" href="/nerd-for-tech/breaking-down-javascript-functions-5be9b9fba96d">分解 JavaScript 函数</a>。</p></blockquote><p id="9340" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么箭头功能是如何关联并影响<code class="du ju jv jw jx b">this</code>的呢？为了理解这一点，首先理解词法范围的含义会有所帮助。如果你理解了词法范围，你可以跳过下一节，直接进入<a class="ae iu" href="#3066" rel="noopener ugc nofollow">为什么词法范围很重要</a>。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="3d5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用我自己的话来说，我将词法范围定义为嵌套函数的外部范围。实际上这要复杂一点，可以用<a class="ae iu" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures#lexical_scoping" rel="noopener ugc nofollow" target="_blank"> MDN </a>来更彻底的描述。</p><blockquote class="jy jz ka"><p id="6bf5" class="iv iw jt ix b iy iz ja jb jc jd je jf kb jh ji jj kc jl jm jn kd jp jq jr js hb bi translated">单词<em class="hi">词法</em>指的是词法作用域使用变量在源代码中声明的位置来确定该变量在哪里可用。嵌套函数可以访问在其外部作用域中声明的变量。— MDN</p></blockquote><p id="fe39" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这意味着嵌套函数总是可以访问任何父作用域(变量或函数),而不是相反。对 scope 的访问在家族树中向上移动，而不是向下。</p><p id="df3a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对我来说，举例比阅读定义更容易理解。</p><pre class="kl km kn ko fd kp jx kq kr aw ks bi"><span id="d883" class="kt ku hi jx b fi kv kw l kx ky">1.  function lexicalDemo() {<br/>2.    let a = 100</span><span id="7860" class="kt ku hi jx b fi kz kw l kx ky">3.    function innerFunction() {<br/>4.      console.log(a * 5)<br/>5.    }</span><span id="89f1" class="kt ku hi jx b fi kz kw l kx ky">6.    innerFunction()<br/>7.  }</span><span id="22de" class="kt ku hi jx b fi kz kw l kx ky">8.  lexicalDemo() // =&gt; 500</span></pre><p id="3215" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">即使变量<code class="du ju jv jw jx b">a</code>是在函数<code class="du ju jv jw jx b">innerFunction</code>之外定义的，它仍然能够访问该变量的值，因为它可以访问<code class="du ju jv jw jx b">lexicalDemo</code>的范围。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><h1 id="3066" class="la ku hi bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">为什么词法范围很重要</h1><p id="d813" class="pw-post-body-paragraph iv iw hi ix b iy lx ja jb jc ly je jf jg lz ji jj jk ma jm jn jo mb jq jr js hb bi translated">箭头函数不同于 JavaScript 中的常规函数，因为它们维护其父函数的作用域，而不是创建新的作用域，并且它们没有自己的<code class="du ju jv jw jx b">this</code>。如果它们没有自己的作用域，那么<code class="du ju jv jw jx b">this</code>在一个箭头函数内部指的是什么？让我们测试一下，看看。</p><pre class="kl km kn ko fd kp jx kq kr aw ks bi"><span id="78c6" class="kt ku hi jx b fi kv kw l kx ky">1.  function arrowFuncTest() {<br/>2.    let a = this</span><span id="f19b" class="kt ku hi jx b fi kz kw l kx ky">3.    const arrow = () =&gt; {<br/>4.      return this<br/>5.    }</span><span id="3c03" class="kt ku hi jx b fi kz kw l kx ky">6.    return arrow() === a<br/>7.  }</span><span id="3fcd" class="kt ku hi jx b fi kz kw l kx ky">8.  arrowFuncTest() // =&gt; true</span></pre><p id="6a53" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如你所见，从箭头函数<code class="du ju jv jw jx b">arrow</code>在第 4 行返回的<code class="du ju jv jw jx b">this</code>，严格等于变量<code class="du ju jv jw jx b">a</code>，变量【】在第 2 行被赋值为<code class="du ju jv jw jx b">this</code>。这是因为箭头函数没有自己的<code class="du ju jv jw jx b">this</code>，而是在它们的词法范围内引用<code class="du ju jv jw jx b">this</code>！</p><p id="6905" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">知道了这一点，我们现在知道如何理解箭头函数中的<code class="du ju jv jw jx b">this</code>所指的内容，但是如果箭头函数没有在另一个函数中定义呢？简单，让我们看一个例子。</p><pre class="kl km kn ko fd kp jx kq kr aw ks bi"><span id="455c" class="kt ku hi jx b fi kv kw l kx ky">1. let a = this</span><span id="7a56" class="kt ku hi jx b fi kz kw l kx ky">2. const globalArrow = () =&gt; this</span><span id="f60c" class="kt ku hi jx b fi kz kw l kx ky">3. console.log(a === globalArrow()) // =&gt; true</span></pre><p id="5e5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们的箭头函数<code class="du ju jv jw jx b">globalArrow</code>是在全局范围内定义的，所以它的词法范围是全局范围。正如我们在我以前的帖子中看到的,<code class="du ju jv jw jx b">this</code>在全局范围内是指窗口对象。</p><p id="101c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们结束之前，很快有必要讨论一下<code class="du ju jv jw jx b">bind()</code>、<code class="du ju jv jw jx b">call()</code>和<code class="du ju jv jw jx b">apply().</code>，我计划在本系列的后面讨论这些，但是我想指出，不建议在箭头函数中使用它们。快速而肮脏的解释是因为箭头函数假定了它们的父作用域的<code class="du ju jv jw jx b">this</code>，而没有它们自己的<code class="du ju jv jw jx b">this</code>。</p><p id="2f49" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在不要太担心最后一段，因为我将介绍一个在箭头函数和常规函数上使用<code class="du ju jv jw jx b">bind()</code>、<code class="du ju jv jw jx b">call()</code>和<code class="du ju jv jw jx b">apply()</code>的比较示例。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="7855" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望在阅读完这个迷你系列的前两篇文章后，你会对<code class="du ju jv jw jx b">this</code>和箭头功能感到更加舒服。类似于第一篇文章，我不认为你需要记住每一个例子或用例。我认为对于面试来说，至少对于入门级的角色来说，最重要的事情是箭头函数维护它们的词法范围，并且不创建它们自己的<code class="du ju jv jw jx b">this</code>，相反，它们维护它们词法范围内的<code class="du ju jv jw jx b">this</code>。</p><p id="d754" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下周收听如何使用<code class="du ju jv jw jx b">bind()</code>、<code class="du ju jv jw jx b">call()</code>和<code class="du ju jv jw jx b">apply()</code>的介绍。和往常一样，欢迎在下面评论<code class="du ju jv jw jx b">this</code>或箭头功能或你用来准备面试的任何技巧。</p><p id="d9b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" rel="noopener" href="/nerd-for-tech/what-is-this-javascripts-this-keyword-23cc6fab741a"> <strong class="ix hj"> <em class="jt">第一部分这是什么？JavaScripts 本关键字</em> </strong> </a></p><p id="e0aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://davidpolcari.medium.com/using-javascripts-bind-call-and-apply-868c4347cea9" rel="noopener"> <strong class="ix hj"> <em class="jt">第三部分:使用 JavaScripts bind()、call()和 apply() </em> </strong> </a></p></div></div>    
</body>
</html>