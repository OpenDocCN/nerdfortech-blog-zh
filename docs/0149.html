<html>
<head>
<title>Data Analysis on Twitter Data Using DynamoDB and Hive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用DynamoDB和Hive对Twitter数据进行数据分析</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/data-analysis-on-twitter-data-using-dynamodb-and-hive-12d9164d6aa3?source=collection_archive---------0-----------------------#2020-05-15">https://medium.com/nerd-for-tech/data-analysis-on-twitter-data-using-dynamodb-and-hive-12d9164d6aa3?source=collection_archive---------0-----------------------#2020-05-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/847e8ef0da5dd7f822be760a3fa0e69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*zkzHVADobg_OJ1ivobX2Ig.jpeg"/></div></figure><p id="d4d7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我遵循两个步骤来创建这个管道:</strong></p><p id="385d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 1) </strong> <strong class="io hj">收集推特信息并上传到DynamoDB </strong></p><p id="07b8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2) </strong> <strong class="io hj">将Twitter数据从DynamoDB复制到Hive </strong></p><p id="22d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">首先:收集Twitter Feeds并将其导入DynamoDB </strong></p><p id="be4b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">为了创建一个管道，我收集特定主题的推文，并将其写入DynamoDB表中。</strong></p><p id="17da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我启动了一个EC2实例并安装了以下内容:</strong></p><p id="a841" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">蟒蛇3 </strong></p><p id="f36a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> Python包(</strong> tweepy，boto，awscli，textblob)</p><p id="42a1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我在DynamoDB中创建了一个表，我将用它来写推文。</p><p id="dd11" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我准备了一个脚本“collect_tweets.py”，它将收集与“trump”话题相关的推文，并将其写入DynamoDB表。在脚本中，我从每条推文中提取了11个字段，分别是id、用户名、屏幕名称、推文文本、关注者、地理位置、创建时间、每条推文的情绪、极性和主观性。</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jk"><img src="../Images/99d29c22226b3a370bb65f2a4cae54dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RKXLbiHIdaoV_NStFA-Uvg.png"/></div></div></figure><p id="5dab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将collect_tweets.py脚本从本地机器复制到EC2实例。</p><p id="b109" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">scp-I ~/private keyfile . PEM collect _ tweets . py ec2-user @ ec2–xx–XXX–XXX–XXX . compute-1 . Amazon AWS . com:/home/ec2-user</p><p id="a250" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用nohup在EC2上运行脚本，以确保即使在断开ssh会话后脚本也能在后台运行。</p><p id="39d7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">nohup python 3 collect _ tweets . py 2 &gt; &amp; 1 &amp;</p><p id="9cd0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用tail来检查脚本是否正常工作。</p><p id="e459" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">尾部nohup.out</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jt"><img src="../Images/7ecd2a2bf6195165fed847938b2e2354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NN448FBjA74GYesGglfjFQ.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy">外壳上印的推文</strong></figcaption></figure><p id="f2d7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我检查了DynamoDB中的twitter_table，在我停止在EC2上运行脚本之前，它已经写入了2816条tweet记录。</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jz"><img src="../Images/cf9b91c0b4ceecc11271393ae9cb1f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rc46ICjgOrjGMvZG9lcWBg.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy">dynamo db表中的记录数</strong></figcaption></figure><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ka"><img src="../Images/e75888e3c48e5e6336a3ada607f1aded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*keXhoSp18oM9lOxKR30baw.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy"> DynamoDB表样本记录</strong></figcaption></figure><p id="0989" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步:将twitter数据从DynamoDb复制到hive </strong></p><p id="c8cf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我推出了一个EMR集群，用了以下工具</strong> Hadoop，Hive，Presto，HBase。</p><p id="ce61" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我连接到Hue，创建了两个外部表，并将“twitter_table”中的数据从DynamoDB复制到hive表“twitter_hive”中。</strong></p><p id="d28a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">下面是“twitter_hive”表:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kb"><img src="../Images/ea912a9f51e65dc2876da9a37a17dee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqsA5QEY4ri48pb6egfPLw.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy"> twitter_hive表</strong></figcaption></figure><p id="cba4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">下面是“twitter_ddb”表，用于将“twitter_table”中的数据从DynamoDB复制到hive表“twitter_hive”中。</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kc"><img src="../Images/b6787fd9947c31ecc734b1b48ce5a3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4Dv07LGbk5tFiavyi_K3A.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy"> twitter_ddb表</strong></figcaption></figure><p id="3682" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我将“twitter_ddb”表中的数据复制到“twitter_hive”表中。</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kd"><img src="../Images/daeb41e5e985fdd4909c58ed875d8250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zWqvicIecRdWEQLH_IZJA.png"/></div></div></figure><p id="3e83" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过执行一些查询，我测试了数据是否被成功复制到了配置单元表中。</p><p id="c888" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">在下面的查询中，我选择了twitter_hive表的前10条记录。</strong></p><p id="5cce" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><p id="1cf9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">select * from Twitter _ hive limit 10；</p><p id="6c6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ke"><img src="../Images/246a72d696a3cf0e605ff2be7ef0b7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPOXRs7QZ2OLHseKO6mUoA.png"/></div></div></figure><p id="0d04" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">在下面的查询中，我从twitter_hive表的前10条记录中选择情感、极性和主观性。</strong></p><p id="11d6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kf"><img src="../Images/ee3de5c385a5e7032862116a8c21da8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fD38faVLNcNe7WiRbXmsBg.png"/></div></div></figure><p id="674a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kg"><img src="../Images/1c6d3cf57b9aabb544c3d15663d2e30c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n9qJKPspdQ9HfNYerP1-Nw.png"/></div></div></figure><p id="d450" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">在下面的查询中，我计算了twitter数据集中前10个最受欢迎的标签</strong></p><p id="5b27" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kh"><img src="../Images/b487ae0ce9dacae55278620c8400528a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2QIMQOerzhUNXk1KG3rqsw.png"/></div></div></figure><p id="24ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ki"><img src="../Images/f625f06610c2c4145ddaa205ed1dfcfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h_bQi5_GI9pyz3oXmJyJiA.png"/></div></div></figure><p id="1618" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在下面的查询中，我将检查哪些地点关于“trump”的推文数量最多。</p><p id="5324" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kj"><img src="../Images/5b74c70670e99920a34f2323b158f832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60NcFUfP63LsGRqc3PS_eg.png"/></div></div></figure><p id="42b4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kk"><img src="../Images/b5d3e6bf0379027a715e181589df793d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ux48sHJStpBpk5Q83WHBqA.png"/></div></div></figure><p id="1ae2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在下面的查询中，我将检查哪些地点对特朗普的负面情绪最大。</p><p id="4a7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kl"><img src="../Images/e1ce77218beeb8d85c9e6f55dd2cd284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2QJHCnfsh8Qux9eIgXyNw.png"/></div></div></figure><p id="83d0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es km"><img src="../Images/1c511fb1d4da9f805b8538a025f53ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onz5zvarntfj8VNamknYYg.png"/></div></div></figure><p id="b7bf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在下面的查询中，我进行了字数统计，以在数据集中找到一个流行的关键字，然后计算包含该关键字的所有推文的平均极性。</p><p id="87dc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">首先，我做了一个字数统计，在数据集中找出一个热门关键词。</strong></p><p id="c9be" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kn"><img src="../Images/af4199a3f2d3d7c88878fb1cc972ea60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qK26TqXVYoGEYEVhU96bjg.png"/></div></div></figure><p id="80ff" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ko"><img src="../Images/0a219a6cc65c28e9b96d565ac4d7abc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xwhX9XOAXXGUW452kyK0Q.png"/></div></div></figure><p id="c12b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">其次，我选择了出现1124次的单词“Trump”来计算所有包含“Trump”的推文的平均极性。</strong></p><p id="119d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">查询:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kp"><img src="../Images/7523d4fe507ce15ab9895b917651f4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXy4OpNLgX-Z2Jh7rqOInw.png"/></div></div></figure><p id="c413" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kq"><img src="../Images/411007e507ea9ce4d2403c1c37a100af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avomsJTyQF5toDLYSA80Lw.png"/></div></div></figure><p id="724c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">注意:</strong>推文被原样使用，实际上它们不应该被使用。数据在用于分析之前应该进行清理。一种清理形式可以是删除停用词，另一种清理形式可以是删除提及，..等等。</p></div></div>    
</body>
</html>