<html>
<head>
<title>Ansible Dynamically Loads Operating System Specific Variable File</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ansible 动态加载操作系统特定的变量文件</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/ansible-dynamically-load-operating-system-specific-variable-file-95683b5c6efc?source=collection_archive---------11-----------------------#2021-07-19">https://medium.com/nerd-for-tech/ansible-dynamically-load-operating-system-specific-variable-file-95683b5c6efc?source=collection_archive---------11-----------------------#2021-07-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dc59e66f43fe1f3eb2e26bc1c4d17023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-mAiyIy7baZ1z-ZHrLDUA.png"/></div></div></figure><p id="52f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客中，我将演示我如何创建一个可行的剧本<em class="jo">，它将</em> <strong class="is hj"> <em class="jo">动态加载与被管理节点的操作系统同名的变量文件，并且仅仅通过使用变量名我们就可以配置我们的被管理节点。</em> </strong></p><h1 id="b3c3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">可行的目录结构。</h1><p id="3076" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">下面是我的 ansible 工作空间的目录结构:</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/1782792ab0acf95004039ebac78a50f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Am3hYy9PLuhi1jxLSHEyw.png"/></div></div></figure><p id="0f72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可行的配置文件:</p><p id="6646" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ vim ansible.cfg </strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/0e94282a48ae4b637aad31583ebc1f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uccIoy1z3kO19K8rrZ5PEw.png"/></div></div></figure><p id="f832" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个演示中，我使用 AWS cloud 启动了 3 个托管节点，它们具有 3 个不同的操作系统向导:</p><ol class=""><li id="f6b9" class="ky kz hi is b it iu ix iy jb la jf lb jj lc jn ld le lf lg bi translated">Redhat Linux 8</li><li id="357d" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn ld le lf lg bi translated">Ubuntu 20.04</li><li id="3431" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn ld le lf lg bi translated">亚马逊 Linux 2</li></ol><p id="e3ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可行的库存文件:</p><p id="4187" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ vim 库存</strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/4b41e082d2f12621f6126402be7058de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9kAajeSLbWGOCeUg738TA.png"/></div></div></figure><p id="3d8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们检查每个受管节点上的可回答事实:</p><p id="e823" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ ansible -m 安装 amazon2 | grep 发行版</strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/fc6e23e51695a84e4720de318f8fdb66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uosLzVy4FhzHSzWR5GcO1A.png"/></div></div></figure><p id="2dc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ ansible -m 安装 ubuntu| grep 发行版</strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/f0bb08cd88e2efdfaa27cc3f7a4fb1df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqWoEeOdC210L-HGckrCmw.png"/></div></div></figure><p id="3fe5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ ansible -m 安装 redhat| grep 分发</strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/97cdea5910bfb20d2268ae041b213cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wuKSb0UHI6438b7oo7AFtw.png"/></div></div></figure><p id="b1ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是创建<strong class="is hj">变量文件</strong>，其名称与我们将在剧本中使用的变量分布相同。</p><p id="2725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ vim vars/Redhat.yml </strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/d05a60dbb6602ce0b707c867c616c957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*EfIgsP16m7NMgqZUNVbzpw.png"/></div></figure><p id="656b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ vim vars/Ubuntu.yml </strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/aef9f3f073232ccb044a283024f915cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*qrJfKroqd5FPiZMs4PIdbQ.png"/></div></figure><p id="7c77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ vim vars/Amazon.yml </strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/d05a60dbb6602ce0b707c867c616c957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*EfIgsP16m7NMgqZUNVbzpw.png"/></div></figure><p id="d9d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后一步是创建一个<strong class="is hj">剧本</strong>并运行剧本。在行动手册中，我们可以使用 vars_file 关键字和 ansible 事实来导入特定于操作系统的文件。</p><p id="d30f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> $ vim setup.yml </strong></p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="a284" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">$ ansi ble-playbook setup . yml</strong></p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/0448a437e7311865705f3b0f44834aee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3aQMO-_rCdis2nqfZFgBcw.png"/></div></div></figure><p id="b68e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在浏览器上查看网页。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/f30bb4d4d5f2b46ab577a33763f2daef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txfxjzFS7L3mu8JSlfpCKQ.png"/></div></div></figure><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/43c6ccf842972aef7611e9d731c82ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_hpEwpia_42NrVp2gJ-oRA.png"/></div></div></figure><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/53e11067306cd3b26c54b27b602d1f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V2W_tQ8YMqO_O-pFVzbmIw.png"/></div></div></figure><p id="97af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">瞧，我们已经成功地创建了一个剧本，它动态地加载了与被管理节点的操作系统同名的变量文件，只需使用变量名，我们就可以配置我们的被管理节点。</em> </strong></p><p id="a8de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">GitHub:</strong><a class="ae lx" href="https://github.com/mtabishk/ansible-playbooks/tree/main/load_os_specific_files" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/mtabishk/ansi ble-playbooks/tree/main/load _ OS _ specific _ files</a></p></div><div class="ab cl ly lz gp ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="hb hc hd he hf"><p id="5238" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">这篇文章就到这里，希望你能从这里学到一些东西。</strong></p><h2 id="3790" class="mf jq hi bd jr mg mh mi jv mj mk ml jz jb mm mn kd jf mo mp kh jj mq mr kl ms bi translated">谢谢大家的阅读。我很快会带一些新文章回来，谢谢！</h2><p id="922b" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">穆罕默德·塔比什·坎戴</p><p id="8971" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">领英:<a class="ae lx" href="https://www.linkedin.com/in/mtabishk/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/mtabishk/</a></p></div></div>    
</body>
</html>