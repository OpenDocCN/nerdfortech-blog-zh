<html>
<head>
<title>Customer Segmentation in Python using K-means</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用K-means在Python中进行客户细分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/customer-segmentation-in-python-using-k-means-c39a6680586c?source=collection_archive---------11-----------------------#2021-04-09">https://medium.com/nerd-for-tech/customer-segmentation-in-python-using-k-means-c39a6680586c?source=collection_archive---------11-----------------------#2021-04-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="27bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分析现在越来越多地用于指导各种领域的商业决策。如今，企业比以往任何时候都拥有更多的关于消费者和市场的数据。因此，对于企业来说，利用这些数据来辅助决策变得越来越重要。</p><p id="f142" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">营销是一个使用数据分析为营销经理提供可操作的见解的领域。任何品牌经理的关键任务之一就是识别客户群。客户群是指具有共同特征的人群，如年龄、教育、偏好和态度。细分可以帮助营销经理制定目标客户战略，从而增加销售额。在本例中，我们将对购物中心客户样本进行聚类分析。</p><p id="6e90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将要使用的数据集是一个购物中心客户列表，我们有他们的性别、年龄、年收入和支出。阅读完文件后，做一些探索性的数据分析来了解数据是很重要的。为此，我们将使用matplotlib库。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8232" class="jm jn hi ji b fi jo jp l jq jr">sns.scatterplot(cust["Age"],cust["Spending Score (1-100)"],color="green",hue=cust["Gender"])<br/>plt.title(" Spending Score vs Age"</span></pre><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es js"><img src="../Images/017e66e9500f6b79ae331e9a740e1954.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*_rLfZlm8pVQUv2q6FY4dmQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">支出分数/年龄散点图</figcaption></figure><p id="e1ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到的第一个图表是消费分数与年龄的关系，我们可以清楚地看到，20-40岁之间的人比样本中的其他人有更高的消费分数。年龄和消费分数之间有一定的相关性。为了进一步分析，我们还可以查看相关矩阵。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es ka"><img src="../Images/cc348ecdd9ceeafe2a2f6d11379667dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*udIi5YU6v6dANKL4sXmRbg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">相关图</figcaption></figure><p id="338a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以看出，与其他因素相比，年龄和支出分数具有非常高的相关性。这些图可以帮助我们识别数据中的关系和模式。现在让我们继续编写聚类分析的代码。</p><p id="1dc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将要使用的聚类算法是K-means，这是一种非常流行的算法。它识别k个质心，然后将数据中的每个点分配到最近的聚类中。K-means是一个迭代过程，这意味着在每次分配迭代后重新计算质心，直到聚类中没有改进或达到最大迭代次数。</p><p id="d84d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在进行聚类分析之前，对变量进行缩放是很重要的，为此我编写了以下代码。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f9f1" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">from</strong> <strong class="ji hj">sklearn.preprocessing</strong> <strong class="ji hj">import</strong> StandardScaler<br/>cust_transform["Age"]=scaler.fit_transform(cust["Age"].values.reshape(-1,1))<br/>cust_transform["Annual Income"]=scaler.fit_transform(cust["Annual Income"].values.reshape(-1,1))<br/>cust_transform["Spending Score"]=scaler.fit_transform(cust["Spending Score"].values.reshape(-1,1))</span></pre><p id="4943" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进行k-means聚类分析时，最大的决策之一是决定聚类的数量。对于这些数据，我们将使用通过以下公式计算的轮廓系数</p><p id="7edb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">x-y/最大值(x，y)</p><p id="007a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中x是平均聚类间距离，y是平均聚类内距离。分数范围从-1到+1，其中分数越高，聚类分离得越好。我们将使用sci-kit库来计算一系列聚类的轮廓得分</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="4663" class="jm jn hi ji b fi jo jp l jq jr"><strong class="ji hj">from</strong> <strong class="ji hj">sklearn.metrics</strong> <strong class="ji hj">import</strong> silhouette_score<br/>silhouette_coefficients=[]<br/><strong class="ji hj">for</strong> i <strong class="ji hj">in</strong> range(2,12):<br/>     kmeans = KMeans(n_clusters=i)     <br/>     kmeans.fit(cust_transform)<br/>     score = silhouette_score(cust_transform, kmeans.labels_)<br/>     silhouette_coefficients.append(score)<br/><br/>sns.lineplot(x=range(2,12),y=silhouette_coefficients,color="green"</span></pre></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es ki"><img src="../Images/0f54a2eb8e82e7fa10f59064b4cec2c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*ijOc9hI0Vz5IRNUeHC920w.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">最佳聚类数:6</figcaption></figure><p id="fd73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面可以看出，聚类的最佳数量是6，因此我们将数据分成6个聚类。在聚类之后，我将可视化聚类，并尝试识别任何可以帮助我们做出决策的模式或见解。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kj"><img src="../Images/d889516701f00c6ccf4ae321d94f9220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*zri1dPr1lmdF1_HAkrrFRQ.png"/></div></figure><p id="e1aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图中我们可以看到，聚类0由年收入较高但支出分数较低的人组成。聚类#2是具有高年收入和高支出分数的聚类。这是我们可以瞄准的高价购买的集群。我们可以沿着不同的维度进一步分析我们的集群</p><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kj"><img src="../Images/234a091bec5cec50796a52f734a6b3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*6p3ewCNOePA1MrfWvx0L2w.png"/></div></figure><p id="2cc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的聚类是按照消费分数和年龄来可视化的。从前面的可视化中，我们知道第二组由高收入高消费人群组成。然而，从这张图中我们可以看出，他们的年龄在20-40岁之间。此外，集群4也有较高的支出分数，但他们的年收入较低。</p><p id="6745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">聚类分析在商业决策尤其是市场营销中有很多应用。在这里，我们使用聚类分析来创建细分市场，这可以帮助营销经理确定他们可以增加销售的目标群体或细分市场。</p></div></div>    
</body>
</html>