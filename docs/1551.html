<html>
<head>
<title>How to copy Objects in JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在JavaScript中复制对象？</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-copy-objects-in-javascript-4a44740b04a5?source=collection_archive---------8-----------------------#2021-03-25">https://medium.com/nerd-for-tech/how-to-copy-objects-in-javascript-4a44740b04a5?source=collection_archive---------8-----------------------#2021-03-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e70b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您正在使用JavaScript，那么处理对象总是很困难。作为一个JS初学者，我在对象方面面临了很多挑战，但现在我对此有了更好的理解，我想和大家分享一下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0fdde0c5543c9946ee7ddef5cbbc1389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWK6yDaBe7x5viez2VyeMw.jpeg"/></div></div></figure><blockquote class="jp jq jr"><p id="a8db" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">这里要理解的最基本的东西是基本类型和对象之间的区别。像字符串、数字、布尔值等基本类型总是作为一个值被复制，而对象则不同，因为它们是通过引用被复制和存储的。</p></blockquote><p id="feac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是什么意思？我们举个例子来了解一下基本的区别。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="c6f2" class="kb kc hi jx b fi kd ke l kf kg">let foo = "Hello String";<br/>let bar = foo;<br/>bar = "Bye String";<br/>console.log(foo);  // "Hello String"</span></pre><p id="9d63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你看到刚才发生了什么吗？让我为你打破它。</p><p id="f8c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您将foo赋值给bar时，它会为整个值创建一个单独的副本。所以当我们给bar赋值时，它不会影响foo值，因为原语不使用引用。</p><p id="edcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而与对象完全不同。</p><h2 id="d266" class="kb kc hi bd kh ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">对象是引用类型</h2><blockquote class="jp jq jr"><p id="312c" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">分配给对象存储的变量，不是对象本身，而是它的“内存地址”——换句话说，是对它的“引用”。</p></blockquote><p id="f1ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过例子来理解它。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="9607" class="kb kc hi jx b fi kd ke l kf kg">let person = { name: 'Sarfraz' };<br/>let person2 = person;<br/>person.name = 'John';<br/>console.log(person2.name); // "John" changes from person refernce</span></pre><p id="ef10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，这里只有一个对象，有两个引用指向它。因此，复制一个对象变量会创建一个对同一个对象的引用。</p><p id="f0a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是如果我们需要复制一个对象呢？这是可以做到的，但是JavaScript中没有内置的方法。让我们看看复制对象的三种方法。</p><h2 id="06ef" class="kb kc hi bd kh ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">使用Spread (…)语法</h2><p id="2662" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">Spread操作符克隆对象及其属性。请记住，这是一个浅层复制，这意味着只有第一级原语字段通过值进行复制，其余的嵌套对象通过引用进行复制。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="3c44" class="kb kc hi jx b fi kd ke l kf kg">const dishes = { chicken: '🍗', pizza: '🍕' };<br/>const cloneDish = { ...dishes };</span><span id="8796" class="kb kc hi jx b fi lf ke l kf kg">console.log(cloneDish); <br/>// { chicken: '🍗', pizza: '🍕' }</span></pre><h2 id="f3a2" class="kb kc hi bd kh ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">使用Object.assign()方法</h2><p id="141b" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">Object.assign()方法用于将所有可枚举的自身属性的值从一个或多个源对象复制到目标对象。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="40f0" class="kb kc hi jx b fi kd ke l kf kg">let obj = { a: 1, b: 2, };<br/>let objCopy = Object.assign({}, obj);</span><span id="2755" class="kb kc hi jx b fi lf ke l kf kg">console.log(objCopy); <br/>// Result - { a: 1, b: 2 }</span></pre><blockquote class="jp jq jr"><p id="fb68" class="if ig js ih b ii ij ik il im in io ip jt ir is it ju iv iw ix jv iz ja jb jc hb bi translated">Spread (…)语法和Object.assign有一个问题，它们只做浅层复制。这意味着嵌套属性仍将通过引用进行复制。使用时要小心。</p></blockquote><h1 id="403d" class="lg kc hi bd kh lh li lj kl lk ll lm kp ln lo lp ks lq lr ls kv lt lu lv ky lw bi translated">深层复制对象</h1><p id="a50f" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">深层拷贝将复制它遇到的每个对象。副本和原始对象不会共享任何东西，所以它将是原始对象的副本。这解决了我们在上述两种方法中面临的问题。</p><h2 id="d8f5" class="kb kc hi bd kh ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">使用JSON . parse(JSON . stringify(object))</h2><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="45d9" class="kb kc hi jx b fi kd ke l kf kg">let obj = <br/>  {<br/>    foo: 1,<br/>    bar: {<br/>         foobar: 2,<br/>       }<br/>   }</span><span id="35fa" class="kb kc hi jx b fi lf ke l kf kg">let newObj = JSON.parse(JSON.stringify(obj));</span><span id="dd5b" class="kb kc hi jx b fi lf ke l kf kg">obj.bar.foobar = 20;<br/>console.log(obj); <br/>// { foo: 1, bar: { foobar: 20 } }<br/>console.log(newObj); <br/>//{ foo: 1, bar: { foobar: 2 }} (New Object with Original Values)</span></pre><p id="14ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种方法有一些缺陷。它不能用于复制用户定义的对象方法，并且您必须确保源对象是JSON安全的。</p><h2 id="146f" class="kb kc hi bd kh ki kj kk kl km kn ko kp iq kq kr ks iu kt ku kv iy kw kx ky kz bi translated">使用_。cloneDeep()方法</h2><p id="8a09" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">_。cloneDeep()方法用于创建值的深层副本，即递归克隆值。</p><pre class="je jf jg jh fd jw jx jy jz aw ka bi"><span id="4b4f" class="kb kc hi jx b fi kd ke l kf kg">const _ = require('lodash');<br/>var obj = { x: 23 };<br/>var deepCopy = _.cloneDeep(obj);<br/>obj.x = 10; // Changing original value</span><span id="6845" class="kb kc hi jx b fi lf ke l kf kg">console.log(obj.x); //10<br/>console.log(deepCopy); //23</span></pre><p id="cebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为这是一个深层拷贝，你不会有任何原始对象的痕迹。</p><h1 id="4eb1" class="lg kc hi bd kh lh li lj kl lk ll lm kp ln lo lp ks lq lr ls kv lt lu lv ky lw bi translated">结论</h1><p id="9c07" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">在JS中复制对象可能很棘手，尤其是如果您是Javascript新手的话。希望这篇文章能帮助你理解工作原理，避免以后可能会遇到的问题。如果您有任何建议或任何更好的方法来实现这一点，欢迎指出来，我会更新它。编码快乐！</p></div></div>    
</body>
</html>