<html>
<head>
<title>Delivering messages via SQS Queue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过 SQS 队列传递消息</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/delivering-messages-via-sqs-queue-f5d2e98994b?source=collection_archive---------0-----------------------#2022-10-30">https://medium.com/nerd-for-tech/delivering-messages-via-sqs-queue-f5d2e98994b?source=collection_archive---------0-----------------------#2022-10-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="79c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Lambda 函数将当前时间发送到 SQS 队列。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/2989534c5b8a89ca194bce737775de6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*5ZO36Dnf2M5CjNzeQ4BVYg.jpeg"/></div></figure><p id="834b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">概述:</strong>亚马逊简单队列服务(SQS)让您可以在任意数量的软件组件之间发送、存储和接收消息，而不会丢失消息或要求其他服务可用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/d9e2a162d68d6031c9dbe007fe7c6b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqN2sRH8vtXcRxRLUYM4ww.png"/></div></div></figure><p id="d7aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">项目目的:</strong>通过 Lambda 函数向 SQS 队列发送消息(当前时间)</p><pre class="je jf jg jh fd jq jr js jt aw ju bi"><span id="a127" class="jv jw hi jr b fi jx jy l jz ka">Objectives:<br/>- Create a Standard SQS Queue using Python<br/>- Create a Lambda function<br/>- Modify Lambda to send a message to the SQS Queue with current time<br/>- Create an API gateway HTTP API type trigger<br/>- Test the trigger to verify the message was sent</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es kb"><img src="../Images/4eb244ed6a5271d53a5b26d3c149b501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TzVTAMrpZr8xU2WOMWOUew.png"/></div></div></figure><p id="b04a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:创建一个 SQS 队列<br/> </strong>这可以通过 AWS 控制台完成，但对于这个项目，我们将通过 Python 使用 boto3 库来完成。作为参考，我将使用该链接获取我的 python 代码来构建 sqs 队列。不要忘记在代码中添加导入 boto3。</p><div class="kc kd ez fb ke kf"><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/sqs.html" rel="noopener  ugc nofollow" target="_blank"><div class="kg ab dw"><div class="kh ab ki cl cj kj"><h2 class="bd hj fi z dy kk ea eb kl ed ef hh bi translated">示例教程- Boto3 Docs 1.25.3 文档</h2><div class="km l"><h3 class="bd b fi z dy kk ea eb kl ed ef dx translated">本教程将向您展示如何在 AWS 服务中使用 Boto3。在本示例教程中，您将学习如何使用…</h3></div><div class="kn l"><p class="bd b fp z dy kk ea eb kl ed ef dx translated">boto3.amazonaws.com</p></div></div></div></a></div><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ko"><img src="../Images/bf64f57b9047ff1a5025f697e2814841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0ZKfISVE051VsYZc1VYNw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es kp"><img src="../Images/3c471917dab3b4eb25089d5e8d3ecc9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0nI2KLgq_GOWBv_6PSmwXQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">来自 AWS 控制台的 SS</figcaption></figure><p id="f2e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第 2 步:创建 IAM 角色<br/> </strong>我们将前往 IAM 角色，为 Lambda 服务创建 IAM 角色，并为其分配 FullSQSAccess 权限。这个 IAM 角色将被分配给 Lambda 函数来访问 SQS。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ku"><img src="../Images/6eb04c6d947029ee488ea611c169afaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kkv1Fo4eUFgpp4Y3bqybAg.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">选择 Lambda 作为用例</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es kv"><img src="../Images/b13fbe0e4e092e282c49683ccf00ab9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkPdliogGTOihI_OWx7u1g.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">添加 SQS 完全访问权限</figcaption></figure><p id="bbe0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤 3:创建 Lambda 函数<br/> </strong>为此，我们将前往控制台创建 Lambda 函数。</p><p id="a765" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转到&gt;&gt; Lambda &gt;&gt;创建函数&gt;&gt;从头开始创作&gt;&gt;名称&gt; &gt;选择 Python 作为运行时&gt; &gt;选择在上一步中创建的策略</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es kw"><img src="../Images/47adcad801ed4856c5d9211ad5b6fb43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tB_9oe_VMtllN9IWwlTVEw.png"/></div></div></figure><p id="4944" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤 2 和 3 的结论:</strong>我们创建了一个 IAM 角色(SQS 完全访问)，并将其分配给 Lambda 函数(Time_Function)，这将让 Lambda 函数承担一个角色，将消息发送到 SQS 队列中。</p><p id="f172" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤 4:修改 Lambda 函数代码<br/> </strong>现在，我们将修改“lambda_function.py”脚本，以便在它执行时生成一个时间戳。为此，删除样板文件并添加以下代码。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="6e21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更新代码&gt;&gt;后，单击部署&gt;&gt;测试</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es kz"><img src="../Images/f09c9ebad97024333a580abf8cae7c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQpYqCcIdya1NpTRzs4wtA.png"/></div></div></figure><p id="cc92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤 5:创建 API 网关<br/> </strong>现在我们将添加 API 网关来触发 Lambda 函数，以将所需的结果发送到我们的 SQS 队列中。</p><p id="dc12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转到&gt;&gt; Lambda 函数&gt;&gt;添加触发器&gt; &gt;使用以下设置选择 API 网关</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es la"><img src="../Images/a1acf53fb520b0046d66b143de57ae43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V2h3BJiEXQrp-LLoPXvN5Q.png"/></div></div></figure><p id="ebc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将 API 网关创建为触发器后，在 browser 选项卡中检查 API 端点。您将收到以下结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/c7bf80e49f9b174c4c1a47375f779702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*ShZA9wXrqyUaQfHyC051AA.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">显示此结果的 API 端点</figcaption></figure><p id="a110" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，您也将收到 SQS 队列中的消息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lc"><img src="../Images/94df2a39bb5016136d94dde3a3d83d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHord1tJCRMdQiWAVks9Hg.png"/></div></div></figure><p id="6960" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任务完成后，我们配置了 lambda 函数，将当前时间发送到 sqs 队列。感谢阅读！！</p></div></div>    
</body>
</html>