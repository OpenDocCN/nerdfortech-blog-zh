<html>
<head>
<title>Capital One Data Breach — 2019</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Capital One 数据泄露— 2019 年</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/capital-one-data-breach-2019-f85a259eaa60?source=collection_archive---------0-----------------------#2022-12-04">https://medium.com/nerd-for-tech/capital-one-data-breach-2019-f85a259eaa60?source=collection_archive---------0-----------------------#2022-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/59e548d34ec3923bd27c268c3a9eba3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_SX4HdK0xvya86-Ot19oYQ.jpeg"/></div></div></figure><p id="67cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">简介</strong></p><p id="8c52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated"><span class="l jp jq jr bm js jt ju jv jw di"> C </span> apital One 是最大的信用卡发行商之一，他们的数据泄露暴露了属于超过 1 亿个人的记录。威胁参与者通过错误配置的开源 web 应用程序防火墙(WAF)渗透到网络中。这种多阶段攻击使得攻击者能够泄露存储在 AWS S3 存储桶中的数据。哪些数据被盗？Capital One 的一份声明指出，最大数量的数据被泄露的是个人信息，包括姓名、地址、邮政编码、电话号码、电子邮件地址、出生日期和自我报告的收入。(Wolf，2022 年)除了个人信息，140，000 个社会安全号码和 80，000 个关联的银行账号以及大约 100 万个加拿大社会保险号码也被泄露。(One，2022)客户状态数据被暴露，包括信用评分、信用额度、余额、支付历史、联系信息和零碎的交易数据。(One，2022)下面的段落将提供一个简短的技术概述，介绍数据泄露是如何发生的，Capital One 对安全事件的响应，他们失败的安全控制，以及云服务提供商(CSP)如亚马逊网络服务(AWS)如何改善他们的服务。</p><p id="dc88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">技术概要</strong></p><p id="5732" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一资本银行是美国第五大银行。他们雇佣了近 5 万人，收入 320 亿。(Trends，2022)他们是世界上首批投资将其内部数据中心迁移到云环境的银行之一。(Khan，2022)如此大规模的数据泄露是如何发生在这样一个受到严格监管的大型机构中的？Capital One 拥有大量的安全预算，因为他们是一家大型金融机构。这次袭击不是由一个国家威胁者实施的，而是由一个人实施的。攻击者名叫佩奇·汤普森(Paige Thompson)，是 AWS 的前员工。她通过创建一个扫描工具来扫描云基础架构并寻找错误配置的防火墙，从而进入了网络。第一资本并不是她唯一妥协的公司。她还泄露了包括私人和政府机构在内的 30 多个组织的数据。(Khan，2022)她后来在一封匿名电子邮件发送到 Capital One 后被捕，该电子邮件帮助联邦调查局发现了 GitHub 知识库和社交媒体帖子。(Waldman，2022)以下是攻击和响应的概述:</p><ul class=""><li id="9759" class="jx jy hi is b it iu ix iy jb jz jf ka jj kb jn kc kd ke kf bi translated">2019 年 3 月 22 日和 23 日:攻击者获得了访问权限。</li><li id="4dba" class="jx jy hi is b it kg ix kh jb ki jf kj jj kk jn kc kd ke kf bi translated">2019 年 7 月 17 日:首都一号发现事件。</li><li id="420e" class="jx jy hi is b it kg ix kh jb ki jf kj jj kk jn kc kd ke kf bi translated">2019 年 7 月 19 日:他们确定外部用户获得了未经授权的访问。</li></ul><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/4b805ea67b1aa38174ffada8e082aeb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*gsufeeBAmBom37nc6DLNiQ.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">图 1:对 AWS 基础设施的攻击</figcaption></figure><p id="58a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">图 1 概述了为获取访问权和泄露数据而实施的攻击。(1)威胁参与者通过 tor 和 VPN 等匿名服务访问网络。(2)然后他们执行服务器端请求伪造或 SSRF 攻击，欺骗服务器以远程用户的身份执行命令。(3)接下来，扫描工具识别出错误配置的 WAF，并转发命令以获得对 AWS 平台的访问并接收对环境的临时凭证。(4)SSRF 和 WAF 错误配置结合在一起，攻击者获得了有效的凭证，这允许她通过 AWS CLI 运行命令。(5)她识别了存储在 S3 桶中的数据。(6)最后，她在 700 个不同的 S3 存储桶中复制了 30 GB 的客户数据。</p><p id="cd1e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">响应</strong></p><p id="c322" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦 Capital One 意识到数据泄露，他们很快就解决了问题，并提醒客户注意安全事件。这部分归因于金融行业及其必须遵守的法规和要求。最终，他们迅速而透明地处理了安全事件。他们通过通知受影响的个人向客户提供详细信息，并免费提供两年的免费信用监控和身份保护。由于数据泄露的性质和规模，罪犯很快被找到并逮捕。这使得当局能够确定攻击者负责的其他 30 起安全事件。第一资本是透明的，并提供了对该事件的深入分析，这是非常有帮助的。这些信息允许其他公司和个人从他们的错误中吸取教训并做出必要的改进。他们的网站通过提供持续更新和在 2019 年网络事件解决方案中提供结论性信息，清晰简洁地说明了数据泄露问题。(一，2022)</p><p id="aaf3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">反应改善</strong></p><p id="a885" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总的来说，Capital One 在意识到该事件后，对数据泄露做出了迅速而负责任的响应，但仍有一些地方需要改进。拥有社会保险号的人数比他们最初陈述的要多。在 2021 年 1 月 27 日进一步调查后，他们发现有 4700 个社会安全号码被泄露。(One，2022)发现并通知受影响的客户花费了大量时间。他们本可以使用适当的工具来更快地检测事故并减轻损失。他们本可以更快地重新评估他们的云架构并实施适当的控制。最后，该公司本可以从不同的角度来看待安全性，不要混淆法规遵从性和安全性。金融部门受到高度监管，需要持续的审计和评估，但这些缺陷直到超过 1 亿人丢失敏感信息后才被发现。</p><p id="2f10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">最大的错误</strong></p><p id="00d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Capital One 最大的错误是缺乏适当的安全控制来监控、检测和警告入侵。他们需要适当的机制来提供网络上发生的事情的更多可见性。不幸的是，如果实施了适当的控制，数据泄露本来是可以被察觉的。使用访问管理(IAM)控制来访问云资源和服务。用于执行攻击的角色被过度配置，并且不应该具有访问加密密钥、S3 桶和 WAF 配置的权限。威胁参与者能够在不被发现的情况下进入网络，执行攻击，扫描外部安全控制，识别错误配置，以及在不被发现的情况下泄露数据。为了防止攻击获得访问权限和访问凭据，需要适当的技术控制来限制用户帐户和管理权限的使用。</p><p id="8976" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了缺乏控制之外，他们还错误地配置了安全控制，没有遵循最低权限或零信任架构。他们应该利用适当的 IAM 角色、组和权限来限制对敏感数据和服务的访问。应对 IAM 控制进行审计，以确保为角色、用户和组提供适当的权限。应定期对 IAM 进行适当评估，以确保角色、用户或组是必需的，或者在不需要时被适当禁用或删除。晶圆多久重新配置一次？该角色应该一直处于活动状态，还是应该在 30 天内未使用时被禁用？正确使用 IAM 应该禁用当前未使用的角色，或者删除不再需要的角色。</p><p id="c3d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，没有正确实施数据丢失防护(DLP)来限制从网络中泄漏数据的能力。网络的可见性和适当的工具本可以检测到试图从 700 多个不同的 S3 存储桶离开的数据。技术控制可以帮助 Capital One 检测、缓解和预防攻击。他们将云用于面向客户的应用程序，他们的大型网络也产生了同样大的攻击面。适当的流程、程序和测试将有助于他们通过审计和攻击性/防御性安全约定(如红队、桌面练习和 bug bounty)来发现错误配置的 WAF。</p><figure class="km kn ko kp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/8f080841d6bf2a047feec0cbfbb4590c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cAub1Ch4NMvVReUYiijt-Q.png"/></div></div></figure><p id="7110" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> AWS 支持</strong></p><p id="cf8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我认为第一资本应对数据泄露负责。他们拥有来自 AWS、第三方和开源项目的工具。最终，攻击是可以避免的，根据云责任模型，客户应对错误配置安全控制负责，AWS 没有过错。我确实认为 AWS 本可以让 S3 水桶在默认情况下更加安全。例如，一个角色可能不应该如此容易地访问 700 个存储桶。我认为 AWS 应该提供工具来帮助用户正确配置应用程序和服务。服务不应该包含与安全配置相关的数据。他们可以实施安全最佳实践、测试，并在配置过程中提醒用户。他们还可以提供工具，在应用程序或服务配置完成后对其进行扫描。在 VMware 的《2021 年云安全状况报告》中，六分之一的受访公司在过去一年中因配置不当而遭遇云数据泄露。(Cozens，2022) AWS 应该通过提供检查错误配置和安全问题的机制来支持其用户。</p><p id="037b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结论</strong></p><p id="b3dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总之，由于五个不同的安全控制失败，这次攻击是成功的。Capital One 发现一名外部用户访问了他们的网络，并采取了适当的措施来保护网络并通知受影响的个人。5 个失败的安全控制概述如下(Khan，2022):</p><p id="916d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.名为 Modsecurity WAF 错误配置的 WAF</p><p id="ef09" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.支持查询元数据服务的云基础架构的弱点，使得攻击者能够通过临时凭据获得访问权限</p><p id="51ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.缺少最低权限并允许 IAM 角色访问 S3 存储桶</p><p id="12a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.不恰当地使用加密技术和密钥来正确加密数据</p><p id="aed5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.入侵检测(IDS 或 IPS)和监控功能无效</p><p id="977c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于数据泄露，Capital One 面临 8000 万美元的罚款和处罚，并遭受了声誉和其他非金钱方面的后果。(Press，2020 年)这是一个很好的例子，说明一个资金充足、监管严格的组织是如何无法免受网络攻击的。需要进行适当的尽职调查，以确保他们的客户和组织得到适当的保护。此外，云服务提供商可以做得更好，使其服务在默认情况下更加安全，并通过工具和配置提供评估服务和应用程序安全状况的机制。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><p id="059f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献</strong></p><p id="c162" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Cozens，B. (2022 年 6 月 9 日)。<em class="lc">云数据泄露:云存储安全的 4 大威胁</em>。Malwarebytes。2022 年 11 月 20 日检索，来自<a class="ae ld" href="https://www.malwarebytes.com/blog/business/2022/06/cloud-data-breaches-4-biggest-threats-to-cloud-storage-security" rel="noopener ugc nofollow" target="_blank">https://www . malwarebytes . com/blog/business/2022/06/cloud-data-breakes-4-maximum-threats-to-cloud-storage-security</a></p><p id="d791" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">汗，s .，I .，华，y .，&amp; Madnick，S. (2022 年 2 月 1 日)。<em class="lc">对 Capital One 数据泄露事件的系统分析:关键教训</em>。美国计算机学会隐私与安全汇刊。2022 年 12 月 2 日，从<a class="ae ld" href="https://dl.acm.org/doi/10.1145/3546068" rel="noopener ugc nofollow" target="_blank">https://dl.acm.org/doi/10.1145/3546068</a>检索</p><p id="979f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一，C. (2022)。<em class="lc"> 2019 首创一号网络事件:发生了什么</em>。大写一。检索于 2022 年 12 月 2 日，来自<a class="ae ld" href="https://www.capitalone.com/digital/facts2019/" rel="noopener ugc nofollow" target="_blank">https://www.capitalone.com/digital/facts2019/</a></p><p id="41bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Press，T. A. (2020 年 8 月 7 日)。<em class="lc"> Capital one 因严重数据泄露被罚款 8000 万美元</em>。财富。检索于 2022 年 12 月 2 日，来自<a class="ae ld" href="https://fortune.com/2020/08/07/capital-one-fined-80-million-data-breach/" rel="noopener ugc nofollow" target="_blank">https://fortune . com/2020/08/07/capital-one-fined-8000 万-data-breach/ </a></p><p id="bb5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">趋势，M. (2022)。<em class="lc">首创 2010–2022 年财务收入:COF </em>。宏观趋势。2022 年 12 月 2 日检索，来自<a class="ae ld" href="https://www.macrotrends.net/stocks/charts/COF/capital-one-financial/revenue" rel="noopener ugc nofollow" target="_blank">https://www . macro trends . net/stocks/charts/COF/capital-one-financial/revenue</a></p><p id="315c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Waldman，A. (2022 年 6 月 20 日)。<em class="lc"> Paige Thompson 因 2019 年 capital one 数据泄露事件被判有罪:TechTarget </em>。安全。2022 年 12 月 2 日检索，来自<a class="ae ld" href="https://www.techtarget.com/searchsecurity/news/252521775/Paige-Thompson-found-guilty-in-2019-Capital-One-data-breach" rel="noopener ugc nofollow" target="_blank">https://www . techtarget . com/search security/news/252521775/Paige-Thompson-found-有罪-2019-Capital-One-data-breach</a></p><p id="19e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">沃尔夫，A. (2022 年 6 月 18 日)。capital one 的入侵:它的影响以及它教给我们的网络安全知识。北极狼。检索于 2022 年 12 月 2 日，来自<a class="ae ld" href="https://arcticwolf.com/resources/blog/the-capital-one-breach-its-impact-and-what-it-teaches-us-about-cybersecurity/" rel="noopener ugc nofollow" target="_blank">https://arctic wolf . com/resources/blog/the-capital-one-breach-its-impact-and-what-it-teaches-us-about-cyber security/</a></p></div></div>    
</body>
</html>