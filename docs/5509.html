<html>
<head>
<title>AccessibleML: Linear Regression with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AccessibleML:用 Python 实现线性回归</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/programming-machine-learning-linear-regression-with-python-1871609ee3c5?source=collection_archive---------3-----------------------#2021-10-11">https://medium.com/nerd-for-tech/programming-machine-learning-linear-regression-with-python-1871609ee3c5?source=collection_archive---------3-----------------------#2021-10-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7ef1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何使用 Scikit Learn 编写线性回归模型！</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/689c78fe7010069468265913e97811b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kio1iNolY2UqPguON_4fZg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">安娜·涅克拉舍维奇在<a class="ae jn" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">的照片</a></figcaption></figure><p id="dbaa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是我的“易访问性”系列的第一篇文章，我很高兴能写这篇文章！在参加了一些在线课程和阅读了一些书籍后，我最近学会了如何用 Scikit-Learn(一个 Python 库)用 Python 编写这些算法，并希望与他人分享我的知识！如果你刚刚开始接触人工智能，我建议你先阅读我的<a class="ae jn" href="https://itsliterallymonique.medium.com/?p=207e31388de1" rel="noopener">入门文章</a>，以了解人工智能算法的类型。</p><p id="e5fe" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我要讨论的第一个算法是线性回归。这是一种监督学习算法，可用于预测两个不同变量之间的关系。然后，我将向您展示如何使用 Scikit-Learn 创建一个模型！</p><h1 id="3225" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">线性回归:概述</h1><p id="f4af" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">线性回归是最简单的机器学习算法之一——然而，它可能非常强大！本质上，它是通过将一个线性方程拟合到数据上并绘制一条最佳拟合线来模拟两个变量之间的关系。从这个方程，如果你知道输入值，你可以很容易地找到输出。</p><p id="eb88" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，如果我收集了城市中不同房屋的房龄和市场价格的数据，我可以将它们绘制在图表上，然后画出最佳拟合线。这条最佳拟合线可以让我根据房龄预测房屋的市场价格。我也可以根据一条线的方程来做一个方程:<em class="lh"> y = mx + c </em></p><p id="261c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">线性回归图可能是这样的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es li"><img src="../Images/9f1ebe1de1be8548e9deb8b5574a87f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_eecnMFPR4uGyev5jDsvXQ.png"/></div></div></figure><h1 id="c8a7" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">下载数据集</h1><p id="f5b2" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">让我们来看看我们将要使用的数据集——来自 Kaggle 的<a class="ae jn" href="https://www.kaggle.com/camnugent/california-housing-prices" rel="noopener ugc nofollow" target="_blank">加州房价</a>数据集！在我们开始编程之前，您需要下载它。为此，请转到<a class="ae jn" href="https://www.kaggle.com/camnugent/california-housing-prices" rel="noopener ugc nofollow" target="_blank"> Kaggle 数据集</a>，然后在页面底部您会看到数据表。看到后，<strong class="jq hj">点击<strong class="jq hj">下载</strong>按钮上的</strong>！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lj"><img src="../Images/de7750a106a01740680a9eef5514d89d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*42e-sjZXj-8YAybt0D6PXA.png"/></div></div></figure><p id="3874" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">完成了吗？太棒了，现在下一步是通过绘制不同的列来做一些数据分析。通过这种方式，我们可以观察趋势，并决定将哪些列用于线性回归模型。</p><h1 id="d92d" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">可视化数据集</h1><p id="6062" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我们首先需要导入我们将使用的所有库:</p><ul class=""><li id="143e" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">scikit 学习</li><li id="abb3" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">熊猫</li><li id="9192" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">numpy</li><li id="4bf5" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">海生的</li></ul><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="c029" class="md kl hi lz b fi me mf l mg mh"><strong class="lz hj">import</strong> pandas <strong class="lz hj">as</strong> pd</span><span id="7d2b" class="md kl hi lz b fi mi mf l mg mh"><strong class="lz hj">import</strong> seaborn <strong class="lz hj">as</strong> sns</span><span id="08f8" class="md kl hi lz b fi mi mf l mg mh"><strong class="lz hj">import</strong> sklearn <strong class="lz hj">as</strong> sk</span><span id="4633" class="md kl hi lz b fi mi mf l mg mh"><strong class="lz hj">from</strong> sklearn.model_selection <strong class="lz hj">import</strong> train_test_split</span></pre><p id="43fb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后，我们将需要使用<strong class="jq hj">熊猫</strong>打开数据集的<strong class="jq hj"> csv </strong>文件！</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="f0be" class="md kl hi lz b fi me mf l mg mh">house_data = pd.read_csv("housing.csv")</span><span id="94e3" class="md kl hi lz b fi mi mf l mg mh">house_data.head()</span></pre><p id="50db" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> head() </strong>函数将给出数据集的前 5 行。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/5ccfaef80f7815670c6f851856cfcf0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6K1mg5kjjkUHAP88ii5Hg.png"/></div></div></figure><p id="68c2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">既然我们的数据都是干净漂亮的，我将使用另一个 Python 库<strong class="jq hj"> seaborn </strong>来创建一个非常特殊和有用的绘图——一个<strong class="jq hj"> pairplot </strong>！这将创建每一个可能的数据对，并一次性绘制出来。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="2df9" class="md kl hi lz b fi me mf l mg mh"># making the pairplot<br/>sns.pairplot(house_data, palette=pal)</span><span id="f413" class="md kl hi lz b fi mi mf l mg mh"># giving a title to our plots<br/>plt.title("Housing Prices Pairplot")</span></pre><p id="db5c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们可以看到哪些图具有相关性—这是我们可以用来创建线性回归模型的两列！我想我们将在模型中使用<strong class="jq hj">“total _ rooms”</strong>和<strong class="jq hj">“population”</strong>列。我在下图中用相关性圈出了图，以便于查看！请注意，<strong class="jq hj">经纬度</strong>图与<strong class="jq hj">经纬度</strong>图基本相同。因此，这些技术上是重复的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/f4c9d964ab90d4e93bfb0e350c454c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zj16dqPRm6cMMLNgR2pPzw.png"/></div></div></figure><h1 id="8e06" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">线性回归模型编程</h1><p id="1d37" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">因此，我们现在将开始创建我们的线性回归模型。然而，第一步是总是<strong class="jq hj">将我们的数据集分割</strong>成<strong class="jq hj">训练</strong>和<strong class="jq hj">测试</strong>数据，因为我们想要用以前没有遇到过的数据来检查我们的模型的准确性。首先，我们将把我们的<strong class="jq hj"> X </strong>变量分配给<strong class="jq hj">“人口”</strong>，把我们的<strong class="jq hj"> y </strong>变量分配给<strong class="jq hj">“总房间数”</strong>。因此，线性回归模型将使用人口来<strong class="jq hj">预测</strong>总房间数。使用<strong class="jq hj">两个</strong>方括号告诉 Python 该变量仍然是一个<strong class="jq hj">pandas</strong>T38】data frame，这确保了线性回归模型的工作。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="be2d" class="md kl hi lz b fi me mf l mg mh">X = house_data[['population']]<br/>y = house_data[['total_rooms']]</span></pre><p id="917f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们可以使用<strong class="jq hj"> train_test_split() </strong>函数将<strong class="jq hj"> X </strong>和<strong class="jq hj"> y </strong>分割成训练和测试数据。<strong class="jq hj"> test_size </strong>参数是如何分割的，将其设置为<strong class="jq hj"> 0.3 </strong>意味着 train 变量将拥有<strong class="jq hj"> 70% </strong>的数据，测试将拥有<strong class="jq hj"> 30% </strong>。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="ec01" class="md kl hi lz b fi me mf l mg mh">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)</span></pre><p id="23c9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">是时候真正制作我们的模型了！！！我们需要首先创建我们的模型，并将其设置为一个变量。在 Scikit Learn 中，我们是这样创建模型的:</p><ol class=""><li id="52b8" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj ml lq lr ls bi translated"><strong class="jq hj">从<strong class="jq hj"> sklearn </strong>导入</strong>线性回归模型。</li></ol><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="c0a4" class="md kl hi lz b fi me mf l mg mh"><strong class="lz hj">from</strong> sklearn.linear_model <strong class="lz hj">import</strong> LinearRegression</span></pre><p id="4644" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">2.创建我们的模型，并将其设置为一个变量。我们没有参数，因为默认值很好。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="5077" class="md kl hi lz b fi me mf l mg mh">lreg = LinearRegression()</span></pre><p id="f40f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">3.<strong class="jq hj">使用<strong class="jq hj"> fit() </strong>函数训练</strong>模型，将我们的训练变量放在括号内。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="a503" class="md kl hi lz b fi me mf l mg mh">lr = lreg.fit(X_train, y_train)</span></pre><p id="7480" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">干得好，你已经创建了自己的线性回归模型！</p><h1 id="d6b3" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">分析结果</h1><p id="4dd4" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">仅仅制作模型是不够的。我们需要检查我们的模型在根据人口预测总房间数时是否真的有用。为此，我们需要检查准确性。这可以使用一个简单的函数来完成，这个函数叫做<strong class="jq hj"> score() </strong>:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="3642" class="md kl hi lz b fi me mf l mg mh"># using the function <strong class="lz hj">score()</strong> to see the accuracy of our model based on our test variables</span><span id="8183" class="md kl hi lz b fi mi mf l mg mh"><strong class="lz hj">print</strong>("Accuracy Score:", lr.score(X_test, y_test)*100)</span></pre><p id="7a47" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">准确率为<strong class="jq hj"> 74.9% </strong>，一点都不差！</p><h1 id="4558" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">扩展:多变量线性回归</h1><p id="cabc" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">该数据集是一个房价数据集，所以如果我们不创建一个线性回归模型来预测房价，这将是不公平的。然而，正如你在数据可视化中看到的，房价和任何其他栏目之间实际上没有相关性。</p><p id="4b5c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是，如果所有其他列组合在一起会创建一个相关性呢？我们来试试吧！这个想法非常相似，但是，我们将使用除“median_house_value”列之外的所有列，而不是 X 变量只有一列。让我们试一试。</p><p id="35ed" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，我们将再次分离 X 和 y 变量，这次使用。drop()获取我们的 X 列！我们还想从 X 变量中删除“ocean_proximity”列，因为它不包含数字数据。然后还将其分成训练和测试数据。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="7b17" class="md kl hi lz b fi me mf l mg mh"># includes all columns except the "median_house_value" and "ocean_proximity" columns<br/>X_multi = house_data.drop(["median_house_value", "ocean_proximity"], axis = 1)<br/>y_multi = house_data[["median_house_value"]]<br/>X_multi_train, X_multi_test, y_multi_train, y_multi_test = train_test_split(X_multi, y_multi, test_size = 0.3, random_state = 0)</span></pre><p id="2211" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在运行模型之前，您还需要将其从 NaN 值中清除。在训练线性回归模型时，我得到了一个错误，通知我有 NaN 值。你可能想知道，“NaN 值到底是什么？”嗯，它们本质上是不包含数据的单元格——它们是空的！以下是去除它们的简单技巧:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="69ab" class="md kl hi lz b fi me mf l mg mh">house_data.dropna()</span></pre><p id="fa4b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">只要确保在拆分数据之前放入这些代码就行了！</p><p id="43d8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们的模型已经设置好了，所以我们要做的就是将它训练(或拟合)到我们的 X_multi 和 y_multi 变量，然后检查我们的准确性</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="999c" class="md kl hi lz b fi me mf l mg mh"># train model<br/>lr_multi = lreg.fit(X_multi_train, y_multi_train)</span><span id="c39d" class="md kl hi lz b fi mi mf l mg mh"># get the accuracy<br/><strong class="lz hj">print</strong>("Accuracy Score:", lr_multi.score(X_multi_test, y_multi_test)*100)</span></pre><p id="7a15" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">所以…我得到的准确率在<strong class="jq hj"> 64.0% </strong>左右，并不是最好的准确率分数。但是，您可以通过删除列来试验一下，看看是否有所改进！很好地完成了本教程。机器学习并不总是容易学会的——但请继续努力吧！</p><h1 id="855e" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">下次见！</h1><p id="a119" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我希望你喜欢阅读本教程，并学会如何使用 Scikit Learn 编写线性回归模型！欢迎留下评论，提出任何问题，我很乐意帮忙。下一个模型将是逻辑回归…敬请期待！</p><p id="9aef" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下面是我的代码的 github 文件:<a class="ae jn" href="https://github.com/itsliterallymonique/Linear-Regression-using-California-Housing-Prices-dataset" rel="noopener ugc nofollow" target="_blank">点击这里！</a></p></div></div>    
</body>
</html>