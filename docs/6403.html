<html>
<head>
<title>Typescript sealed union types — better factories without switch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Typescript 密封联合类型—没有开关的更好的工厂</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/typescript-sealed-union-types-better-factories-without-switch-32deda73a26b?source=collection_archive---------0-----------------------#2022-02-17">https://medium.com/nerd-for-tech/typescript-sealed-union-types-better-factories-without-switch-32deda73a26b?source=collection_archive---------0-----------------------#2022-02-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d3bf9a5b2e3a430f06c0a36922fc24cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*21JBhrZoKoKkzNCE-w23wg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">安东尼奥·巴蒂尼奇从<a class="ae iu" href="https://www.pexels.com/photo/black-screen-with-code-4164418/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>拍摄的照片</figcaption></figure><p id="f318" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你曾经偶然发现一个奇怪的编程世界，那么你可能听说过<a class="ae iu" href="https://en.wikipedia.org/wiki/Factory_method_pattern" rel="noopener ugc nofollow" target="_blank">工厂方法模式</a>。它真的很有用，可以让你的生活更轻松(不要相信我，读一读它是关于什么的，试着理解它的利弊)。</p><p id="cd22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您将它与 typescript 中的<a class="ae iu" href="https://www.typescriptlang.org/docs/handbook/literal-types.html" rel="noopener ugc nofollow" target="_blank">字符串文字类型</a>和<a class="ae iu" href="https://www.w3schools.com/js/js_objects.asp" rel="noopener ugc nofollow" target="_blank"> javascript 对象</a>相结合，您将能够立即创造出惊人的东西。</p><p id="4b5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看一个例子:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="9ad0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尽管这个例子有它的缺点，但它可以向您展示如何利用前面提到的概念创建有区别的联合。我们使用<code class="du jz ka kb kc b">_tag</code>属性来区分不同的工厂。它具有字符串文字类型的联合类型，因此被定义为可能的字符串值的有限集合。通过这种方式，typescript 编译器知道允许的值，现代 IDE(或编辑器)可以基于这一点很容易地帮助您。</p><p id="1ae3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">之后我们定义了所有工厂都必须遵守的接口。这样我们就可以充分利用多态的力量，面向接口而不是实现编程。</p><p id="13db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">具体工厂(<code class="du jz ka kb kc b">Factory1</code>、<code class="du jz ka kb kc b">Factor2</code>、<code class="du jz ka kb kc b">Factory3</code>)以这种方式实现，只是作为示例，实现完全取决于业务逻辑。</p><p id="9afe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有趣的部分来了。我们将抛弃<code class="du jz ka kb kc b">switch</code>语句，转而支持 javascript 对象(或者本质上是 map，如果你想在不同的编程语言中使用这种策略的话)。那么这个物体是由什么组成的呢？如果您已经阅读了这篇文章，那么键实际上是用于<code class="du jz ka kb kc b">_tag</code>字段的 union 中的字符串文字，而值是应该从有区别的 union 中返回三个工厂之一的函数。为了实现这个类型<code class="du jz ka kb kc b">FactoryT</code>已经被定义为一个函数返回类型。另外，即使我们可以用前面提到的键和值创建一个对象，我还是决定用一个函数，以防万一你想传递一些创建将被返回的对象所需的选项。</p><p id="7792" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后有一个用法的例子，当然这是人为的，这就是为什么它写着<code class="du jz ka kb kc b">clientFactories[factoryType || "default"]</code>，因为通常你可能不知道你是否有工厂类型以及它是否是正确的，所以最安全的是退回到<code class="du jz ka kb kc b">"default"</code>。</p><p id="8397" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以使用泛型、不同的参数类型等使这变得更复杂。或者用字符串类型和类型映射来简化它。由你决定:)</p><p id="6934" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您对如何改进这一点有任何意见，请写下来。另外，如果你喜欢这篇文章，请鼓掌并跟我来。</p><h1 id="035a" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">文学</h1><ol class=""><li id="8168" class="lb lc hi ix b iy ld jc le jg lf jk lg jo lh js li lj lk ll bi translated"><a class="ae iu" href="https://refactoring.guru/design-patterns/factory-method/typescript/example" rel="noopener ugc nofollow" target="_blank">https://refactoring . guru/design-patterns/factory-method/typescript/example</a></li><li id="a184" class="lb lc hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://www.logicbig.com/tutorials/misc/typescript/discriminated-unions.html" rel="noopener ugc nofollow" target="_blank">https://www . logic big . com/tutorials/misc/typescript/discribed-unions . html</a></li><li id="ee1e" class="lb lc hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://mariusschulz.com/blog/string-literal-types-in-typescript" rel="noopener ugc nofollow" target="_blank">https://mariusschulz . com/blog/string-literal-types-in-typescript</a></li><li id="8413" class="lb lc hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" rel="noopener" href="/codex/factory-pattern-type-script-implementation-with-type-map-ea422f38862">https://medium . com/codex/factory-pattern-type-script-implementation-with-type-map-ea 422 f 38862</a></li></ol></div></div>    
</body>
</html>