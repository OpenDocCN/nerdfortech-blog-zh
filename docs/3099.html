<html>
<head>
<title>Naive Bayes Algorithm in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的朴素贝叶斯算法</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/naive-bayes-algorithm-in-machine-learning-ca4c896d95b7?source=collection_archive---------19-----------------------#2021-05-29">https://medium.com/nerd-for-tech/naive-bayes-algorithm-in-machine-learning-ca4c896d95b7?source=collection_archive---------19-----------------------#2021-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5cea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为 ML 爱好者和爱好者设计的改变游戏规则的算法</strong></p><p id="8f41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di"> N </span> aive Bayes 是一种概率算法，通常用于分类问题。朴素贝叶斯简单、直观，但在许多情况下表现惊人地好。朴素贝叶斯算法之所以称为“朴素”，是因为它假设某个特征的出现独立于其他特征的出现。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/2ccd8b84f4915423399c9b7b0de864c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OOWSoWHeQ5kyJ4N0P2ptNA.png"/></div></div></figure><h1 id="1436" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">朴素贝叶斯算法背后的数学</h1><p id="fb92" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">简单写成<strong class="ih hj">p(a | b)=【p(b | a)⋅p(a)】/p(b)</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lb"><img src="../Images/84173eba10e2adced0fb83e5ac4b4663.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*5ZdkaWDps6CKL2CwrnC4Yw.jpeg"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">朴素贝叶斯标准公式</figcaption></figure><p id="49ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以这里的“A”代表类，例如球或任何东西。“B”代表单独计算的特性。贝叶斯定理简化了后验概率的计算，它提供了一种方法，即从 P ( A)，P ( B)和 P ( B| A)计算 P ( A| B)。</p><ul class=""><li id="71c2" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">P ( A | B)是 A 类给定预测值(特征)的后验概率。</li><li id="138f" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">P ( A)是类的概率。</li><li id="5879" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">P ( B | A)是似然性，它是给定类别的预测值的概率。</li><li id="bb2a" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">P ( B)是预测值的早期概率。</li></ul><p id="c2e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯分类器采用的假设实际上是一个强大的假设，即预测值(B)对给定类(A)的影响独立于其他预测值。因为假设，也叫类条件独立。</p><h1 id="52f0" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">朴素贝叶斯的例子</strong></h1><p id="6433" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">一个清晰的例子可以让你深入了解上面的等式是如何付诸实践的。让我们考虑一个由 10 个数据样本组成的简单数据集:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lv"><img src="../Images/710183e2b7421bf27c1dd26a75041979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVT9UHO2tZOYZxkX8AFhAw.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">数据由 10 个数据样本记录组成</figcaption></figure><p id="df6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">给定三个输入——例如，单亲、年轻和低——我们想计算这些人买车的概率。让我们用朴素贝叶斯。</p><p id="2aa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们计算给定数据的输出标签的概率(P(Y))。</p><p id="cf56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(否)= 4/10 </strong></p><p id="50c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> P(是)= 6/10 </strong></p><p id="142c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来计算证据可能性的概率。给定输入无子女、年轻和低，我们将计算两个分类标注的概率，如下所示:</p><p id="6b58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(单亲|是)= 1/6 <br/> P(单亲|否)= 1/4 <br/> P(年轻|是)= 2/6 <br/> P(年轻|否)= 1/4 <br/> P(低|是)= 1/6 <br/> P(低|否)= 4/4</p><p id="866f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为 P(X1) * P(X2) * … * P(Xn)在计算“是”和“否”输出标签的概率时保持不变，所以我们可以消除该值。</p><p id="1a62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，后验概率计算如下(注意<em class="lg"> X </em>是测试数据):</p><p id="0668" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(是|X) = P(单亲|是)* P(年轻|是)* P(低|是)= 1/6 * 2/6 * 1/6 = 0.0063</p><p id="16e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(No|X) = P(单亲|No) * P(年轻|No) * P(低|No) = 1/4 * 1/4 * 4/4 = 0.0625</p><p id="f9bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终概率是:</p><p id="cf1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(是| X)= 0.0063/(0.0063+0.0625)= 0.09<br/>P(否| X)= 0.0625/(0.0063+0.0625)= 0.91</p><p id="87f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，结果清楚地表明，汽车可能不会被购买。</p><p id="97c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们之前提到过，该算法的“幼稚”之处在于它假设每个特征都是相互独立的。我们根据这一假设计算了输出标签的概率，因此每个特征都具有相同的贡献，并且独立于所有其他特征。这确实是一个天真的假设。</p><h1 id="cbd7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">朴素贝叶斯算法的 python 实现</h1><p id="11e9" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">用 Python 实现和构建朴素贝叶斯算法。第一步是导入所有必需的库。</p><ul class=""><li id="57b0" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated"><em class="lg">导入</em> NumPy 作为 np</li><li id="42df" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated"><em class="lg">进口</em>熊猫当 pd</li><li id="dc10" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated"><em class="lg">from</em>sk learn . naive _ Bayes<em class="lg">import</em>GaussianNB</li><li id="ce5c" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated"><em class="lg">从</em> sklearn .预处理<em class="lg">导入</em> LabelEncoder</li><li id="d25a" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated"><em class="lg">从</em>sk learn . model _ selection<em class="lg">导入</em> train_test_split</li><li id="49a6" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated"><em class="lg">从</em> sklearn.metrics <em class="lg">导入</em> accuracy_score</li></ul><blockquote class="lw lx ly"><p id="ee44" class="if ig lg ih b ii ij ik il im in io ip lz ir is it ma iv iw ix mb iz ja jb jc hb bi translated"><strong class="ih hj">实施朴素贝叶斯算法的步骤</strong></p></blockquote><p id="f703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯算法的主要目的是计算具有属于特定类别的特征向量 f1，f2，…，fn 的对象的条件概率。下面是一些要实现的步骤。</p><p id="3403" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lg"> 1。数据加载</em> </strong> <em class="lg"> : </em></p><p id="9862" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从任何文件加载数据</p><p id="a23f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将其格式化为“xls”或“CSV”文件格式</p><p id="975c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将其分为训练数据集和测试数据集。</p><p id="377f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">T29】2。准备数据 </strong> <em class="lg"> : </em></p><p id="91de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总结训练数据集的属性，以计算进行预测的概率。</p><p id="3b1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lg"> 3。生成预测</em> </strong>:</p><p id="3a60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用步骤 2 中的训练数据集，清理并组织它。</p><p id="6d95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对测试数据集生成单个预测。</p><p id="b534" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lg"> 4。绩效评估</em> </strong>:</p><p id="5b23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">评估模型</p><p id="9ca2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重复步骤 2、3 和 4 以提高预测的准确性。</p><p id="874d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">找出误差最小的地方</p><p id="7526" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lg"> 5。清理和定稿</em> </strong> <em class="lg"> : </em></p><p id="f161" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">清理、组织和润色预测模型代码</p><p id="d110" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用包含所有元素的预测模型来呈现完整的质量代码</p><p id="8ba9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实现并保存算法的代码。</p><h1 id="6ec8" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">朴素贝叶斯各种应用</h1><p id="1a73" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">朴素贝叶斯算法在大量的现实生活场景中使用，例如</p><ol class=""><li id="a092" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc mc ln lo lp bi translated"><strong class="ih hj">文本分类</strong>:用作文本分类的概率学习方法。当涉及到文本文档的分类，即文本文档是否属于一个或多个类别(类)时，朴素贝叶斯分类器是最成功的已知算法之一。</li><li id="6c2d" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mc ln lo lp bi translated">多类预测:如前所述，当输出变量有两个以上的类时，朴素贝叶斯工作得很好。</li><li id="886d" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mc ln lo lp bi translated"><strong class="ih hj">推荐系统</strong>:朴素贝叶斯算法结合协同过滤用于构建混合推荐系统，帮助预测用户是否喜欢给定的资源。</li><li id="d298" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mc ln lo lp bi translated"><strong class="ih hj">文本分类</strong>:文本分类还包括垃圾邮件过滤和情感分析等子应用。由于朴素贝叶斯最适合处理离散变量，因此它在这些应用程序中也能很好地工作。</li></ol><h1 id="b9a7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">朴素贝叶斯算法的利与弊</h1><p id="bcb0" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">每个硬币都有两面。朴素贝叶斯算法也是如此。它有优点也有缺点，列举如下:</p><blockquote class="lw lx ly"><p id="61c0" class="if ig lg ih b ii ij ik il im in io ip lz ir is it ma iv iw ix mb iz ja jb jc hb bi translated"><strong class="ih hj">优点如下:</strong></p></blockquote><ul class=""><li id="3760" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">朴素贝叶斯易于掌握，并且可以快速预测类别标签。在多类预测上也表现不错。</li><li id="0d32" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">它可以有效地处理大型数据集。</li><li id="97f8" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">它可以用于多类预测问题。</li><li id="2708" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">当输入值是分类值而不是数字值时，它的性能很好。在数字的情况下，假设正态分布来计算概率(钟形曲线，这是一个强假设)。</li><li id="900f" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">当独立性假设成立时，朴素贝叶斯分类器与其他模型(如逻辑回归)相比表现更好。</li></ul><blockquote class="lw lx ly"><p id="c730" class="if ig lg ih b ii ij ik il im in io ip lz ir is it ma iv iw ix mb iz ja jb jc hb bi translated"><strong class="ih hj">缺点如下:</strong></p></blockquote><ul class=""><li id="f6f7" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">如果分类变量在测试数据集中有一个类别，而该类别在训练数据中未被模型观察到，则它将分配 0(零)概率，并且无法进行预测。这就是通常所说的“<strong class="ih hj">零频</strong>”。为了解决这个问题，我们可以使用平滑技术。最简单的平滑技术之一叫做<strong class="ih hj">拉普拉斯估计</strong>。</li><li id="3f34" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">独立特征的假设。实际上，该模型几乎不可能得到一组完全独立的预测值。</li><li id="2716" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">从这个算法来看，概率估计不是最值得信赖的。</li></ul><h1 id="e395" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">摘要</h1><p id="7956" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">虽然朴素贝叶斯有一些限制，但它仍然是分类数据的首选算法，主要是因为它简单。它在文档分类和垃圾邮件过滤方面表现尤为出色。为了更实际地理解 Naive Bayes，我建议您尝试使用我们在各种其他数据集上实现的内容，以更深入地了解 Naive Bayes 如何对数据进行分析和分类。</p></div></div>    
</body>
</html>