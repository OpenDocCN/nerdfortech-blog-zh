<html>
<head>
<title>Mochawesome Report Integration with Cypress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mochawesome 报告与 Cypress 的集成</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/mochawesome-report-integration-with-cypress-e9f5c72c01a3?source=collection_archive---------3-----------------------#2021-06-02">https://medium.com/nerd-for-tech/mochawesome-report-integration-with-cypress-e9f5c72c01a3?source=collection_archive---------3-----------------------#2021-06-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8a9c2c757644bc58e90e7f1a400cdfa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1iXZEdAGJkPsyGcpuOzwYQ.png"/></div></div></figure><p id="87d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是摩卡牛逼</strong></p><p id="3a77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Mochawesome 是为 mocha 定制的 Javascript 测试报告程序。这是一个简单，圆滑，现代风格，可爱的图表，测试和套件嵌套支持，显示之前或之后的挂钩，检查在线测试代码。它对失败的测试进行跟踪，并支持为测试添加的上下文信息。它只过滤显示你想要的测试。【https://www.npmjs.com/package/mochawesome T2】号</p><p id="31e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，让我们使用命令提示符安装它。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="94c1" class="jy jz hi ju b fi ka kb l kc kd">npm i --save mochawesome</span></pre><p id="f9c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我创建了一个测试<strong class="is hj">orangehrm-moch awesome-log in . spec . js</strong></p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="8189" class="jy jz hi ju b fi ka kb l kc kd">import {Login} from "../pages/Login";<br/>const login = new Login();<br/><br/>describe('Login Page',()=&gt;{<br/>    beforeEach('navigate to login page',()=&gt;{<br/>        login.navigate();<br/>    })<br/>    it('should not be able to login to using invalid credentials',()=&gt;{<br/>        login.validateTheLoginPage();<br/>        login.login('Admin','admin');<br/>        login.validateInvalidCredentials('Invalid credentials');<br/>    })<br/>    it('should be able to login to using valid credentials',()=&gt;{<br/>        login.login('Admin','admin123')<br/>        cy.get('#welcome').should('have.text','Welcome Paul');<br/>    })<br/>})</span></pre><p id="8b33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后通过以下命令运行该命令:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="b9de" class="jy jz hi ju b fi ka kb l kc kd">cypress run --spec "cypress/integration/orangehrm-mochawesome-login.spec.js" --reporter mochawesome</span></pre><p id="1198" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦它被执行，您就会在下面的路径中看到 HTML 和 JSON 报告:moch awesome-report/moch awesome . HTML</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/9948b32dc382c451a4a65dd95d4984d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2svV0_x2Ls9dvnJJBkh8dQ.png"/></div></div></figure><p id="e6ff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们打开 HTML 报告时，您可以看到如下图像:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/08feb0b3d1d5e931a1ea0e1e0255c35e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDdtH-Dr_6uSf1q4lz5NhA.png"/></div></div></figure><p id="f31b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我测试失败并打开 HTML 文件:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/e4c5863225340f72e17cd6bc28116214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-JQZFavtEaifuZKQ2QOeCg.png"/></div></div></figure><p id="7403" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这份报告真的很棒，对吧，☺☺☺☺</p><p id="267e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在是时候用失败截图把报告做得很详细了。将以下代码片段添加到 describe 块中。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="64e4" class="jy jz hi ju b fi ka kb l kc kd">Cypress.on('test:after:run', (test, runnable) =&gt; {<br/>    if (test.state === 'failed') {<br/>        const screenshot = `screenshots/${Cypress.spec.name<br/>        }/${runnable.parent.title} -- ${test.title} (failed).png`;<br/>        addContext({ test }, "/cypress-tests/cypress/"+screenshot);<br/>    }<br/>});</span></pre><p id="b8dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Cypress 在每个测试用例执行后检查失败，如果失败，它从给定的路径中获取截图并将其添加到报告中。</p><p id="98d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完整详细的代码:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="5929" class="jy jz hi ju b fi ka kb l kc kd">import {Login} from "../pages/Login";<br/>const login = new Login();<br/>const addContext = require('mochawesome/addContext');<br/><br/>describe('Login Page',()=&gt;{<br/>    beforeEach('navigate to login page',()=&gt;{<br/>        login.navigate();<br/>    })</span><span id="7475" class="jy jz hi ju b fi kh kb l kc kd">    Cypress.on('test:after:run', (test, runnable) =&gt; {<br/>        if (test.state === 'failed') {<br/>            const screenshot = `screenshots/${Cypress.spec.name<br/>            }/${runnable.parent.title} -- ${test.title} (failed).png`;<br/>            addContext({ test }, "/cypress-tests/cypress/"+screenshot);<br/>        }<br/>    });<br/><br/>    it('should not be able to login to using invalid credentials',()=&gt;{<br/>        login.validateTheLoginPage();<br/>        login.login('Admin','admin');<br/>        login.validateInvalidCredentials('Invalid credentials');<br/>    })<br/>    it('should be able to login to using valid credentials',()=&gt;{<br/>        login.login('Admin','admin1234')<br/>        cy.get('#welcome').should('have.text','Welcome Paul');<br/>    })<br/>})</span></pre><p id="4d3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后再次运行测试并打开 HTML 报告:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/2dd4ceac3fcacd5ad79b14d916d642f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1w-N0y9XC2AnrVQlFWOyYw.png"/></div></div></figure></div></div>    
</body>
</html>