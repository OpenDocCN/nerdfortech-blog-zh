<html>
<head>
<title>Understanding Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/understanding-logistic-regression-782baa868a54?source=collection_archive---------1-----------------------#2021-04-23">https://medium.com/nerd-for-tech/understanding-logistic-regression-782baa868a54?source=collection_archive---------1-----------------------#2021-04-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/43997006fbe6ebed56464cd1e18cf5b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*is3vZACPepjNVWf-j6kUgA.jpeg"/></div></div></figure><p id="642f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到目前为止，我们要么着眼于估计连续变量的条件期望(如在回归中)。然而，在许多情况下，我们对投入产出关系感兴趣，如在回归中，但产出变量是离散的而不是连续的。</p><p id="6e43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">特别是，在很多情况下我们会有二元的结果(一种情况只有两种可能的结果)。除了二元结果，我们还有一些输入变量，它们可能是连续的，也可能不是连续的。</p><p id="bc3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们如何对这些数据进行建模和分析？我们可以试着想出一个从输入变量中猜测二进制输出的规则。这叫做分类，是统计学和机器学习中的一个重要课题。</p><p id="a8f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分类预测离散的目标标签 y。分类是基于从带标签的训练数据构建的分类模型，将新观察值分配给它们最可能属于的类别的问题。</p><p id="5300" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分类的准确性将取决于您选择的算法的有效性、您如何应用它以及您有多少有用的训练数据。</p><h2 id="5690" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">逻辑回归</h2><p id="2d1a" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">逻辑回归是一种分类方法，其中模型输出分类目标变量 Y 属于某一类别的概率。</p><p id="32b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">换句话说，逻辑回归是一种用于预测因变量的方法，给定一组自变量，使得因变量是分类的。</p><ul class=""><li id="6812" class="ko kp hi is b it iu ix iy jb kq jf kr jj ks jn kt ku kv kw bi translated">因变量(Y):响应二进制变量，包含值 0 或 1，是或否。</li><li id="31cc" class="ko kp hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">自变量(X):用于预测响应变量的预测变量。</li></ul><p id="0570" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上，逻辑回归的结果是明确的。因此，当结果有两个可能的值时，总是希望有一个预测 0 或 1 或 0 到 1 之间的概率得分的模型。</p><blockquote class="lc ld le"><p id="9d20" class="iq ir lf is b it iu iv iw ix iy iz ja lg jc jd je lh jg jh ji li jk jl jm jn hb bi translated">虽然逻辑回归通常用于有两个类别的二元分类，但请记住，分类可以用任何数量的类别来执行(例如，当给手写数字分配 0 到 9 之间的标签时)。但是我们只对二元分类使用逻辑回归。</p></blockquote><p id="90c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以应用逻辑回归的分类问题的一个很好的例子是确定贷款申请是否是欺诈性的。</p><p id="d27f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最终，贷款人想知道他们是否应该给借款人贷款，他们对申请事实上是欺诈性的风险有一定的容忍度。</p><p id="c048" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，逻辑回归的目标是计算应用程序是欺诈的概率(在 0%和 100%之间)。有了这些概率，我们就可以设定一个阈值，如果超过这个阈值，我们就愿意借钱给借款人，如果低于这个阈值，我们就拒绝他们的贷款申请，或者对申请进行进一步审查。</p><h2 id="0f9f" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated"><strong class="ak">为什么不用线性回归来预测概率？</strong></h2><p id="5f5b" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">对于分类变量，使用线性回归是不合适的，因为响应值不是在比率尺度上测量的，并且误差项不是正态分布的。</p><p id="dba5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，线性回归模型可以将预测值生成为从负到正无穷大范围内的任何实数，而分类变量只能采用指定范围内有限数量的离散值。</p><p id="c963" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，如果你对一系列 Y = 0 或 1 的例子训练一个线性回归模型，你可能最终预测出一些小于 0 或大于 1 的概率，这是没有意义的。这是因为线性回归适用于连续响应变量。</p><p id="d758" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们不能利用线性回归。相反，我们将使用逻辑回归模型，该模型被设计为分配 0 到 1 之间的概率，表示 Y 属于某个类。</p><h2 id="77b2" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">逻辑回归背后的数学</h2><blockquote class="lc ld le"><p id="62b5" class="iq ir lf is b it iu iv iw ix iy iz ja lg jc jd je lh jg jh ji li jk jl jm jn hb bi translated">这一部分的数学很有趣，但可能更具技术性。</p></blockquote><p id="09db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">逻辑回归(logit 模型)是对线性回归的一种修改，它通过应用 sigmoid 函数来确保输出介于 0 和 1 之间的概率，当绘制该函数时，它看起来就像特征 S 形曲线。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/d23aed741d312f7814c14d9657117dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/0*OKtToRvreZL8FLiZ"/></div></figure><p id="7e1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Sigmoid 函数压缩 0 和 1 之间的值，其计算公式如下</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/d0bf4f3855c35348ab907bb20d1c2bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/0*Nm_UcNC5H2S2-8yq"/></div></figure></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><p id="ee1b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在继续之前，让我们先了解什么是几率，以及它们与概率有何不同。</p><p id="95b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">概率是某件事发生与某件事没有发生的比率。概率是某件事情发生与所有可能发生的事情的比率。</em></p><p id="a178" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">举个例子，我们队赢一局的几率是 3 比 5(赢局数与输局数之比)，那么你们队赢的几率是 3 比 8(赢局数与总局数之比)</em></p><p id="947b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">为了根据概率计算赔率，我们有</em></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/8326b73690ba9353712028005a9c4190.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/0*_q8o7-ySeP6_KYtI"/></div></figure><p id="0d86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">哪里，</em></p><ul class=""><li id="47a4" class="ko kp hi is b it iu ix iy jb kq jf kr jj ks jn kt ku kv kw bi translated"><em class="lf"> p 是事件发生的概率，在我们的案例中是获胜的概率</em></li></ul><p id="8f72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">概率有一个上限，即一个事件的概率不能大于 1。但是当把概率转换成赔率时，就去掉了上限。但是概率的下限呢。取赔率的对数就去掉了下限。</em></p><p id="a56f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">采用对数赔率的另一个原因是，你的团队获胜的几率可以从 0 到 1。但是你的团队失败的几率可以从 1 到无穷大。由于赔率值之间的不对称，我们采用了对数。采用 log()的概率通过使一切对称来解决问题。</em></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/89f0c0ab66fba6eda9fa28782fd7fcfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/0*r1N_mZFN0IvWZALX"/></div></figure><p id="38c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">概率比的对数被称为 logit 函数，是逻辑回归的基础。</em></p></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><blockquote class="lc ld le"><p id="7f23" class="iq ir lf is b it iu iv iw ix iy iz ja lg jc jd je lh jg jh ji li jk jl jm jn hb bi translated">如果你不熟悉线性回归，可以看看下面这篇文章<a class="ae ly" rel="noopener" href="/geekculture/linear-regression-in-a-nutshell-1714d5665fd2"> <strong class="is hj">简单地说线性回归</strong> </a></p></blockquote><p id="21c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回想一下简单线性回归模型的原始形式，我们现在称之为 g(x ),因为我们将在复合函数中使用它:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/0b942da6f0b5afc92c6240b9ea92c2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/0*LdRlv6ry_X8gGQYE"/></div></figure><p id="9ad1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">哪里，</em></p><ul class=""><li id="2105" class="ko kp hi is b it iu ix iy jb kq jf kr jj ks jn kt ku kv kw bi translated"><em class="lf"> β0 是 y 轴截距</em></li><li id="a0ca" class="ko kp hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated"><em class="lf"> β1 是直线的斜率</em></li><li id="0616" class="ko kp hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated"><em class="lf"> x 是 x 坐标的值</em></li><li id="a7a6" class="ko kp hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated"><em class="lf"> y 是预测值</em></li></ul><p id="bd04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，为了解决模型输出小于 0 或大于 1 的问题，我们将定义一个新的函数 F(g(x))，通过将线性回归的输出压缩到[0，1]范围内的值来转换 g(x)。</p><p id="9e73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们将 g(x)代入上述 sigmoid 函数，得到一个输出概率在 0 和 1 之间的函数:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/9d16e9b7066172217acc18bd350bf821.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/0*TH2DoBHoDyJQHGod"/></div></figure><p id="b21a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">换句话说，我们正在计算训练示例属于某个类的概率:P(Y=1)。</p><p id="5ffc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">上式的推导</strong></p><p id="83a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">线性方程如</em>所示</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/6c1f46a248fcb2206e4233bcbaaa5d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/0*JeDVLtjpP8XEpGAs"/></div></figure><p id="1e5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">现在，我们预测中奖的几率</em></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/2e6c1f7762229c8c8e9c5fb5d9d5e293.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/0*Z3g-HOg9KuVLnhHn"/></div></figure><p id="c1c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">双方指数化</em></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es md"><img src="../Images/0ff42506584b36700ce8b4bc8012878c.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/0*GX-3jfDD-kUnxn_P"/></div></figure><p id="9653" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">现在让，</em></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es me"><img src="../Images/89ec5b8e47a935ed7c47518411897eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:172/0*FGM4TnP7hyXion9j"/></div></figure><p id="8849" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">然后，</em></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/6e0b1a8cd0d0915e5764504f8f03aa0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/0*7pp9X73DTJ__jgDS"/></div></figure><blockquote class="lc ld le"><p id="6d34" class="iq ir lf is b it iu iv iw ix iy iz ja lg jc jd je lh jg jh ji li jk jl jm jn hb bi translated">在 logit 模型中，β1 现在表示随着 X 的变化，对数优势比的变化率。换句话说，这是“对数优势的斜率”，而不是“概率的斜率”。</p></blockquote><h1 id="0f23" class="mg jp hi bd jq mh mi mj ju mk ml mm jy mn mo mp kb mq mr ms ke mt mu mv kh mw bi translated">最大似然估计</h1><p id="3740" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">最大似然估计(MLE)是一种估计逻辑回归模型参数的方法。这种估算方法是最广泛的一种<a class="ae ly" href="https://arunaddagatla.medium.com/maximum-likelihood-estimation-in-logistic-regression-f86ff1627b67" rel="noopener"> …【阅读更多】</a></p><h1 id="bed4" class="mg jp hi bd jq mh mi mj ju mk ml mm jy mn mo mp kb mq mr ms ke mt mu mv kh mw bi translated">了解逻辑回归模型的输出</h1><p id="a9b0" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">如前所述，逻辑回归只计算结果为 0 或 1。那么为什么我们会有一条从 0 到 1 的曲线呢？在 0 和 1 处应该是一条直线。这是因为逻辑回归计算概率。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/80e682cefadfae55fd6fa27030fc9c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*oOgETPD4zbHkQ0vP"/></div></figure><p id="82d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑一个事件发生概率为 0.6 的例子，这个输出属于 0 类还是 1 类。</p><p id="407d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，设置一个阈值。考虑阈值为 0.5。这意味着 0 到 0.5 范围内的任何值都被分类为 0，0.5 到 1 被分类为 1。这将得到一个二进制结果，即使结果是连续的。</p><p id="61d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，预测 Y 标签——垃圾邮件/非垃圾邮件、癌症/非癌症、欺诈/非欺诈等。—你必须设置一个概率截止值或阈值。</p><h2 id="3263" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">线性回归与逻辑回归</h2><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/3c68215f2f87b27b9778fd65ecafbd43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VOJIlmDkM9myaUZNjw_YrQ.png"/></div></div></figure><h2 id="12ef" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">结论</h2><p id="1ae1" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">逻辑回归产生二进制格式的结果，用于预测分类因变量的结果。由于逻辑回归预测概率，而不仅仅是类别，我们可以使用可能性来拟合它。</p></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><p id="a7d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lf">感谢您阅读这篇文章！如果你有任何问题，请在下面留言。请务必关注</em><a class="ae ly" href="https://arunaddagatla.medium.com/" rel="noopener"><em class="lf">@ arunadagatla</em></a><em class="lf">，获取关于最新数据科学和深度学习文章的通知。</em></p><blockquote class="lc ld le"><p id="e5bf" class="iq ir lf is b it iu iv iw ix iy iz ja lg jc jd je lh jg jh ji li jk jl jm jn hb bi translated"><em class="hi">您可以在</em><a class="ae ly" href="https://www.linkedin.com/in/arun-addagatla/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="hi">LinkedIn</em></strong></a><em class="hi">，</em><a class="ae ly" href="https://github.com/arun2728" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="hi">Github</em></strong></a><em class="hi">，</em><a class="ae ly" href="https://www.kaggle.com/arun2729" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="hi">Kaggle</em></strong></a><em class="hi">，或者通过访问</em><a class="ae ly" href="https://arunaddagatla.medium.com/" rel="noopener"><strong class="is hj"><em class="hi">【Medium.com</em></strong></a><em class="hi"/></p></blockquote></div></div>    
</body>
</html>