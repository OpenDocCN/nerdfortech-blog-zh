<html>
<head>
<title>Analysis of Bank Marketing Dataset By using Support Vector Machine (SVM)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于支持向量机(SVM)的银行营销数据集分析</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/analysis-of-bank-marketing-dataset-by-using-support-vector-machine-svm-1ccae6eaa782?source=collection_archive---------1-----------------------#2021-06-20">https://medium.com/nerd-for-tech/analysis-of-bank-marketing-dataset-by-using-support-vector-machine-svm-1ccae6eaa782?source=collection_archive---------1-----------------------#2021-06-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if"><p id="e165" class="ig ih hi bd ii ij ik il im in io ip dx translated"><strong class="ak"> <em class="iq">分析预测客户是否会认购定期存款……</em></strong></p></blockquote><figure class="is it iu iv iw ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es ir"><img src="../Images/b0207479cba2f941d7553fcb8df6ad92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJpPGY70QpBeY-Qegl2EkA.jpeg"/></div></div></figure><p id="7840" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">用例:数据集与一家葡萄牙银行机构的直接营销活动(电话)相关。目标是预测客户是否会认购定期存款。<em class="kb"> </em> <a class="ae kc" href="https://archive.ics.uci.edu/ml/datasets/bank+marketing#" rel="noopener ugc nofollow" target="_blank"> <em class="kb">下载数据集</em> </a> <em class="kb">。</em></p><p id="4a4d" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 01 —数据预处理</strong></p><p id="7f62" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 02 —应用合适的数据转换</strong></p><p id="df7c" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 03 —应用合适的特征离散化</strong></p><p id="7df6" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 04——应用合适的特征编码技术</strong></p><p id="c2c0" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 05——缩放和/或标准化特征</strong></p><p id="7cf3" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 06——相关矩阵和主成分分析(PCA ) </strong></p><p id="eaa8" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 07 —检查类别不平衡并处理类别不平衡</strong></p><p id="3d45" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated"><strong class="jg hj">步骤 08——应用支持向量机(SVM) </strong></p><p id="f309" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">首先我们必须导入一些库。因为大多数 python 库都有一组有用的函数，可以简单地消除从头编写代码的需要。所以我导入了下面的库</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="5518" class="km kn hi ki b fi ko kp l kq kr">import numpy as np<br/>import pandas as pd<br/>import scipy.stats as stats<br/>from matplotlib import pyplot as plt<br/>%matplotlib inline<br/>from sklearn.preprocessing import StandardScaler</span></pre><p id="f744" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">我已经添加了以下代码，用于将 google drive 帐户安装到 google colaboratory，以访问 drive 上可用的文件。当我们执行下面的代码时，我们必须转到生成的 URL，并获得授权代码才能进入这里。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="7138" class="km kn hi ki b fi ko kp l kq kr">from google.colab import drive</span><span id="f425" class="km kn hi ki b fi ks kp l kq kr">drive.mount(“/content/gdrive”)</span></pre><p id="2908" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">输入授权码后。您将得到一条消息“安装在<a class="ae kc" href="https://colab.research.google.com/drive/1nVXYLhJ2QiFQHRE3n43m-LxgliqJQz2-?authuser=1#" rel="noopener ugc nofollow" target="_blank"> /content/drive </a>”。此后，通过下面的代码，您可以访问您连接的 google drive 上的文件。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="9488" class="km kn hi ki b fi ko kp l kq kr">data = pd.read_csv('/content/gdrive/My Drive/Colab Notebooks/data/banking.csv')</span></pre><p id="2eb2" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我们可以检查数据集上可用的记录数</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="9b2c" class="km kn hi ki b fi ko kp l kq kr">len(data)</span></pre><p id="2a0a" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">现在，您已经成功地将数据加载到名为“data”的变量中。出于修改的目的，我已经将数据复制到另一个名为“X”的变量中</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="5ce5" class="km kn hi ki b fi ko kp l kq kr">X = data.copy() #dataset has been copied to  X</span></pre><p id="090e" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，您可以看到该变量中存储的前 10 个数据行。Pandas libary 提供了一个名为 head()的方法，广泛用于返回数据帧或数据系列的前 n 行。默认情况下，该方法返回存储数据集的前 5 行。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="0ae9" class="km kn hi ki b fi ko kp l kq kr">X.head(10)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es kt"><img src="../Images/5d5ec4803c82ffd5790c9b14d2d58425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlM0s4U7as1KTV9KGE6gCQ.png"/></div></div></figure><p id="44bd" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">让我们详细看看每个步骤，</p><h2 id="dbc1" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 01 —数据预处理</h2><p id="e726" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">数据预处理是机器学习中的一个主要步骤，因为从数据集中获得的有用信息直接影响模型的质量，所以在将数据输入模型之前，对数据进行至少必要的预处理是非常重要的。</p><blockquote class="ls lt lu"><p id="c751" class="je jf kb jg b jh ji jj jk jl jm jn jo lv jq jr js lw ju jv jw lx jy jz ka ip hb bi translated">步骤 01 A -&gt;数据清理-识别和处理缺失值、重复记录</p></blockquote><p id="7c55" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">按照下面的代码，我们可以确定每列数据中缺少的值</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="bbf7" class="km kn hi ki b fi ko kp l kq kr">X.isnull().sum()  #No null values</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es ly"><img src="../Images/10e137134db53ed51ebd41ff629f5ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*oLxvjn_cxG9ULHhN3aCgww.png"/></div></div></figure><p id="4640" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">在上面的输出中，所有的值都是零，所以现在我们可以得出结论，在数据集中没有任何 nan 值。</p><p id="c3f8" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我们可以检查数据集中的重复行。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="920f" class="km kn hi ki b fi ko kp l kq kr">print(X.duplicated().value_counts()) # To check duplicated values</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es lz"><img src="../Images/960f4cd0b206b04f69d325e13d420fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*K9wjIv8hE4GjDWQWgnEa_Q.png"/></div></figure><p id="29fd" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">从上面的输出中，我们可以得出结论，数据集中有 12 个重复的行，但是我们不能将它们作为重复的值，因为没有客户 ID 或任何东西的唯一列。因此价值观可能是另一个人的价值观。所以我没有删除那些值</p><blockquote class="ls lt lu"><p id="c4c7" class="je jf kb jg b jh ji jj jk jl jm jn jo lv jq jr js lw ju jv jw lx jy jz ka ip hb bi translated">步骤 01 B -&gt;数据清理——识别和处理异常值</p></blockquote><p id="7517" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我们可以得到数字列的名称</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="a804" class="km kn hi ki b fi ko kp l kq kr">X._get_numeric_data().columns.tolist()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es ma"><img src="../Images/6cbd57975bbb6a12b2c76845a1196b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*OJbmgcc1qKBUhPayEwlcpg.png"/></div></figure><p id="7b9f" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">a)特征年龄 Q-Q 图和盒图</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="b7cf" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["age"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mb"><img src="../Images/2ee6543db052b7721f049674b40e890e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*eadwNiyoEgkR3mNCjcLSdQ.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="7052" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['age'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mc"><img src="../Images/8400c0cb1912e8ea01c65e36e6063456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJ1zy2p00YQbvgZTPJEIgw.png"/></div></div></figure><p id="f363" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它</p><p id="babb" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">b)特征持续时间 Q-Q 图和箱线图</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1c9b" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["duration"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es md"><img src="../Images/d844820d94509b6c4fe2ba23785c11d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*Ijk-QSAXyRIDyMhH_9bpkQ.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="43d8" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['duration'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es me"><img src="../Images/767c4067bc8e7f1fb570b22f17e74402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2YKFALaxiQcfuTWqJ4mnfg.png"/></div></div></figure><p id="b247" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">此属性对输出目标有很大影响(例如，如果 duration=0，则 y='no ')。然而，在执行呼叫之前，持续时间是未知的。还有，结束通话后 y 显然是已知的。因此，该输入应仅用于基准测试目的，如果目的是获得现实的预测模型，则应丢弃。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="cd59" class="km kn hi ki b fi ko kp l kq kr">X = X.drop(['duration'], axis = 1)</span></pre><p id="c3d5" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">按照上面的代码，我们可以删除持续时间列。</p><p id="8916" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">c)特色活动 Q-Q 图和箱线图</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="4e21" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["campaign"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mf"><img src="../Images/503c00bfcda2078569f018070b2f8ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*_aRcZx7ycWy5zglEbIXPdQ.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="92ed" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['campaign'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mg"><img src="../Images/c2d5c661a32295823a2d767e4c6da802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOfG6Hp7aSYt0d3un3-VFw.png"/></div></div></figure><p id="5dad" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">代表在此活动期间为此客户执行的联系次数的活动。在上面的箱线图中，我们可以看到只有 1 个值超过 50。所以我已经删除了那个记录。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="45b7" class="km kn hi ki b fi ko kp l kq kr">X=X[X['campaign']&lt;50]<br/>X=X.reset_index(drop=True)</span></pre><p id="9c12" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">去除异常值后的箱线图，</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mg"><img src="../Images/80aae7017dbe0cef39a8ab9f2c6986a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WSPXKoTB__iui1BVBgwpQ.png"/></div></div></figure><p id="bbbe" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">d)特征日 Q-Q 图和箱线图</p><p id="85c8" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">自上次活动联系客户后经过的天数(999 表示以前没有联系过客户)</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1397" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["pdays"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es md"><img src="../Images/9c1870b4365606bc9ae09ed640e45335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*X8d2Ml0Lx8JtgyUW1Ob5jg.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8852" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['pdays'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mh"><img src="../Images/15d52aac2d0133b29c64e60c424afe4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3c2HsGFxjGkzxydb9HfBRw.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="c30a" class="km kn hi ki b fi ko kp l kq kr">len(X[X['pdays']==999])  # -&gt; 39672</span></pre><p id="38f9" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它。我们必须通过使用标签编码来处理特征。因为 39672 个值中有 999 个意味着客户以前没有联系过。</p><p id="2586" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">e)以先前 Q-Q 图和箱线图为特征</p><p id="7c59" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">在此活动之前为特定客户执行的联系次数</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="6fcf" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["previous"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mi"><img src="../Images/e4081309c003f61205f8fdc2cf6d1113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*EmiBOnrYeejkEjtgJo6v8g.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="20d0" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['previous'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es me"><img src="../Images/8b876e1947f992c77881358326f27c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zm-1D-T6A4sFf7_Ll9yU_A.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="ecd2" class="km kn hi ki b fi ko kp l kq kr">X['previous'].value_counts()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mj"><img src="../Images/4a6a2f4535e93c2e24dba318e3785e83.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*srtkjGjMt-IG7HNxFPnZ5g.png"/></div></figure><p id="9d3c" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它</p><p id="74af" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">f)特征是雇员变量比率 Q-Q 图和箱线图</p><p id="3bcc" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">就业变化率-季度指标</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="0f27" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["emp_var_rate"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mi"><img src="../Images/ad99142757736b6d8a5d10f1e7f5e874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*v0ZcgMkI4KScV5X64lUf4w.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="fe31" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['emp_var_rate'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mk"><img src="../Images/30fe51ce75b4c46665a472e99a149eab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gjkRSkGvKTzBFmmOlfqfPQ.png"/></div></div></figure><p id="e05b" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它</p><p id="2814" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">g)特征 Cons_price_idx Q-Q 图和箱线图</p><p id="0270" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">消费者价格指数——月度指标</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="a134" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["cons_price_idx"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mf"><img src="../Images/fff3516f601985beb533b15d1bca8387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*o8TJ4XkBMB9e2ZRbvWn2tw.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="d860" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['cons_price_idx'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es ml"><img src="../Images/79ab6ebcbab7ae98391295243af4a170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q96smnhxYHcTyCXZu4JN3w.png"/></div></div></figure><p id="e694" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它</p><p id="0973" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">h)特征 Cons_conf_idx Q-Q 图和盒图</p><p id="ae5b" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">消费者信心指数——月度指标</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="0d73" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["cons_conf_idx"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mm"><img src="../Images/7e97ae05f2d115b86a4a767b5a1e087a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*0F8Mr1rX9pZn4YhN4uo9aw.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="bf2c" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['cons_conf_idx'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mn"><img src="../Images/6d4d32b4d3ecc911b9a10f15cebd6eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpZwDhj0Dea91A9HmzfGfw.png"/></div></div></figure><p id="0c1a" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它</p><p id="3028" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">I)以 Euribor3m Q-Q 图和箱线图为特色</p><p id="4692" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">每日指示器</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="909f" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["euribor3m"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mi"><img src="../Images/9484124f515f6d12c332a82b6d15ae44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*8dHvME2MDepNWARlaecj5Q.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="3e5d" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['euribor3m'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mo"><img src="../Images/37b6a6054ec572be6c6d9dc34273b30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZg9RtiCx__NMWmMU9IzfQ.png"/></div></div></figure><p id="815b" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它</p><p id="c1e3" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">j)特征 Nr _ 采用 Q-Q 图和盒图</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="c401" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (10, 6)<br/>stats.probplot(X["nr_employed"], dist="norm", plot=plt)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es md"><img src="../Images/bb80cc2abb3a116cd2e8afa9358d3007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*1zk386wpkVBxHjPVOEUcJw.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="4a8b" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (22, 3)<br/>temp_df = pd.DataFrame(X, columns=['nr_employed'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mp"><img src="../Images/63ed90aee36b19efb7479f8633338cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IokTMsJKcQjSshznRe3SuA.png"/></div></div></figure><p id="7c93" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这个特性没有太大的问题，所以我们可以不经过任何预处理就使用它。</p><h2 id="658c" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 02 —应用合适的数据转换</h2><p id="416c" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">大多数情况下，我们更喜欢数据来自正态分布来训练模型。因为实际数据集中的要素通常会遵循更偏态的分布。通过根据这些变量的偏斜度应用不同类型的变换，我们可以将偏斜分布映射成正态分布。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1f07" class="km kn hi ki b fi ko kp l kq kr">cols_ForHist= X._get_numeric_data().columns.to_list()<br/>cols_ForHist.remove('y')<br/>cols_ForHist</span></pre><p id="557a" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">['age '，' campaign '，' pdays '，' previous '，' emp_var_rate '，' cons_price_idx '，' cons_conf_idx '，' euribor3m '，' nr_employed']</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="be19" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (24, 12)<br/>X[cols_ForHist].hist()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mq"><img src="../Images/9e8716c8630652ab6e35bc5e7f64c149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t5FHPA8MNK7E2ZZ96aYm6Q.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="ae9b" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (8, 6)<br/>from sklearn.preprocessing import FunctionTransformer</span></pre><p id="bdb1" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">由于天数和一些独特的代码，我认为有些特征是绝对的。例如，Pdays 有 999 表示以前没有联系过客户。由于这些类型的原因，我认为它们是绝对的</p><h2 id="64c2" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">左偏分布</h2><p id="d3a9" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">我们可以使用指数或幂变换来减少左偏分布。</p><p id="92f0" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">a)柱- Euribor3m 的改造</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="50f9" class="km kn hi ki b fi ko kp l kq kr">exponential_transformer = FunctionTransformer(np.exp,validate=True)<br/>exponential_transformer.fit(X[['euribor3m']])<br/>X['euribor3m'] = exponential_transformer.transform(X[['euribor3m']])<br/>X['euribor3m'].hist()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mr"><img src="../Images/abb6b71596f631dc3747fee2e7a89017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*doQ4ZpAxy5cEN8wohM5faA.png"/></div></figure><p id="3b69" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">b)列的转换-雇员变量比率</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="50d6" class="km kn hi ki b fi ko kp l kq kr">exponential_transformer = FunctionTransformer(lambda x: x ** 2)<br/>exponential_transformer.fit(X[['emp_var_rate']])<br/>X['emp_var_rate'] = exponential_transformer.transform(X[['emp_var_rate']])</span><span id="777a" class="km kn hi ki b fi ks kp l kq kr">X['emp_var_rate'].hist()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es ms"><img src="../Images/46a2935506eb007d7a329bc9c74aa89c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*iI5ODKnDwSvMR22tkDDxzw.png"/></div></figure><p id="4a14" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">c)转换列- Nr_employed</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="ab50" class="km kn hi ki b fi ko kp l kq kr">logarithm_transformer = FunctionTransformer(lambda x: x ** 2, validate=True)<br/>logarithm_transformer.fit(X[['nr_employed']])<br/>X['nr_employed'] = logarithm_transformer<br/>                   .transform(X[['nr_employed']])<br/>X['nr_employed'].hist()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es mt"><img src="../Images/25a849d75c325953667de0bae99ccd61.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*QzKlAgIV3ULFuWXdHmiIlQ.png"/></div></figure><h2 id="e8d7" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 03 —应用合适的特征离散化</h2><p id="dfac" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">特征离散化是指将特征或变量的连续值划分或转换为离散化的或标称的特征或区间的过程。</p><p id="705b" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">在这里，我为年龄特征创建了 bin。因为我们可以把 10 岁到 30 岁的年轻人归为一类。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f53c" class="km kn hi ki b fi ko kp l kq kr">bins = [18, 30, 40, 50, 60, 70, 120]<br/>labels = ['18-29', '30-39', '40-49', '50-59', '60-69', '70+']<br/>X['age'] = pd.cut(X['age'], bins, labels = labels,include_lowest = True)</span></pre><h2 id="d60c" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 04 —应用合适的特征编码技术</h2><p id="3268" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">ML 模型要求所有输入和输出值都应该是数字。因此，如果数据集包含分类数据，您必须在拟合和评估模型之前将其编码为数字。有几种方法可以完成这项任务，如一键编码、整数(标签)编码。这里我使用了一键编码</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f18d" class="km kn hi ki b fi ko kp l kq kr">cols = X.columns<br/>num_cols = X._get_numeric_data().columns<br/>cat_cols=  list(set(cols) - set(num_cols))</span><span id="5cca" class="km kn hi ki b fi ks kp l kq kr">add_cat = ['pdays','previous','campaign']<br/>for x in add_cat:<br/>    cat_cols.append(x)</span><span id="1a14" class="km kn hi ki b fi ks kp l kq kr">for col in X[cat_cols]:<br/>    print(col,"---&gt;",X[col].unique())<br/>    print("")</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mu"><img src="../Images/5fd184b4f9c45b1095449e30124cb3f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THs1kuXbWlUmNbeI5zc-KQ.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="29b8" class="km kn hi ki b fi ko kp l kq kr">for col in X[cat_cols]:<br/>   print(col+'-Values ')<br/>   print(X[col].value_counts())<br/>   print("")</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mv"><img src="../Images/1e279f57b0db733f80ab76fb66fd3df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mr-Vi0a6fzY5fIuz4MYRFQ.png"/></div></div></figure><p id="dda1" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">从上图中，您可以看到数据集中可用的唯一值和这些值的计数。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f937" class="km kn hi ki b fi ko kp l kq kr">X = X.drop(['default'], axis = 1)</span><span id="c51b" class="km kn hi ki b fi ks kp l kq kr">cat_cols.remove('default')</span><span id="1d36" class="km kn hi ki b fi ks kp l kq kr">from sklearn.preprocessing import LabelEncoder<br/>labelencoder =LabelEncoder()</span><span id="eddf" class="km kn hi ki b fi ks kp l kq kr">dummies= []</span><span id="a24b" class="km kn hi ki b fi ks kp l kq kr">for col in X[cat_cols]:<br/>   temp_dummies = pd.get_dummies(X[col],prefix=col)<br/>   dummies += (temp_dummies.columns.to_list())<br/>   X=pd.concat([X, temp_dummies], axis=1)<br/>   X = X.drop(col, axis = 1)</span><span id="7dd1" class="km kn hi ki b fi ks kp l kq kr">print(dummies)</span></pre><p id="e565" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">从下图中，你可以看到数据集中创建的假人。</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mw"><img src="../Images/deb37832db5303eb0eb7bce1231a1104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AbDiJ6gG4eeCLp54QiZgWg.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="2930" class="km kn hi ki b fi ko kp l kq kr">xa_Encode = X.copy()</span><span id="9a16" class="km kn hi ki b fi ks kp l kq kr">xa_Encode.isnull().sum()</span></pre><p id="e5dc" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过使用上面的代码，我检查了数据集中的空值，以便进行缩放。</p><h2 id="0639" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 05-缩放和/或标准化特征</h2><p id="f65f" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">数据标准化是重新调整一个或多个要素的方式，以便它们的平均值为 0，标准差为 1。标准化假设您的数据具有高斯(钟形曲线)分布。但这并不一定是真的，但如果你的特征值分布属于高斯分布，这种技术被认为是更有效的。</p><p id="fbb5" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我删除了数据集中的分类变量来进行缩放。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="fecb" class="km kn hi ki b fi ko kp l kq kr">Remove_columns_values = dummies<br/>Remove_columns_values.append('y')<br/>X_without_Cat=X.drop(Remove_columns_values, axis = 1)<br/>X_without_Cat.head()</span></pre><p id="7510" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">移除分类特征后的数据集输出，</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mx"><img src="../Images/39737e12b33c632e4fcf92b07f691204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PkaewwGzTNiCaqUJrJbv2A.png"/></div></div></figure><p id="627e" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">我已经使用 sklearn.preprocessing 的 StandardScaler 对上面的数据集进行了扫描，我已经在下面的代码中展示了这一点。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1dc3" class="km kn hi ki b fi ko kp l kq kr">from sklearn.preprocessing import StandardScaler<br/>scaler = StandardScaler()<br/>scaler.fit(X_without_Cat)<br/>X_Scaled = scaler.transform(X_without_Cat)</span><span id="f52f" class="km kn hi ki b fi ks kp l kq kr">columns_value_new=X_without_Cat.columns<br/>X_Scaled_Except = pd.DataFrame(X_Scaled, columns=columns_value_new)</span><span id="ca87" class="km kn hi ki b fi ks kp l kq kr">X_Scaled_Except.head(5)</span></pre><p id="35e2" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">缩放后数据集的输出，</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es my"><img src="../Images/a86b8097264f20777e18ce11c5fdba38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rpExc7ANAfOtl522Tf83EA.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="6e16" class="km kn hi ki b fi ko kp l kq kr">plt.rcParams["figure.figsize"] = (24, 12)</span><span id="7010" class="km kn hi ki b fi ks kp l kq kr">X_Scaled_Except.hist()</span></pre><p id="8b8d" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">我用上面的代码制作了相关的图表来展示缩放/标准化的效果。</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mq"><img src="../Images/6a26b0ad267a3dcc6f7d18dbb54bfe83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1-H4B07ivBBneb6iC95hQ.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="347d" class="km kn hi ki b fi ko kp l kq kr">data_Final =X_Scaled_Except</span><span id="2a8d" class="km kn hi ki b fi ks kp l kq kr">for f in dummies:<br/>     data_Final = data_Final.join(xa_Encode[f])</span></pre><p id="defd" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过使用上面的代码，我已经将分类值加入到缩放数据集。</p><h2 id="f6c3" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 06 —相关矩阵和主成分分析(PCA)</h2><p id="4408" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">通过以下代码，我们可以生成给定数据集的相关矩阵，</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="642c" class="km kn hi ki b fi ko kp l kq kr">import seaborn as sns<br/>plt.rcParams["figure.figsize"] = (24, 8)<br/>sns.heatmap(X_Scaled_Except.corr(),annot=True); <br/>#Seems they can be assuemed as independent</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es mz"><img src="../Images/cd584d8e4e21a45226e653fd89817c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0YX4Rc-3StvkIupQJ4t3xA.png"/></div></div></figure><p id="c606" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过观察上图和下图，我们可以说 nr_employed 和 euribor3m 具有很高的相关性。但有一些相当大的差异，所以可以保持原样。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f894" class="km kn hi ki b fi ko kp l kq kr">X_Scaled_Except.corr()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es na"><img src="../Images/52f00a1767ced95c98dad3c4c55c7161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hBI6zzyumPCVbqqN7K-IA.png"/></div></div></figure><p id="7a87" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我们可以看到与目标变量 Y 的相关性。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="6a0d" class="km kn hi ki b fi ko kp l kq kr">X_Scaled_Except['y']=xa_Encode['y']</span><span id="2ed6" class="km kn hi ki b fi ks kp l kq kr">plt.rcParams["figure.figsize"] = (24, 8)</span><span id="8ef7" class="km kn hi ki b fi ks kp l kq kr">sns.heatmap(X_Scaled_Except.corr(),annot=True);</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es nb"><img src="../Images/e4660272035b756ec9b998bc165c0989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hiMxoGjzVdovqJMxmMuObg.png"/></div></div></figure><p id="9477" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过查看上面的相关矩阵和下面的表值，我们可以得出结论，与其他特征相比，cons_conf_idx 与 y 的相关性非常低。这是一个消费者信心指数，是月度指标。员工信心指数是衡量员工对经济、他们的雇主以及他们寻找其他工作的能力的整体信心。因此，预测客户是否会认购定期存款是我们必须考虑的重要问题。所以我没有移除它。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="2400" class="km kn hi ki b fi ko kp l kq kr">X_Scaled_Except.corr()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="er es nc"><img src="../Images/1fd9f6f41c5a8f60e1f674978cc31a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LMvVAigTVQaGiPXSQL7LIw.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="4d50" class="km kn hi ki b fi ko kp l kq kr">Y=data_Final['y']</span><span id="1838" class="km kn hi ki b fi ks kp l kq kr">data_Final_without_Y = data_Final.drop('y', axis = 1)</span></pre><p id="23e5" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">按照上面的代码，我放弃了目标变量 Y 来进行主成分分析。</p><h2 id="de4c" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">主成分分析</h2><p id="7317" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">主成分分析(PCA)是一种降维方法，通常用于降低大型数据集的维数，方法是将一个大型变量集转换为一个较小的变量集，该变量集仍包含大型数据集中的大部分信息。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8d0a" class="km kn hi ki b fi ko kp l kq kr">from sklearn.decomposition import PCA</span><span id="efdb" class="km kn hi ki b fi ks kp l kq kr">pca = PCA(n_components=30)</span><span id="4455" class="km kn hi ki b fi ks kp l kq kr">pca.fit(data_Final_without_Y)<br/>X_PCA = pca.transform(data_Final_without_Y)<br/>#X_pca_test = pca.transform(X_test)<br/>X_PCA = pd.DataFrame(data = X_PCA)</span><span id="e2e6" class="km kn hi ki b fi ks kp l kq kr">pca.explained_variance_ratio_[:30].sum()</span></pre><p id="1cec" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过将维数减少到 30，我得到的总方差为 0.93，因此足以进行平衡步骤。</p><p id="65da" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过使用下面的代码，我将数据集分成 20%用于测试，80%用于使用 sklearn.model_selection 中的 train_test_split 进行训练</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="81f7" class="km kn hi ki b fi ko kp l kq kr">from sklearn.model_selection import train_test_split</span><span id="5e25" class="km kn hi ki b fi ks kp l kq kr">X_class_train, X_test, y_class_train, y_test = train_test_split(data_Final_without_Y, Y, test_size=0.2, random_state=0)</span></pre><h2 id="b040" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 07 —检查班级失衡并处理班级失衡</h2><p id="c066" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">大多数机器学习算法都假设数据是均匀分布的。因此，当我们在数据集中存在类别不平衡时，机器学习分类器往往会更偏向于多数类别，导致少数类别的错误分类。所以我们应该检查和处理这些问题。</p><p id="4091" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我们可以通过绘制目标数据分类值计数来检查类别不平衡。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="c4d1" class="km kn hi ki b fi ko kp l kq kr">import seaborn as sns<br/>plt.rcParams["figure.figsize"] = (8, 6)<br/>data_Final['y'].value_counts()<br/>sns.countplot(x='y', data=data_Final)<br/>plt.show()</span></pre><p id="92ce" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">从上面的图中我们可以看到，我们的数据集数据类不平衡。所以我用过 SMOTE。也许最广泛使用的合成新示例的方法是合成少数过采样技术，简称 SMOTE。该过程可用于根据需要为少数类创建尽可能多的合成示例。</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es nd"><img src="../Images/45082de1e09731bce193aaff16068e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*E-Wf3uV36MEGR3z8_J08Iw.png"/></div></figure><p id="3807" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">有两种取样技术。一种是欠采样技术，即去除多数类点的欠采样技术。另一种是过采样技术，过采样技术是指创建人为的少数类点。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="7261" class="km kn hi ki b fi ko kp l kq kr">from imblearn.over_sampling import SMOTE</span><span id="e33f" class="km kn hi ki b fi ks kp l kq kr">os = SMOTE(random_state=0)<br/>columns = X_class_train.columns<br/>data_X, data_y = os.fit_sample(X_class_train, y_class_train)<br/>smoted_X = pd.DataFrame(data=data_X,columns=columns )<br/>smoted_y = pd.DataFrame(data=data_y,columns=['y'])</span></pre><p id="0828" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过下面的代码，我们可以看到只对训练数据集应用 SMOTE 后的输出。我们不应该增加测试数据集。当使用任何专门的合成采样技术时，如 SMOTE，您应该首先划分您的数据，然后仅对训练数据应用合成采样。训练后，您可以使用只包含原始样本的测试集进行评估。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="2f06" class="km kn hi ki b fi ko kp l kq kr">sns.countplot(x='y', data=smoted_y)<br/>plt.show()</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es nd"><img src="../Images/092c8733bde3bed55bd8d91b982e3191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*y-EgCnlhwk-AcJdDf7zBmg.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="cc40" class="km kn hi ki b fi ko kp l kq kr">X_train = smoted_X<br/>y_train = smoted_y<br/>X_test<br/>y_test</span></pre><h2 id="2806" class="km kn hi bd ku kv kw kx ky kz la lb lc jp ld le lf jt lg lh li jx lj lk ll lm bi translated">步骤 08 —应用支持向量机(SVM)</h2><p id="7e26" class="pw-post-body-paragraph je jf hi jg b jh ln jj jk jl lo jn jo jp lp jr js jt lq jv jw jx lr jz ka ip hb bi translated">SVM 是一种监督机器学习方法，其中 y 是分类的和二进制的。在这里，我使用了 sklearn 库中的 svm 进行训练和测试。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8b30" class="km kn hi ki b fi ko kp l kq kr">from sklearn import svm<br/>from matplotlib import pyplot as plt<br/>%matplotlib inline</span></pre><p id="17a8" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">这里的核可以是 rbf、poly 或 sigmoid。但是在尝试了不同的核之后，我选择了 rbf 来进行模型训练。径向基核是在机器学习中用于寻找非线性分类器或回归线的核函数。</p><p id="a97a" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">c 是 SVM 正则化参数。我选择了 70 作为 c。</p><p id="f064" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">gamma 是“rbf”、“poly”和“sigmoid”的核心系数。当 gamma 的值增加时，它将尝试精确地拟合每个训练数据集。通过试验，我选择了 0.001</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="810e" class="km kn hi ki b fi ko kp l kq kr">svc = svm.SVC(kernel='rbf', C=70, gamma=0.001).fit(X_train,y_train)<br/>predictionsvm = svc.predict(X_test)<br/>from sklearn.metrics import classification_report<br/>print(classification_report(y_test,predictionsvm))</span></pre><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es ne"><img src="../Images/58901ffcd9106efd260a2994f247c094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*sjqsXqlU8uY5pxKgLcTuaw.png"/></div></figure><p id="d63b" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">以上输出是模型的分类报告。我已经在这篇文章的结尾解释了上面的报告。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="21a6" class="km kn hi ki b fi ko kp l kq kr">predictionsvm = svc.predict(X_test)<br/>percentage = svc.score(X_test,y_test)<br/>percentage      #0.8614955086185967</span></pre><p id="e06f" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">从上面的代码输出中，我们可以看到模型的整体预测准确性。但我们不能只从整体预测精度来评价该模型。所以也要对照分类报告来做研究。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="04cc" class="km kn hi ki b fi ko kp l kq kr">from sklearn.metrics import plot_confusion_matrix<br/>plt.rcParams["figure.figsize"] = (8, 10)<br/>fig=plot_confusion_matrix(svc, X_test, y_test,display_labels=["0",'1'],cmap=plt.cm.Blues,values_format = '.2f')</span><span id="5271" class="km kn hi ki b fi ks kp l kq kr">fig.figure_.suptitle("Confusion Matrix ")<br/>plt.show()</span></pre><p id="cf7c" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">通过使用上述代码，我们可以为开发模型的结果绘制混淆矩阵。</p><figure class="kd ke kf kg fd ix er es paragraph-image"><div class="er es nf"><img src="../Images/e025b02b3434c7b10c9cc96cc2390e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*RcmYlbqFQykYXKftbqp6WA.png"/></div></figure><p id="40a2" class="pw-post-body-paragraph je jf hi jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka ip hb bi translated">上面的图像和分类报告显示了我们开发的模型。真阳性计数高于假阳性计数。实际上，这意味着我们的模型确实表现不好，但对于 yes 分类来说相当可观。您可以看到 1(是)类的精度是 0.42。与 0(无)级相比，该值较低。以上结果是应用 SMOTE 后的结果。作为总结我们可以看到，我们的模型有 0.68 的宏观平均精度和 0.89 的加权平均精度。</p></div></div>    
</body>
</html>