<html>
<head>
<title>Scalable Near Real-Time Data Analytics Architecture Made Easy with AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS 简化了可扩展的近实时数据分析架构</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/scalable-near-real-time-data-analytics-architecture-made-easy-with-aws-397f197adc0?source=collection_archive---------4-----------------------#2021-06-09">https://medium.com/nerd-for-tech/scalable-near-real-time-data-analytics-architecture-made-easy-with-aws-397f197adc0?source=collection_archive---------4-----------------------#2021-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2cf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多现代数据分析用例需要接近实时的基础架构。作为一名企业家，刚从大学毕业，有一个想法和一个大梦想，但经验很少，我努力寻找一个可靠的架构，既经济实惠，又性能良好。</p><p id="9c31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很自然，我四处打听。朋友，关系，AWS 支持，以及更多的人。我写这个博客是为了分享我收集的一些知识，以及我自己对一些真正简单的方法的想法，这些方法可以实现几乎不需要维护的近实时分析基础设施。</p><p id="c05e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随意评论我谈到的任何体系结构，并分享您的想法！另外，如果有错误的信息和建议，请随时在<a class="ae jd" href="https://www.linkedin.com/in/sayantapadar/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上 ping 我！</p><blockquote class="je jf jg"><p id="91e7" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">改变的第一步是意识。第二步是接受。—纳撒尼尔·布兰登</p></blockquote></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h1 id="c55a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">成分</h1><p id="7e74" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">首先，让我们谈谈什么是最重要的部分，这应该是经过深思熟虑的。</p><ol class=""><li id="c320" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">草案</li><li id="e217" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">数据收集</li><li id="06ea" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">处理单元(摄入)</li><li id="8c54" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">存储和数据湖</li></ol><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lj"><img src="../Images/7c660bbb65a2c8bcfb2a859d217e4b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoxX-rtN3PTGLlfpPCbNcw.png"/></div></div></figure><h1 id="f199" class="js jt hi bd ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl lz kn ko kp bi translated">草案</h1><p id="5745" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这完全取决于你的用例。让我列出一些更常用的。</p><ol class=""><li id="93f5" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">HTTP/HTTPS —流行、安全，当然，你已经听说过了。面向文档的请求/响应工作流。</li><li id="1c6f" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">MQTT/MQTT——轻量级、更好的响应时间、吞吐量，适用于电池/电源和带宽受限的设备。<a class="ae jd" rel="noopener" href="/mqtt-buddy/mqtt-vs-http-which-one-is-the-best-for-iot-c868169b3105">这篇文章</a>很值得一读。</li><li id="356e" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">AQMP——非常适合服务器对服务器的通信。<a class="ae jd" href="https://www.educba.com/amqp-vs-mqtt/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>很值得一读。</li><li id="8a9e" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">TCP —经典、高吞吐量。在带宽限制下不太好。非常适合服务器与服务器之间的通信。</li></ol><p id="86f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有更多的协议。我将把它保留在这 4 个我用过或见过的常用词中。</p><h1 id="2ce5" class="js jt hi bd ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl lz kn ko kp bi translated">数据收集</h1><p id="a606" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这是将所有传入数据导向处理(摄取)单元的漏斗。</p><blockquote class="je jf jg"><p id="0eff" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">关键必备— </em> </strong> <a class="ae jd" href="https://www.digitalocean.com/community/tutorials/what-is-high-availability" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="hi">高可用性</em> </strong> </a> <strong class="ih hj"> <em class="hi">，</em> </strong> <a class="ae jd" rel="noopener" href="/@cielo.raymundo1/scalability-101-617b626e5a20"> <strong class="ih hj"> <em class="hi">可扩展性</em> </strong> </a></p></blockquote><p id="e9dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最重要的是，您的漏斗总是需要存在，以接收来自最终用户设备的传入消息。如果漏斗关闭，就会丢失大量数据。我将分享一些我用过的或者经常看到被使用的服务/架构。</p><ol class=""><li id="7e45" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated"><a class="ae jd" href="https://docs.aws.amazon.com/streams/latest/dev/building-producers.html" rel="noopener ugc nofollow" target="_blank"> AWS Kinesis 数据流</a> —托管服务。所以根本不用担心基础设施。有据可查。使用 HTTPS。<br/> <br/>看看<a class="ae jd" href="https://aws.amazon.com/kinesis/data-firehose/" rel="noopener ugc nofollow" target="_blank"> Kinesis Firehose </a>看大图。我将在本文中多次提到 Kinesis Firehose。<br/> <br/>我最喜欢<em class="jh"> Kinesis Firehose </em>的地方就是它的缓存能力。在调用流程流的下一部分之前，您可以选择缓存最多 6 分钟的数据，或者最多 128MB 的数据。如果分析用例可以接受几分钟的“延迟”，这将大大有助于成本优化。</li><li id="edc2" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">融合 kafuent Kafka——既是一个<em class="jh">完全托管的服务</em>,也是一个可以在自己的<em class="jh">自我管理的</em>托管环境中使用的包。很好的记录，很好的社区支持。<br/> <br/>附带了过多的插件——源连接器和宿连接器。比如 REST 连接器、MQTT 连接器、AWS/Azure/GCP 服务的连接器等等。<br/> <br/>您可以使用它来构建一个基础设施，终端设备可以使用 HTTPS 或 MQTT 来发布数据。并将数据传输到处理单元、永久存储、第三方服务等等。</li></ol><h1 id="0eab" class="js jt hi bd ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl lz kn ko kp bi translated">处理单元—您的代码</h1><p id="3b2f" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这当然是你最应该关注的地方。让这一切成为可能的代码！我将讨论一些您可以使用的基础设施想法——少担心基础设施，多担心代码。</p><blockquote class="je jf jg"><p id="a29d" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">关键要素—可扩展性</em> </strong></p></blockquote><p id="57b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总是提前为大规模的使用高峰做好准备。毕竟，一个企业是带着繁荣的希望建立的。当你刚刚达到 100 万用户的时候，如果后端开始失败，那不是很糟糕吗？</p><p id="1f41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通读后，请务必谷歌出<strong class="ih hj"> <em class="jh">垂直缩放</em> </strong>和<strong class="ih hj"> <em class="jh">水平缩放</em> </strong>。</p><p id="2cc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将再次谈论一些我个人使用过的或经常使用的服务/架构。</p><ol class=""><li id="b147" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated"><a class="ae jd" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a> —完全托管-部署您的代码，AWS 处理所有其他事情，高度可用，可根据您的需求进行扩展，非常适合小型团队。缺点——它对部署包的大小有一个上限，但是有几种方法可以绕过它；过于频繁的调用往往会增加开销。仔细阅读定价。如果使用得当，它还具有惊人的成本效益。</li><li id="3a40" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><a class="ae jd" href="https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html" rel="noopener ugc nofollow" target="_blank"> AWS EKS(弹性 Kubernetes 服务)</a> —这是一篇关于 Kubernetes 的<a class="ae jd" href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/" rel="noopener ugc nofollow" target="_blank">好文章</a>。EKS 为您的自我管理集群提供了一个管理控制平面。如果需要更多的资源和更频繁的调用，这是比 Lambda 更好的成本优化选择。</li><li id="52dc" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">自我管理的 Kubernetes——这已经成为某种“行业标准”。集装箱化和 Kubernetes。然而，这需要注意基础设施的维护。一定要看看<a class="ae jd" href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/AutoScalingGroup.html" rel="noopener ugc nofollow" target="_blank"> AWS EC2 自动缩放组</a>，让生活变得简单一点。Docker 是最受欢迎的集装箱服务。不过也看看<a class="ae jd" href="https://containerd.io/" rel="noopener ugc nofollow" target="_blank">集装箱</a>。</li></ol><h1 id="a399" class="js jt hi bd ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl lz kn ko kp bi translated">存储和数据湖</h1><p id="ea13" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">和上面一样，这也很大程度上取决于你的用例。主要尝试使用以下方法的组合:</p><ol class=""><li id="4d0c" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">缓存—通常是更昂贵的存储，主要用于保存非常常用的数据。比数据库加载和写入速度更快。如果使用得当，还可以为您带来急需的成本优化。查看<a class="ae jd" href="https://aws.amazon.com/elasticache/?trkCampaign=acq_paid_search_brand&amp;sc_channel=ps&amp;sc_campaign=acquisition_IN&amp;sc_publisher=Google&amp;sc_category=Database&amp;sc_country=IN&amp;sc_geo=APAC&amp;sc_outcome=acq&amp;sc_detail=aws%20redis&amp;sc_content={adgroup}&amp;sc_matchtype=e&amp;sc_segment=477000491510&amp;sc_medium=ACQ-P|PS-GO|Brand|Desktop|SU|Database|Solution|IN|EN|Sitelink&amp;s_kwcid=AL!4422!3!477000491510!e!!g!!aws%20redis&amp;ef_id=CjwKCAjwqvyFBhB7EiwAER786eMTl5VW9Bk6mkgQHhzTeHZnZAFDdFC7KesXH34syClUpRpajqKRbhoCLhgQAvD_BwE:G:s&amp;s_kwcid=AL!4422!3!477000491510!e!!g!!aws%20redis" rel="noopener ugc nofollow" target="_blank">AWS elastic cache</a>。</li><li id="3aac" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">数据库——我在这里同时谈到了 SQL 和 NoSQL。一般来说，我更喜欢两者结合使用。我更喜欢将关系数据保存在 SQL 数据库中，比如用户表、用户信息表等；以及 NoSQL 数据库中的文档类型数据，例如喜欢的歌曲、推荐等。<br/> <br/> <a class="ae jd" href="https://aws.amazon.com/rds" rel="noopener ugc nofollow" target="_blank"> AWS RDS </a>和<a class="ae jd" href="https://aws.amazon.com/rds/aurora/" rel="noopener ugc nofollow" target="_blank"> AWS RDS Aurora </a>都是很棒的服务。Aurora 是全托管的，支持动态自动伸缩，这是一个很大的优势。但是，如果您清楚地了解您的扩展需求，AWS RDS 往往更具成本效益。但是，您必须自己处理缩放。<br/> <br/> <a class="ae jd" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> AWS DynamoDB </a>，<a class="ae jd" href="https://aws.amazon.com/documentdb" rel="noopener ugc nofollow" target="_blank"> AWS DocumentDB </a>，<a class="ae jd" href="https://www.mongodb.com/cloud/atlas" rel="noopener ugc nofollow" target="_blank"> MongoDB Atlas </a>都是很棒的全托管 NoSQL 数据库。DynamoDB 的成本效率令人难以置信，但也有一些限制，写操作的成本是读操作的 3 倍。DocumentDB</li><li id="216c" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">存档——这里我只说一下<a class="ae jd" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3 </a>。它支持<strong class="ih hj">所有</strong>用例的存储。您可能经常需要、不会经常需要、可能根本不需要的数据，但最好保存起来，以防万一。一切。请务必查看本页以获得更清晰的理解。</li></ol><p id="539c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于数据分析，所有收集的数据可能都很重要，我总是喜欢关注<strong class="ih hj"> <em class="jh">高效查询。</em> </strong></p><blockquote class="je jf jg"><p id="5d2b" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">关键要素—高效查询</em> </strong></p></blockquote><p id="f172" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询是建立高效数据湖的关键。您需要一个体系结构来查询超过 TB 的数据。在一个好的数据湖中，我通常会看到</p><ol class=""><li id="29cb" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">可接受的查询响应时间</li><li id="db5c" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">划分良好的数据。查询整个<strong class="ih hj">档案是非常不可取的。</strong></li><li id="22c4" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">一致的文档结构。这使得查询更加高效。</li><li id="48b6" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">如有可能，文件以<a class="ae jd" href="https://blog.clairvoyantsoft.com/big-data-file-formats-3fb659903271" rel="noopener ugc nofollow" target="_blank"> Avro 或拼花格式</a>存储。</li></ol><p id="eb3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样没错，Hadoop 很神奇。但是这里我就不说 Hadoop 和算法了。</p><p id="177e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一定要看看<a class="ae jd" href="https://docs.aws.amazon.com/glue/latest/dg/what-is-glue.html" rel="noopener ugc nofollow" target="_blank"> AWS Glue </a>和<a class="ae jd" href="https://aws.amazon.com/athena" rel="noopener ugc nofollow" target="_blank"> AWS Athena </a>，我个人在几乎所有的项目中都使用过。它处理爬虫、元数据数据库，并通过 Athena 提供高效的查询框架。</p><p id="f260" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一篇<a class="ae jd" href="https://aws.amazon.com/blogs/big-data/build-a-data-lake-foundation-with-aws-glue-and-amazon-s3/" rel="noopener ugc nofollow" target="_blank">好文章</a>用 S3 和 AWS 胶水做一个好的数据湖。</p><h1 id="1ab9" class="js jt hi bd ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl lz kn ko kp bi translated">摘要</h1><p id="efa7" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">你的架构完全取决于你的用例。根据您的需求进行混搭。当您选择使用什么时，您的主要考虑事项应该包括</p><ol class=""><li id="8aee" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">允许的延迟—设备事件与其在您的分析仪表板中的反映之间的延迟。</li><li id="899f" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">选择哪些数据需要经常访问，哪些数据需要缓存。</li><li id="4165" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">您设备的环境—带宽限制、电源限制、资源限制。</li><li id="1b15" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">观众——试着判断你的观众是否会突然大幅增加。</li></ol><p id="6319" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像我之前说的，请评论分享更多想法，为了读者和我！这是我的第一篇博客，所以如果你发现错误的信息，请<a class="ae jd" href="https://www.linkedin.com/in/sayantapadar/" rel="noopener ugc nofollow" target="_blank">通知我</a>。有经验的博客和作者，也请平我建议更好的方式来表达我的想法。</p></div></div>    
</body>
</html>