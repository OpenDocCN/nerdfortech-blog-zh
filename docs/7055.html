<html>
<head>
<title>How to implement light and dark modes with a toggle switch on your website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在你的网站上用拨动开关实现亮暗模式</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-implement-light-and-dark-modes-with-a-toggle-switch-on-your-website-3f2426bc4717?source=collection_archive---------3-----------------------#2022-07-12">https://medium.com/nerd-for-tech/how-to-implement-light-and-dark-modes-with-a-toggle-switch-on-your-website-3f2426bc4717?source=collection_archive---------3-----------------------#2022-07-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1d25effafbdf9b828175397679a19c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_pw9Pp_iQQ2Dsn5M.jpg"/></div></div></figure><p id="5de2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我最近重新设计了我的网站的外观和感觉。作为重新设计的一部分，我实现了一个亮和一个暗的主题，可以根据用户的偏好自动选择；它还包括一个拨动开关，允许用户改变这个网站的偏好。在这篇文章中，我将向你展示我是如何做到的。</p><p id="a043" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如今，在明亮或黑暗主题之间切换的能力在互联网上变得非常流行。从我们开始在桌面应用上看到它已经有一段时间了，但是现在，在我们使用的大多数网站上，我们也可以每天看到它:Github、Stackoverflow、Twitter 等。有多种方法来实现它，我会告诉你我的。</p><h1 id="e111" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">写主题</h1><p id="a6b0" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在是 2022 年，我们躲过了冠状病毒，Internet Explorer 终于死了。如果你还没有开始使用 CSS 自定义属性，我认为这是一个很好的时机(如果你不熟悉或者不知道我在说什么，你可以阅读来自克里斯·科伊尔的这篇精彩的文章<a class="ae kr" href="https://css-tricks.com/a-complete-guide-to-custom-properties/" rel="noopener ugc nofollow" target="_blank">)。</a></p><p id="5a71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">即使我已经开始谈论两个主题，我显然是在谈论让<strong class="is hj">一个 CSS 代码有两个变体</strong>。创建这些变体的关键是在自定义属性中编写出现在主题上的每一种颜色。在我的例子中，我已经开始定义灯光主题中使用的所有颜色，这是我在不知道用户偏好的情况下选择的默认颜色:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="7d00" class="lb jp hi kx b fi lc ld l le lf">body {<br/>  --bg-color: #fff;<br/>  --bg-color-secondary: #eee;<br/>  --text-color: #303030;<br/>  --text-color-secondary: #707070;<br/>  --border-color: #eeeeee;<br/>}</span></pre><p id="af61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦我们有了浅色变体的值，我们需要为深色变体定义相同的属性，我们将把它们添加到媒体查询中。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="4024" class="lb jp hi kx b fi lc ld l le lf">@media (prefers-color-scheme: dark) {<br/>  body {<br/>    --bg-color: #292639;<br/>    --bg-color-secondary: #1b1928;<br/>    --text-color: #ebeaf7;<br/>    --text-color-secondary: #bebbd2;<br/>    --border-color: #3a3650;<br/>  }<br/>}</span></pre><p id="4c72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们可以在 CSS 中使用这些属性。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="1e0b" class="lb jp hi kx b fi lc ld l le lf">body {<br/>  background: var(--bg-color);<br/>  color: var(--text-color);<br/>  /* ... */ <br/>}<br/><br/>.header {<br/>  border-bottom: 1px solid var(--border-color);<br/>  /* ... */ <br/>}<br/><br/>.menu-item {<br/>  color: var(--text-color-secondary);<br/>  /* ... */ <br/>}<br/><br/>.button {<br/>  background: var(--bg-color-secondary);<br/>  border: 1px solid var(--border-color);<br/>  /* ... */ <br/>}<br/><br/>/* ... */</span></pre><h1 id="062d" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">UX 的一些考虑</h1><p id="97f5" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">不要误会我；我不是 UX 设计师。无论如何，我很乐意给你一些关于 UX 光明/黑暗主题的建议:</p><p id="9a25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">暗不黑</strong>。除了<code class="du lg lh li kx b">#000000</code>还有很多深色，事实上，你可以看到我在这个网站没有使用黑色作为背景色。光也不一定是白色的。有很多地方可以从中获得灵感；如果你也不是色彩理论方面的专家，回顾一下其他网站的做法，或者从 IDE 主题中获取一些想法。</p><p id="2649" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">没有必要每种颜色都切换</strong>。我可能错了，但阴影总是黑暗的。考虑颜色被使用的地方。你可以为每个变体使用不同种类的阴影，也许你会需要它们在黑暗主题中更强烈(或透明度更低)，但它们应该是黑暗的。</p><p id="a800" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">根据内容确定 SVG 图标的颜色</strong>。确保不要在 SVG 图标的<code class="du lg lh li kx b">stroke</code>或<code class="du lg lh li kx b">fill</code>属性中硬编码颜色代码。在那些属性中使用<code class="du lg lh li kx b">currentColor</code>,让 CSS 级联完成它的工作。</p><p id="406d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">关注内容图片</strong>。并不是每一张照片都能很好地配合这两个主题。测试您为内容选择的图像，选择那些在深色和浅色背景下看起来不错的图像。有时这是不可能的，不要担心，有不同的方式向您的用户显示多个图像，例如:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="786f" class="lb jp hi kx b fi lc ld l le lf">&lt;picture&gt;<br/>  &lt;source srcset="image-dark.png" media="(prefers-color-scheme: dark)" /&gt;<br/>  &lt;source srcset="image-light.png" media="(prefers-color-scheme: light)" /&gt;<br/>  &lt;img src="image-light.png" /&gt;<br/>&lt;/picture&gt;</span></pre><p id="0d66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一个选项，也是我选择的，是在黑暗模式下对图片应用滤镜，使它们更暗，对比度更高:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="2835" class="lb jp hi kx b fi lc ld l le lf">@media (prefers-color-scheme: dark) {<br/>  img {<br/>    filter: brightness(0.9) contrast(1.1);<br/>  }<br/>}</span></pre><p id="aef2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您遵循这些步骤，您现在将有两个版本的主题。我知道这并不总是像我在这里描述的那样简单，特别是如果你不是从零开始创建你的主题，而是在现有的基础上增加一个新的变体。<strong class="is hj">根据你的情况调整这些建议</strong>，不要放弃。</p><h1 id="a224" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">让用户切换</h1><p id="7154" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在这一点上，我们已经假设用户总是希望看到您的网站，并使用我们在<code class="du lg lh li kx b">prefers-color-scheme</code>媒体功能中读到的颜色模式偏好。这是一个很大的假设。在我看来，这是一个很好的起点，但是<strong class="is hj">我们总是会让用户从亮到暗切换，反之亦然</strong>。</p><p id="7d5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最常见的方法是创建一个奇特的开关，但任何类型的按钮也可以。本文旨在向您展示如何实现该功能，我们不会关注交换机的设计。无论如何，你可以<a class="ae kr" href="https://codepen.io/search/pens?q=dark+mode+switch" rel="noopener ugc nofollow" target="_blank">在这里</a>寻找灵感或者看看我自己在这个 Codepen 上的开关代码:</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="0aec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦我们设计了开关或按钮，我们应该做的就是用 javascript 实现功能。我们将能够用这个简单的代码来完成它:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="ecae" class="lb jp hi kx b fi lc ld l le lf">// Get the button element<br/>const btn = document.querySelector(".your-button-or-switch-class");<br/>// Detect if user preference is dark<br/>const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");<br/>// On button click<br/>btn.addEventListener("click", function() {<br/>  // Get users preference<br/>  const userSystemPreference = prefersDarkScheme.matches ? "dark" : "light";<br/>  // Choose the class that will be added or removed<br/>  const toggleClass = userSystemPreference === "dark" ? "light" : "dark";<br/>  // Add or remove the class on the &lt;html&gt; element<br/>  document.documentElement.classList.toggle(toggleClass);<br/>});</span></pre><p id="981e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如你所见，如果用户喜欢浅色主题，我们将添加或删除<code class="du lg lh li kx b">dark</code>类到<code class="du lg lh li kx b">html</code>元素，如果他们喜欢深色，我们将切换<code class="du lg lh li kx b">light</code>类。这暂时不会触发任何效果，但是在我们的 CSS 中添加这个简单的内容后，它会触发任何效果:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="e854" class="lb jp hi kx b fi lc ld l le lf">.dark body {<br/>  --bg-color: #292639;<br/>  --bg-color-secondary: #1b1928;<br/>  --text-color: #ebeaf7;<br/>  --text-color-secondary: #bebbd2;<br/>  --border-color: #3a3650;<br/>}<br/><br/>@media (prefers-color-scheme: dark) {<br/>  .light body {<br/>    --bg-color: #fff;<br/>    --bg-color-secondary: #eee;<br/>    --text-color: #303030;<br/>    --text-color-secondary: #707070;<br/>    --border-color: #eeeeee;<br/>  }<br/>}</span></pre><p id="83d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了这一切，我们的网站将加载用户的首选主题，它将允许他们切换，如果他们想要的。那么，我们谈完了吗？还没有。</p><h1 id="9151" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">存储用户偏好</h1><p id="328a" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们只缺少一样东西；<strong class="is hj">我们需要存储用户的偏好，以便在会话或页面导航之间保存它们</strong>。我认为最简单的方法是将其保存在浏览器的本地存储中，为此，我们需要修改我之前向您展示的 Javascript 代码。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="23f4" class="lb jp hi kx b fi lc ld l le lf">const btn = document.querySelector(".your-button-or-switch-class");<br/>const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");<br/>btn.addEventListener("click", function() {<br/>  const userSystemPreference = prefersDarkScheme.matches ? "dark" : "light";<br/>  const toggleClass = userSystemPreference === "dark" ? "light" : "dark";<br/>  document.documentElement.classList.toggle(toggleClass);<br/><br/>  // Obtain which is the user's current preference for our website<br/>  const userCurrentPreference = document.documentElement.classList.contains(toggleClass)<br/>    ? toggleClass<br/>    : userSystemPreference;<br/>  // Save it in local storage<br/>  localStorage.setItem("mode", mode);<br/>});</span></pre><p id="45d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个小小的修改将基于<code class="du lg lh li kx b">html</code>文档的类(或其不存在)获得当前模式，并将其保存在本地存储上。一旦保存了设置，我们需要确保在每次页面加载时都使用它，我们将在加载任何 CSS 之前通过在网页的<code class="du lg lh li kx b">&lt;head&gt;</code>中执行以下代码来做到这一点:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="b897" class="lb jp hi kx b fi lc ld l le lf">&lt;script type="text/javascript"&gt;<br/>  (function () {<br/>      var userCurrentPreference = localStorage.getItem("mode");<br/>      if (userCurrentPreference === "dark") document.documentElement.classList.toggle("dark");<br/>      else if (userCurrentPreference === "light") document.documentElement.classList.toggle("light");<br/>  })();<br/>&lt;/script&gt;</span></pre><p id="1122" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">想知道为什么我要求你直接在你的 HTML 的<code class="du lg lh li kx b">head</code>中添加一些同步的 Javascript 代码吗？通过异步添加这个代码片段，或者在 HTML 和 CSS 加载后添加，您将面临出现不正确主题颜色的风险(这意味着在几毫秒内可能会显示错误的主题)。这段代码的过载在我看来是值得的。有些人使用基于 cookie 的解决方案来避免这些代码，但它需要在服务器端实现，如果您像我一样有一个静态生成的站点，这是不可能的。</p><p id="98cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你喜欢阅读；如果你这样做了，不要忘记在你喜欢的社交网络上分享它。你也可以给我你对整个网站重新设计和品牌重塑的想法。</p><p id="b1c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ll">本文以</em> <a class="ae kr" href="http://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank"> <em class="ll">知识共享署名 4.0 国际许可</em> </a> <em class="ll">进行许可。</em></p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><p id="c9a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ll">原载于 2022 年 7 月 12 日 https://www.albertovarela.net</em><a class="ae kr" href="https://www.albertovarela.net/blog/2022/07/implementing-light-dark-mode/" rel="noopener ugc nofollow" target="_blank"><em class="ll"/></a><em class="ll">。</em></p></div></div>    
</body>
</html>