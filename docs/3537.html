<html>
<head>
<title>Creating an NLP template from scratch with python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用python从头开始创建NLP模板</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/creating-an-nlp-template-from-scratch-with-python-a6dcd90513e7?source=collection_archive---------5-----------------------#2021-06-13">https://medium.com/nerd-for-tech/creating-an-nlp-template-from-scratch-with-python-a6dcd90513e7?source=collection_archive---------5-----------------------#2021-06-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0fb2fc653adf6d064d3aaa0b0e49e19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*Mm3C8wPCI58ZQtDS6KWxSQ.jpeg"/></div></div></figure><p id="83d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击 <a class="ae jo" href="https://luis-miguel-code.medium.com/criando-um-modelo-de-nlp-do-zero-com-python-5ae278568119" rel="noopener"> <strong class="is hj">这里</strong> </a> <strong class="is hj">阅读葡萄牙语</strong></p><p id="a56c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">NPL(或自然语言处理)是数据科学的一个分支，近年来发展很快，考虑到这一点，我决定写一篇关于如何使用它以及今天了解这一分支的重要性的文章！</p><p id="5700" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中你会发现什么？</p><ul class=""><li id="ce1c" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">什么是NLP？；</li><li id="2556" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">NLP有多重要？；</li><li id="5f4a" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">如何创建NLP模板？；</li></ul><h1 id="b2c0" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">什么是NLP？</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es if"><img src="../Images/3b23bb785f88c202422c5f166f97eaf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*a02VQlXpGkXJqQLAVL8K4w.jpeg"/></div></figure><p id="5772" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们开始分析之前，我们必须对什么是NLP有一个概念！NLP代表自然语言处理。以一种非常直观的方式，NLP是数据科学的一个子领域，旨在使用机器和人类语言来分析和处理T21。</p><p id="32aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，NLP正在让计算机能够翻译人类语言。</p><h1 id="6f59" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">NLP有多重要？</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/ce4bf4fdbe836ffd44e37c86e0c0a931.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*SLaHpqFHEeQx8oUTF_Lurw.gif"/></div></figure><p id="d051" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">NLP和所有的数据科学都有许多特性，这个子领域有几个工作选项！</p><p id="fee5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">许多公司都有数据库，在这些数据库中，我们可以有文本数据，这些数据可以告诉我们很多关于客户想法的信息。</p><p id="02b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了说明这个主题，我将举一些例子:</p><ul class=""><li id="ea91" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><strong class="is hj">分析客户短信</strong>:想象一下，能够使用机器学习将我们的邮件数据分组为“问题”、“投诉”和“建议”，并发送到公司的不同部门；</li><li id="2a0c" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><strong class="is hj">建议等级</strong>:如果客户在对产品发表意见时，我们可以建议他们仅根据文字给出哪个评级等级，会怎么样？；</li><li id="8592" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><strong class="is hj">图形化分析意见</strong>:想象一下，能够从数据库中创建图像，以图形化方式显示意见中最常出现的单词？；</li></ul><p id="c538" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在你知道了我们可以用NLP做什么，是时候动手了。加油？</p><h1 id="8857" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">机器学习</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c60ccd37be12b75ce990bbfe23770b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*q2ONUR-wu3ZdIM03U2g8MA.jpeg"/></div></div></figure><p id="10e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了开始我们的模型，我必须弄清楚我将在本文中用作示例的数据的来源，所有这些数据都来自<a class="ae jo" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>站点，您可以通过点击<a class="ae jo" href="https://www.kaggle.com/nicapotato/womens-ecommerce-clothing-reviews" rel="noopener ugc nofollow" target="_blank">此处</a>来访问它。</p><p id="cf2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我想指出的另一件事是，下面的教程可以直接从GoogleColaboratory访问，那里有完整的代码行和对所使用的每个算法的更详细的解释。要访问，请点击此处的。</p><p id="74e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的模型中，我们应该做的第一件事是考虑<strong class="is hj">预处理</strong>我们的文本。但是为什么呢？文本集(尤其是那些从互联网上获取的)可能包含“污垢”，如链接和表情，为了避免代码问题，应该删除<strong class="is hj">。</strong></p><p id="a994" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们应该删除的另一件事是“停用词”，这些词基本上是通常不会在机器的解释中聚合的<strong class="is hj">词</strong>(像“是”、“这个”、“不是”和“那个”这样的词往往不会有助于算法的解释)。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="5669" class="ll ke hi lh b fi lm ln l lo lp"><strong class="lh hj">def</strong> Preprocessing(instancia):<br/>    <em class="lq"># </em>instantiating the stemmer method<br/>    stemmer = nltk.stem.RSLPStemmer()<br/><br/>    <em class="lq"># </em>removing links from text<br/>    instancia = re.sub(r"http\S+", "", instancia).lower().replace('.','').replace(';','').replace('-','').replace(':','').replace(')','')<br/><br/>    <em class="lq"># </em>aggregating the stopwords into a list<br/>    stopwords = set(nltk.corpus.stopwords.words('english'))<br/><br/>    <em class="lq"># </em>removing the stopwords from the sentence<br/>    palavras = [stemmer.stem(i) <strong class="lh hj">for</strong> i <strong class="lh hj">in</strong> instancia.split() <strong class="lh hj">if</strong> <strong class="lh hj">not</strong> i <strong class="lh hj">in</strong> stopwords]<br/>    <br/>    <strong class="lh hj">return</strong> (" ".join(palavras))</span></pre><p id="2439" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不打算详细介绍每一行代码是做什么的，但一般来说，我们使用python的<strong class="is hj"> RE </strong>库来<strong class="is hj">从链接</strong>中移除某些字符和前缀，就像我们使用<strong class="is hj"> NLTK </strong>库来将停用词存储在列表中，然后<strong class="is hj">再从句子(实例)中移除它们</strong>。</p><p id="2bca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意:我们应该指出的是，这些预处理技术需要大量的处理和时间，因此我们在应用时必须考虑到这一点，因为并非在所有情况下，这些预处理都会在我们的模型中产生明显更好的结果。</strong></p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/36c0a67543f37070f0fde6466decd345.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*cGwg_byxqCwzj3pHQ3a3_w.gif"/></div></figure><p id="7746" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">处理完我们的文本后，是时候开始机器学习本身了。</p><p id="f1a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我想马上强调的一点是:<strong class="is hj">机器不处理文本！你看到的没错，<strong class="is hj">电脑无法理解字母是什么！</strong>毕竟，我们要如何解决这个问题？很简单:计算机理解数字而不是单词，所以我们为什么不把文本转换成数字呢？这正是我们将要做的。</strong></p><p id="80b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用机器学习<strong class="is hj"> Scikit Learn </strong>库中的<em class="lq">计数矢量器</em>方法，我们可以解决这个问题！</p><p id="cd80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们举个例子:</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="622a" class="ll ke hi lh b fi lm ln l lo lp">frase = ["Olá Mundo!","Olá , Meu nome é Luís Miguel"]</span><span id="96d3" class="ll ke hi lh b fi ls ln l lo lp">vetorizador = CountVectorizer(analyzer="word")</span><span id="8ef2" class="ll ke hi lh b fi ls ln l lo lp">frase = vetorizador.fit_transform(frase)</span><span id="0067" class="ll ke hi lh b fi ls ln l lo lp">print(frase)</span><span id="8138" class="ll ke hi lh b fi ls ln l lo lp">output:<br/><br/>  (0, 5) 1   <br/>  (0, 3) 1   <br/>  (1, 5) 1<br/>  (1, 1) 1   <br/>  (1, 4) 1   <br/>  (1, 0) 1   <br/>  (1, 2) 1</span></pre><p id="c059" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意，我们有一个用括号括起来的元组(一组值),在其中我们可以看到列表中单词的索引作为第一个元素，然后我们有一个与该单词相关联的数值。请注意，单词“Olá”在列表的两个项目中都被赋予了值“5”。</p><p id="32ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">usando essa veto Riza o vamos aplicar as altera es em nossos textos:</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="f768" class="ll ke hi lh b fi lm ln l lo lp">reviews = df['Review Text']</span><span id="509c" class="ll ke hi lh b fi ls ln l lo lp">reviews_processed = [Preprocessing(i) <strong class="lh hj">for</strong> i <strong class="lh hj">in</strong> reviews]</span><span id="5a76" class="ll ke hi lh b fi ls ln l lo lp">reviews_processed = vetorizador.fit_transform(reviews_processed)</span></pre><p id="214f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将我们的数据集称为“df ”,只将文本保存在一个变量中，然后应用预处理技术，最后将文本“矢量化”。</p><p id="069f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最期待的部分已经到来，创造模型！经历了这么多麻烦之后，我们可以看到我们将要创造的东西。</p><p id="b9c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我选择使用的算法是<strong class="is hj">朴素贝叶斯多项式</strong>，它最适合我们的分析，甚至是最值得推荐的。如果你想更多地了解他和他背后的数学理论，我建议<a class="ae jo" href="https://www.organicadigital.com/blog/algoritmo-de-classificacao-naive-bayes/" rel="noopener ugc nofollow" target="_blank">这篇</a>文章，作者是劳罗·贝克尔。</p><pre class="lb lc ld le fd lg lh li lj aw lk bi"><span id="7594" class="ll ke hi lh b fi lm ln l lo lp">X_treino, X_teste, y_treino, y_teste = train_test_split(reviews_processed , y , random_state=42 , stratify=y)</span><span id="8403" class="ll ke hi lh b fi ls ln l lo lp">modelo = MultinomialNB()</span><span id="8e59" class="ll ke hi lh b fi ls ln l lo lp">modelo.fit(X_treino , y_treino)</span><span id="60d3" class="ll ke hi lh b fi ls ln l lo lp">predicoes = modelo.predict(X_teste)</span></pre><p id="ef8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们首先将我们的数据分为训练和测试数据，以便能够衡量我们的模型最终有多好。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es if"><img src="../Images/7de026bd82f8dd75f8ddbbf8ee21ca80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*03noWozxs5vxm0qZjuiRDw.jpeg"/></div></figure><p id="31be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们训练并做了预测，是时候看看他的结果了:</p><figure class="lb lc ld le fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/4b160369340539472fad9071c74a416a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LN7vTT1rO6lcb03tBosA-A.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">我们模型的结果</figcaption></figure><p id="6470" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的准确率相对较低，只有0.61 (61%的整体命中率)，除此之外，随着等级的提高，我们的准确率会更高。这要归功于我们自己的数据。在使用的集合中，我们有一个不平衡的特征，也就是说，我们有更多的数据用于评分为5的评论。这无疑改变了我们模型的效率。</p><p id="41e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有一种方法可以“解决”这个问题，我已经写了一篇关于不平衡类的文章，可以点击<a class="ae jo" href="https://luis-miguel-code.medium.com/how-to-deal-with-unbalanced-classes-in-machine-learning-precision-recall-oversampling-and-9a719d9bb3b0" rel="noopener">这里</a>随意阅读。</p><p id="603f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天我不打算解决这个问题，但如果你愿意，你可以解决这个问题，并测试效率的差异。</p><p id="6554" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在关于Colab的原始文章中，我解决了这个问题，如果你想看完整版，请点击<a class="ae jo" href="https://colab.research.google.com/github/LuisMig-code/NLP-com-Reviews-de-roupas-femininas/blob/main/NLP_Reviews_roupas_femininas.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="89f9" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">了解更多:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/55ad2236d85a0fadbcfe06e5186b4310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*SFf3VczKcQODbUZ3Ik2H6g.gif"/></div></figure><p id="7971" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想加深知识，这里有一些有用文章的链接:</p><ul class=""><li id="2f25" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><a class="ae jo" href="https://www.ibm.com/cloud/learn/natural-language-processing" rel="noopener ugc nofollow" target="_blank">自然语言处理(NLP)——IBM</a>；</li><li id="06ff" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://www.digitalhouse.com/br/blog/naive-bayes" rel="noopener ugc nofollow" target="_blank">朴素贝叶斯:机器学习算法的共同功能——数字房屋</a></li></ul></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><h1 id="e8fa" class="kd ke hi bd kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la bi translated">链接:</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/b5ba56e8fbd83a9a27322ff216c8f4ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/1*uutu42mKUJsFb8YF0gZnfQ.gif"/></div></figure><p id="df5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">点击</strong> <a class="ae jo" href="https://colab.research.google.com/github/LuisMig-code/NLP-com-Reviews-de-roupas-femininas/blob/main/NLP_Reviews_roupas_femininas.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">此处</strong> </a>可访问包含所有代码行和更详细解释的GoogleColaboratory笔记本</p><p id="4043" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢您阅读本文，请考虑访问其他文章并在社交媒体上找到我:</p><ul class=""><li id="b88e" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">Github </li><li id="be16" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://www.linkedin.com/in/luis-miguel-code/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></li><li id="fd52" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://linktr.ee/iNukss" rel="noopener ugc nofollow" target="_blank"> LinkTree </a></li></ul></div></div>    
</body>
</html>