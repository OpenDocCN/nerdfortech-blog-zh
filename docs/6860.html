<html>
<head>
<title>Take it easy with Makefile</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻松使用 Makefile</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/take-it-easy-with-makefile-c1e31fb38928?source=collection_archive---------3-----------------------#2022-05-30">https://medium.com/nerd-for-tech/take-it-easy-with-makefile-c1e31fb38928?source=collection_archive---------3-----------------------#2022-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ab7a5a3597ed6d963beadc1075bfdf30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4AXj6U-vhOExG4JY"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@wesleyphotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">韦斯利·廷吉</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="876f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di"> M </span>虽然 Makefile 乍听起来很简单，但它让使用一个命令执行一长串命令和函数变得非常容易。</p><p id="0d65" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如:创建虚拟环境、设置环境变量和安装依赖项可以使用一个<code class="du kc kd ke kf b">make install</code>命令来完成。酷吧？</p><h1 id="7ff1" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">先决条件</h1><p id="11e9" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">要验证 make 是否安装在您的系统中，请在命令行中运行<code class="du kc kd ke kf b">make</code>。如果没有安装，您可以使用</p><pre class="lk ll lm ln fd lo kf lp lq aw lr bi"><span id="b39c" class="ls ki hi kf b fi lt lu l lv lw">sudo apt-get install build-essential</span></pre><h1 id="10cc" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">入门</strong></h1><p id="7c22" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">Makefile 可以被认为是以预定义结构编写的规则集合。规则通常具有以下格式。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="4cf1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个<strong class="ix hj"> <em class="kg">目标</em> </strong>可以是可执行文件或一个目标文件的名称。它也可以是规则或操作的名称。<br/>一个<strong class="ix hj"> <em class="kg">先决条件</em> </strong>是一个用作目标输入的动作或文件。在运行目标的命令之前，这些文件/操作需要存在。这些也叫<strong class="ix hj"> <em class="kg">依赖</em> </strong>。我们可以为一个目标声明多个依赖项，用空格分隔它们。有些规则可能不需要任何依赖关系。<br/>一个<strong class="ix hj"> <em class="kg">命令</em> </strong>是一个需要完成的单一工作单元，以便“制定”目标。这些需要以一个<em class="kg">制表符开始。</em></p><blockquote class="lz ma mb"><p id="6211" class="iv iw kg ix b iy iz ja jb jc jd je jf mc jh ji jj md jl jm jn me jp jq jr js hb bi translated">如果您喜欢使用 tab 以外的字符，您可以将<code class="du kc kd ke kf b">.RECIPEPREFIX</code>变量设置为替代字符。</p></blockquote><h2 id="bdeb" class="ls ki hi bd kj mf mg mh kn mi mj mk kr jg ml mm kv jk mn mo kz jo mp mq ld mr bi translated">例子</h2><p id="a893" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">现在让我们编写第一个<code class="du kc kd ke kf b">make</code>命令，在被调用时打印“Hello World”。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="448b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要运行这个命令，请转到您的终端，进入与 Makefile 相同的目录，并使用:</p><pre class="lk ll lm ln fd lo kf lp lq aw lr bi"><span id="e1d9" class="ls ki hi kf b fi lt lu l lv lw">make run</span></pre><p id="cb23" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您将看到类似于以下内容的输出:</p><pre class="lk ll lm ln fd lo kf lp lq aw lr bi"><span id="04c3" class="ls ki hi kf b fi lt lu l lv lw">echo "Hello World"<br/>Hello World</span></pre><p id="81f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如您所看到的，实际的命令在命令输出之前打印出来。要停止这种行为，您可以在命令的开头添加一个“<code class="du kc kd ke kf b">@</code>”符号，以防止它被打印出来。</p><p id="212b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以在 Makefile 中使用 v <em class="kg">变量</em>来保存文件信息、一些参数，或者甚至是命令的一部分。变量被写入<strong class="ix hj">大写</strong>，后跟一个<code class="du kc kd ke kf b">=</code>符号。变量通常在文件的顶部声明。我们可以使用<code class="du kc kd ke kf b">${VARIABLE_NAME}</code>来访问它们的值，其中<strong class="ix hj"> VARIABLE_NAME </strong>是您想要访问其值的变量。</p><p id="377a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有时，我们也用符号<code class="du kc kd ke kf b">?=</code>来设定以前没有的变量。如果变量已经设置，赋值操作将被忽略。</p><p id="ea0f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们试着为一个简单的 Django 项目编写一个稍微酷一点的 Makefile，它能够设置一个虚拟环境，安装依赖项，并运行基本但常用的 Django 命令。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="2132" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以使用像<code class="du kc kd ke kf b">make install</code>、<code class="du kc kd ke kf b">make format</code>这样的命令来快速设置工作空间并开始工作。相当整洁！</p><p id="6424" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">默认情况下，如果我们只在命令行中键入<code class="du kc kd ke kf b">make</code>，那么将执行第一个定义的规则。要执行其他一些规则，我们需要在 Makefile 中设置<code class="du kc kd ke kf b">.DEFAULT_GOAL</code>变量。比如我们想默认执行<code class="du kc kd ke kf b">install</code>，定义<code class="du kc kd ke kf b">.DEFAULT_GOAL=install</code>。现在，当我们在命令行中运行<code class="du kc kd ke kf b">make</code>时，我们应该会看到以下输出:</p><pre class="lk ll lm ln fd lo kf lp lq aw lr bi"><span id="6bf0" class="ls ki hi kf b fi lt lu l lv lw">-&gt; Making Virtual Environment<br/>-&gt; Installing Dependencies<br/>.<br/>.<br/>.<br/>(installation proceeds)</span></pre><p id="18f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读！如果你有任何疑问或建议，请在评论中告诉我。</p><h1 id="f334" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">参考</h1><div class="ms mt ez fb mu mv"><a href="https://opensource.com/article/18/8/what-how-makefile" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hj fi z dy na ea eb nb ed ef hh bi translated">什么是 Makefile，它是如何工作的？</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">如果您想在某些文件更新时运行或更新任务，make 实用程序会派上用场。品牌……</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">opensource.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj io mv"/></div></div></a></div><div class="ms mt ez fb mu mv"><a href="https://makefiletutorial.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hj fi z dy na ea eb nb ed ef hh bi translated">Makefile 示例教程</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">我创建这个指南是因为我从来没有完全理解过 Makefiles。他们似乎充斥着潜规则和…</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">makefiletutorial.com</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj io mv"/></div></div></a></div></div></div>    
</body>
</html>