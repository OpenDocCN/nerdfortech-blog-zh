<html>
<head>
<title>The Debian Series: disk partitions and filesystems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Debian系列:磁盘分区和文件系统</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/the-debian-series-disk-partitions-and-filesystems-6303073ba6fd?source=collection_archive---------5-----------------------#2019-11-07">https://medium.com/nerd-for-tech/the-debian-series-disk-partitions-and-filesystems-6303073ba6fd?source=collection_archive---------5-----------------------#2019-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="503f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">借此机会，我们将做一个关于如何执行和评估硬盘或任何类型的存储外围设备状态的实际案例，为特定磁盘生成一个分区表，并讨论一系列实用命令，这些命令</p><p id="359a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么是现实生活中的例子？因为除此之外，还有很多相关的理论，大部分可以呈现给你的情况都是真实的。</p><p id="0c5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我一直在使用一个Debian 7实例，但是我很确定这个研讨会中使用的大多数命令在不同的UNIX操作系统上都能很好地工作。我们不需要为此安装额外的工具。出于明显的原因，我们只需要一个额外的u盘。</p><p id="af28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">亲提示:你需要非常小心地选择一个磁盘，这是一个非常愚蠢的事情，选择你的主磁盘上运行你的操作系统。相信我，它会发生的。</p><p id="30e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始使用<code class="du jd je jf jg b">dmesg</code>命令，这将评估已安装的磁盘实例，并向我们显示内核的完整日志及其识别的内容。这个命令的输出非常大，所以，您需要使用标志来过滤数据。我建议使用<code class="du jd je jf jg b">man</code>来检查参数，以过滤日志类型，不管你想要什么原因。</p><p id="4761" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个关键命令是<code class="du jd je jf jg b">df</code>，这个命令报告可用的每个磁盘、闪存或分区的磁盘实例、文件系统和存储空间。旗帜<code class="du jd je jf jg b">-h</code>是人类可读的，在指南、教程或书籍中看到这种组合<code class="du jd je jf jg b">df -h</code>是很常见的。</p><p id="d869" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续之前，让我们停下来，开始一个场景，当我们在<code class="du jd je jf jg b">/dev/sda</code>上有一个主硬盘，在<code class="du jd je jf jg b">/dev/sdb</code>上连接并放置了一个闪存驱动器</p><p id="d9df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">说了这么多，我需要引入<code class="du jd je jf jg b">fdisk</code>命令，一个允许你操作磁盘和分区的系统二进制程序。您可以随时使用<code class="du jd je jf jg b">man</code>命令查阅文档。</p><p id="02fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">fdisk</code>在选择了我们要使用的磁盘后，驱动您进入向导，在我们的例子中，我们将使用<code class="du jd je jf jg b">/dev/sdb</code>磁盘。</p><p id="76b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事情是这样的:</p><p id="38c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">fdisk /dev/sdb</code></p><p id="8cda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将启动向导，<code class="du jd je jf jg b">p</code>选项将向您显示一个分区列表，<code class="du jd je jf jg b">n</code>选项将允许从磁盘创建一个新的分区，在<code class="du jd je jf jg b">n</code>选项内(作为子级别)，您将需要放置大小(基于扇区)和我们要创建的分区类型</p><p id="dd99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的特定示例中，我将创建一个主分区(缺省值为1)，当然，在我的示例中，带有开始值和结束值的扇区值将从2048–20971519。很好，所以，在那之后，我们使用<code class="du jd je jf jg b">w</code>来写更改，一个新的分区被创建。</p><p id="73ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新分区在:<code class="du jd je jf jg b">/dev/sdb1</code></p><p id="ad6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们需要使用旧的<code class="du jd je jf jg b">mfks</code>实用程序为创建的分区设置文件系统类型，有很多选项，但常见的有<code class="du jd je jf jg b">ext3</code>、<code class="du jd je jf jg b">ext4</code>或<code class="du jd je jf jg b">ntfs</code></p><p id="0f78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们这样做，<code class="du jd je jf jg b">mkfs -t ext4 /dev/sdb1</code></p><p id="27d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我刚刚格式化了<code class="du jd je jf jg b">/dev/sdb1</code>磁盘的分区1</p><p id="056e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以将创建的分区挂载到OS目录中(只是为了测试它是否正常工作)。</p><p id="e375" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为根用户，我们在任何地方创建一个目录，我们将分区挂载到创建的目录，然后用任何东西填充它(txt的文件、图像等等)</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="d2d1" class="jp jq hi jg b fi jr js l jt ju">mkdir /test-directory<br/>mount /dev/sdb1 /test-directory<br/>cd /test-directory<br/>seq 1 1000000 &gt; numbers.txt</span></pre><p id="387f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对应的是<code class="du jd je jf jg b">umount</code>命令。轻松卸载分区</p><p id="902c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">umount /dev/sdb1</code></p><p id="6667" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再多读一点，有一种方法可以将挂载的分区保存到OS目录中，就像最近一篇文章中提到的。这有点棘手(至少对我来说)，当然，首先是困难的。</p><p id="2d7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阅读<a class="ae jv" href="https://www.howtogeek.com/howto/38125/htg-explains-what-is-the-linux-fstab-and-how-does-it-work/" rel="noopener ugc nofollow" target="_blank">这篇</a>文章我发现，<code class="du jd je jf jg b">fstab</code>或操作系统的文件系统表是一个文件，它描述了计算机启动时或运行时(手动)将随时挂载的更改和驱动器。</p><p id="f533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在同一篇文章中，我引用了这句话来加强我的解释:“Fstab被配置为寻找特定的文件系统，并每次都以所需的方式自动挂载它们，从而防止无数灾难的发生。”</p><p id="8022" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该文件位于<code class="du jd je jf jg b">/etc/fstab</code>，您可以更改或保持之前的配置。</p><p id="fb72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仔细看看这个例子:</p><pre class="jh ji jj jk fd jl jg jm jn aw jo bi"><span id="d88c" class="jp jq hi jg b fi jr js l jt ju">nano /etc/fstab<br/># now we are going to places the previous changes<br/>UUID=XXXX /test-directory ext4 </span></pre><p id="570b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用应用于特定分区的<code class="du jd je jf jg b">blkid</code>命令可以获得UUID值。</p><p id="4cbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">blkid /dev/sdb1</code></p><p id="1750" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">复制并粘贴到<code class="du jd je jf jg b">/etc/fstab</code>上</p><p id="359c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，您需要使用<code class="du jd je jf jg b">mount -a</code>命令将更改挂载到文件上。并且，在您完全完成后，需要重新启动以获得持久驱动器。</p><p id="6c06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您总是可以通过运行<code class="du jd je jf jg b">df -h</code>来验证是否一切顺利，并查看是否出现了预期的变化。</p><p id="0cd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个特别的故事是在运行中创建的，在整个过程中有很多不好的期望和错误，我相信我很容易忘记在这里解释一些东西，但我会在未来更新它。</p><p id="f53a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读，并在本系列的下一篇文章中继续讨论交换内存配置。</p><p id="7733" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">敬请关注。</p><p id="0c2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐编码:)</p></div></div>    
</body>
</html>