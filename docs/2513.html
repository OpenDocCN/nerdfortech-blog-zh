<html>
<head>
<title>Imputing Missing Data with R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R输入缺失数据</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/imputing-missing-data-with-r-a7f04692c895?source=collection_archive---------14-----------------------#2021-05-09">https://medium.com/nerd-for-tech/imputing-missing-data-with-r-a7f04692c895?source=collection_archive---------14-----------------------#2021-05-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="8cb0" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">“不完整的数据导致不完整的结论。”(<strong class="ak">亨利·h·内夫，</strong> <a class="ae ix" href="https://www.goodreads.com/work/quotes/3646120" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">罗文的猎犬</strong> </a> <strong class="ak"> ) </strong></h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/35e4c8e849c1a9e38fdb0637bdcc00d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FmnPg3dBe8YxvBl-"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">照片由<a class="ae ix" href="https://unsplash.com/@mbaumi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米卡·鲍梅斯特</a>在<a class="ae ix" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8cf7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在数据建模之前，我们必须实施的一种常见数据准备方法是缺失值的插补。在处理数据集时，我们经常会遇到可能缺少大量值的变量。如果这些值处理不当，从我们的数据推断可能是不准确的。</p><p id="4d8a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="kk">为什么数据会丢失？</em>T15】</strong></p><p id="2c60" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在开始我们的案例研究之前，让我们试着理解“缺失”的一些原因:</p><ol class=""><li id="4af6" class="kl km hi jq b jr js ju jv jx kn kb ko kf kp kj kq kr ks kt bi translated"><strong class="jq hj">完全随机缺失(MCAR): </strong>这里假设所有情况下缺失值的概率是相同的。因此，如果我们删除所有带有缺失值的案例，我们将不会导致偏差，但会丢失信息。</li><li id="09f4" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj kq kr ks kt bi translated"><strong class="jq hj">随机缺失(MAR): </strong>一个值缺失的概率取决于一个已知的机制。例如，某些群体不太可能比其他群体对社会调查做出回应。只要我们知道案例的组成员，我们就可以通过一些调整删除这些缺失的案例(Faraway，2014)。然而，有更好的方法来处理MAR问题，我们将在本帖中进一步讨论。</li><li id="e80b" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj kq kr ks kt bi translated"><strong class="jq hj">非随机缺失(MNAR): </strong>这种假设缺失值的概率取决于未观察到的变量或假设值。</li></ol><p id="fe3c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们下面的案例研究主要涉及MAR。</p><h1 id="7832" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated"><strong class="ak"> <em class="lr">案例分析</em> </strong></h1><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es ls"><img src="../Images/ffdfcd77474815037fb9a24fbe89295e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1WDGc03F-QbWX8Fd"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">由<a class="ae ix" href="https://unsplash.com/@kkalerry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Klara Kulikova </a>在<a class="ae ix" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2777" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们将探索一个包含12，795种市售葡萄酒信息的数据集。数据集可以在我的<a class="ae ix" href="https://raw.githubusercontent.com/AtinaKarim/DATA_621/master/dataset.csv" rel="noopener ugc nofollow" target="_blank"> Github </a>中获得。</p><p id="f028" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是对数据集中感兴趣的变量的描述:</p><p id="7f39" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">目标:</strong>购买例数<br/> <strong class="jq hj">酸度指数:</strong>采用加权平均法检测葡萄酒总酸度的专有方法<br/> <strong class="jq hj">酒精:</strong>酒精含量<br/> <strong class="jq hj">氯化物:</strong>葡萄酒的氯化物含量<br/> <strong class="jq hj">柠檬酸:</strong>柠檬酸含量<br/> <strong class="jq hj">密度:</strong>葡萄酒的密度<br/> <strong class="jq hj">固定酸度:</strong>葡萄酒的固定酸度<br/> <strong class="jq hj">高数字表明消费者喜欢标签设计。负数表明顾客不喜欢这个设计。许多消费者基于葡萄酒标签设计的视觉吸引力进行购买。更高的数字意味着更好的销售。<br/> <strong class="jq hj">残糖:</strong>葡萄酒的残糖<br/> <strong class="jq hj">星级:</strong>葡萄酒由专家团队评定等级。4颗星=优秀，1颗星= PoorA高星数表明高销量<br/> <strong class="jq hj">硫酸盐:</strong>葡萄酒中的硫酸盐含量<br/> <strong class="jq hj">总二氧化硫:</strong>葡萄酒中的总二氧化硫|| <br/> <strong class="jq hj">挥发性酸度:</strong>葡萄酒中的挥发酸含量<br/> <strong class="jq hj"> pH: </strong>葡萄酒的pH</strong></p><p id="c4f8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">缺失值</strong></p><p id="051b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们运行下面的代码来检测数据集中的一些缺失值。</p><pre class="iz ja jb jc fd lt lu lv lw aw lx bi"><span id="8311" class="ly la hi lu b fi lz ma l mb mc">library(skimr)<br/>skimr::skim(wine_train)</span></pre><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es md"><img src="../Images/5c1cdc10650ad0b339b820abac5349d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*l06OUXTG2jNzRentB75VqQ.png"/></div></figure><p id="6497" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">STARS在所有变量中完成率最低(约73%)。在这种情况下，可能缺少的价值是有待星级评定的葡萄酒品牌。</p><p id="0f0a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本帖中，我们将尝试三种处理缺失数据的方法——删除法、均值/中位数估算法和线性回归估算法。</p><p id="ece2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">删除</strong></p><pre class="iz ja jb jc fd lt lu lv lw aw lx bi"><span id="f03a" class="ly la hi lu b fi lz ma l mb mc">deletedata &lt;- na.omit(dataset)</span></pre><p id="2679" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这将删除具有一个或多个缺失值的观测的所有数据。然而，通过这种方法，我们正在丢失许多信息。或者，我们的代码也将丢失的变量重新编码为0。</p><pre class="iz ja jb jc fd lt lu lv lw aw lx bi"><span id="8c65" class="ly la hi lu b fi lz ma l mb mc">dataset2 &lt;- dataset%&gt;%<br/>  mutate(STARS = replace_na(STARS, 0)) </span></pre><p id="e15f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">均值、中值和众数插补</strong></p><pre class="iz ja jb jc fd lt lu lv lw aw lx bi"><span id="4cfd" class="ly la hi lu b fi lz ma l mb mc">library(imputeTS)<br/>dataset3&lt;- na.mean(dataset, option = "mean")   <br/>dataset4 &lt;-na.mean(dataset, option = "median")<br/>dataset5 &lt;-na.mean(dataset, option = "mode")</span></pre><p id="ad33" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是估算缺失数据的一种快速简便的方法。但是，这种方法减少了数据集中的方差并缩小了标准误差。此外，平均值容易受到异常值的影响(这不是我们关心的问题，因为STARS不是一个连续变量，它有固定的值)。</p><p id="2ba0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">线性回归</strong></p><p id="e02b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们将通过使用随机森林方法使用R中的MICE库进行预测来估算我们的数据。更多关于小鼠的插补方法可在<a class="ae ix" href="https://www.rdocumentation.org/packages/mice/versions/2.25/topics/mice" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><pre class="iz ja jb jc fd lt lu lv lw aw lx bi"><span id="e522" class="ly la hi lu b fi lz ma l mb mc">library(mice)<br/>dataset_mice &lt;- mice(dataset, method = 'rf', m = 1)</span></pre><p id="6e13" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果插补模型是正确的，这是插补缺失数据的最佳方法。</p><h1 id="e746" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated">估价</h1><p id="7f76" class="pw-post-body-paragraph jo jp hi jq b jr me ij jt ju mf im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">在我的下一篇<a class="ae ix" href="https://atinakarim.medium.com/imputing-missing-data-with-r-evaluation-with-linear-regression-cb7e6e07302d" rel="noopener"/>文章中，我将稍微讨论一下这种情况下的数据建模，并评估哪一个结果给了我们最好的模型拟合。</p><p id="b577" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我也在下面列出了所有帮助我写这篇文章的惊人资源。如果你想更深入地研究缺失数据和插补方法，请查阅它们。</p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><h2 id="136f" class="ly la hi bd lb mq mr ms lf mt mu mv lj jx mw mx ll kb my mz ln kf na nb lp nc bi translated">引文</h2><p id="f711" class="pw-post-body-paragraph jo jp hi jq b jr me ij jt ju mf im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">Swalin，A. S. (2018年1月30日)。<em class="kk">如何处理丢失的数据</em>。走向数据科学。https://towardsdatascience . com/how-to-handle-missing-data-8646 b 18 db0d 4</p><p id="1cea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">统计解决方案。(2021年1月1日)。<em class="kk">数据中缺少数值</em>。<a class="ae ix" href="https://www.statisticssolutions.com/missing-values-in-data/" rel="noopener ugc nofollow" target="_blank">https://www.statisticssolutions.com/missing-values-in-data/</a></p><p id="4e40" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">遥远的，J. J. (2014)。<em class="kk">带R的线性模型(统计科学中的Chapman &amp; Hall/CRC文本)</em>(第二版。).查普曼和霍尔/CRC。</p></div></div>    
</body>
</html>