<html>
<head>
<title>Tomato plant leaf Disease detection using CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于CNN的番茄叶部病害检测</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/tomato-plant-leaf-disease-detection-using-cnn-2ee2dd8ab77a?source=collection_archive---------0-----------------------#2021-10-29">https://medium.com/nerd-for-tech/tomato-plant-leaf-disease-detection-using-cnn-2ee2dd8ab77a?source=collection_archive---------0-----------------------#2021-10-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1f874bb0a7427a5d947115b41fe15ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Yfq6GPVcby0x2E0"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@mekalluakella?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kalyani Akella </a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="8783" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">简介:</strong>在本帖中，我们将讨论番茄植株叶片中的病害检测。通常，植物叶子会遭受各种类型的疾病。在深度学习技术的帮助下，我们可以提供一个检测模型来检测特定的疾病，并采取进一步的行动。我们将应用深度学习算法来创建模型，这些模型可以检测番茄植物叶子中的疾病。在训练模型之后，我们还将分析我们训练的模型的性能。我们还分析了迁移学习对疾病检测的影响。</p><p id="76c7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">数据集:</strong>我们将使用一个公开可用的数据集<a class="ae iu" href="https://www.kaggle.com/kaustubhb999/tomatoleaf" rel="noopener ugc nofollow" target="_blank">番茄植株叶片</a>，其中包含10000个文件。数据集有10种均匀分布的疾病。数据集包含以下病害:细菌性斑点病、健康病、早疫病、叶霉病、晚疫病、葡萄斑病、花叶病毒、叶螨、目标斑病、黄化卷叶病毒。我们只使用每一类疾病的100份档案。您可以使用完整大小的数据集进行实验。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/491f0a88a939e410e91200558f024423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hb1oDiTCLV3ctfY_1t-mww.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图01树叶示例</figcaption></figure><p id="4b46" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">流程图:</strong>图02显示了我们的休假疾病检测任务方法的概述。我们将详细讨论每个阶段。我们训练两种类型的深度学习模型，从数据中探索和获得洞察力。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/628e33f1f34896460d7b71335a537513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*eH1UqU43sy5msZu85dH1GQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图02工艺流程</figcaption></figure><ol class=""><li id="e717" class="jz ka hi ix b iy iz jc jd jg kb jk kc jo kd js ke kf kg kh bi translated"><strong class="ix hj">预处理:</strong>我们应用一般的图像预处理步骤来生成训练和测试数据。每个图像的大小为(256，256，3)。</li><li id="8180" class="jz ka hi ix b iy ki jc kj jg kk jk kl jo km js ke kf kg kh bi translated"><strong class="ix hj">基本CNN模型训练:</strong>在对数据进行预处理后，我们创建了我们的第一个深度学习模型。我们构建了一个具有所需输入和输出单元的卷积神经网络模型。我们的CNN模型的最终架构如图3所示。</li></ol><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/cf271c2ce19329649d8bdd36f3d5d637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*lZw_MQCvPFpp1GWw_QtxsA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图03模型架构</figcaption></figure><p id="c663" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们用Adam optimizer以0.0001的学习率训练我们的CNN模型500个时期。我们使用分类交叉熵作为损失函数。图04显示了精度方面的训练和验证损失以及模型性能。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/1bf5cba1bd191b0209daf36abe0907d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4VSL-9j4XLNm8Q5V-h3vA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图04培训和验证性能</figcaption></figure><p id="22f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 3。基于迁移学习的模型训练:</strong>我们每种体裁只有80个样本进行训练。在这种情况下，迁移学习可能是一个有用的选择，以提高我们的CNN模型的性能。现在，我们使用预先训练好的mobilenet模型来训练CNN模型。原理图见图05。基于迁移学习的模型使用与先前模型中使用的相同设置进行训练。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/94d8947b367827357f29d78ab5b78ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*VkuMjArK56I3ToUyv7s3FA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图05。迁移学习模型架构</figcaption></figure><p id="7df3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">图06显示了两种模型的损耗和性能对比分析。如果我们分析模型的训练行为，我们发现基本CNN模型在训练和测试数据的损失值和性能分数方面有很大的波动。基于迁移学习的模型表现出较小的性能差异。与基本CNN模型相比，迁移学习模型的性能逐渐提高。验证损失值在20个时期后突然上升。另一方面，另一种迁移学习模式的验证损失不断减少。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/16df24fdaf3afd85750fc01414e44f30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sY4EPR8N0Fa03oEdmGJbhA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图06培训和验证性能比较</figcaption></figure><p id="5388" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">测试模型</strong></p><p id="50c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在训练我们的模型之后，我们在20%的测试数据上测试每个模型。我们计算每种疾病(类别)的精确度、召回率和F分数。我们的数据集是平衡的；因此，精度、召回率和F值的宏观平均值和加权平均值是相同的。</p><p id="a87e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">基本CNN模型:</strong>图07展示了我们的CNN模型对测试数据的结果。CNN模型能够以最高的F1值对“黄化曲叶病毒”病害进行分类。CNN对“Septoria_Leaf_Spot”和“Leaf_Mold”疾病的表现最差。图08显示了CNN模型对测试数据的混淆矩阵。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/8a267483d5f8a9faa93aeda822ffeaa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*k6CYw9SJZfZhVLVX7A7U9w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图07基本CNN模型在测试数据上的表现</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/b6b70b1d6048550b37ac37dfb34748bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*SZag-esCGv4-Tn2HJwTS0w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图08基本CNN模型的混淆矩阵</figcaption></figure><p id="1809" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">基于迁移学习的模型:</strong>我们使用迁移学习技术来改善疾病的表现。图09展示了基于迁移学习模型的测试数据的结果。由于迁移学习,“黑斑病”和“叶霉病”疾病的F1分数增加。如果我们从整体结果来看，我们在应用迁移学习后取得了很大的进步。F-1平均得分增加了20%。图10显示了测试数据上迁移学习模型的混淆矩阵。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/ac0b91665a4d4f4743c118f727f97509.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*hCqKIFLyCtYq3QXzFeGMSA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图09。测试数据上的迁移学习模型性能</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/84f8e84867d3208791f1e161596283b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*BPBU_ECT9GJN4c1XvMtW7A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图10迁移学习模型的混淆矩阵</figcaption></figure><p id="8afe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我们使用深度学习技术进行了番茄叶病检测。基于迁移学习的模型表现最好。我们使用Keras框架在google Collaboratory平台上实现。源代码可从以下GitHub链接获得:<a class="ae iu" href="https://github.com/sawan16/Tomato-Plant-Leave-Disease-detection" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/sawan 16/Tomato-Plant-leaf-Disease-detection</a></p><p id="754e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢你。</p></div></div>    
</body>
</html>