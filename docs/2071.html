<html>
<head>
<title>A Modern Jazz Discovery Tool (pt. 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现代爵士乐发现工具(pt。2)</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/a-modern-jazz-discovery-tool-pt-2-82adb4f97e36?source=collection_archive---------19-----------------------#2021-04-19">https://medium.com/nerd-for-tech/a-modern-jazz-discovery-tool-pt-2-82adb4f97e36?source=collection_archive---------19-----------------------#2021-04-19</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><div class=""><h2 id="9924" class="pw-subtitle-paragraph ig hi hj bd b ih ii ij ik il im in io ip iq ir is it iu iv iw ix dy translated">这是两部分系列的第二部分。本文主要关注在Streamlit上部署我的基于内容的发现工具。</h2></div><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et iy"><img src="../Images/f05e0b9c729e939f051f155c37387ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFpVzpk9M2NcU4zyfRQ8cQ.png"/></div></div></figure><p id="066b" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated"><strong class="jm hk">在本系列的</strong> <a class="ae kg" href="https://chris-chan1.medium.com/a-modern-jazz-discovery-tool-420344872985" rel="noopener"> <strong class="jm hk">第一部分</strong> </a> <strong class="jm hk">中，</strong>我带领我们完成了构建现代Jazz发现工具的旅程，从项目的<em class="kh">动机</em>，使用的<em class="kh">数据</em>，从分析数据中收集的<em class="kh">见解</em>，以及推荐器是如何构建的开始。本文将重点介绍<a class="ae kg" href="https://pitchfork-metis.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jm hk">Streamlit</strong></a><strong class="jm hk">app</strong>本身的一个简短教程，以及如何在app中嵌入一个<a class="ae kg" href="https://newsroom.spotify.com/2018-09-04/how-to-embed-spotifys-play-button/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm hk"> Spotify播放按钮</strong> </a>。下面是文章的大致流程:</p><ol class=""><li id="ad2d" class="ki kj hj jm b jn jo jq jr jt kk jx kl kb km kf kn ko kp kq bi translated">Streamlit应用程序—探索数据</li><li id="1cc7" class="ki kj hj jm b jn kr jq ks jt kt jx ku kb kv kf kn ko kp kq bi translated">Streamlit应用程序—按艺术家或流派发现</li><li id="5b78" class="ki kj hj jm b jn kr jq ks jt kt jx ku kb kv kf kn ko kp kq bi translated">如何嵌入Spotify播放按钮</li></ol><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et kw"><img src="../Images/56d8cfdb686c62b0ee6b88588dee2618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ioSjwYcIh4WV0XIdpqz1QQ.png"/></div></div><figcaption class="kx ky eu es et kz la bd b be z dy translated">app登陆页面截图</figcaption></figure><p id="4fbf" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated"><strong class="jm hk">上面的截图</strong>是我们现代爵士乐发现工具的登陆页面。如左图所示，该工具分为两部分。第一个是<em class="kh">“探索数据</em>”，侧重于数据洞察，更具探索性。例如，我们可以看到类似于上一篇文章中的图表，但是我们有更多的动态功能。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et kw"><img src="../Images/30c29ecb6a193d7cc0588594a3c5d297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6tI9NHJNLBUDB2QMWHukUg.png"/></div></div><figcaption class="kx ky eu es et kz la bd b be z dy translated">Pitchfork jazz专辑评论中提到的顶级艺术家的截图(用户可以选择艺术家的数量)</figcaption></figure><p id="3249" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">工具的第二部分“爵士发现”是推荐系统本身。这就是爵士乐发现奇迹发生的地方！</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et kw"><img src="../Images/5e6f00f14a0f040b3f3318b2508de71f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D0APEfbjQ_RN0XdX6d58iA.png"/></div></div></figure><h2 id="1dec" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated">艺术家搜索</h2><p id="db2c" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">如上所述，用户可以通过键入喜爱的艺术家名字或选择喜爱的流派来发现爵士乐。让我们先看看艺术家的搜索。假设我们想找到类似于电台司令的艺术家，因为那是我们最喜欢的乐队之一。通过在搜索框中输入“电台司令”,可以在爵士乐专辑评论中搜索这个词，看看它是否出现过。接下来，我们可以根据这个搜索参数输入我们希望看到的推荐专辑数量。我们最多可以输入10场比赛。如果没有匹配(意味着电台司令没有出现在任何爵士评论中)，那么我们就不会收到任何推荐。但是，如果有匹配的，推荐系统会找到提到过<em class="kh">电台司令</em>的专辑，并给出这些匹配的列表:</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et kw"><img src="../Images/68f77804d71cafcfc91dcf4f085d427a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Mf2FlbeJMVSfJ9VsCzn8A.png"/></div></div></figure><p id="51af" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">以上是结果的快照。信息包括专辑名称、艺术家和专辑纹理(如前一篇文章所述)。您还将有机会使用<strong class="jm hk"> Spotify播放按钮</strong>收听专辑。我将在下面进一步解释我是如何将它整合到应用程序中的。首先，让我们简要地看一下按类型划分的探索。</p><h2 id="97c6" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated">流派搜索</h2><p id="f5d5" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">比方说，我想发现爵士乐，但我更喜欢T2电子音乐。所以我想找和<em class="kh">电子</em>有相似质感的爵士专辑。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et kw"><img src="../Images/8a686b29ee8f17d917c1f8db086a513d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dVKyKJFRpCGJ4mJoGOT9UA.png"/></div></div></figure><p id="ce02" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">选择了流派= <em class="kh">电子</em>之后，我们还有一个子流派可供选择。假设我们今天有心情享受黑暗的环境。我可以选择短语“<em class="kh">黑暗环境”</em>在评论中出现的频率，如果不止一次，但我们现在选择一个。最后，我们现在有了一个符合我们参数的爵士乐艺术家列表。我对这个叫做<em class="kh">的乐队很好奇。</em>一旦我点击“发现”按钮，默认情况下，我们会得到5个推荐专辑。给出的信息与您按艺术家搜索时的信息相同，但是您也将获得余弦相似性得分:</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et kw"><img src="../Images/c5a5938a273f03f7a5022e9286835ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBr7HLtVRjYIi-9ERshuag.png"/></div></div></figure><h2 id="501e" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated">Spotify播放按钮</h2><p id="2486" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">那么，我们是如何将<strong class="jm hk"> Spotify播放按钮</strong>放入应用程序的呢？根据简单的搜索，有很多关于如何做到这一点的教程。没有放之四海而皆准的方法，所以这里是我拼凑的一些组件，让它在我的Streamlit应用程序中工作。以下是一般步骤:</p><ol class=""><li id="01ca" class="ki kj hj jm b jn jo jq jr jt kk jx kl kb km kf kn ko kp kq bi translated">获取Spotify API凭证，并使用<a class="ae kg" href="https://spotipy.readthedocs.io/en/2.18.0/" rel="noopener ugc nofollow" target="_blank"><strong class="jm hk">Spotify</strong></a>初始化连接</li><li id="a59b" class="ki kj hj jm b jn kr jq ks jt kt jx ku kb kv kf kn ko kp kq bi translated">使用我们的专辑(或艺术家)列表获取<strong class="jm hk"> Spotify嵌入链接</strong></li><li id="e9fa" class="ki kj hj jm b jn kr jq ks jt kt jx ku kb kv kf kn ko kp kq bi translated">将链接放入你的数据框，然后<strong class="jm hk">加载你的应用</strong></li></ol><h2 id="be17" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated"><strong class="ak">第一步。获取Spotify API凭证并建立连接</strong></h2><p id="93d2" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">Spotify的web API非常有用，也很容易使用。我不会深入讨论如何获得Spotify证书，但这里有一个链接指向<a class="ae kg" href="https://developer.spotify.com/documentation/web-api/quick-start/" rel="noopener ugc nofollow" target="_blank"> API教程</a>来开始。获得Spotify API证书后，您需要导入<a class="ae kg" href="https://spotipy.readthedocs.io/en/2.18.0/" rel="noopener ugc nofollow" target="_blank"> Spotipy </a>，然后使用以下代码启动与API的连接:</p><pre class="iz ja jb jc fe mb mc md me aw mf bi"><span id="5419" class="lb lc hj mc b fj mg mh l mi mj">import spotipy<br/>from spotipy.oauth2 import SpotifyClientCredentials<br/>from tqdm import tqdm<br/>from time import sleep<br/>import time<br/>import pandas as pd<br/>import numpy as np</span><span id="225e" class="lb lc hj mc b fj mk mh l mi mj"># Replace Spotify Credentials once you've set up an account</span><span id="71c2" class="lb lc hj mc b fj mk mh l mi mj">client_credentials = SpotifyClientCredentials(client_id = ‘xxxxxxxx’, client_secret = ‘xxxxxxxx’)<br/>sp = spotipy.Spotify(client_credentials_manager = client_credentials)</span></pre><h2 id="be68" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated">第二步。获取Spotify专辑ID</h2><p id="597e" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">下一步是在我们的数据中获取与Spotify专辑相关的唯一ID(Spotify URI)。在某些情况下，Spotify上的每个专辑、艺术家和曲目都由一个URI唯一标识(基本上只是一个唯一标识符)。例如，如果我想听米勒·戴维斯的<em class="kh">，蓝色的</em>，我需要以下链接:</p><p id="7f8e" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated"><em class="kh">h</em><a class="ae kg" href="https://open.spotify.com/embed/album/1weenld61qoidwYuZ1GESA" rel="noopener ugc nofollow" target="_blank"><em class="kh">ttps://open . Spotify . com/embed/album/</em><strong class="jm hk"><em class="kh">1 ween LD 61 qoidwyuz 1 gesa</em></strong></a></p><p id="489c" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">该url的前缀是静态的，用于嵌入相册，但末尾粗体字母数字部分是该相册的URI。那么我们如何获得这些呢？我们首先从数据入手，获得我们希望URI获奖的专辑的唯一列表:</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et ml"><img src="../Images/8d6096d242bd1db361456f48a3c22476.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*9UkAhJahMA_Wr1q2ob5Smg.png"/></div></figure><p id="1b3b" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">以上只是我们希望Spotify嵌入的5位艺术家和专辑的样本。现在我们有了一个独特的专辑列，我们将它转换成一个列表，以便使用Spotipy包搜索专辑URI:</p><pre class="iz ja jb jc fe mb mc md me aw mf bi"><span id="0d39" class="lb lc hj mc b fj mg mh l mi mj">album_list=list(df_wide_art[‘album’])<br/>artist_list=list(df_wide_art[‘artist’])</span></pre><p id="6960" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">给定专辑列表，我们搜索专辑URI，并使用以下代码将它们附加到一个单独的列表中:</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et mm"><img src="../Images/356de7fdda8bcee1375a68d5ecba9bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*9n4tniG5fs03mSYChTb6-w.png"/></div></figure><h2 id="eddc" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated">第三步。创建Spotify嵌入链接并加载到应用程序中</h2><p id="0ec3" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">我们的专辑《URI》出现在上面结果的最后部分(第二个冒号之后)。因此，我们将它们剥离出来，创建一个嵌入链接:</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et mn"><img src="../Images/3be08abcba1fcf933f553296e22e3226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONc_jU_QSa74M2DpdUTI8w.png"/></div></div></figure><p id="dbb9" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">如上所示，<em class="kh"> album_uri_link </em>是我们将Spotify play按钮嵌入应用程序所需的。现在我们的数据框架中已经有了这个，在构建Streamlit应用程序的代码中，我们可以编写一个函数来加载Spotify embed的链接，以便在我们的应用程序中使用:</p><pre class="iz ja jb jc fe mb mc md me aw mf bi"><span id="51ea" class="lb lc hj mc b fj mg mh l mi mj">def load_audio2(url):<br/> if type(url) == str:<br/> try:<br/> audio2=url <br/> components.iframe(album_uri_link , width=600, height=200 )<br/> except:<br/> st.image([‘../img/none.jpeg’])</span></pre><p id="7a05" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">对于推荐的每张专辑，现在都会有一个Spotify播放按钮供您尝试和感受。</p><h2 id="40ee" class="lb lc hj bd ld le lf lg lh li lj lk ll jt lm ln lo jx lp lq lr kb ls lt lu lv bi translated">现代爵士乐发现工具</h2><p id="46a9" class="pw-post-body-paragraph jk jl hj jm b jn lw ik jp jq lx in js jt ly jv jw jx lz jz ka kb ma kd ke kf hc bi translated">最后，这里有一个在Heroku上部署的<a class="ae kg" href="https://pitchfork-metis.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm hk"> jazz发现工具</strong> </a> <strong class="jm hk"> </strong>的链接，供大家欣赏。</p><p id="0783" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">我希望本教程有助于您导航发现工具，以及了解如何将Spotify播放按钮嵌入到您的Streamlit应用程序中。</p><p id="8c61" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated"><strong class="jm hk">免责声明</strong> : <em class="kh">该工具是一项持续进行的工作。将定期编辑/添加特性和功能。任何即时反馈都非常受欢迎！</em></p><p id="318e" class="pw-post-body-paragraph jk jl hj jm b jn jo ik jp jq jr in js jt ju jv jw jx jy jz ka kb kc kd ke kf hc bi translated">更多细节、代码或连接，请访问我的<a class="ae kg" href="https://github.com/chan-chris/Metis_proj5" rel="noopener ugc nofollow" target="_blank"> Github知识库</a>或<a class="ae kg" href="https://www.linkedin.com/in/chrischanlkn/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>页面。</p></div></div>    
</body>
</html>