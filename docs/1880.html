<html>
<head>
<title>Crucial Facts About JavaScript Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于JavaScript引擎的重要事实</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/crucial-facts-about-javascript-engine-7b264c17f36d?source=collection_archive---------8-----------------------#2021-04-11">https://medium.com/nerd-for-tech/crucial-facts-about-javascript-engine-7b264c17f36d?source=collection_archive---------8-----------------------#2021-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="01f5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="81ee" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">JavaScript引擎正在遵循ECMAScript标准。这些标准的工作是给出一个定义，JavaScript引擎应该如何工作。它还说明了它应该具有什么样的特征。<br/>如果泛泛而谈，JavaScript、C等高级语言已经从机器语言中抽象出来了。与C或C++相比，JavaScript是从机器层面抽象出来的。C和C++更接近于硬件，这是它更快的原因。</p><p id="825a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在开始Js引擎之旅之前，我们应该知道Js引擎的确切位置。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/3fef9fca353d002c0a1fc4f016f9c651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNlcf5cQVmdQhGCv3QaAmQ.png"/></div></div></figure><p id="5eb5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">浏览器最重要的两个部分是JavaScript引擎和渲染引擎。</p><p id="24a2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Blink </strong>是一个渲染引擎，负责整个渲染管道，包括DOM树、样式、事件和V8集成。</p><p id="7e9b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">V8是Google开发的Javascript引擎，现在在NodeJs和chrome中使用，关于V8 Js引擎将在本文后面讨论。</p><h1 id="5922" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">编译和解释</h1><p id="bc4b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">编译和解释是编程语言实现的两个原则，它们在某些情况下也是相互关联的。</p><p id="c7e6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果我们谈论JavaScript的范畴，那么从技术上来说，它同时属于解释的和编译的。今天的现代编译器，如<em class="ks"> JavaScript引擎</em>，它们执行运行时发生的<strong class="jf hj">实时(JIT) </strong>编译。</p><h1 id="173f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">准时制</h1><p id="49b2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">jit编译器的伟大之处在于，一旦代码开始运行，它就可以优化它，jit根据JIT实现一次又一次地运行相同的代码，每次输出都可以针对每个用户进行不同的优化。</p><p id="4c20" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">因此，一般来说，每个浏览器和运行时可能都实现了它们的JIT编译器版本，但是理论和结构通常都是相同的。JIT编译器应该遵循相同的结构:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kt"><img src="../Images/bb5a8d7fa09c76be4e3909bd79f221ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*ioYb_2w_fCETqx1cHjAIzQ.png"/></div></figure><ul class=""><li id="8300" class="ku kv hi jf b jg kb jk kc jo kw js kx jw ky ka kz la lb lc bi translated">解释和执行是在低级字节码中完成的，因为它有一个点火解释器。尽管这些低级字节码比机器码更慢、更小，但它们需要的编译时间更少。为了生成未优化的代码<strong class="jf hj">，可以使用全代码编译器</strong>，与其他编译器相比，它运行得更快。涡轮风扇，JIT编译器将编译代码，它还关注代码，如果它在整个JavaScript执行中被多次使用。<br/>其中的对象由<strong class="jf hj">垃圾收集器</strong>观察，包括不再被引用的数据。这种数据的收集由这个收集器完成。在执行垃圾收集周期时，V8引擎会自动停止程序的执行。</li></ul><p id="21dd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">监视器或分析器</strong></p><p id="cfac" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">基本思想是尽可能避免重译。首先，分析器只是通过解释器运行代码。在执行过程中，分析器跟踪运行几次的热代码段和运行多次的热代码段。</p><p id="2867" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">基线编译器</strong></p><p id="2cda" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">JIT将热代码段发送给基线编译器，尽可能重用编译后的代码。</p><p id="108f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">JIT还将热代码段发送给优化编译器。该编译器使用解释器收集的信息来(a)做出假设和(b)基于这些假设进行优化。</p><p id="a4a2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">然而，如果这些假设无效，优化编译器会执行<strong class="jf hj">去优化</strong>，这意味着它会丢弃优化后的代码。</p><h1 id="a92c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">V8 JavaScript引擎</h1><p id="ea15" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><em class="ks">终于，现在我们能够理解什么是V8发动机了，我们走吧……</em></p><p id="692d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><a class="ae ld" href="https://v8.dev" rel="noopener ugc nofollow" target="_blank"> V8 </a>是Google开源的高性能JavaScript和WebAssembly引擎，用C++编写。它被用于Chrome和Node.js等。</p><ul class=""><li id="833a" class="ku kv hi jf b jg kb jk kc jo kw js kx jw ky ka kz la lb lc bi translated">点火将AST翻译成字节码。然后执行字节码序列，并通过内联缓存收集反馈。这种反馈被(a)点火本身用于随后的解释和(b)涡轮风扇发动机用于推测性的优化。</li><li id="7376" class="ku kv hi jf b jg le jk lf jo lg js lh jw li ka kz la lb lc bi translated">基于反馈，涡扇通过将字节码翻译成特定于架构的机器代码来推测性地优化字节码。</li></ul><p id="ac69" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><em class="ks">让我们探索点火和涡轮风扇</em></p><h2 id="2a64" class="lj ig hi bd ih lk ll lm il ln lo lp ip jo lq lr it js ls lt ix jw lu lv jb lw bi translated">点火</h2><ul class=""><li id="eb8f" class="ku kv hi jf b jg jh jk jl jo lx js ly jw lz ka kz la lb lc bi translated">Ignition有助于减少代码长度，提高脚本的执行速度。它将字节码大小减少了25%到50%，为V8编译器打开了新的大门，并帮助低内存Android设备运行更流畅。</li><li id="b93b" class="ku kv hi jf b jg le jk lf jo lg js lh jw li ka kz la lb lc bi translated">无需在编译期间重新解析Javascript。这意味着有了字节码，涡扇的去优化不再需要源代码。</li><li id="eba6" class="ku kv hi jf b jg le jk lf jo lg js lh jw li ka kz la lb lc bi translated">它将每个Chrome标签的内存减少了5%左右，累计起来，尤其是当你运行的设备没有这么大的内存，同时还要处理大量打开的标签时。</li></ul><h2 id="278b" class="lj ig hi bd ih lk ll lm il ln lo lp ip jo lq lr it js ls lt ix jw lu lv jb lw bi translated">涡轮风扇发动机</h2><p id="e762" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">涡扇管道遵循一些步骤将字节码翻译成机器码。基于点火收集的反馈来执行流水线中的优化。</p><ul class=""><li id="d095" class="ku kv hi jf b jg kb jk kc jo kw js kx jw ky ka kz la lb lc bi translated">涡扇发动机的在线JIT式编译和优化完成了V8从源代码到机器码的翻译。</li><li id="613d" class="ku kv hi jf b jg le jk lf jo lg js lh jw li ka kz la lb lc bi translated">涡扇优化了峰值性能、静态类型信息使用、编译器前端、中间和后端的分离以及可测试性。这种高潮的一个关键贡献，叫做一个<strong class="jf hj">海</strong>(或<strong class="jf hj">汤</strong>)的节点。</li></ul><p id="19c1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">有时，我们可能有重复的代码块。JavaScript编译器运行反馈，并为正在执行的代码收集分析数据。如果遇到每次都用相同类型的参数调用并且调用了多次的函数，这个代码会通过涡扇。涡扇发动机产生高度优化的机器级代码，直接在CPU上运行热代码。只有当JS发动机检测到一个热代码时，涡扇发动机才会启动。当一个代码经常运行、在循环中运行等时，它就是热的。编译后的代码有直接的CPU指令，速度相当快。</p><h1 id="2e14" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">JavaScript运行时</h1><p id="cb93" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果我们将JavaScript与其他编程语言进行比较，就会发现它们并不相似。它在运行时是单线程语言。这意味着代码执行完毕，但每次只执行一部分。因为代码是按顺序执行的，所以任何花费更长时间的代码通常会阻塞在那之后需要执行的其他代码的路径。所以有时你会在使用谷歌浏览器时看到下面的屏幕。</p><p id="2f65" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">当你在浏览器上打开任何一个网站时，它都会使用JavaScript，一个单独的执行线程。这个单线程负责处理所有事情，比如滚动网页、在网页上打印内容、监听DOM事件以及做其他事情。</p><p id="154d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">一旦JavaScript停止执行，浏览器将自动停止执行这些操作。这意味着它将简单地停在一个点上，换句话说，停在一个点上，在任务完成之前不会对任何事情做出反应。</p><h1 id="5fd0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><ul class=""><li id="dc9b" class="ku kv hi jf b jg jh jk jl jo lx js ly jw lz ka kz la lb lc bi translated">Node.js是一个基于Chrome的<strong class="jf hj"> JavaScript运行时</strong>构建的平台，用于轻松构建快速、可扩展的网络应用。Node.js使用事件驱动的非阻塞I/O模型，这使得它轻量级且高效，非常适合跨分布式设备运行的数据密集型实时应用程序。</li><li id="b0e3" class="ku kv hi jf b jg le jk lf jo lg js lh jw li ka kz la lb lc bi translated">Node.js包含libuv来处理异步事件。V8为JavaScript提供了运行时</li></ul><p id="f179" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我希望你在这里学到了新东西。</p><p id="56cc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">谢谢你的time☺️</p></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><p id="e614" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果您有任何与JS相关的疑问，请随时联系社交媒体</p><p id="166c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">https://instagram.com/rkstarji?igshid=j6twh39s09n9<a class="ae ld" href="https://instagram.com/rkstarji?igshid=j6twh39s09n9" rel="noopener ugc nofollow" target="_blank"/></p><p id="110b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">【https://twitter.com/RkStarJi T4】</p></div></div>    
</body>
</html>