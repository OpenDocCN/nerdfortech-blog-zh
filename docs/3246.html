<html>
<head>
<title>Running SQL queries on local excel files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对本地 excel 文件运行 SQL 查询</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/running-sql-queries-on-local-excel-files-2233f41dcb4c?source=collection_archive---------7-----------------------#2021-06-03">https://medium.com/nerd-for-tech/running-sql-queries-on-local-excel-files-2233f41dcb4c?source=collection_archive---------7-----------------------#2021-06-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="1d30" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">在工作时，我常常想，是否有一种方法可以从平面文件或本地 excel 文件中创建数据库，并对它们执行查询操作。经过一番探索后，我想出了一个方法，我们可以这样做，并想到记录和分享给任何人寻找同样的东西。</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/ada94d90fcce0909290f0caf5278b433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ae6t2_dir6t0tw_A"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">卡斯帕·卡米尔·鲁宾在<a class="ae jx" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="13dc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">这篇文章的结构如下，我将详细介绍:</p><ol class=""><li id="b3ef" class="ki kj hi il b im in iq ir kf kk kg kl kh km jg kn ko kp kq bi translated">我们将使用的数据</li><li id="247b" class="ki kj hi il b im kr iq ks kf kt kg ku kh kv jg kn ko kp kq bi translated">我们将使用的工具</li><li id="59a1" class="ki kj hi il b im kr iq ks kf kt kg ku kh kv jg kn ko kp kq bi translated">将数据导入数据库的过程</li><li id="af91" class="ki kj hi il b im kr iq ks kf kt kg ku kh kv jg kn ko kp kq bi translated">启动查询控制台</li><li id="366d" class="ki kj hi il b im kr iq ks kf kt kg ku kh kv jg kn ko kp kq bi translated">查询数据库和表</li></ol><h1 id="4b9c" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">关于数据</h1><p id="9804" class="pw-post-body-paragraph ii ij hi il b im lu io ip iq lv is it kf lw iw ix kg lx ja jb kh ly je jf jg hb bi translated">在这里，我使用了亚马逊的评论和销售数据，这些数据是我从以下地方创建的:<br/> <strong class="il hj"> 1。点评数据:</strong> <a class="ae jx" href="https://data.world/datafiniti/amazon-and-best-buy-electronics" rel="noopener ugc nofollow" target="_blank">亚马逊和百思买电子—数据集由 data initi | data . world</a><br/><strong class="il hj">2。销售数据:</strong> <a class="ae jx" href="https://www.mockaroo.com/" rel="noopener ugc nofollow" target="_blank"> Mockaroo —随机数据生成器和 API 模仿工具| JSON / CSV / SQL / Excel </a></p><p id="aa53" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">从这些资源，我能够创建 3 个 excel 平面文件，我将导入到 SSMS 和查询它们。<br/>文件的简要描述:<br/> <strong class="il hj"> 1。ProductIdTable: </strong>有 50 种产品的 ASIN 级别数据。<br/>②<strong class="il hj">。ProductReviews: </strong>有 ASINs 的评论数据以及每个产品评论被查看的时间。<br/> <strong class="il hj"> 3。ProductSales: </strong>有 ASINs 的销售数据。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="ef9f" class="kw kx hi bd ky kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt bi translated">关于工具</h1><p id="8415" class="pw-post-body-paragraph ii ij hi il b im lu io ip iq lv is it kf lw iw ix kg lx ja jb kh ly je jf jg hb bi translated">我在这个练习中使用了 windows 上的<strong class="il hj">SQL Server Management Studio(SSMS)</strong>和<strong class="il hj"> SQL Server 2019 配置</strong>。对于您可以跟随此视频的设置过程，它向您展示了一步一步的设置过程:<a class="ae jx" href="https://www.youtube.com/watch?v=3o2xvWoNBIA&amp;t=368s" rel="noopener ugc nofollow" target="_blank">如何在 Windows 10 中安装和配置 Sql Server 2019</a><em class="ik">——(请喜欢视频并订阅频道)</em></p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="64b7" class="kw kx hi bd ky kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt bi translated">关于将 excel 文件作为表格导入数据库</h1><p id="2edb" class="pw-post-body-paragraph ii ij hi il b im lu io ip iq lv is it kf lw iw ix kg lx ja jb kh ly je jf jg hb bi translated">SSMS 启动并运行后，我们可以继续上传文件，请遵循以下流程:</p><ol class=""><li id="f424" class="ki kj hi il b im in iq ir kf kk kg kl kh km jg kn ko kp kq bi translated">登录<strong class="il hj"> SSMS </strong>并连接到您本地的<strong class="il hj"> SQL 服务器</strong>。</li></ol><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es me"><img src="../Images/5ba7f67333c31926f73304b61171f451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XMe2DnHrLqVW2Hvz1gG_Q.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">我将 SQL server 设置为“SQL EXPRESS 2021 ”,因此将连接到该服务器。</figcaption></figure><p id="e90b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">2.在对象浏览器中，右键点击<strong class="il hj">“Databases”</strong>，选择<strong class="il hj">“新建数据库……”</strong>，将打开<strong class="il hj">新建数据库对话框</strong>，然后命名数据库，点击<strong class="il hj">“确定”</strong>。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mf"><img src="../Images/35649a244ad674e89fbec2a61052c72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GA5zU-FhUct2E_KllB81Ww.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">我已经将这个数据库命名为“AmazonPracticeDB ”,并且没有添加任何文件，我们稍后会添加。</figcaption></figure><p id="7633" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">3.您会注意到数据库已经在对象资源管理器中创建好了。现在，我们将把表添加到数据库中。为此，我们需要右键单击数据库，并转到<strong class="il hj">任务&gt;导入数据</strong>，这将打开<strong class="il hj"> SQL Server 导入</strong>和<strong class="il hj">导出向导</strong>。</p><p id="742a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">在<strong class="il hj">数据源下拉菜单</strong>中，您必须选择<strong class="il hj"> Microsoft Excel </strong>，这将允许您浏览并选择您想要<strong class="il hj">导入</strong>的 Excel 文件。点击下一步。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mg"><img src="../Images/850983d4ddfdc739a628f4396a4fc88b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9gNcwLBZY1p6YbZfMy-Iw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">这基本上就像你的进口来源。</figcaption></figure><p id="26c1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">接下来，您需要选择<strong class="il hj">目标源</strong>，它应该设置为<strong class="il hj">“SQL Server Native Client 11.0”</strong>。点击下一步。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mh"><img src="../Images/95996669cae90d61fa59ca24a4c30b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nXF37KDxfE9JGpktjANWrA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">注意，数据库选择是我之前创建的 AmazonPracticeDB，表明导入的文件将作为这个 DB 中的一个表。</figcaption></figure><p id="8828" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">在<strong class="il hj">导入</strong>三个数据集后，我们可以看到它们在我们创建的<strong class="il hj">Amazon pricedb</strong>下显示为表格。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mi"><img src="../Images/a698279fd1b55837255f2ffe27cf8e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*uU3N6YXBYEK1arfrGDmWCA.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">您也可以右键单击这些表来重命名它们。</figcaption></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="a120" class="kw kx hi bd ky kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt bi translated">关于访问查询控制台。</h1><p id="5ec9" class="pw-post-body-paragraph ii ij hi il b im lu io ip iq lv is it kf lw iw ix kg lx ja jb kh ly je jf jg hb bi translated">完成上述所有步骤后，我们终于可以开始从数据库和表中进行查询了。点击<strong class="il hj">“新查询”</strong>，将打开查询选项卡，您可以从这里开始。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mj"><img src="../Images/d6a5e447538880fd1f19a260a144b78c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTXp4oN9hwsUWvWe9IE9pQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">在结果选项卡中，您可以看到结果或错误(如果有)。</figcaption></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="d2b1" class="kw kx hi bd ky kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt bi translated">让我们做一些示例查询！</h1><p id="7d93" class="pw-post-body-paragraph ii ij hi il b im lu io ip iq lv is it kf lw iw ix kg lx ja jb kh ly je jf jg hb bi translated">我将从拉动产品表的<strong class="il hj">前几行</strong>开始。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mk"><img src="../Images/8dc7ca08545ac4a993a13920db146273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__t_hbo5iSy4ArGhApZjvA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">产品表中似乎有 8 列。</figcaption></figure><p id="53ed" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">让我们来看看表中可用的 asin 的分类计数<strong class="il hj">。</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ml"><img src="../Images/53afcd872b2ed35335aad95ea5f7fbb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QkRy9AfyXDqauEHjU_nWrg.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">似乎只有一个类别(电子产品)有 50 种不同的 ASINs。</figcaption></figure><p id="62c4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">让我们将产品表与销售表连接起来，并查看<strong class="il hj">品牌明智销售</strong>。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mm"><img src="../Images/9a2482344859fe134ebf75711b778fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qbgrx-pMNed6GYCuU-lRYA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">正如我们所见，索尼和权威技术似乎有最大的销量。</figcaption></figure><h1 id="8939" class="kw kx hi bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结束语和资源。</h1><p id="bad4" class="pw-post-body-paragraph ii ij hi il b im lu io ip iq lv is it kf lw iw ix kg lx ja jb kh ly je jf jg hb bi translated">我希望这对于那些试图学习自己查询他们熟悉的数据的人有所帮助，因为我知道在在线 ide 上工作有时感觉就像只是编辑预先编写的查询，几乎没有留给实验的空间。</p><p id="7850" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">我将在下面链接一些非常棒的<strong class="il hj">资源</strong>，在那里你可以学习<strong class="il hj"> SQL，也可以练习在线查询</strong>。</p><p id="3ee7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated"><a class="ae jx" href="https://www.w3schools.com/sql/" rel="noopener ugc nofollow" target="_blank"> SQL 教程(w3schools.com)</a><br/><a class="ae jx" href="https://sqlzoo.net/" rel="noopener ugc nofollow" target="_blank">SQLZOO</a><br/><a class="ae jx" href="https://www.youtube.com/watch?v=qfyynHBFOsM" rel="noopener ugc nofollow" target="_blank">SQL 数据探索— YouTube </a> <em class="ik">(这是我了解导入过程的来源—请喜欢视频并订阅频道，这是一个非常好的地方，有很多好的内容)</em></p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="b04c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kf iv iw ix kg iz ja jb kh jd je jf jg hb bi translated">请继续关注下一部分，我将深入分析一些复杂的查询，并希望从数据中获得一些有趣的东西。</p></div></div>    
</body>
</html>