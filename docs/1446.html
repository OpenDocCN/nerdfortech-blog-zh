<html>
<head>
<title>MS Build — What you need to know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MS Build —您需要了解的内容</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/ms-build-what-you-need-to-know-4e811e00dac6?source=collection_archive---------9-----------------------#2021-03-19">https://medium.com/nerd-for-tech/ms-build-what-you-need-to-know-4e811e00dac6?source=collection_archive---------9-----------------------#2021-03-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aeccb17fa5b4254241fda689d08dbaf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XK51LoFc5IxnFogd"/></div></div></figure><p id="d857" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在现代世界中，应用程序和软件是使用诸如 C#和 Java 之类的高级编程语言编写的，这些语言是人类可以理解的，并且不能由计算机直接执行。</p><p id="34e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了让计算机“执行”这些应用程序，用高级编程语言编写的代码必须转换成一组机器指令。然后，必须对其进行捆绑和部署，以便成功访问应用程序。</p><p id="ba1b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是在实时中，应用程序程序员并不强调或专注于编译和打包部分。相反，他们更关注构建应用程序背后的逻辑。那么，高级代码到机器指令的转换和捆绑是如何处理的呢？</p><p id="9d45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于基于 C#的应用程序，微软提供了一个工具来处理这些活动。它被称为 MSBuild。让我们看看什么是 MSBuild，以及它如何在这个博客中有用。</p><p id="f249" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目录</strong></p><ol class=""><li id="7e1c" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">什么是 MSBuild？</li><li id="8de6" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">什么项目文件包含？</li><li id="da25" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">项目文件中的节</li><li id="3f68" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">结论</li></ol><h1 id="57d8" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是 MSBuild？</h1><p id="df9e" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">直接来自于。在. Net 2.0 中，微软提供了构建引擎工具 MSBuild。MSBuild 是一个构建平台工具，有助于自动化创建软件产品的过程，包括编译源代码、打包、测试和部署源代码。</p><p id="de44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">MSBuild 是随 Visual Studio IDE 安装程序一起提供的独立工具。也可以单独安装。从技术上讲，它不依赖于 Visual Studio，可以在不包含 Visual Studio 的计算机上运行。它只需要 csproj、vbproj、vcproj、vjsproj、proj 和。可以作为输入传递给 MSBuild 以处理代码的目标。MSBuild 可用于生成。基于. Net Framework 的应用程序和。基于. Net 核心的应用程序。</p><h1 id="e7d3" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">项目文件包含什么？</h1><p id="53aa" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">在本节中，让我们以 csproj 文件为例，详细了解它包含的内容以及如何在基于 C#的项目中使用它。</p><p id="949f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑一个基于三层架构的应用程序，其中表示层、业务层和数据库层是完整解决方案中包含的三个不同的项目。当用户创建这样的解决方案时，MSBuild 会查找 csproj 文件或项目文件来生成项目。这样，单个项目将由 MSBuild 生成。</p><p id="fff2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">项目文件是基于 XML 的文件，包含以下信息。</p><p id="882e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑解决方案中的一个业务层项目。现在，代码中的操作可以处理基于 JSON 的对象和文件、电子表格、处理 pdf 等等。并非所有这些功能都带有预定义的。Net 程序集和引用。其中一些必须在外部引用，并在代码内部使用。在编译期间，编译器必须利用它们来完成编译过程。</p><p id="b9df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，项目中引用的包的信息是在项目文件中定义的。</p><p id="9076" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑另一种情况。解决方案中的项目之间存在内部引用，例如，表示层与业务层交互，业务层与数据库层交互。现在需要在项目文件中跟踪的解决方案之间有引用。</p><p id="c75a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除此之外，它还包括。Net，项目必须以 32 位还是 64 位模式编译，以及项目内部需要引用的类文件列表。所有这些数据都将在项目文件中提及。</p><h1 id="9ee9" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">项目文件中的节</h1><p id="4b4d" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">让我们看看项目文件中可用的不同部分。</p><h2 id="9cb3" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">属性组</h2><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="37f8" class="lf kd hi ly b fi mc md l me mf">&lt;PropertyGroup&gt; &lt;Configuration Condition=" '$(Configuration)' == '' "&gt;Debug&lt;/Configuration&gt; &lt;Platform Condition=" '$(Platform)' == '' "&gt;AnyCPU&lt;/Platform&gt; &lt;ProjectGuid&gt;{BC644873-5471-4675-AD4C-E40D91DC7463}&lt;/ProjectGuid&gt; &lt;OutputType&gt;WinExe&lt;/OutputType&gt; &lt;RootNamespace&gt;WindowsFormsApp1&lt;/RootNamespace&gt; &lt;AssemblyName&gt;WindowsFormsApp1&lt;/AssemblyName&gt; &lt;TargetFrameworkVersion&gt;v4.7.2&lt;/TargetFrameworkVersion&gt; &lt;FileAlignment&gt;512&lt;/FileAlignment&gt; &lt;AutoGenerateBindingRedirects&gt;true&lt;/AutoGenerateBindingRedirects&gt; &lt;Deterministic&gt;true&lt;/Deterministic&gt; &lt;/PropertyGroup&gt;</span></pre><p id="b29f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">属性组部分包含配置的类型、使用此配置时要生成的输出的类型、的框架。Net，它将用于构建项目、文件对齐细节等。此外，一个项目文件中可以引用多个 propertygroup。</p><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="ba7a" class="lf kd hi ly b fi mc md l me mf">&lt;ItemGroup&gt; &lt;Compile Include="Form1.cs"&gt; &lt;SubType&gt;Form&lt;/SubType&gt; &lt;/Compile&gt; &lt;Compile Include="Form1.Designer.cs"&gt; &lt;DependentUpon&gt;Form1.cs&lt;/DependentUpon&gt; &lt;/Compile&gt; &lt;Compile Include="Program.cs" /&gt; &lt;Compile Include="Properties\AssemblyInfo.cs" /&gt; &lt;/ItemGroup&gt;</span></pre><p id="ccae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与属性组类似，项目文件中也可以有多个项组。“Compile Include”中提到的项目中的文件将由 MSBuild 编译，并生成打包的输出。类似地，项组还保存项目内部引用的程序集引用。</p><h2 id="bde6" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">情况</h2><p id="6aed" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">条件可以作为属性包含在内，以便在运行时为属性设置值。这里，在上面的例子中，在属性组部分中，configuration 有一个名为 Condition 的属性，它有一个在运行时验证配置值的检查。</p><h2 id="0420" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">自定义任务</h2><p id="b0f8" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">与程序集类似，文件引用、关于要使用的框架版本的详细信息、配置、自定义任务也可以添加到项目文件中。这些属于自定义任务的范畴。</p><h2 id="c9f6" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">属性函数</h2><p id="99ae" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">MSBuild 4.0 版提供了某些内置的常见函数，而不是为许多常见操作编写自定义任务。例如，打印日期时间，这可以通过</p><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="4907" class="lf kd hi ly b fi mc md l me mf">$([System.DateTime]::Now). $([])</span></pre><p id="0432" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述内容表明，内部编写的内容是系统内置的属性，不需要寻找任何自定义任务。</p><h1 id="caf2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论</h1><p id="b6ca" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">MSBuild 生成和打包。基于网络的应用程序更流畅，更容易，更省事。MSBuild 可以在命令提示符下单独调用，也可以在云服务器中的 CI/CD 管道中调用。</p></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><p id="8d7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="mn">原载于</em><a class="ae mo" href="https://www.partech.nl/nl/publicaties/2021/03/ms-build---what-you-need-to-know" rel="noopener ugc nofollow" target="_blank"><em class="mn">https://www . partech . nl</em></a><em class="mn">。</em></p></div></div>    
</body>
</html>