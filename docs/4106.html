<html>
<head>
<title>Send Emails Direct from JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">直接从 JavaScript 发送电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/send-emails-direct-from-javascript-b58966154681?source=collection_archive---------10-----------------------#2021-07-07">https://medium.com/nerd-for-tech/send-emails-direct-from-javascript-b58966154681?source=collection_archive---------10-----------------------#2021-07-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0cabec64792a2e5bb72287c25aaab507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjCDir56CXqcHadiLksopQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@ecees" rel="noopener ugc nofollow" target="_blank">埃里卡·斯蒂维斯</a>通过<a class="ae iu" href="https://unsplash.com/photos/G_lwAp0TF38" rel="noopener ugc nofollow" target="_blank">unsplash.com</a>拍摄</figcaption></figure><h1 id="4830" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">更新 6.30.22</h1><p id="989d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">别忘了测试东西！花了一些时间在我的投资组合网站上刷新我的一些反应技能，结果遇到了一个奇怪的问题。当我尝试使用我在下面设置的 EmailJS 服务发送电子邮件时，我得到了以下错误:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5828" class="la iw hi kw b fi lb lc l ld le">Gmail_API: Invalid grant. Please reconnect your Gmail account</span></pre><p id="4312" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">在快速搜索之后，我意识到 Gmail API 会自动停止任何超过 6 个月没有使用的连接。是的——不幸的是，至少 6 个月没有人给我发电子邮件，老实说，可能从来没有。</p><p id="65b4" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">不用担心——我所要做的就是登录我的 EmailJS 帐户，断开电子邮件服务，然后重新连接。祝你好运，我希望你比我收到更多的电子邮件！</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="7736" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">在之前的<a class="ae iu" rel="noopener" href="/nerd-for-tech/implementing-action-mailer-ruby-on-rails-1766f59c6f">帖子</a>中，我写了如何从 web 应用程序中获得电子邮件，以及如何在 Ruby 中使用 Action Mailer 来实现这一点。但是，如果您没有开发一个全栈的 web 应用程序，并且没有后端来处理这个问题，该怎么办呢？</p><p id="f1e8" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">当我在一个用 JavaScript 和 React 构建的投资组合网站上工作时，遇到了同样的场景。我需要一种方法来处理联系表单，以便在访问者提交联系表单后，它会给我发送电子邮件。</p><p id="100a" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">在这篇文章中，我将向你展示我是如何使用一种叫做 EmailJS 的服务来完成这个任务的。它非常容易设置，在写作时，每月可以免费发送 200 封邮件(对于一个作品集网站来说绰绰有余)。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h1 id="6bd8" class="iv iw hi bd ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo lv jq jr js bi translated">设置电子邮件</h1><p id="5c66" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">你需要做的第一件事是在<a class="ae iu" href="https://www.emailjs.com/" rel="noopener ugc nofollow" target="_blank"> EmailJS </a>上创建一个账户。完成并登录后，您需要设置您的电子邮件服务。点击菜单顶部的<code class="du lw lx ly kw b">Email Service</code>。然后点击<code class="du lw lx ly kw b">+ Add New Service</code>并选择您喜欢的电子邮件提供商。</p><p id="c30d" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">不要忘记记下每天的电子邮件限额。我选择了 Gmail，它有每天 500 封邮件的限制，所以没问题。</p><p id="7d4a" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">接下来点击<code class="du lw lx ly kw b">Connect Account</code>按钮用你的邮箱登录。此时，弹出窗口应该会显示您已连接到您选择的电子邮件地址，并有一个断开连接的选项。点击<code class="du lw lx ly kw b">Create Service</code>按钮继续。如果一切正常，你应该会在收件箱里收到一封测试邮件，而且这项服务应该会列在你的<code class="du lw lx ly kw b">Email Services</code>页面上。</p><p id="04c4" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">我们一会儿会回到你的 EmailJS 账户，但在此之前，让我们跳到我们的节目。</p><h1 id="ca7a" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">在项目中实施 EmailJS</h1><p id="4f90" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">这部分其实很简单。您所需要做的就是用包含正确键和值的对象对 EmailJS 端点进行 API 调用。</p><p id="b673" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">下面是我在发送 API 调用时使用的 post 对象。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/4f4460c4b12acc64f1e840e65751f38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*8QbBf_HQw07VgYQf6I8FsQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">用 id 和表单变量发布正文对象</figcaption></figure><p id="d4c9" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated"><code class="du lw lx ly kw b">service_id</code>、<code class="du lw lx ly kw b">template_id</code>、<code class="du lw lx ly kw b">user_id</code>都是 EmailJS 提供的。<code class="du lw lx ly kw b">template_params</code>键用于发送您想要在电子邮件模板中访问的表单信息。我输入了发件人的名字，他们的电子邮件，这样我就可以回复，主题行和正文。</p><p id="84fa" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi ma translated">重要提示:别忘了要他们的电子邮件地址，否则你将无法回复他们。EmailJS 从你的电子邮件地址给你自己发送一封电子邮件，所以没有用户的输入，你将不得不尝试谷歌他们的名字，并找到另一种联系方式。</p><p id="0458" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">发送调用的端点在下面。这可能会改变，但可以很容易地在他们的网站上的<a class="ae iu" href="https://www.emailjs.com/docs/rest-api/send/" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="7018" class="la iw hi kw b fi lb lc l ld le">POST https://api.emailjs.com/api/v1.0/email/send</span></pre><p id="614f" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">到现在为止，除了一个<code class="du lw lx ly kw b">template_id</code>，你应该已经拥有了你需要的一切。我这样做是为了让您在 EmailJS 中创建电子邮件模板之前知道您将从表单中收集哪些变量。</p><h1 id="2dbd" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">使用变量创建电子邮件模板</h1><p id="0265" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在 EmailJs 中，转到<code class="du lw lx ly kw b">Email Template</code>选项卡并点击<code class="du lw lx ly kw b">Create New Template</code>。一旦出现，您将可以选择自定义将要发送的电子邮件的主题行和正文。关于如何访问在<code class="du lw lx ly kw b">template_params</code>下 API 调用中传递的变量，请参见关于在模板中使用<a class="ae iu" href="https://www.emailjs.com/docs/user-guide/dynamic-variables-templates/" rel="noopener ugc nofollow" target="_blank">动态变量的文章。</a></p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/050fef9b43091d6e428ef30f8b532cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytLP15eGxoOrQEJJokmDtA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用名称、主题、正文和电子邮件变量的我的模板的屏幕截图</figcaption></figure><p id="772f" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">编辑完模板后，只需点击保存即可。此时，您将可以访问 API 调用所需的所有不同 id，包括<code class="du lw lx ly kw b">template_id</code>。如何在程序中存储这些变量取决于你自己。我创建了一个<code class="du lw lx ly kw b">.env</code>文件并将我的保存在那里。可能有更好的方法，如果你知道，请在下面的评论中告诉我！</p><p id="7860" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated"><code class="du lw lx ly kw b">user_id</code>:点击左侧的集成，在 API keys 下查看</p><p id="b5e2" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated"><code class="du lw lx ly kw b">template_id</code>:列在电子邮件模板中您新创建的模板下</p><p id="866d" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated"><code class="du lw lx ly kw b">service_id</code>:列在电子邮件服务中您新链接的电子邮件服务下</p><p id="def5" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">现在您已经在 POST 对象中拥有了所有需要的 id 和变量，您已经准备好测试您的新电子邮件服务了！</p><p id="fa9e" class="pw-post-body-paragraph jt ju hi jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq hb bi translated">注意:EmailJS 也有一个 SDK，可以使用 NPM 或鲍尔安装。这允许您用样板函数替换 API 调用，将您的 id 作为参数传递。我使用他们的 API，因为它似乎对我的小项目来说也很容易，但也可以在这里查看他们的文档。</p></div></div>    
</body>
</html>