<html>
<head>
<title>Developing a Live Video Streaming Application using Socket Programming with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 套接字编程开发实时视频流应用程序</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/developing-a-live-video-streaming-application-using-socket-programming-with-python-6bc24e522f19?source=collection_archive---------0-----------------------#2021-06-14">https://medium.com/nerd-for-tech/developing-a-live-video-streaming-application-using-socket-programming-with-python-6bc24e522f19?source=collection_archive---------0-----------------------#2021-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/34d3538e429cb72ff290532c21801412.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6hryHuSMuArV-gIJy3njA.jpeg"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">upklyak 创建的业务向量</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h2 id="e037" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">简介:</h2><p id="10b9" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">今天，只要有足够快的互联网连接，任何人都可以通过互联网观看高清电影或打视频电话。这之所以成为可能，是因为一种叫做<strong class="kc hj"> <em class="kv">流</em> </strong>的技术。</p><p id="40e1" class="pw-post-body-paragraph ka kb hi kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hb bi translated">流式传输是从服务器到客户端的音频或视频文件的连续传输。简单来说，流媒体就是消费者在联网设备上看电视或听播客的过程。通过流式传输，在客户端设备上播放的媒体文件被远程存储，并通过互联网一次传输几秒钟。</p><p id="35a2" class="pw-post-body-paragraph ka kb hi kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hb bi translated">在当前场景中，由于疫情，视频流变得更加流行，以便社交、俯瞰、连接、学习等等。</p><h2 id="6af7" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">目标:</h2><p id="5426" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">使用 python 的套接字编程构建一个没有音频的实时视频流应用程序。</p><h2 id="270a" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">什么是套接字编程？</h2><p id="bac0" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">套接字和套接字 API 用于通过网络发送消息。它们提供了一种<a class="ae lb" href="https://en.wikipedia.org/wiki/Inter-process_communication" rel="noopener ugc nofollow" target="_blank">形式的进程间通信(IPC) </a>。该网络可以是计算机的逻辑本地网络，也可以是物理连接到外部网络的网络，它自己连接到其他网络。最常见的例子是互联网。</p><p id="1fbb" class="pw-post-body-paragraph ka kb hi kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hb bi translated">最常见的套接字应用程序类型是客户端-服务器应用程序，其中一方充当服务器并等待来自客户端的连接，这就是我们将要构建的直播视频流应用程序的类型。</p><h2 id="d6a5" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">什么类型的插座适合我们的目标？</h2><p id="8cbc" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">最合适的套接字类型是作为传输控制协议(TCP)的<strong class="kc hj"> TCP 套接字</strong>:</p><ul class=""><li id="41d9" class="lc ld hi kc b kd kw kh kx jn le jr lf jv lg ku lh li lj lk bi translated"><strong class="kc hj">可靠:</strong>网络中丢弃的数据包被发送方检测并重新发送。</li><li id="d5c2" class="lc ld hi kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk bi translated"><strong class="kc hj">具有有序的数据传递:</strong>应用程序按照发送方写入的顺序读取数据。</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es lq"><img src="../Images/e92e0e4026ee445ceba2ba3894bdf0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FSwphdtNC5THBGoL.jpg"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">TCP 套接字流</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><blockquote class="lr"><p id="6935" class="ls lt hi bd lu lv lw lx ly lz ma ku dx translated">让我们开始构建实时视频流应用程序</p></blockquote><h2 id="9942" class="jc jd hi bd je jf mb jh ji jj mc jl jm jn md jp jq jr me jt ju jv mf jx jy jz bi translated">必需品</h2><ul class=""><li id="28bb" class="lc ld hi kc b kd ke kh ki jn mg jr mh jv mi ku lh li lj lk bi translated">IDE : Jupyter 笔记本</li><li id="d53c" class="lc ld hi kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk bi translated">语言:Python</li></ul><p id="307f" class="pw-post-body-paragraph ka kb hi kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hb bi translated">按照 TCP 流，我们需要两个不同的文件，一个用于客户端，另一个用于服务器。所以这两者都需要一些基本的设置，除非特别说明，否则没有什么不同。</p><h2 id="3584" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">步骤 1:在两个文件中安装并导入以下库</strong></h2><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mj"><img src="../Images/68c635a3b4effb96f90ceb4d99fda390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*ONnwTa2yMB1pi4xV9FdZkQ.png"/></div></figure><p id="2d80" class="pw-post-body-paragraph ka kb hi kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hb bi translated">您可能需要专门安装 opencv-python 和 imutils，以便导入它们。</p><ul class=""><li id="0847" class="lc ld hi kc b kd kw kh kx jn le jr lf jv lg ku lh li lj lk bi translated">socket:从 python <br/> cv2 获取 socket 模块:从 python <br/> pickle 导入计算机视觉模块:用于序列化和反序列化 python 对象结构。<br/> struct:将原生 Python 数据类型(如字符串和数字)转换为字节字符串，反之亦然<br/> imutils:图像处理操作</li></ul><h2 id="8e7d" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">第二步:创建套接字</strong></h2><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mk"><img src="../Images/06588260281a2473532dbed113f129c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*Vbjg2DDPTYMqFUW2zjc8Xg.png"/></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">创建客户端套接字</figcaption></figure><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es ml"><img src="../Images/9d72829067d74ea85aa43b4d14e9f444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxVKiX48IHsX7zSC2N9wMw.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">创建服务器端套接字</figcaption></figure><h2 id="e71a" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">第三步:流式视频</strong></h2><p id="513f" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">在<strong class="kc hj">服务器</strong>端，我们使用<code class="du mm mn mo mp b">accept()</code>，因为它<a class="ae lb" href="https://realpython.com/python-sockets/#blocking-calls" rel="noopener ugc nofollow" target="_blank">阻塞</a>并等待传入的连接。当客户端连接时，它返回一个表示连接的新套接字对象和一个保存客户端地址的元组。元组将包含用于 IPv4 连接的<code class="du mm mn mo mp b">(host, port)</code>或用于 IPv6 的<code class="du mm mn mo mp b">(host, port, flowinfo, scopeid)</code>。然后，我们必须将帧序列化为字节，打包序列化的数据并发送这些数据，打印错误消息以防出错，最后显示视频帧。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mq"><img src="../Images/5b706dcbcec990fc47ef93774786496a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*1GXESzbCIggV7tow2VKUbg.png"/></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">服务器接受客户端的请求</figcaption></figure><p id="be1a" class="pw-post-body-paragraph ka kb hi kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hb bi translated"><strong class="kc hj">客户端</strong>创建一个 socket 对象，连接到服务器并调用<code class="du mm mn mo mp b">s.recv()</code>读取服务器的回复。在客户端，我们接收视频流的数据帧，但以数据包的形式，我们必须对其进行解包和解串，然后显示实际的视频帧。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es mr"><img src="../Images/a0f6731296b095d83906d80096dc6f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*DGAvMDS8H8cAAmVtHEyEMA.png"/></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">客户端</figcaption></figure><h2 id="d4c3" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结果:</h2><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es ms"><img src="../Images/5d357fef8d73c430e4bdbb59edd2391b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HX4_ZRZVRgSwzd3kd-CpSg.jpeg"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">视频流截图</figcaption></figure><h2 id="f7f9" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论:</h2><p id="7f65" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hb bi translated">因此，通过这种方式，我们可以创建一个没有音频的实时视频流应用程序，该应用程序可以用于监控等目的，或者可以用于无干扰的群体学习等。</p><h2 id="03c2" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">供参考:</h2><blockquote class="mt mu mv"><p id="9946" class="ka kb kv kc b kd kw kf kg kh kx kj kk mw ky km kn mx kz kp kq my la ks kt ku hb bi translated"><strong class="kc hj"> GitHub 资源库链接:</strong><a class="ae lb" href="https://github.com/AmimaShifa/Live-Video-Streaming-Application" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/AmimaShifa/Live-Video-Streaming-Application</a></p></blockquote></div></div>    
</body>
</html>