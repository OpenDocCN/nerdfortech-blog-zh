<html>
<head>
<title>Design Patterns in Django 1.2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django 1.2中的设计模式</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/design-patterns-in-django-1-2-c57c6e1d23c8?source=collection_archive---------2-----------------------#2019-04-09">https://medium.com/nerd-for-tech/design-patterns-in-django-1-2-c57c6e1d23c8?source=collection_archive---------2-----------------------#2019-04-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7565c0db8169af9873dcdcaf9254886b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C5Zrv6rzXfJB8md-"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@lanceanderson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">兰斯·安德森</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="75ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上一篇文章(<a class="ae iu" rel="noopener" href="/@sawanrai777/design-patterns-in-django-1-1-b74fc38a877b">第1.1部分</a>)中，我已经给你介绍了Django设计模式(DDPs)。我们还讨论了一些设计模式。在这里，我们将继续我们的DDPs之旅。我们已经完成了<strong class="ix hj">模型</strong>部分下的<strong class="ix hj">结构设计模式</strong>。现在是讨论更多DDP的时候了。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/0e7ce695e4aeb763e86d7ec6f8e28fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*N8AXFSS9WjiHF7ZhAi19EA.png"/></div></figure><p id="b948" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1.2检索模式:</strong>在结构化设计模式下，我们开始了解models.py中可能发生的各种类型的类间和类内结构。在创建模型之后，我们需要访问/检索我们的模型的属性和方法。检索模式下有两个DDP，如下所示:</p><p id="e862" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1.2.1属性字段:</strong>如果你学过DBMS课程，你会知道我们不在表中存储派生属性。我们使用基本属性在运行时计算派生属性。<strong class="ix hj">例子</strong>:我们存储用户的“出生日期”，可以计算任意时间点的“年龄”。Django模特也是如此。我们可以在User类内部创建实例级<strong class="ix hj"> get_age() </strong>方法，提取用户的DOB，计算后返回年龄。写<strong class="ix hj"> user.get_age() </strong>正确但不pythonic化。我想访问<strong class="ix hj">年龄</strong>作为一个属性。我能做的就是把<strong class="ix hj"> "@Property" </strong> decorator放在<strong class="ix hj"> get_age() </strong>方法之前。现在，我可以写<strong class="ix hj"> user.age. </strong></p><p id="6e44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1.2.2自定义模型管理器CMM: </strong>查询的两个基本问题:I)提取数据的复杂和嵌套查询，ii)某些查询在整个代码中被重复调用，这也违反了<strong class="ix hj"> DRY </strong>原则。我们可以为每个条件创建多个方法来提取数据，并按照所需的顺序调用这些方法来过滤有用的数据。<strong class="ix hj">举例</strong> : <strong class="ix hj">用户。Objects.all()。过滤器(user_type='prime ')。过滤器(状态= '活动')</strong>。这里，我们使用Django的内置功能来过滤数据。首先，我们提取所有的用户对象。接下来，我们过滤prime用户，然后过滤活跃用户。我们不再编写单一的条件语句，而是逐个调用filter方法。通过定义多个数据访问方法，并在每个方法中使用单个条件，可以为我们的自定义模型类实现相同的设置。</p><p id="cb63" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。表单:</strong>需要表单来从用户那里收集数据。在Django中，我们将所有表单存储在<strong class="ix hj"> forms.py </strong>文件中。我们可以有基于函数或基于类的表单(更多细节参见Django文档)。我们在表单级别有以下DDP。</p><p id="415c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2.1动态表单生成:</strong>在创建表单时，我们希望在表单中添加/删除一些字段。我们可以有一个表单初始化方法，它接受要添加到表单中的有效表单字段的列表。<strong class="ix hj">举例:</strong>网购中的支付选项。我们要求用户货到付款(COD)和在线支付。如果用户选择货到付款，我们将不会在下一页提供在线支付详情字段。这是一个很基本的例子。可以分享更多与此模式相关的有意义的复杂例子。</p><p id="1d76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2.2基于用户的表单:</strong>所有基于Web的应用程序都以不同的方式处理多种类型的用户。每个用户都有不同级别的访问权限和附加设施。根据用户类型，我们可以在将表单发送给用户之前添加/删除表单字段。<strong class="ix hj">举例:</strong>某航空公司向其prime客户提供“添加特别午餐”选项，而普通客户没有此选项。</p><p id="7152" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2.3每个视图多个表单动作:</strong>如何在单个视图中处理多个表单动作？当多个表单动作被映射到一个URL时，我们如何以不同的方式对待每个动作？<strong class="ix hj">阶级基础观点</strong>就是答案。通过扩展通用的<strong class="ix hj"> TemplateView </strong>创建一个视图类，它将提供默认的<strong class="ix hj"> get </strong>和<strong class="ix hj"> post </strong>方法。我们可以将表单动作标识符作为参数传递给<strong class="ix hj">请求</strong>。在视图端，我们可以检查用户执行了哪个操作，并进一步采取相应的步骤来生成响应。</p><p id="2933" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2.4 CRUD视图:</strong>在web应用中，我们总是执行CRUD操作。<strong class="ix hj"> C </strong>:创建信息，<strong class="ix hj"> R </strong>:读取信息，<strong class="ix hj"> U </strong>:更新信息，<strong class="ix hj"> D </strong>:删除信息。作为一名web开发者，你需要为用户提供<strong class="ix hj"> CRUD </strong>工具。我们也可以在这里使用基于类的视图概念，而不是为每个操作创建单独的URL。对于每组相关信息(在单个页面上创建或者与一个模型相关)，通过扩展generic <strong class="ix hj"> TemplateView </strong>创建一个视图类。借助表单动作标识符(来自请求对象中的用户方)对视图类的<strong class="ix hj"> post/get </strong>方法中的数据执行<strong class="ix hj"> C/R/U/D </strong>操作。</p><p id="8dcf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是这篇文章的内容。我们已经完成<strong class="ix hj">型号</strong>和<strong class="ix hj">表格</strong> DDPs。我们现在只剩下<strong class="ix hj">视图</strong>和<strong class="ix hj">模板</strong> DDPs。我知道看文字和只看文字很无聊。这就是为什么我只提供每个DDP很少的细节。更多详细信息，请参考A. Ravindran的<a class="ae iu" href="https://doc.lagout.org/programmation/Django/Django%20Design%20Patterns%20and%20Best%20Practices%20%5BRavindran%202015-03-26%5D.pdf" rel="noopener ugc nofollow" target="_blank">实际书籍</a>，其中也包含示例。感谢你阅读这篇文章。我希望在这个系列的下一篇文章中见到你。<a class="ae iu" rel="noopener" href="/@sawanrai777/design-patterns-in-django-1-3-4b0b8324e5f">https://medium . com/@ sawan rai 777/design-patterns-in-django-1-3-4 b0b 8324 e5f</a></p><p id="7e85" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">访问下面的工作实例链接:【https://github.com/DjangoPatternsBook/superbook<a class="ae iu" href="https://github.com/DjangoPatternsBook/superbook" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8dd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">【代码作者:阿伦·拉文德兰(GitHub id: arocks)】</p></div></div>    
</body>
</html>