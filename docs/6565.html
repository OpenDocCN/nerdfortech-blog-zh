<html>
<head>
<title>Initializing a Firewall on an Ubuntu Cloud Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu云服务器上初始化防火墙</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/initializing-a-firewall-on-an-ubuntu-cloud-server-7e0d2c88f0be?source=collection_archive---------0-----------------------#2022-03-24">https://medium.com/nerd-for-tech/initializing-a-firewall-on-an-ubuntu-cloud-server-7e0d2c88f0be?source=collection_archive---------0-----------------------#2022-03-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6ba445122b3e2139795d3994b7345314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uSEevqXVvrwVFa5njP05pA.jpeg"/></div></div></figure><h2 id="9a6b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">TLDR: 在本指南中，我将给出保护服务器的基本说明和解释。</h2><p id="260d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">👉<strong class="jq hj">我不是网络安全专家👈</strong></p><p id="44bb" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">让我们陷入…</p><p id="90bc" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">当您启动远程实例时，防火墙被禁用，所有内容都是打开的，因为它们假设您需要打开所有内容来进行初始设置，这种设置如下所示。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/44221d0a7614d644c025f3e9100bf515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uz9_m2rT1nE2P_RSA6fJKQ.jpeg"/></div></div></figure><p id="a9a9" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">你可以想象这是你能拥有的最不安全的设置，这种设置完全依赖于你的密码的强度，如果它不是一个强密码，它可能容易受到暴力攻击和许多其他类型的利用。</p><p id="10e2" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj">旁注/兴趣点:</strong></p><p id="b2fd" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">你可以在谷歌上搜索“暴力计算器”，找到一个网站，让你知道你的密码有多强，以及破解密码需要多长时间。如果有人试图用暴力攻击你的登录，看看这个网站</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/73974a4f3a0d26f18ea0cd3996c909d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YTCvFN_u44xJUonimABFg.png"/></div></div></figure><p id="bcb9" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj">强密码是确保服务器安全不可或缺的第一步。</strong>有很多网站可以帮助你设置一个强随机密码，这是我通过另一个谷歌搜索找到的一个。像下面这样的密码需要非常长的时间才能被暴力攻击。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/ad2f35cadbc5e072bb3e8fc5cb5d0642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P4vhQETo8bYN34Gmea3_DA.png"/></div></div></figure></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><p id="a22c" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">为了建立防火墙，我们将使用一个非常简洁的包，叫做<a class="ae kt" href="https://help.ubuntu.com/community/UFW" rel="noopener ugc nofollow" target="_blank">简单防火墙</a> (UFW)。UFW应该默认安装在Ubuntu服务器上。如果不是因为某种原因，可以用。</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="39e5" class="iq ir hi le b fi li lj l lk ll">sudo apt install ufw</span></pre><p id="aa79" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在那里，我们将需要阻止所有打开的端口，并为我们想要打开的端口创建例外，如<strong class="jq hj">端口22 </strong>用于<strong class="jq hj"> SSH等。<br/> </strong>对我来说，我打开了端口22和端口8080，因为我需要访问我的服务器，并且我还需要访问在端口8080上运行的应用程序。</p><p id="0d52" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">首先，我们配置UFW，然后打开它。我们这样做是为了避免被拒之门外。这听起来很明显，我知道，但相信我，你只需要一次被锁在门外的头痛就知道这是初始化防火墙的黄金法则。</p><p id="5e9e" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">因此，我将首先通过键入以下命令来关闭所有端口</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="09ef" class="iq ir hi le b fi li lj l lk ll">sudo ufw default deny incoming</span></pre><p id="72fc" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">接下来，让我们添加<strong class="jq hj"> SSH </strong>或<strong class="jq hj">端口22 </strong></p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="7ef6" class="iq ir hi le b fi li lj l lk ll">sudo ufw allow ssh</span></pre><p id="fe20" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">或者</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="759c" class="iq ir hi le b fi li lj l lk ll">sudo ufw allow 22</span></pre><p id="9fc8" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">接下来，我想添加将在端口8080上运行的应用程序，您可以用同样的方式添加您的应用程序。</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="22f2" class="iq ir hi le b fi li lj l lk ll">sudo ufw allow 8080</span></pre><p id="cdf7" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">我想你明白了。</p><p id="494e" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">接下来，我们需要通过键入以下命令来激活UFW</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="c6ea" class="iq ir hi le b fi li lj l lk ll">sudo ufw enable</span></pre><p id="74d7" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">祈祷你仍然能够进入你的服务器🤞</p><p id="dc88" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在任何时候，您都可以通过键入以下命令来查看防火墙的状态</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="19bb" class="iq ir hi le b fi li lj l lk ll">sudo ufw status verbose</span></pre><p id="ca59" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">如果UFW关闭了，您将会收到如下消息</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="37e3" class="iq ir hi le b fi li lj l lk ll">Output</span><span id="6576" class="iq ir hi le b fi lm lj l lk ll">Status: inactive</span></pre><p id="4e11" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">应该有用吗</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="6986" class="iq ir hi le b fi li lj l lk ll">Output</span><span id="af99" class="iq ir hi le b fi lm lj l lk ll">Status: active<br/>Logging: on (low)<br/>Default: deny (incoming), allow (outgoing), disabled (routed)<br/>New profiles: skip<br/><br/>To                         Action      From<br/>--                         ------      ----<br/>22/tcp                     ALLOW IN    Anywhere<br/>8080/tcp                   ALLOW IN    Anywhere</span></pre><p id="c357" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">检查防火墙是否正常工作的一个好方法是测试它。</p><h1 id="11bc" class="ln ir hi bd is lo lp lq iw lr ls lt ja lu lv lw je lx ly lz ji ma mb mc jm md bi translated"><strong class="ak">测试您的防火墙</strong></h1><p id="e893" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">在写这篇文章的时候<a class="ae kt" href="https://networkappers.com/tools/open-port-checker" rel="noopener ugc nofollow" target="_blank"> NetWorkAppers </a>有一个有用的工具来做这件事。你只需弹出你的IP地址和你想检查的端口。正如你所看到的，端口22是打开的，这意味着我可以SSH到我的远程服务器！🎉</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es me"><img src="../Images/811ffa9de8e2b140d95d48bd9da6772e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*mCxGAuLLoPpx12ujZafMvw.png"/></div></figure><p id="2fb6" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">然后挑另一个不该开的端口测试，我用的是8085，被封了。如果你对此感兴趣，并且你想了解更多<a class="ae kt" href="https://www.google.com/search?q=Penetration+test+ports&amp;sxsrf=APq-WBsAdKZLi0tbiB_3weReZ93oODD4cw%3A1648111197184&amp;ei=XS48YoTyCuKEhbIPqd6SqAI&amp;ved=0ahUKEwjElNXTrN72AhViQkEAHSmvBCUQ4dUDCA4&amp;uact=5&amp;oq=Penetration+test+ports&amp;gs_lcp=Cgdnd3Mtd2l6EAMyBggAEBYQHjIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjIGCAAQFhAeMgYIABAWEB46BwgjELADECc6BwgAEEcQsAM6CggAEEcQsAMQyQM6CwgAEIAEELEDEIMBOgUIABCABDoICAAQgAQQyQNKBAhBGABKBAhGGABQhwRY5RJg7BNoAXABeACAAYcCiAGLCpIBAzItNZgBAKABAqABAcgBCcABAQ&amp;sclient=gws-wiz" rel="noopener ugc nofollow" target="_blank">谷歌渗透测试</a>。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/0f7b2c37821dbf4affa6f7f92875039c.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*om07QsMpFk7EL13i-o5mHA.png"/></div></figure><p id="21aa" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">下面是一个很好的视觉形象，展示了我们在这里已经取得的成就，以及你们将会得到什么。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/344bfd9db327b6fdaf2eb5f183f9430d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SJB7mnEBJFar4d1WMz9ig.jpeg"/></div></div></figure><p id="eb71" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">恭喜你有了一个基本的工作防火墙，希望你能有所了解。</p><p id="45c9" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">有更多的设置和首选项可以用来“增强”你的安全性，其中一些可以在UFW配置文件中找到。</p><pre class="kp kq kr ks fd ld le lf lg aw lh bi"><span id="1777" class="iq ir hi le b fi li lj l lk ll">sudo nano /etc/default/ufw</span></pre><p id="eea4" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">还有一些可以通过CI或第三方软件包实现，例如</p><p id="6aec" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">1.失败班<br/> 2。禁用根用户<br/> 3。公钥认证<br/> 4。地理封锁<br/> 5。反向代理:我使用Nginx，但Traefik最近似乎很流行。<br/> 6。Cloudflare CDN <br/> 7。将SSH移动到不同的端口</p><p id="2e25" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">为了提高服务器安全性，我强烈推荐以上所有方法。</p><p id="d4a4" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">注意安全祝你好运✌</p></div></div>    
</body>
</html>