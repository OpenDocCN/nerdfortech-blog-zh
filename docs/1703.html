<html>
<head>
<title>AWS CDK : things you should know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS CDK:你应该知道的事情</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/aws-cdk-things-you-should-know-d620a2de9669?source=collection_archive---------9-----------------------#2021-04-02">https://medium.com/nerd-for-tech/aws-cdk-things-you-should-know-d620a2de9669?source=collection_archive---------9-----------------------#2021-04-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2211fb29fec3727861d7dba06d6f2b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCOBpevfigJ0COX_de0TBQ.jpeg"/></div></div></figure><p id="4bc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你正在使用 AWS，你应该已经开始使用或者至少听说过 CDK；这是他们的基础设施，作为市场上其他参与者的代码替代，包括他们自己的基于 yaml 的“CloudFormation”。</p><p id="4d88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">虽然，我在 CDK 的经历一直很愉快，但有几件事我很想早点知道。有些是我在没有阅读每一篇文档的情况下采用某项技术时遗漏的；而有些是可能没有明确说明的缺失元素。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="4ab3" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">在当地与 CDK 合作</h1><p id="bc1a" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">像大多数 IAC 工具一样，AWS CDK 也有一个命令行实用程序，你可以用它在 AWS 上执行一些操作，包括引导一个帐户，合成一个 CloudFormation 模板等等。</p><p id="ffe4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您所在的组织已经启用了 SSO，那么您可能需要执行一些额外的步骤来实现这一点。我说的问题是<a class="ae ky" href="https://github.com/aws/aws-cdk/issues/5455" rel="noopener ugc nofollow" target="_blank"> AWS SSO 命名配置文件支持</a>。在这一点上，社区已经有了多种解决方法，这实际上不是 CDK 的问题；但是 JS SDK 直到几天前还不支持 SSO。希望这一个成为过去的事情，一旦变化滚滚而来。</p><p id="c725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我最终使用了其中一个解决方案<a class="ae ky" href="https://www.matscloud.com/blog/2020/06/25/how-to-use-aws-cdk-with-aws-sso-profiles/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="e711" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">AWS 服务的命名约定</h1><p id="0522" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">熟悉 AWS 服务使用的命名约定。或多或少围绕着“大写名字允许吗？”。我遇到了一些问题，我计算的带有项目前缀的服务名有大写字符，而 CDK 悄悄地把它们转换成了小写。</p><ul class=""><li id="b8bf" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">DB 子网组只能有小写名称。</li><li id="b72c" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">如果您将一个数据库集群与子网组相关联，CloudFormation 控制台将继续失败，并显示消息“<name>不存在”。</name></li></ul><p id="64f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:我后来注意到 AWS 控制台的行为也是如此。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="958d" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">自动气象站/ CDK/运行时</h1><p id="52dc" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">如果您完全不熟悉 AWS，并且正在努力掌握您不熟悉的 CDK 和运行时；以下是我的建议:</p><ul class=""><li id="91ef" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">开始关注你将要使用的 AWS 服务。</li><li id="5f2b" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">通过在 AWS 控制台中使用它来理解服务的细微差别。</li><li id="1b66" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">除非你知道它的存在，否则你不会知道在 CDK 该怎么做。</li><li id="8182" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">文档和示例在以后会更有意义</li></ul></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="9308" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">Python CDK 文档</h1><p id="4dfd" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">python CDK 文档有一些印刷错误。有几个来自 typescript 的例子和一些缺失的更新。如果您使用的是 VSCode 或 PyCharm 之类的 IDE，<strong class="is hj">查找 AWS 工具包扩展。</strong></p><div class="ln lo ez fb lp lq"><a href="https://aws.amazon.com/pycharm/" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">PyCharm 的 AWS 工具包</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">AWS Toolkit for PyCharm 是 PyCharm IDE 的一个开源插件，它使创建、调试和管理变得更加容易</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">aws.amazon.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me io lq"/></div></div></a></div><div class="ln lo ez fb lp lq"><a href="https://aws.amazon.com/visualstudiocode/" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">AWS Visual Studio 代码工具包</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">AWS Toolkit for Visual Studio Code 是一个针对 Visual Studio 代码的开源插件，它将使……</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">aws.amazon.com</p></div></div><div class="lz l"><div class="mf l mb mc md lz me io lq"/></div></div></a></div></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="1d57" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak"> CDK 管道:上下文查找</strong></h1><p id="9393" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">如果您计划在 CICD 流程中使用 CDK 管道，您应该意识到这一点。您不会遇到这种限制，直到您进入一些需要 VPC 的资源，如 Aurora 无服务器集群。</p><p id="289d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考</strong>:<a class="ae ky" href="https://docs.aws.amazon.com/cdk/api/latest/docs/pipelines-readme.html#current-limitations" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/CDK/API/latest/docs/pipelines-readme . html # current-limits</a></p><p id="f2d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">你能为 VPC 局势做些什么</strong>:</p><ul class=""><li id="bc9a" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">当您创建管道并描绘出您感兴趣的部署环境时，记下客户 id 和区域。</li><li id="eaf6" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">对所有环境组合执行<strong class="is hj"> cdk synth </strong>。如果需要，在合成时将 vpcId 指定为上下文变量。</li><li id="167d" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">这将创建一个“context.cdk.json ”,其中包含您的环境的网络/vpc 相关信息。</li><li id="7e90" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">将它们提交给代码存储库，并从中获取 vpcid。</li></ul></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="1f13" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">CDK 版本</h1><p id="8eb6" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">关于 AWS CDK，我必须承认的一件令人担忧的事情是次要版本的变化率。<strong class="is hj">不要误解我的意思，引入重大修复和功能的改变受到高度赞赏</strong>。而且，我还没有被变化咬得很厉害。这类似于我在使用 istio 作为服务网格选项时注意到的变化。</p><p id="9abd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这表明对您为应用程序创建的结构进行良好测试的必要性。如果您正在为您的组织创建可重用的通用构造，请进行一些测试，以验证新版本的更改没有破坏您这边的某些东西。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="52bb" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">CDK 松弛水道</h1><p id="8012" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">如果你已经阅读了这篇文章，看起来你对使用或学习 CDK 很感兴趣。没有比他们的松散渠道更好的地方来与志同道合的人建立网络，这些人已经接受了 CDK 作为他们前进的道路。我有过无数次互动，其中有人向我介绍了挑战和我的问题的可能解决方案。所以<a class="ae ky" href="https://cdk.dev/" rel="noopener ugc nofollow" target="_blank">如果你还没有加入这里</a>。</p><p id="55f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献:</strong></p><ol class=""><li id="1a44" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn mg lf lg lh bi translated">汉斯-彼得·高斯特在<a class="ae ky" href="https://unsplash.com/s/photos/learning?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</li></ol></div></div>    
</body>
</html>