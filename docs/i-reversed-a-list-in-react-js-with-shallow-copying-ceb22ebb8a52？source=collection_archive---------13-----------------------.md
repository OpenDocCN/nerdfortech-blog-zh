# 我在 React.js 里用浅层复制反了一个列表！

> 原文：<https://medium.com/nerd-for-tech/i-reversed-a-list-in-react-js-with-shallow-copying-ceb22ebb8a52?source=collection_archive---------13----------------------->

## *本帖假设你对 React.js、state、props、fetch()有基本了解；在 JavaScript 中。

在过去的几个月里，我真的深入研究了 JavaScript 基础知识，以帮助我提升我的前端知识。Flatiron 是一个令人难以置信的程序，我学到了很多东西，但无论你如何分割它，3 周的 JavaScript 和 3 周的 React.js 都不是学习前端开发的很多时间。学习如何把东西放在一起是很棒的，但我真的一直在关注*为什么*事情以他们的方式工作，特别是在 JavaScript 中。话虽如此，我终于开始梳理旧项目，我惊讶地发现，加强 React 的 JavaScript 基础知识是多么有益。其中一个例子是我如何决定反转一个列表。

我为那些有写作障碍的作家创建了一个非常基本的网络应用程序，让他们在随机生成的提示下快速发布广告和想到的故事。我用 Rails 创建了我的后端，并使用`fetch();`请求来更新我的帖子。相当简单的应用程序。我的挑战是，在提交时，我不希望我的帖子更新到页面的底部，而是顶部。

![](img/b14526615a8f9fb99e19e82e6f3109e3.png)

在我的 console.log()中，我可以从上到下看到帖子的 id。

每当我更新我的帖子时，帖子都会正确地提交并更新到 state，但是在现实情况下，为什么我希望我最近的帖子在页面的底部呢？想想 Twitter、脸书、Tumblr、Reddit 等等……没有人的帖子会更新到页面底部，而是顶部！那是大家的注意力所在！所以我开始让它发挥作用。

**全面披露:**我不确定我这样做是不是最好的方式。事实上，有人告诉我，最好更新我的 Rails 服务器中的逻辑来实现这一点。但是我在前端这样做的理由是，也许我可能需要根据更新到 state 的最新数据来更新信息，而我没有访问后端的权限，或者也许我想要来自我无法控制的 API 的最新信息。那我该怎么办？首先，让我们看看我的基本设置。

![](img/77e6f5a554ff3272ca826f40bf8ae5f6.png)

第一步:用 fetch()导入数据；

正如您所看到的，首先，我为我的获取请求创建了一个自定义钩子。在本例中，我从我的帖子中获取数据，并将帖子数据作为道具传递给我的帖子容器。从那以后，我做了一个很标准的动作。map()；显示我的帖子。

![](img/e8598d3d09c458508ba75c45ad08c8ce.png)

第二步:map():通过道具展示帖子。

在上面的第一张图中，你可以看到显示了什么。这太棒了！我显示了我的帖子，我的错误信息是有效的，如果加载时间太长，我也会显示加载信息。但这仍然不是我想要的。我决定，因为大多数最近的帖子都在我的道具数组的末尾，我可以把它反过来，这样就一帆风顺了！

当然，事情没那么简单。我想了一个简单的办法。`map();` 可以工作，但它实际上并没有撤销我的帖子，尽管当我撤销 `console.log();`时，它显示`.map`被撤销了。

![](img/5550988b0f443849825f2878819155eb.png)

我的 console.log()显示了反向的帖子，尽管显示的是原始数组。

经过一番头脑风暴和一点点轻*(*咳*一点也不轻*咳*)* 阅读，我完全忘记了 React 里的道具是不可改变的。简单的`.map();`通常不是问题，因为它只是数据数组的快速迭代，但是当我试图反转我的数组时，我实际上是在试图操纵道具本身。所以为了解决这个问题，我使用了便利的 spread 操作符，并创建了一个我的道具的浅拷贝。

我原本在第 16 行做了`posts.reverse().map((post) => . . . )`,但是我把`posts`改成了`[...posts]`,效果非常好！

![](img/bb8f55a1134df1690959732266f89d1c.png)

我的代码现在看起来像这样:

![](img/95613d2692db81ae819e240d5ce5cb77.png)

[…帖子]

## 那么，为什么会这样呢？

我以前见过并与传播操作员一起工作过，但对我在做什么或为什么做并不十分熟悉。据我所知，我最初的逆转帖子的方法是试图操纵`({posts})`道具本身，这是一个大禁忌。通过创建数据的*浅层副本*，React 能够操纵它，而不是改变不可变的信息。就这样，我的帖子在控制台和显示屏上都被正确地反转了:)

我相信有更好的方法来解决这个问题，如果你有什么建议，请告诉我！快乐的编码朋友。