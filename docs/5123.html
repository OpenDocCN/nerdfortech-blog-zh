<html>
<head>
<title>Working with Animation Events in Unity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Unity中处理动画事件</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/working-with-animation-events-in-unity-d9ce4a404380?source=collection_archive---------7-----------------------#2021-08-30">https://medium.com/nerd-for-tech/working-with-animation-events-in-unity-d9ce4a404380?source=collection_archive---------7-----------------------#2021-08-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="564b" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">现在我们已经有了一个抓岩架，让我们开始制作动画来爬上我们的岩架，并在到达顶部时保持在那个位置。首先，我们将找到一个新的动画，并将其与animator网格一起添加到我们的资产中。我们现在将它附加到挂起的空闲动画上，这样我们可以确保它正常工作:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/81069f64de186ba1f49466e5e9710d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZoFqtanJLuytnuKWNyqpQ.png"/></div></div></figure><p id="6203" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">从这里开始，我们将需要在我们的播放器中创建代码，使我们能够按下一个键来启用我们的壁架攀爬，但是因为我们已经在连接到壁架时关闭了控制器，所以我们需要确保将它添加到我们已经做出的控制器运动声明之后:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jq"><img src="../Images/f58a7686e7ea1ca504e21630b3c50660.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*4xov31LiG2ONkUWEOnDBLw.png"/></div></figure><p id="25ac" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">从这里，我们可以通过快速播放来查看它在我们场景中的样子:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/3fc06ef1543e01b085a933399ff5376c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EIkJWP8KFlm0sUX8ZztFoA.gif"/></div></div></figure><p id="fc6e" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">现在，如果我们想让它在动画结束时切换到空闲状态，我们会遇到一个小问题:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/289e5749629f234363e9ae83779371e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OVFrFTw5G6dCE2OuwLc4Fw.gif"/></div></div></figure><p id="49f1" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">发生这种情况的原因是，当我们把玩家的位置设置到终点时，玩家已经附着到壁架上了。由于动画没有覆盖当前玩家的位置，我们现在需要在代码中创建一个方法，使我们能够在结束攀爬动画时将角色移动到新的位置。要做到这一点，我们首先需要弄清楚我们的玩家将要站立的大致位置，以使它成为我们希望玩家在完成攀爬动画后捕捉到的位置。一旦我们分配了它并放置了坐标，我们必须在我们的壁架探测器脚本中创建一个函数，我们可以调用它来将我们的玩家放置在那个位置:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/f71eba0a53fac2d8453889bdf284af1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*7FMiH9gLXw8tqnxGut7Nug.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es js"><img src="../Images/468f6a078fb5c7f61f6351863109e003.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*LI2KXs8bBDniEgm-2oZILw.png"/></div></figure><p id="f689" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">在我们的玩家脚本中，我们想要创建一个新的方法，让玩家的位置变成我们之前确定的位置，同时关闭我们的ledgegrab bool并重新激活我们的玩家控制器，这样我们就可以继续玩游戏。从这里，我们将想要创建一个新的脚本，但这一次将是我们的动画，所以这将是一个有点不同的方法:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jt"><img src="../Images/8a5d6e0868969fe1d6c9d2c476cbe8dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/1*4vkh7y-Pm1avmVJZAyqghg.gif"/></div></figure><p id="656d" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">这样做的目的是为我们的动画创建一个行为脚本，为我们提供可供选择的选项，我们可以选择我们认为最适合我们所处情况的选项:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/890e4f515378b42fbb7acba424e70fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lfgel4K6s-1fWiSOWMZZug.png"/></div></div></figure><p id="8fbe" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">在这种情况下，我们需要OnStateExit条件，我们将调用player对象来调用新创建的方法。这将在我们的攀爬动画结束后播放。现在所有这些都完成了，让我们看看它是否有效:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/61301726c7772381dea87f1e75beb8e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AlKeOqXhzBRuByV51Ir5MA.gif"/></div></div></figure><p id="9060" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">它几乎完美地工作，除了动画结束时出现的小故障。这是因为我们对过渡设置了过渡持续时间，这是我们不希望的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jt"><img src="../Images/07416a870d9426fde06782271ca54e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*YACQSDk9aGX4G55siG2yaA.png"/></div></figure><p id="b5c3" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">一旦我们把这个拿掉，我们就可以看到我们最终的结果了:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/b047b8e5c0de314fa134a7c122b768ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2L0BW8kQ0gSNLoi1g3oOVw.gif"/></div></div></figure><p id="46c4" class="pw-post-body-paragraph ig ih hi ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hb bi translated">我们已经做到了，我们已经设法在我们的游戏中创建了一个向上爬的动画，允许我们快速移动到新的位置，并启用游戏中的所有内容，这样我们就可以继续玩下去。</p></div></div>    
</body>
</html>