<html>
<head>
<title>Use Case: Fabric Stain Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用案例:织物污渍分类</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/use-case-fabric-stain-classification-5c7cf63cf9d2?source=collection_archive---------11-----------------------#2021-08-10">https://medium.com/nerd-for-tech/use-case-fabric-stain-classification-5c7cf63cf9d2?source=collection_archive---------11-----------------------#2021-08-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/55817c4d6aad086392a25bbd42740f1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfIsniBQ4RVqsyvTzATIVQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/photos/9epO7Cu6UiM" rel="noopener ugc nofollow" target="_blank">图片来源</a>。</figcaption></figure><p id="3af6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">全球纺织业几乎影响着地球上的每一个人，预计2020年其规模将达到10003亿美元。它包括生产、提炼和销售用于成千上万个行业的合成和天然纤维。</p><p id="9883" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">近年来，对高质量纺织品的高需求导致了自动化、基于人工智能的纺织品生产质量控制的应用。这也部分归因于技术发展、建模和模拟的使用，以及纺织品生产中普遍存在的高概率错误和缺陷。</p><p id="7a89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着(机器学习)ML在<a class="ae iu" href="https://en.wikipedia.org/wiki/Industrial_internet_of_things" rel="noopener ugc nofollow" target="_blank">工业物联网</a> (IIoT)和<a class="ae iu" href="https://en.wikipedia.org/wiki/Fourth_Industrial_Revolution" rel="noopener ugc nofollow" target="_blank">工业4.0 </a>中的使用越来越多，我们开始在<a class="ae iu" href="https://www.perceptilabs.com/" rel="noopener ugc nofollow" target="_blank">感知实验室</a>中建立一个图像识别模型，该模型可以分析纺织品的图像，以确定它们是否含有污渍。像这样的模型可以与纺织制造厂的实时摄像头或视频源结合使用，以快速捕捉缺陷并改善质量控制。</p><p id="dee2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">数据集</strong></p><p id="f307" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了训练我们的模型，我们在<a class="ae iu" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上使用了来自<a class="ae iu" href="https://www.kaggle.com/priemshpathirana/fabric-stain-dataset" rel="noopener ugc nofollow" target="_blank">织物污渍数据集</a>的图像。原始数据集包括466幅描绘正常和染色织物的图像。</p><p id="9c1c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">原始数据集不平衡，有68张<em class="jt">无缺陷</em>图像和398张不同类型的涤棉织物污渍缺陷图像。为了消除训练过程中的潜在偏差，我们使用数据扩充(应用随机旋转，以及垂直和水平翻转)制作了一个平衡数据集，以将<em class="jt">无缺陷</em>图像的数量从68个增加到408个。图1显示了该数据集中的一些示例图像:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/5df66f68365e1c3b8592f703e52b0e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rc3EParmT_Ntxx1Q"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="jz">图1:来自数据集的图像示例— </em> <a class="ae iu" href="https://www.kaggle.com/priemshpathirana/fabric-stain-dataset" rel="noopener ugc nofollow" target="_blank"> <em class="jz">图像来源</em> </a> <em class="jz">。</em></figcaption></figure><p id="8c65" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当通过PerceptiLabs的<a class="ae iu" href="https://docs.perceptilabs.com/perceptilabs/references/ui-overview/data-wizard" rel="noopener ugc nofollow" target="_blank">数据向导</a>加载数据时，我们将图像大小调整为224x224以缩短计算时间，而三个(RGB)通道用于将数据输入预训练的模型。为了将分类映射到图像，我们创建了一个. csv文件，该文件将每个图像文件与适当的分类标签(<em class="jt">污点</em>和<em class="jt">缺陷_自由</em>)相关联，以便将数据加载到感知实验室中。下面是一个部分的例子。csv文件看起来:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/c26e935034f5417d9509d2923ffc6b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wi0c093fxxM8AgLfhEYl6w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="jz">的例子。csv文件，用于将数据加载到将图像文件映射到其分类标签的感知标签中。</em></figcaption></figure><p id="d762" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">车型总结</strong></p><p id="5728" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的模型由三个<a class="ae iu" href="https://docs.perceptilabs.com/perceptilabs/references/components" rel="noopener ugc nofollow" target="_blank">组件</a>组成:</p><p id="2033" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">组件1: <a class="ae iu" href="https://keras.io/api/applications/mobilenet/" rel="noopener ugc nofollow" target="_blank"> MobileNetV2 </a>，include_top=false，pretrained=imagenet</p><p id="9d42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">成分2:密集，激活= <a class="ae iu" href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank"> ReLU </a>，神经元=128</p><p id="f276" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">组件3:密集，激活= <a class="ae iu" href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank"> ReLU </a>，神经元=2</p><p id="d515" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该模型通过MobileNetV2使用迁移学习，如图2所示:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/0e44e9c27fcdba5ff5ec84af4660edf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwAEdJdwbQadtvjT8kJxFw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="jz">图2:感知实验室中模型的拓扑结构— </em> <a class="ae iu" href="http://www.perceptilabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="jz">图片来源</em> </a> <em class="jz">。</em></figcaption></figure><p id="5e0d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">训练和结果</strong></p><p id="4588" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">我们使用<a class="ae iu" href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/#:~:text=Adam%20is%20a%20replacement%20optimization,sparse%20gradients%20on%20noisy%20problems." rel="noopener ugc nofollow" target="_blank"> ADAM </a>优化器、0.001的学习率和交叉熵<a class="ae iu" href="https://blog.perceptilabs.com/choosing-and-customizing-loss-functions-for-image-processing/" rel="noopener ugc nofollow" target="_blank">损失</a>函数，在10个时期</strong>中分批训练模型，每批32个。使用大约122秒的训练时间，<strong class="ix hj">我们实现了93.79%的训练准确率和83.23%的验证准确率</strong>。</p><p id="a5f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">图3显示了训练期间PerceptiLabs的统计视图:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/2aaedb7b3c74db1411c895675e722592.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdVa_UAWXPThvmDpNh1iGg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="jz">图3: PerceptiLabs训练时的统计视图— </em> <a class="ae iu" href="http://www.perceptilabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="jz">图片来源</em> </a> <em class="jz">。</em></figcaption></figure><p id="a0d7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的图4和图5显示了训练期间10个时期的损失和准确度:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/13c3d609187f97bca8319ee4aa16a472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5M5WALlssYrAjESn-qFyOQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="jz">图4:训练中的损耗— </em> <a class="ae iu" href="http://www.perceptilabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="jz">图片来源</em> </a> <em class="jz">。</em></figcaption></figure><p id="4ba3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在图4中，我们可以看到，在第一个epic中，训练和验证损失都迅速下降。在剩余的时期，训练损失保持相当稳定，而验证损失稳步增加，这表明我们可以更早地停止训练，以减少过度拟合。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/3e57d30e64d84b604767c9e11ff96080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MYiz-gIq4bkXIoCw"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="jz">图5:训练时的准确度— </em> <a class="ae iu" href="http://www.perceptilabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="jz">图片来源</em> </a> <em class="jz">。</em></figcaption></figure><p id="9744" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在图5中，我们可以看到，在前两个时期之后，训练精度保持相对稳定，并在接近结束时逐渐降低，而验证精度始终保持相当稳定。</p><p id="a6d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">垂直应用</strong></p><p id="c1ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">像这样的模型可以用于制造业中基于计算机视觉的质量控制。当与生产线上材料的实时图像或视频配合使用时，这种ML模型为自动识别材料缺陷提供了坚实的基础。该模型本身也可以用作<a class="ae iu" href="https://blog.perceptilabs.com/when-to-use-transfer-learning-in-image-processing/" rel="noopener ugc nofollow" target="_blank">迁移学习</a>的基础，以创建用于检测其他类型材料中的缺陷的模型。</p><p id="9ba1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">总结</strong></p><p id="d442" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此使用案例是图像识别如何应用于制造业的示例。如果你想建立一个类似这样的深度学习模型，<a class="ae iu" href="https://docs.perceptilabs.com/perceptilabs/getting-started/quickstart-guide" rel="noopener ugc nofollow" target="_blank">运行PerceptiLabs </a>并在<a class="ae iu" href="https://github.com/PerceptiLabs/fabric_stain" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看我们为这个用例创建的回购。另外，请务必查看我们的其他材料缺陷博客:<a class="ae iu" href="https://blog.perceptilabs.com/use-case-defect-detection-in-metal-surfaces/" rel="noopener ugc nofollow" target="_blank">用例:金属表面缺陷检测</a>。</p><p id="1eb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.grandviewresearch.com/industry-analysis/textile-market" rel="noopener ugc nofollow" target="_blank">https://www . grandviewresearch . com/industry-analysis/textile-market</a></p></div></div>    
</body>
</html>