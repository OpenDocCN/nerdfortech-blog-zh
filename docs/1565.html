<html>
<head>
<title>Build Microservices with Ocelot API Gateway in .NET Core</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Ocelot API网关构建微服务。网络核心</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/build-microservices-with-ocelot-api-gateway-in-net-core-d87666a278f4?source=collection_archive---------2-----------------------#2021-03-26">https://medium.com/nerd-for-tech/build-microservices-with-ocelot-api-gateway-in-net-core-d87666a278f4?source=collection_archive---------2-----------------------#2021-03-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/e4cfb7150b39d336f5625d81b1ae3e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*irJI4PjFYP6VcXW7rRDYdw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">Ocelet API网关微服务</figcaption></figure><p id="30cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天我们将学习微服务架构及其在ASp.Net核心3.1中使用Ocelot API Gateway的实现。我们都知道大规模应用使用微服务的好处。</p><div class="jp jq ez fb jr js"><a href="https://github.com/JayKrishnareddy/Microservice.WebApi-master" rel="noopener  ugc nofollow" target="_blank"><div class="jt ab dw"><div class="ju ab jv cl cj jw"><h2 class="bd hj fi z dy jx ea eb jy ed ef hh bi translated">JayKrishnareddy/微服务。WebApi-master</h2><div class="jz l"><h3 class="bd b fi z dy jx ea eb jy ed ef dx translated">微服务架构概述Monolith与微服务使用Ocelot API Gateway运行和配置微服务…</h3></div><div class="ka l"><p class="bd b fp z dy jx ea eb jy ed ef dx translated">github.com</p></div></div><div class="kb l"><div class="kc l kd ke kf kb kg ik js"/></div></div></a></div><h1 id="9baf" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">微服务架构—概述</h1><p id="f92b" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">有两种可能的方法来构建和组织应用程序:</p><ol class=""><li id="86c0" class="lk ll hi is b it iu ix iy jb lm jf ln jj lo jn lp lq lr ls bi translated">整体建筑</li><li id="4e8a" class="lk ll hi is b it lt ix lu jb lv jf lw jj lx jn lp lq lr ls bi translated">微服务架构</li></ol><h1 id="b081" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">整体建筑</h1><p id="b752" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">Monolith就像一个大容器，一个app的所有软件组件都在里面组装，紧密耦合；即每个组件完全依赖于另一个组件。整体式有优点也有缺点。与微服务相比，整体架构的优势较少。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es ly"><img src="../Images/2b19704397dd05afbe4c488080657386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LelubaFyY-CocEwARCT8HQ.jpeg"/></div></div></figure><h1 id="7735" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">整体材料的缺点:</h1><p id="8a1b" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated"><strong class="is hj">发展缓慢</strong></p><p id="73f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们修改任何模块或组件，我们需要重新部署整个应用程序，而不是更新它的一部分。在缓慢的开发中消耗更多的时间。</p><p id="3c79" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">不可靠</strong></p><p id="ea19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果一个服务关闭，那么整个应用程序将停止工作，因为应用程序的所有服务都是相互连接的。</p><p id="ba8a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">大型复杂应用</strong></p><p id="d002" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于大规模的应用来说，由于相互依赖，很难维护。</p><p id="033e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它会消耗更多的内存，其中每个组件都将访问整个数据，它会消耗更多的内存，并且还会重新构建应用程序。除此之外，我们需要改变整个应用程序，这使得这个过程有点困难。</p><h1 id="966b" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">微服务架构</h1><p id="e50b" class="pw-post-body-paragraph iq ir hi is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hb bi translated">微服务架构是指一种技术，它通过将应用程序分解为实现特定业务功能的离散服务，为现代开发人员提供了一种设计高度可伸缩、灵活的应用程序的方法。这些服务通常被称为“松散耦合”，可以独立构建、部署和扩展。</p><p id="4c43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">设置项目</strong></p><p id="35c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建空白溶液</strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mh"><img src="../Images/17c6ac98e016ed9ab3caf15467e451dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CvZmB2PNh3HRWBv7.png"/></div></div></figure><p id="a1ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建一个名为Microservices </strong>的新解决方案文件夹</p><blockquote class="mi mj mk"><p id="3ed0" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">右键单击微服务文件夹</p><p id="9a92" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">点击添加</p><p id="e40c" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">点击新项目</p></blockquote><p id="bdcb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建客户微服务</strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mo"><img src="../Images/3c91013707ebf6096822840c18e91dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jiqk9gIKaovY9Xut.png"/></div></div></figure><blockquote class="mi mj mk"><p id="8f13" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">输入项目名称</p><p id="bebb" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">选择API作为模板，我们将继续使用。网芯3.1版本。</p><p id="5263" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">点击创建</p></blockquote><p id="cf70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建产品微服务</strong></p><p id="4250" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">遵循我们为客户微服务所做的相同流程。</p><p id="7ba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建API网关</strong></p><p id="1c25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择Empty作为具有相同。网芯3.1版本。</p><p id="d93b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">文件夹结构</strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/86aab8f06d5640709124bd78a91838c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/0*sbNY1GqHTyW3TBIY.png"/></div></figure><p id="6af5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">配置Ocelot API网关</strong></p><p id="4083" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是Ocelot API网关在我们项目中的工作方式。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mq"><img src="../Images/722d1eab75dc3706ad224148fa1e5866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZL1R1fyDlO5AK0bg.png"/></div></div></figure><p id="88f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要了解Ocelot及其特性，请点击此链接<a class="ae mr" href="https://dzone.com/articles/ocelot-the-api-gateway-framework-for-net#:~:text=Ocelot%20is%20an%20API%20Gateway%20for%20.NET%20platform.,runs%20on%20any%20platform%20supported%20by%20ASP.NET%20Core." rel="noopener ugc nofollow" target="_blank"> Ocelot API Gateway </a></p><p id="9d40" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在网关下安装软件包。WebAPI</p><blockquote class="mi mj mk"><p id="2831" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">安装包Ocelot</p></blockquote><p id="76e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在启动时添加配置设置。铯</p><p id="9ba1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Startup.cs </strong></p><figure class="lz ma mb mc fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><p id="8bfb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建配置。网关下的Json文件。WebAPI来定义微服务所必需的路线。</p><p id="08d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">配置。Json </strong></p><figure class="lz ma mb mc fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><p id="3ed5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> DownstreampathTemplate — </strong>定义微服务实际端点的路径</p><p id="5bc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">下游方案</strong>—HTTPS微服务方案</p><p id="0fe2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">DownstreamHostsandPorts—</strong>微服务的主机和端口将在此定义。</p><p id="4504" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> UpstreampathTemplate — </strong>客户端请求Ocelot API网关的路径</p><p id="94d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">UpstreamHttpmethod—</strong>API网关支持的HTTP方法。基于传入的方法，Ocelot也向微服务发送类似的HTTP方法请求。</p><p id="a0c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们测试应用程序，它将在网关下运行。我们已经在configuration.json文件中定义的WebAPI端口号</p><p id="2f73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> launchsettings.json(网关API) </strong></p><figure class="lz ma mb mc fd ij"><div class="bz dy l di"><div class="ms mt l"/></div></figure><p id="b2eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在测试应用程序之前，确保一次性运行多个项目。</p><blockquote class="mi mj mk"><p id="33b4" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">右键单击解决方案</p><p id="77dd" class="iq ir jo is b it iu iv iw ix iy iz ja ml jc jd je mm jg jh ji mn jk jl jm jn hb bi translated">点击属性</p></blockquote><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mu"><img src="../Images/f9e8c6af9387d1295471f25bae5006de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6i36pBY0Ghc5WDBB.png"/></div></div></figure><p id="31b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行项目以检查结果。</p><p id="dd49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">输出</strong></p><p id="a30a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">产品微服务—端点</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mv"><img src="../Images/62bee2db9c41fc4718482354589d2d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5bZeuHOMpSnhQbbC.png"/></div></div></figure><p id="8b10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">客户微服务—端点</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mq"><img src="../Images/7b0e3da00ecafb1d6e8326ffb72a2b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XxL9P2hgDir0TftN.png"/></div></div></figure><p id="ca7a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注</strong></p><p id="fe75" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我还在其中实现了Swagger来检查单个微服务的结果。</p><p id="60fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你发现这篇文章对你有帮助，请给它一个👏🏻</p><p id="aa69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">继续学习！！！</p></div></div>    
</body>
</html>