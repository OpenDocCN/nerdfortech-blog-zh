<html>
<head>
<title>Personalizing App invites with AppsFlyer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AppsFlyer个性化应用邀请</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/personalizing-app-invites-with-appsflyer-4285d42b3ff3?source=collection_archive---------6-----------------------#2021-07-20">https://medium.com/nerd-for-tech/personalizing-app-invites-with-appsflyer-4285d42b3ff3?source=collection_archive---------6-----------------------#2021-07-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3198c2418c32e16208f3afc8cc0449e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b9n5GM0GMii0AybY"/></div></div></figure><p id="88f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">任何人，只要一直在用一个app建立用户交互，都知道这个过程有多复杂。这种相互作用的机制之一是深度链接。这是一种决定推送通知、用户参与度和留存率的机制。</p><p id="0afc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将介绍一些AppsFlyer工具以及如何使用它们，并举例说明邀请用户的功能，这将有助于使签到更加个性化。</p><h1 id="f5a6" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">SDK集成和获取属性数据</h1><p id="4bb2" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">AppsFlyer是一个移动流量分析和归因平台，提供大量付费和免费服务。我们将使用应用程序安装属性数据并创建短链接来实现应用程序邀请功能。</p><p id="b3e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们将SDK集成到项目中(详见<a class="ae kr" href="https://support.appsflyer.com/hc/en-us/articles/207032126-Android-SDK-integration-for-developers#introduction" rel="noopener ugc nofollow" target="_blank">说明</a>)。)</p><p id="851b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">集成后，您可以检查安装后的归属情况。为此，让我们向方法<em class="ks">onconversiondatascence</em>添加一个简单的日志。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/8f2f7588a75fedfc8b50502350df0d8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WdJbTgZeE16_cxiFAJyF_Q.png"/></div></div></figure><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/b9ad90a8b3ef9228e0571a40a92c8eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OcIAGZeMl6pJzM6rCUCGg.png"/></div></div></figure><p id="45d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，你需要在测试设备上打开一个专门生成的<a class="ae kr" href="https://abpv.onelink.me/nWMv/share?c=e_new&amp;af_dp=americabpv%3A%2F%2Fcontent%3Fcid%3DhSPRMKbU8%26s%3De%26pid%3Dshare&amp;af_web_dp=https%3A%2F%2Famericasbestpics.com%2Fgif%2FhSPRMKbU8%3Fs%3De%26pid%3Dshare" rel="noopener ugc nofollow" target="_blank">链接</a>。由于该应用程序没有安装在智能手机上，您将被重定向到商店进行安装。</p><p id="174e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很有可能在安装启动后，会出现一条“归属—空”的消息。这可能有几个原因:</p><ol class=""><li id="ea9b" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">AppsFlyer中的项目配置方式错误。</li><li id="70c2" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">包名不同于AppsFlyer中使用的包名，例如，如果您为调试版本使用附加后缀。</li><li id="22e4" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">您的设备<a class="ae kr" href="https://support.appsflyer.com/hc/en-us/articles/207031996" rel="noopener ugc nofollow" target="_blank">尚未添加</a>到测试设备中。</li></ol><p id="0b53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果一切正常，AppsFlyer将向您发送一个如下所示的属性(为了清楚起见，我通过调试器过滤掉了空值):</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/9c3013cfd729fe8d6a078bcab8287d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fXUdlS18O_MFNYBM"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">安装归属示例</figcaption></figure><p id="f3c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大约这种数据存在于地图中。这里有很多有趣的东西，例如，http_referrer字段显示链接是从哪里被点击的，而is_first_launch可以用来跟踪第一次启动。</p><p id="f8f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，最重要的字段是af_dp:它接收关于链接内容的信息，在这种情况下，它是id为hSPRMKbU8的meme。我们使用这个id使应用程序的打开更加有机——通过这个点击，meme将成为提要中的第一个。</p><p id="1e0b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一切似乎都很好，但也有隐藏的陷阱。</p><ol class=""><li id="f5c7" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">每次启动应用程序时，都会检索安装数据。这是一个小小的安全措施，以防第一次运行时无法处理属性。因此，如果您有只需要在第一次运行时工作的逻辑，那么单独支持它是值得的，例如，通过prefs中的标志或任何其他机制。</li><li id="cc36" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">从启动一个应用程序到调用一个方法所需的时间可能会有所不同，尤其是在第一次运行时。在测试运行中，它从2秒到15秒不等。如果过程中的代码不影响UI，这不是问题，但是如果你必须基于属性构建一个屏幕，事情就更糟了。这里没有好的解决方案，因为每一个都会在应用程序启动后阻止用户一段时间，或者很难实现。</li></ol><p id="e728" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以现在我们知道如何获得安装信息，太好了！不要忘记让分析师对这些数据感到满意。</p><h1 id="932b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">短链路服务</h1><p id="f6a8" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">分析显示，短链接最有可能被打开。或许，这是因为，对于普通人来说，连接中的参数看起来很吓人，难以理解。可能由于没有断字，短链接在屏幕上看起来更有机，但事实是快速链接更适合我们的用户。</p><p id="6810" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AppsFlyer已经有一个<a class="ae kr" href="https://support.appsflyer.com/hc/en-us/articles/360001250345-OneLink-API" rel="noopener ugc nofollow" target="_blank"> API </a>用于生成这样的链接，但是它不是免费的。不准备付出就不要放弃。SDK中为客户提供了一个模拟。它的名字叫<a class="ae kr" href="https://support.appsflyer.com/hc/en-us/articles/115004480866-User-invite-attribution" rel="noopener ugc nofollow" target="_blank"> LinkGenerator </a>。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/c4a5e69c8051b269e52c6b805e825f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ACBPWEni7yTPdnWEnC_12Q.png"/></div></div></figure><p id="7e42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，当你点击一个短链接时，你会被重定向到网站，然后到Google Play，最后到应用程序。</p><p id="4923" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它似乎可以工作，但让我们尝试在已经安装了应用程序的设备上打开链接。整个跳转链又会重复一遍——看起来不太好看，直接通过app打开链接就好了。原来这个也可以。</p><p id="bae8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，您需要向应用程序清单添加一个相关的意图过滤器。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/d3466c6f67cc8f595bc7d3d8273cb25a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zW2tXGY5wGM5ytLtiVsBnQ.png"/></div></div></figure><p id="8da5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其次，您需要在onAppOpenAttribution的方法中添加链接处理。这是所有被短链接隐藏的数据进入的地方。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/cb80792ecda0e502e565298561b14599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WY0ATAsfczZNZdT2xpSvkg.png"/></div></div></figure><p id="1afe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为需要服务器的参与，所以在接收数据时也会有延迟，但是与onConversionDataSuccess方法相比，这种延迟并不显著。</p><h1 id="3eed" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">新的用户邀请功能</h1><p id="bcce" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在我们已经准备好实现我们在文章开头谈到的特性。在一个简化的形式中，它看起来像这样:客户端应该创建包含关于客户端的数据的特殊邀请链接。这些数据应该用于新安装的系统，以显示独特的个性化登录屏幕。</p><p id="3f36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过分解，我们得到两个子任务:</p><ol class=""><li id="e352" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">创建和共享邀请链接。</li><li id="7ffb" class="kz la hi is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">安装后处理邀请链接。</li></ol><p id="f26e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们一步一步来。事实上，我们已经拥有了创建邀请链接所需的一切。让我们添加关于共享链接的用户的数据:他的id、姓名和头像。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/c0e1a5238735bc4ffb5815e625f8c83c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mg34BzDLarXQ1ucm_YZypw.png"/></div></div></figure><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/c63d7a5e44c2eb329c30273e1310d7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLGyDPr9O8BVW5p8dOeJIg.png"/></div></div></figure><p id="cf71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">带有分享文本的就绪链接看起来是这样的:点击此链接将https://abpv.onelink.me/nWMv/344e6258 ABPV的Rick_Rick添加为好友<a class="ae kr" href="https://abpv.onelink.me/nWMv/344e6258" rel="noopener ugc nofollow" target="_blank"/>，只剩下传递给分享了。</p><p id="eb8d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，联系汇率变成了自由浮动。任何在点击进入后安装该应用程序的人都将被视为被邀请，并将自动订阅该链接的作者。</p><p id="f288" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在安装后实现支持邀请的第二部分。</p><p id="8998" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们将处理邀请链接添加到方法<em class="ks"> onConversionDataSuccess </em>中。可以通过字段media_source将它们与普通链接区分开。在它的内部，应该有值af_app_invites。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/1330504b05eea9bfe87d5139fa13cbb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XImcqDtLYRGg3dNqPD1TDQ.png"/></div></div></figure><p id="9321" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后将数据传递给主题上的<em class="ks">，邀请屏幕状态根据该主题的值而变化。</em></p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/5b7f7f6508fbc4cb2d8f11f1a0563701.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*803_zdkZJ6kEmCFo"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">最终邀请屏幕</figcaption></figure><h1 id="c0e3" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">摘要</h1><p id="64be" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">所描述的案例非常简单，但可以用来使注册更加个性化，通过正确的方法和受众提高转化率。</p><p id="53fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个例子可以作为进一步开发成熟的推荐系统或发明其他东西的基础。</p><p id="2455" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了安装的短链接和归属，AppsFlyer还提供了许多其他工具，如反欺诈或受众管理，但那是另一回事了。</p></div></div>    
</body>
</html>