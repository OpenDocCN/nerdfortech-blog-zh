<html>
<head>
<title>Build Simple Linear Regression Model With Deployment Using Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flask构建简单的线性回归部署模型</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/simple-linear-regression-with-deployment-using-flask-cafbf85fa96f?source=collection_archive---------5-----------------------#2021-06-01">https://medium.com/nerd-for-tech/simple-linear-regression-with-deployment-using-flask-cafbf85fa96f?source=collection_archive---------5-----------------------#2021-06-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/42eb5177d9845b3fafacc988e7518384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3xS161_cyhyQGEoXIHW91g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">豪伊·梅普森在<a class="ae iu" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9824" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简单线性回归(SLR)是一种统计模型，可用于处理一个因变量和一个或多个因变量之间的关系。这是机器学习中的一种回归算法。就像它的名字“简单”一样，我认为你应该把这个模型作为你ML道路的开始。</p><p id="b9cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我想分享如何制作一个单反模型，然后将其部署到web服务器上。你认为，为什么我们需要部署它？嗯，因为你不能只用你的数据来告诉你的潜在客户。你必须用一个产品告诉他们。也许，这篇文章是你成为数据科学家的良好开端。</p><h1 id="e05c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.模型</h1><p id="2e13" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">首先，我们需要建立一个机器学习模型。这个模型就像我们的大脑一样工作，它处理部署中需要的所有计算。</p><h2 id="ef13" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">导入库</h2><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="2091" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的代码中，我们需要从Python导入一些库。Sklearn用于实现线性回归算法。Matplotlib和seaborn用于可视化数据，pandas和numpy用于处理数据，joblib用于保存已经建立的模型。</p><h2 id="918a" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">构建数据集</h2><p id="2a25" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">好了，让我们建立数据。假设你是一家广告公司的销售人员，该公司的广告租金在10美元到50美元之间。因为，公司已经比较大了，他们通过使用广告服务从老消费者那里得到了关于他/她的收入的数据。所以，让X作为广告价格，Y作为收入。你的任务是预测收入，如果有人租用服务。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="864e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过使用numpy，我们可以创建X和Y的序列，然后使用pandas，我们将X和Y组合成数据帧，并将其保存到变量中。下一次使用。我们展示简单的数据集。输出将是这样的</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/3a7c3f6309d78f111a9365a8c0411adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*BzBBvuvJYKoy46xS-b6Fxw.png"/></div></figure><p id="9e00" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们制作了简单的数据集。事实上，你可以创造任何你感兴趣的东西。</p><h2 id="966c" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">可视化数据</h2><p id="41c9" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">为了提高我们对数据集是如何编程的理解，我选择先将其可视化，如果您愿意，可以跳过这一步。在这一步中，我使用seaborn jointplot来绘制X和Y之间的相关性，代码如下。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="b781" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我用kid='reg ',因为我想用回归方法画一个图。输出是这样的。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/9d23236b053edd23f177fe9d50df0a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*-rREUrRqaSfHzx_Mhq45Pg.png"/></div></figure><p id="1a98" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上图中，你可以看到每个点都用X和y表示。这条线是回归线。所以这个预测，会显示在线条附近。如果你看到我的数据，那里没有异常值，所以它可以更容易地处理它。</p><blockquote class="ls lt lu"><p id="720d" class="iv iw lv ix b iy iz ja jb jc jd je jf lw jh ji jj lx jl jm jn ly jp jq jr js hb bi translated">离群点是离回归线很远的点</p></blockquote><p id="db19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">没有标签的图片，将无法理解。所以让我们在标签上再画一次图。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="5f14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是输出</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/aafb263fd632558fbe48fdfa95aca96c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*R6YWLb9AtegUtBoIUR0JNQ.png"/></div></figure><p id="77f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从图中，我们可以得出结论，广告越贵，消费者得到的报酬(收入)就越多。理解了这个概念之后，我们来做回归模型。</p><h2 id="ae22" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">制作线性回归模型</h2><p id="0f22" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这是我们模型的大脑。我们使用sklearn类LinearRegression()在我们的数据集中实现SLR。我们需要做的第一件事是改变X值的形状，因为这个数组需要是二维的。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h2 id="694d" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">保存模型</h2><p id="487a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">使用joblib.dump将模型保存到你想要的任何地方，这里我将它保存为<code class="du ma mb mc md b">model.sav</code>通常模型会与你的程序保存在同一个目录</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h2 id="1bc8" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">负载模型</h2><p id="aa1f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">要加载模型，您可以使用joblib.load，如果您想要预测您的模型，这将非常有用</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h2 id="444e" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">预测</h2><p id="0923" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">让我们通过X的put值来测试我们的模型</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="c18d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我用笔记本，输出会显示出来，像这样</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es me"><img src="../Images/08248fe8919e1118d03e14c36602f707.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*KJ93QmUcyT_Hdtve9YczAg.png"/></div></figure><p id="3537" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从模型中我们得到Y值187.42，如果X是20。请记住，它可能与您的不同，这取决于我们的数据集。</p><h1 id="2a05" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.部署</h1><p id="3d30" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Flask是连接Python程序和Web应用程序的Python框架之一。在这篇文章中，我不会把重点放在Flask上，但我会试着向你解释它。如果你有任何问题，就问它。</p><h2 id="b406" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">目录结构</h2><p id="6349" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">机器学习最重要的是模型。从第一步开始，记住我们有<code class="du ma mb mc md b">model.sav</code>。将它移动到名为deploy的新目录中，并在deploy目录中创建一个名为<code class="du ma mb mc md b">app.py</code>的Python文件。最后，在deploy中重新创建新目录，命名为web。在web目录中创建一个html文件并保存为<code class="du ma mb mc md b">home.html</code>。</p><pre class="lk ll lm ln fd mf md mg mh aw mi bi"><span id="75c4" class="kw ju hi md b fi mj mk l ml mm">E:\...\deploy<br/>  |<br/>  |-- web<br/>  |    |--home.html<br/>  |<br/>  |-- app.py<br/>  |-- model.sav</span></pre><h2 id="9368" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">烧瓶文件(App.py)</h2><p id="510d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">下面是app.py的代码</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="067c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我想我不会试图向你解释一切，我会让你自己去理解。</p><h2 id="1f15" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">模板文件</h2><p id="a43d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">请记住，我们已经制作了web目录，在目录中我们有一个文件<code class="du ma mb mc md b">home.html</code>。该文件被Flask框架用作路由文件。这是home.html的代码</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h2 id="a609" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">操作程序</h2><p id="7ac9" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">因为，我们使用flask，我们不是从HTML而是从Python运行代码，你可以使用这个命令来运行它</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/86b610a3ad9323b8fca82468b9ab6bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*aXWw0X-myGBDvwsa-2JLUA.png"/></div></figure><p id="1fda" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如你所见，有一个链接<code class="du ma mb mc md b"><a class="ae iu" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:5000/</a></code>，从任何网络浏览器访问它，你将得到这个显示</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/02c92d29388c9711925ce400a129f686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KhnN_U_OQi3OmIuUagxo2w.png"/></div></div></figure><h2 id="262e" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">测试数据</h2><p id="b4d8" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">最后，让我们通过在盒子里放入任何值来测试我们的工作。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/4701b4b4ffb349f65ed806e6a1695c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-uTwdGUVSAnwmExD0zaW6w.gif"/></div></div></figure><h1 id="953b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="a24c" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">恭喜你，你用线性回归完成了你的第一个机器学习项目。你也可以改进它，用你想要的任何东西或者设计更漂亮的网站。我只希望一件事，如果你读到最后</p><blockquote class="ls lt lu"><p id="6680" class="iv iw lv ix b iy iz ja jb jc jd je jf lw jh ji jj lx jl jm jn ly jp jq jr js hb bi translated">只有实践，你才能做某事。</p></blockquote><p id="333d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，请不要只是复制粘贴我的代码，自己写，一个一个理解。是的，这个过程在开始时很可能是缓慢的，但从长远来看，这是值得的</p><p id="490a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢</p><h1 id="9cf7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">源代码</h1><p id="5942" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">实际上，这是我早期的数据科学之旅，我已经公开发表了。这个项目实际上是我180天数据科学的第二天。如果你愿意，你可以跟着去</p><div class="mq mr ez fb ms mt"><a href="https://github.com/theDreamer911/180-days-of-data-science/tree/main/day2" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">911/180天数据科学梦想</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">就像它的名字一样，让我们在新的一年里再见吧——梦想者911/180天的数据科学</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">github.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh io mt"/></div></div></a></div><p id="9537" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个项目的想法是从<a class="ae iu" rel="noopener" href="/@986110101/cara-men-deploy-model-machine-learning-sederhana-menggunakan-flask-a7fc0ac15aad">这里</a></p><p id="2106" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，<br/>祝✌代码愉快</p></div></div>    
</body>
</html>