<html>
<head>
<title>TypeScript — When JavaScript isn’t your type</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">类型脚本——当 JavaScript 不是你喜欢的类型时</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/typescript-when-javascript-isnt-your-type-184f3a270d12?source=collection_archive---------11-----------------------#2021-05-30">https://medium.com/nerd-for-tech/typescript-when-javascript-isnt-your-type-184f3a270d12?source=collection_archive---------11-----------------------#2021-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/45ac40a2c224ffb57000a0c99a2fcf84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aeMmhM6lf2Wyf4LP"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·温克勒在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="3d27" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">什么是 TypeScript？</h2><p id="2165" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">简而言之，TypeScript 就是带有类型的 JavaScript。JavaScript 是一种动态类型语言，正因为如此，运行时的行为无法很好地预测，可能会导致错误。TypeScript 通过其严格的类型检查和赋值来解决这个问题。</p><p id="729f" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">希望这篇文章能让你掌握 TypeScript 的基础知识。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="be42" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">为变量分配类型</h2><p id="d314" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">让我们从最简单的 TypeScript 代码示例开始。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="46be" class="iv iw hi lf b fi lj lk l ll lm">const message:string = "hello world!";<br/>console.log(message);</span></pre><p id="86af" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">在上面的代码中，我们给<em class="ln">常量消息</em>分配了<em class="ln">字符串</em>类型。</p><p id="765d" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">与上面的代码类似，其他类型如<em class="ln">数字、布尔、符号、对象、未定义、never、any、</em>和<em class="ln"> unknown </em>可以赋给 TypeScript 中的变量。</p><p id="9532" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">将类型赋给变量的一般语法是</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="3a59" class="iv iw hi lf b fi lj lk l ll lm">const/let/var varName:type;</span></pre><p id="0e89" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">其工作原理是，如果你试图给<em class="ln">消息分配一个字符串以外的任何东西，</em> TS 将抛出一个错误。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="078f" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">推断类型</h2><p id="ade3" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">你并不总是需要在 TS 中显式地分配类型。有时候还是让 TS 来推断类型比较好。当您完全确定要传递的文字的类型时，这很有帮助。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="d476" class="iv iw hi lf b fi lj lk l ll lm">// TS infers num as a number<br/>const num = 1000;</span><span id="3caf" class="iv iw hi lf b fi lo lk l ll lm">// TS infers toggle as a boolean<br/>const toggle = true;</span><span id="d855" class="iv iw hi lf b fi lo lk l ll lm">// TS infers str as a string<br/>const str = "I am a string";</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="14b7" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">任何的</h2><p id="a8b9" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">TS 中有一个类型叫做 any，它的行为类似于普通的 JS 变量。它可以被赋予任何东西而不用担心类型，尽管这违背了 ts 的全部目的。只有当你完全不知道要分配什么类型的时候，才使用这个。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="be86" class="iv iw hi lf b fi lj lk l ll lm">let anyThing:any = 1000<br/>anyThing = "Hello"<br/>anyThing = true<br/>console.log(anyThing) // true</span></pre><p id="f259" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">上述代码不会抛出任何错误，并且<em class="ln">any</em>的最终值将为<em class="ln"> true。</em></p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="8176" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">类型联合</h2><p id="571d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">当你想让一个变量在两个或多个类型之间灵活转换时，union 就派上了用场。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="9202" class="iv iw hi lf b fi lj lk l ll lm">let strOrNum:string | number;</span><span id="f75a" class="iv iw hi lf b fi lo lk l ll lm">strOrNum = "I am a string"; // correct<br/>console.log(strOrNum) // I am a string</span><span id="a9e9" class="iv iw hi lf b fi lo lk l ll lm">strOrNum = 111; // correct<br/>console.log(strOrNum) // 111</span><span id="cf2f" class="iv iw hi lf b fi lo lk l ll lm">strOrNum = true; // error<br/>console.log(strOrNum) // :(</span></pre><p id="5501" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">在上面的例子中，我们使用一个|(管道操作符)创建了一个联合。通过这种方式，可以将多个类型链接在一起以创建类型的联合。</p><p id="58e2" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">注意，在这个例子中，当你在联合类型之外赋值时，TS 将抛出一个错误。因此，只能将一个<em class="ln">字符串</em>或一个<em class="ln">数字</em>分配给<em class="ln">stronum。</em></p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="3b0e" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">文字类型</h2><p id="6569" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">甚至像字符串、数字等文字类型也可以作为类型赋给变量。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="dc3a" class="iv iw hi lf b fi lj lk l ll lm">let lit:"abc" | "def" | 100;</span><span id="6f17" class="iv iw hi lf b fi lo lk l ll lm">lit = "abc" // correct</span><span id="594d" class="iv iw hi lf b fi lo lk l ll lm">lit = "def" // correct</span><span id="b51a" class="iv iw hi lf b fi lo lk l ll lm">lit = 100 // correct</span><span id="dc66" class="iv iw hi lf b fi lo lk l ll lm">lit = 1000 /* Type '1000' is not assignable to type '"abc" | "def" | 100'. */</span><span id="d018" class="iv iw hi lf b fi lo lk l ll lm">lit = "random" /* Type 'random' is not assignable to type '"abc" | "def" | 100'. */</span></pre><p id="667f" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">在上面的例子中，我们定义了一个只能用给定的文字赋值的变量。试图分配任何其他文字将抛出一个错误。当您希望将变量限制在几个值内时，TS 的这一特性非常有用。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="b870" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">键入别名</h2><p id="c7df" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">可以使用关键字<em class="ln"> type 创建类型的类型别名。</em></p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="9d46" class="iv iw hi lf b fi lj lk l ll lm">type CustomUnion = string | number | boolean | undefined;</span><span id="400a" class="iv iw hi lf b fi lo lk l ll lm">let something:CustomUnion;</span><span id="4eb2" class="iv iw hi lf b fi lo lk l ll lm">something = "I am a string"; // correct</span><span id="43bf" class="iv iw hi lf b fi lo lk l ll lm">something = 99; // correct</span><span id="aad4" class="iv iw hi lf b fi lo lk l ll lm">something = false; // correct</span><span id="8709" class="iv iw hi lf b fi lo lk l ll lm">something = undefined; // correct</span><span id="09f1" class="iv iw hi lf b fi lo lk l ll lm">something = [1, 2, 3]; // in-correct</span></pre><p id="3c46" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">另一个对象类型的例子。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="778c" class="iv iw hi lf b fi lj lk l ll lm">type Student = {"firstname":string, "lastname":string}</span><span id="b085" class="iv iw hi lf b fi lo lk l ll lm">// correct<br/>let student1:Student = {<br/>    "firstname": "Johan",<br/>    "lastname": "Liebert",<br/>}</span><span id="797e" class="iv iw hi lf b fi lo lk l ll lm">// incorrect, "prefix" does not exist in type Student<br/>let student2:Student = {<br/>    "prefix": "Mrs."<br/>    "firstname": "Anna",<br/>    "lastname": "Liebert",<br/>}</span><span id="c0c3" class="iv iw hi lf b fi lo lk l ll lm">// incorrect, "lastname" property is required<br/>let student3:Student = {<br/>    "firstname": "Kenzou",<br/>}</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="9623" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">用接口定义类型</h2><p id="9141" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">也可以使用接口创建类型。下面的代码与上面的对象类型代码非常相似，并产生相同的输出</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b520" class="iv iw hi lf b fi lj lk l ll lm">interface Student {<br/>    "firstname":string, <br/>    "lastname":string<br/>}</span><span id="dbf6" class="iv iw hi lf b fi lo lk l ll lm">// correct<br/>let student1:Student = {<br/>    "firstname": "Johan",<br/>    "lastname": "Liebert",<br/>}</span><span id="661e" class="iv iw hi lf b fi lo lk l ll lm">// incorrect, "prefix" does not exist in type Student<br/>let student2:Student = {<br/>    "prefix": "Mrs."<br/>    "firstname": "Anna",<br/>    "lastname": "Liebert",<br/>}</span><span id="19fd" class="iv iw hi lf b fi lo lk l ll lm">// incorrect, "lastname" property is required<br/>let student3:Student = {<br/>    "firstname": "Kenzou",<br/>}</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="7811" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">函数中的类型</h2><p id="3667" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">函数中的参数也可以使用前面看到的语法在 TS 中赋值。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="1eec" class="iv iw hi lf b fi lj lk l ll lm">// expects two numbers<br/>function addNums(num1:number, num2:number) {<br/>    console.log(num1 + num2);<br/>}</span><span id="88b3" class="iv iw hi lf b fi lo lk l ll lm">// correct<br/>addNums(10, 20)</span><span id="5c13" class="iv iw hi lf b fi lo lk l ll lm">// in-correct<br/>addNums(10, "20")</span><span id="d2c9" class="iv iw hi lf b fi lo lk l ll lm">// in-correct<br/>addNums("10")</span><span id="4837" class="iv iw hi lf b fi lo lk l ll lm">// in-correct<br/>addNums("10", 20n)</span></pre><p id="fbe6" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">类似地，返回类型也可以分配给函数。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="18ca" class="iv iw hi lf b fi lj lk l ll lm">// can only return a string<br/>function concatAndUpper(s1:string, s2:string):string {<br/>    s1 += s2;<br/>    return s1.toUpperCase();<br/>}</span><span id="4439" class="iv iw hi lf b fi lo lk l ll lm">// error, expected to return string but returned number<br/>function concatAndUpper(s1:string, s2:string):string {<br/>    s1 += s2;<br/>    return 100;<br/>}</span></pre><p id="3edf" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">然而回调有一点不同的语法，回调的类型是用箭头语法指定的。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="e410" class="iv iw hi lf b fi lj lk l ll lm">function funInFun(<br/>  // defining types and return type for callback<br/>  callback:(n1: number, n2: number) =&gt; number, <br/>  other: any<br/>):number {<br/>    return callback(10, 20);<br/>}</span><span id="4007" class="iv iw hi lf b fi lo lk l ll lm">function callback(n1: number, n2:number) {<br/>    return n1 + n2<br/>}</span><span id="679f" class="iv iw hi lf b fi lo lk l ll lm">console.log(funInFun(callback, "dummy"))</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="4e2a" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">通用函数</h2><p id="bc88" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">有时，如果你知道函数中变量之间的关系，你可以给它们分配泛型类型。</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="b2e2" class="iv iw hi lf b fi lj lk l ll lm">/* "Type" is just a placeholder, any name can be used instead of Type */<br/>function fun&lt;Type&gt;(arrOrString: Type[]|Type, index: number): Type {<br/>    return arrOrString[index]<br/>}</span><span id="f85c" class="iv iw hi lf b fi lo lk l ll lm">/* we pass the actual value of "Type" with the function call */ console.log(fun&lt;number&gt;([2, 4, 6, 8], 2))</span><span id="4b0d" class="iv iw hi lf b fi lo lk l ll lm">/* same as above but passing <em class="ln">string</em> as a type this time */<br/>console.log(fun&lt;string&gt;("StrString", 4))</span></pre><p id="53f8" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">这种语法在创建数组、地图等对象时会经常出现</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="0b5b" class="iv iw hi lf b fi lj lk l ll lm">// only takes numeric values<br/>const arr = new Array&lt;number&gt;();</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="4a78" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">缩小</h2><p id="de09" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">有时，根据变量的类型对变量执行一些操作变得很重要。幸运的是，TS/JS 有<em class="ln"> typeof </em>操作符来检查变量的类型。</p><p id="4e9c" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">现在，缩小基本上是使用的<em class="ln">类型通过排除过滤掉类型</em></p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="6b71" class="iv iw hi lf b fi lj lk l ll lm">/* takes a string, number, number array or undefined */<br/>function fun(x: string | number | number[] | undefined) {<br/>    if(typeof x === 'string') {<br/>        x.toUpperCase();<br/>    }<br/>    else if(typeof x === 'number') {<br/>        x = 10 * x<br/>    }<br/>    else if(typeof x === 'number[]') {<br/>        x[0] = x[0] + x[1]<br/>    }<br/>    else {<br/>        console.log("undefined :(")<br/>    }<br/>}</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="1457" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">这是所有的乡亲。以上是让您开始使用 TypeScript 的介绍。如果您想阅读更多关于 TS 的深入信息，请阅读 TS 文档，下一期再见。</p></div></div>    
</body>
</html>