<html>
<head>
<title>Beginner's Guide to Pandas DataFrame Cleaning.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据框清洁初学者指南。</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/beginners-guide-to-pandas-dataframe-cleaning-8712a6e3e63a?source=collection_archive---------10-----------------------#2021-06-24">https://medium.com/nerd-for-tech/beginners-guide-to-pandas-dataframe-cleaning-8712a6e3e63a?source=collection_archive---------10-----------------------#2021-06-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7cc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第 1 部分:从我的宝宝的睡眠跟踪应用程序中清理一个. csv 文件。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/c4231456c72f1ea3136a2b01d1af621f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4jWcxTcH8_vIlMYWJ59DPQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@ltmonster?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">徐世洋</a>在<a class="ae jt" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d2fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了带着新生儿熬过一天，每个新父母的目标都是晚上能够再次入睡。优选地，一次超过两小时。</p><p id="f4e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我丈夫和我使用一个应用程序来跟踪从睡眠、食物到便便的一切，因为缺乏睡眠更容易忘记她上次吃饭的时间。</p><p id="effd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用的应用程序允许我将数据下载到一个. csv 文件中。在这篇文章中，我将使用 Pandas 展示一些基本的组织和数据清理功能，这些功能总会派上用场。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h2 id="20bb" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">导入库和创建数据框架</h2><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="bfed" class="kb kc hi kx b fi lb lc l ld le">#importing libraries we will use</span><span id="d920" class="kb kc hi kx b fi lf lc l ld le">import numpy as np<br/>import pandas as pd<br/>from datetime import time</span><span id="e1ce" class="kb kc hi kx b fi lf lc l ld le">#The app I used allowed me to download the data into a csv file<br/>#open the file into a dataframe and named it df</span><span id="00d1" class="kb kc hi kx b fi lf lc l ld le">df = pd.read_csv('Evie_sleep.csv')<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/ecfa640ffc634563440297b7539cdc24.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*hjo1qBAlwzaMcMEJU0tZ3g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据帧导入后的外观。</figcaption></figure><p id="a2d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入数据帧后，我开始思考我希望它是什么样子，以及我需要做哪些更改。</p><ol class=""><li id="695f" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">首先,“时间”列包含日期和时间，因此我们将把该列分成两个单独的列。</li><li id="990f" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">睡觉的时间是以分钟为单位的，我宁愿以小时为单位。</li><li id="30cf" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">去掉‘注意’和‘宝宝’之类不必要的栏目(我知道我宝宝的名字 lol)。</li></ol><h2 id="61da" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">删除列和行</h2><p id="cf91" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">放下一个有熊猫的专栏。可以使用 drop()函数。还有一些其他部分需要添加到代码中。</p><p id="7e82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分解代码:在穿刺中，您将添加要删除的列的名称。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="8f50" class="kb kc hi kx b fi lb lc l ld le">df.drop(['baby', 'note'], axis=1, inplace=True)<br/>df</span></pre><p id="2ebf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ma mb mc kx b">axis=1</code>告诉 python 这是一个将被删除的列。</p><p id="46d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ma mb mc kx b">inplace=True</code>选项更新数据帧。</p><p id="61fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果未选择 True，则默认为<code class="du ma mb mc kx b">inplace=False</code>。它返回对象的一个副本。关于更详细的解释，我推荐这篇<a class="ae jt" href="https://jman4190.medium.com/explaining-the-inplace-parameter-for-beginners-5de7ffa18d2e" rel="noopener">文章</a>:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/b7319ea4698fd96f89a1a69d5abd2dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*MZ8sZ68DuoSc_HgV8GRPkw.png"/></div></figure><p id="6df2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">放下婴儿和注释栏后，我们只剩下日期和分钟。接下来，我们将拆分日期列。</p><h2 id="a311" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">拆分列</h2><p id="f186" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">日期栏在同一栏中有日期和就寝时间，我希望它们分开。</p><p id="2e3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我创建了一个名为<code class="du ma mb mc kx b">df_split</code>的变量，这样以后更容易连接到数据帧。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="5729" class="kb kc hi kx b fi lb lc l ld le">df_split= df['date'].str.split(",", expand=True)<br/>df_split</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/47e126d6a45adce334f2e6c8a57efe0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*uZ_Sx9JkAG3yJh5sN_zXBg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">日期列拆分。</figcaption></figure><p id="09f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在日期列变成了两个独立的列，一个表示日期，另一个表示就寝时间。</p><h2 id="13a4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">命名列</h2><p id="a95b" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">让我们通过在变量中使用<code class="du ma mb mc kx b">.columns</code>来添加列名，这是一种简单的更改名称的方法。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="a768" class="kb kc hi kx b fi lb lc l ld le">df_split.columns = ['Date', 'Time']<br/>df_split</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/92690df8c9dc0a27de9aa1d59f3fccc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*0oyzSMzJ3YtGIpRu7KjwHg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">列现在有了名称。</figcaption></figure><h2 id="3108" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">使用 Concatenate 合并数据帧</h2><p id="fe18" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">我们准备使用<code class="du ma mb mc kx b">pd.concat</code>来组合数据帧，以进行更改。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="1f7c" class="kb kc hi kx b fi lb lc l ld le">df2 = pd.concat([df_split, df], axis=1)<br/>df2</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/43eaa0a4e0c748ca3dda8a300b711349.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*yLoL436fyN49jD3VNNchBQ.png"/></div></figure><p id="fc3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将使用删除旧的“日期”列。丢弃()。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/654572326db7f29a30c41dfc010a9228.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*GnYx0Bsu-KJQux3t19i5SQ.png"/></div></figure><p id="1b08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后要做的修改是把分钟变成小时，以便于阅读。</p><h2 id="727d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">时间—几分钟到几小时</h2><p id="f63b" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">对于熊猫，有几种方法可以改变约会时间。对于其他的方法，这篇文章详细介绍了不同的方法。</p><p id="7f97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了将分钟转换成小时，我选择用最少的代码来完成。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="3d5b" class="kb kc hi kx b fi lb lc l ld le">hours = pd.to_datetime(df2.minutes, unit='m').dt.strftime('%H:%M')<br/>hours</span></pre><p id="f336" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有我们正在使用的 df 和被调用的列。</p><p id="ee6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ma mb mc kx b">(unit='m)</code>表示当前时间以分钟为单位。</p><p id="8395" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">剩下的代码:<code class="du ma mb mc kx b">.dt.strftime('%H:%M')</code>输入时间小时和分钟，运行后，结果如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mi"><img src="../Images/17c99a55b7c0a249d6f9c1e2f063cb4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*kS-QnUWtCjthNVkbYACpZg.png"/></div></figure><h2 id="3302" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">将数据添加到现有列中</h2><p id="7bba" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">最后一步是将新的时间格式添加到数据帧中。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="1cdc" class="kb kc hi kx b fi lb lc l ld le">df2.insert(3, 'Hours Slept', hours)</span></pre><p id="9070" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用了方便的<code class="du ma mb mc kx b">insert</code>来添加时间。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="f219" class="kb kc hi kx b fi lb lc l ld le">(3, 'Hours Slept', hours)</span></pre><p id="1425" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">括号中的“3”表示该列的位置。在第三列之后，我想添加“睡眠时间”列，包含数据的变量叫做<code class="du ma mb mc kx b">hours</code>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mj"><img src="../Images/8a276c16382dd12f01980b1dac68f015.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*Vkv4hUuaHyh_03dOT8LfCA.png"/></div></figure><p id="0b31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我也将删除分钟列，因为它是不必要的，看看新的 df。</p><pre class="je jf jg jh fd kw kx ky kz aw la bi"><span id="3dc9" class="kb kc hi kx b fi lb lc l ld le">df2.drop(['minutes'], axis=1, inplace=True)<br/>df2</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/8a8d00d74b8de3d9b90d9d35bb6e1ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*q4JXFIB5zLb5iDhnWD2FYQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终数据帧</figcaption></figure><p id="37b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们完事了。数据帧被格式化并准备好用于创建一些可视化。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h2 id="8b57" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">摘要</h2><p id="74ec" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">我想把一些使用熊猫的最有用的数据框清理方法的参考放在一起，希望这个指南是有帮助的。请随意分享任何其他对你有效的方法；我很乐意学习其他方法。</p><h2 id="28c0" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">资源</h2><div class="ml mm ez fb mn mo"><a href="https://towardsdatascience.com/sorting-data-frames-in-pandas-a5a3af6f346a" rel="noopener follow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">对熊猫中的数据框进行排序</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">如何快速有效地排序数据帧</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc jn mo"/></div></div></a></div><div class="ml mm ez fb mn mo"><a href="https://towardsdatascience.com/4-methods-for-adding-columns-to-pandas-dataframes-dd0696863c16" rel="noopener follow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">向 Pandas 数据框架添加列的 4 种方法</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">举例说明</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="nd l mz na nb mx nc jn mo"/></div></div></a></div><p id="0b6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://towardsdatascience.com/working-with-datetime-in-pandas-dataframe-663f7af6c587" rel="noopener" target="_blank">https://towards data science . com/working-with-datetime-in-pandas-data frame-663 f 7 a F6 c 587</a></p></div></div>    
</body>
</html>