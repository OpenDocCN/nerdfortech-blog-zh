<html>
<head>
<title>How to create a custom Autocomplete Entity Field Widget using the Drupal 8 Form API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Drupal 8 表单 API 创建定制的自动完成实体字段小部件</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-create-a-custom-autocomplete-entity-field-widget-using-the-drupal-8-form-api-5593032d1920?source=collection_archive---------2-----------------------#2021-02-19">https://medium.com/nerd-for-tech/how-to-create-a-custom-autocomplete-entity-field-widget-using-the-drupal-8-form-api-5593032d1920?source=collection_archive---------2-----------------------#2021-02-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a7b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我<strong class="ih hj">不会解释</strong> <a class="ae jd" href="https://wengerk.medium.com/how-to-create-a-custom-autocomplete-using-the-drupal-8-form-api-dd64d2eccbed" rel="noopener">如何<strong class="ih hj">使用 Drupal 8 表单 API </strong> </a>创建一个定制的自动完成功能——它应该只在使用 Drupal Admin UI 的定制表单上使用。</p><p id="8ed3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我将尝试向您展示一个<strong class="ih hj">分步</strong>指南，解释如何使用 Drupal 8 Form API 核心特性创建一个定制的自动完成字段小部件<strong class="ih hj">——一个只能在 Drupal Admin UI 表单中使用的自动完成部件(节点、分类法等等)。</strong></p><p id="7884" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程可能在以下情况下对您有所帮助:创建一个<strong class="ih hj">自定义 Drupal 实体字段小部件 Autocomplete </strong>,它从 Drupal 外部获取数据(例如从 API ),但仍然将最终数据存储和显示到 Drupal 实体中。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/8a642fcff157953fa8ff7929a8b7bcf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPXWnOM-Y1q2lDm1YFgBQw.jpeg"/></div></div></figure><p id="ff22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你正在寻找解释如何实现视图来改变自动完成字段的资源，请参考这个优秀的指南。</p><p id="0391" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，如果你正在寻找解释如何创建可以在你自己的 Drupal 前端应用程序中使用的自动完成的资源，请参考我之前的博客文章。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jq"><img src="../Images/f26fd9b56025c15a80c567ccf6211b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/1*iglSatg6MORFea3pn9WbkA.gif"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">这就是你在这个故事的结尾能够实现的目标</figcaption></figure><blockquote class="jv jw jx"><p id="9783" class="if ig jy ih b ii ij ik il im in io ip jz ir is it ka iv iw ix kb iz ja jb jc hb bi translated">真理只能在一个地方找到:代码</p></blockquote></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><p id="f015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">前几天，我被要求为一个项目中的节点创建一个<strong class="ih hj">定制自动完成字段，它应该从一个定制 RESTfull 端点获取数据。</strong></p><p id="2cfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看我是如何做到的。</p><p id="c853" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哦，出于安全原因，我将用<a class="ae jd" href="https://swapi.dev/" rel="noopener ugc nofollow" target="_blank">https://swapi.dev/</a>替换原来的 restful 端点——一个星球大战 RESTfull API。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kj"><img src="../Images/a18e90f883ff3ab989389e5c3a11aab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*NpvZDysXoffa7qZhYkpbmg.gif"/></div></figure></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="16ee" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">步骤 1-自定义自动完成字段类型</h1><p id="37f8" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">字段类型将定义我们的数据存储在数据库中的方式。</p><pre class="jf jg jh ji fd ln lo lp lq aw lr bi"><span id="32ab" class="ls kl hi lo b fi lt lu l lv lw"><em class="jy">&lt;?php<br/><br/>namespace </em>Drupal\swapi\Plugin\Field\FieldType;<br/><br/><em class="jy">use </em>Drupal\Core\Field\FieldItemBase;<br/><em class="jy">use </em>Drupal\Core\Field\FieldStorageDefinitionInterface;<br/><em class="jy">use </em>Drupal\Core\TypedData\DataDefinition;<br/><br/><em class="jy">/**<br/> * Provides a field type to store Star Wars people.<br/> *<br/> * </em><strong class="lo hj"><em class="jy">@FieldType</em></strong><em class="jy">(<br/> *     id="swapi_people",<br/> *     label=</em><strong class="lo hj"><em class="jy">@Translation</em></strong><em class="jy">("Star Wars - People"),<br/> *     module="swapi",<br/> *     description=</em><strong class="lo hj"><em class="jy">@Translation</em></strong><em class="jy">("Autocomplete field to search for Star Wars people through swapi.dev."),<br/> *     default_widget="swapi_people_default",<br/> *     default_formatter="swapi_people_default"<br/> * )<br/> */<br/>class </em>PeopleItem <em class="jy">extends </em>FieldItemBase {<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public function </em>isEmpty() {<br/>    <em class="jy">return empty</em>($this-&gt;swid) || <em class="jy">empty</em>($this-&gt;fullname);<br/>  }<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public static function </em>propertyDefinitions(FieldStorageDefinitionInterface $field_definition) {<br/>    $properties = [];<br/><br/>    $properties['swid'] = DataDefinition::<em class="jy">create</em>('integer')<br/>      -&gt;setLabel(t('Star Wards Identifier')-&gt;__toString());<br/><br/>    $properties['fullname'] = DataDefinition::<em class="jy">create</em>('string')<br/>      -&gt;setLabel(t('Fullname')-&gt;__toString());<br/><br/>    <em class="jy">return </em>$properties;<br/>  }<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public static function </em>schema(FieldStorageDefinitionInterface $field_definition) {<br/>    <em class="jy">return </em>[<br/>      <em class="jy">// Columns contains the values that the field will store.<br/>      </em>'columns' =&gt; [<br/>        'swid' =&gt; [<br/>          'type' =&gt; 'int',<br/>          'not null' =&gt; <em class="jy">FALSE</em>,<br/>        ],<br/>        'fullname' =&gt; [<br/>          'type' =&gt; 'text',<br/>          'size' =&gt; 'tiny',<br/>          'not null' =&gt; <em class="jy">FALSE</em>,<br/>        ],<br/>      ],<br/>    ];<br/>  }<br/><br/>}</span></pre><h1 id="ea75" class="kk kl hi bd km kn lx kp kq kr ly kt ku kv lz kx ky kz ma lb lc ld mb lf lg lh bi translated">步骤 2—自定义自动完成字段小部件</h1><p id="beed" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">FieldWidget 将定义表单元素的外观以及数据在保存前的处理方式。</p><p id="f19e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">乍一看，您可能会对使用<code class="du mc md me lo b">#entity_autocomplete</code>字段类型感兴趣——这似乎正是您所需要的。可惜，这不是。事实上，<code class="du mc md me lo b">#entity_autocomplete</code>不允许你进行任何定制。</p><p id="da2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，你需要老人的<code class="du mc md me lo b">#textfield</code>和他的表亲属性<code class="du mc md me lo b">#autocomplete_route_name</code></p><pre class="jf jg jh ji fd ln lo lp lq aw lr bi"><span id="f393" class="ls kl hi lo b fi lt lu l lv lw"><em class="jy">&lt;?php<br/><br/>namespace </em>Drupal\swapi\Plugin\Field\FieldWidget;<br/><br/><em class="jy">use </em>Drupal\Core\Entity\Element\EntityAutocomplete;<br/><em class="jy">use </em>Drupal\Core\Field\FieldItemListInterface;<br/><em class="jy">use </em>Drupal\Core\Field\WidgetBase;<br/><em class="jy">use </em>Drupal\Core\Form\FormStateInterface;<br/><br/><em class="jy">/**<br/> * Plugin implementation of the 'swapi_people_default' widget.<br/> *<br/> * </em><strong class="lo hj"><em class="jy">@FieldWidget</em></strong><em class="jy">(<br/> *     id="swapi_people_default",<br/> *     module="swapi",<br/> *     label=</em><strong class="lo hj"><em class="jy">@Translation</em></strong><em class="jy">("Default"),<br/> *     field_types={<br/> *         "swapi_people"<br/> *     }<br/> * )<br/> */<br/>class </em>PeopleDefaultWidget <em class="jy">extends </em>WidgetBase {<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public function </em>formElement(FieldItemListInterface $items, $delta, <em class="jy">array </em>$element, <em class="jy">array </em>&amp;$form, FormStateInterface $form_state) {<br/>    $default_value = <em class="jy">NULL</em>;<br/><br/>    <em class="jy">// Build a "label (swid)' value that can be parse for storage.<br/>    if </em>(!<em class="jy">empty</em>($items[$delta]-&gt;swid)) {<br/>      $default_value = <em class="jy">sprintf</em>('%s (%d)', $items[$delta]-&gt;fullname, $items[$delta]-&gt;swid);<br/>    }<br/><br/>    $element['data'] = [<br/>      '#title' =&gt; $this-&gt;t('Star Wars People'),<br/>      '#type' =&gt; 'textfield',<br/>      '#autocomplete_route_name' =&gt; 'swapi.people.autocomplete',<br/>      '#autocomplete_route_parameters' =&gt; [],<br/>      '#placeholder' =&gt; t('Darth Vader'),<br/>      '#default_value' =&gt; $default_value,<br/>      '#element_validate' =&gt; [<br/>        [<em class="jy">static</em>::<em class="jy">class</em>, 'validate'],<br/>      ],<br/>    ];<br/><br/>    <em class="jy">return </em>$element;<br/>  }<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public function </em>massageFormValues(<em class="jy">array </em>$values, <em class="jy">array </em>$form, FormStateInterface $form_state) {<br/>    $item = <em class="jy">NULL</em>;<br/><br/>    <em class="jy">foreach </em>($values <em class="jy">as </em>$delta =&gt; &amp;$item) {<br/>      $item['delta'] = $delta;<br/><br/>      <em class="jy">// Take "label (entity id)', match the ID from inside the parentheses.<br/>      // @see \Drupal\Core\Entity\Element\EntityAutocomplete::extractEntityIdFromAutocompleteInput<br/>      if </em>(<em class="jy">preg_match</em>('/(.+\\s)\\(([^\\)]+)\\)/', $item['data'], $matches)) {<br/>        $item['fullname'] = <em class="jy">trim</em>($matches[1]);<br/>        $item['swid'] = <em class="jy">trim</em>($matches[2]);<br/>      }<br/>    }<br/><br/>    <em class="jy">return </em>$values;<br/>  }<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public static function </em>validate($element, FormStateInterface $form_state) {<br/>    $value = $element['#value'];<br/>    $id = EntityAutocomplete::<em class="jy">extractEntityIdFromAutocompleteInput</em>($value);<br/><br/>    <em class="jy">if </em>(<em class="jy">empty</em>($id)) {<br/>      $form_state-&gt;setValueForElement($element, '');<br/><br/>      <em class="jy">return</em>;<br/>    }<br/><br/>    $response = \Drupal::<em class="jy">httpClient</em>()-&gt;get('https://swapi.dev/api/people/' . $id);<br/><br/>    <em class="jy">if </em>($response-&gt;getStatusCode() !== 200) {<br/>      $form_state-&gt;setError($element, t('This Star Wars person does not exists.'));<br/>    }<br/><br/>    $character = <em class="jy">json_decode</em>($response-&gt;getBody()-&gt;getContents(), <em class="jy">TRUE</em>);<br/><br/>    <em class="jy">if </em>(!<em class="jy">isset</em>($character['url'], $character['name'])) {<br/>      $form_state-&gt;setError($element, t('This Star Wars person does not exists.'));<br/>    }<br/>  }<br/><br/>}</span></pre><p id="270e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du mc md me lo b">#autocomplete_route_name</code>属性将允许您定义一个路由来处理自动完成业务逻辑(根据用户输入返回的数据)。</p><p id="55e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你也可以添加<code class="du mc md me lo b">#autocomplete_route_parameters</code>属性，这个属性可以给你的<code class="du mc md me lo b">#autocomplete_route_name</code>发送一个固定不变的参数，你可以用它来确定返回结果的数量。</p><h1 id="10d5" class="kk kl hi bd km kn lx kp kq kr ly kt ku kv lz kx ky kz ma lb lc ld mb lf lg lh bi translated">步骤 3-定义自动完成路线</h1><p id="29d3" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">现在您知道了如何创建自动完成表单，但是您需要一个路径来管理获取数据并返回数据的逻辑。<br/>如何？只需将对路线的引用(数据将从该处检索)添加到您的<em class="jy"> swapi.routing.yml </em>文件中:</p><pre class="jf jg jh ji fd ln lo lp lq aw lr bi"><span id="1ebf" class="ls kl hi lo b fi lt lu l lv lw">swapi.people.autocomplete:<br/>  path: '/admin/swapi/people/autocomplete'<br/>  defaults:<br/>    _controller: '\Drupal\swapi\Controller\PeopleAutocompleteController::handleAutocomplete'<br/>  requirements:<br/>    _permission: 'administer content types'</span></pre><p id="64bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意在之前的<code class="du mc md me lo b">#autocomplete_route_name</code>中使用相同的路线名称(此处为<code class="du mc md me lo b">swapi.people.autocomplete</code>)。<br/>还有，一定要根据自己的需要更改权限。</p><h1 id="3c2b" class="kk kl hi bd km kn lx kp kq kr ly kt ku kv lz kx ky kz ma lb lc ld mb lf lg lh bi translated">步骤 4—添加控制器，获取 API 并返回 JSON 响应</h1><p id="923c" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">现在有了路由和表单，您必须用<code class="du mc md me lo b">handleAutocomplete</code>方法定义您的定制控制器。<br/>嗯，正是这种方法确保了一旦 Drupal 请求，就能收集到适当的数据并进行适当的格式化。</p><p id="5691" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们更深入地研究一下，看看如何精确地处理我们的<code class="du mc md me lo b">textfield</code>元素的特定 JSON 响应。</p><ol class=""><li id="5616" class="mf mg hi ih b ii ij im in iq mh iu mi iy mj jc mk ml mm mn bi translated">在<em class="jy">swapi/src/Controller/people autocomplete Controller . PHP</em>下设置一个<code class="du mc md me lo b">PeopleAutcompleteController</code>类文件；</li><li id="514b" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">然后，扩展<code class="du mc md me lo b">ControllerBase</code>类并设置你的句柄方法(在我们的例子中<code class="du mc md me lo b">::handleAutocomplete</code>见<code class="du mc md me lo b">swapi.routing.yml</code>)；</li></ol><pre class="jf jg jh ji fd ln lo lp lq aw lr bi"><span id="823c" class="ls kl hi lo b fi lt lu l lv lw"><em class="jy">&lt;?php<br/><br/>namespace </em>Drupal\swapi\Controller;<br/><br/><em class="jy">use </em>Drupal\Component\Utility\Xss;<br/><em class="jy">use </em>Drupal\Core\Controller\ControllerBase;<br/><em class="jy">use </em>GuzzleHttp\ClientInterface;<br/><em class="jy">use </em>Symfony\Component\DependencyInjection\ContainerInterface;<br/><em class="jy">use </em>Symfony\Component\HttpFoundation\JsonResponse;<br/><em class="jy">use </em>Symfony\Component\HttpFoundation\Request;<br/><br/><em class="jy">/**<br/> * Defines a route controller for SWAPI People autocomplete form elements.<br/> *<br/> * </em><strong class="lo hj"><em class="jy">@see </em></strong><em class="jy">\Drupal\swapi\Plugin\Field\FieldWidgetPeopleWidget<br/> */<br/>class </em>PeopleAutocompleteController <em class="jy">extends </em>ControllerBase {<br/>  <em class="jy">/**<br/>   * The HTTP client to fetch the feed data with.<br/>   *<br/>   * </em><strong class="lo hj"><em class="jy">@var </em></strong><em class="jy">\GuzzleHttp\ClientInterface<br/>   */<br/>  protected </em>$httpClient;<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public function </em>__construct(ClientInterface $http_client) {<br/>    $this-&gt;httpClient = $http_client;<br/>  }<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public static function </em>create(ContainerInterface $container) {<br/>    <em class="jy">return new static</em>(<br/>      $container-&gt;get('http_client')<br/>    );<br/>  }<br/><br/>  <em class="jy">/**<br/>   * Handler for autocomplete request.<br/>   */<br/>  public function </em>handleAutocomplete(Request $request) {<br/>    $results = [];<br/>    $input = $request-&gt;query-&gt;get('q');<br/><br/>    <em class="jy">if </em>(!$input) {<br/>      <em class="jy">return new </em>JsonResponse($results);<br/>    }<br/><br/>    $input = Xss::<em class="jy">filter</em>($input);<br/>    $response = $this-&gt;httpClient-&gt;get('https://swapi.dev/api/people/?search=' . $input);<br/><br/>    <em class="jy">if </em>($response-&gt;getStatusCode() !== 200) {<br/>      <em class="jy">return new </em>JsonResponse($results);<br/>    }<br/><br/>    $response = <em class="jy">json_decode</em>($response-&gt;getBody()-&gt;getContents(), <em class="jy">TRUE</em>);<br/><br/>    <em class="jy">foreach </em>($response['results'] <em class="jy">as </em>$person) {<br/><br/>      <em class="jy">// Skip malformed.<br/>      if </em>(!<em class="jy">isset</em>($person['url'], $person['name'])) {<br/>        <em class="jy">continue</em>;<br/>      }<br/><br/>      <em class="jy">// Take id from URL of SWAPI people.<br/>      preg_match</em>('#^https?://swapi\\.dev/api/people/(\\d+)#', $person['url'], $matches);<br/><br/>      <em class="jy">// Skip when id not extractable from URL of swapi.<br/>      if </em>(!<em class="jy">isset</em>($matches[1])) {<br/>        <em class="jy">continue</em>;<br/>      }<br/><br/>      $results[] = [<br/>        'value' =&gt; <em class="jy">sprintf</em>('%s (%d)', $person['name'], $matches[1]),<br/>        'label' =&gt; <em class="jy">sprintf</em>('%s (%d)', $person['name'], $matches[1]),<br/>      ];<br/>    }<br/><br/>    <em class="jy">return new </em>JsonResponse($results);<br/>  }<br/><br/>}</span></pre><h1 id="7ada" class="kk kl hi bd km kn lx kp kq kr ly kt ku kv lz kx ky kz ma lb lc ld mb lf lg lh bi translated">步骤 5—自定义自动完成字段格式化程序</h1><p id="f139" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">FieldFormatter 定义数据在前端显示的方式。</p><pre class="jf jg jh ji fd ln lo lp lq aw lr bi"><span id="428a" class="ls kl hi lo b fi lt lu l lv lw"><em class="jy">&lt;?php<br/><br/>namespace </em>Drupal\swapi\Plugin\Field\FieldFormatter;<br/><br/><em class="jy">use </em>Drupal\Core\Field\FieldItemListInterface;<br/><em class="jy">use </em>Drupal\Core\Field\FormatterBase;<br/><br/><em class="jy">/**<br/> * Plugin implementation of the 'contact_default' formatter.<br/> *<br/> * </em><strong class="lo hj"><em class="jy">@FieldFormatter</em></strong><em class="jy">(<br/> *     id="swapi_people_default",<br/> *     label=</em><strong class="lo hj"><em class="jy">@Translation</em></strong><em class="jy">("Default"),<br/> *     field_types={<br/> *         "swapi_people"<br/> *     }<br/> * )<br/> */<br/>class </em>PeopleDefaultFieldFormatter <em class="jy">extends </em>FormatterBase {<br/><br/>  <em class="jy">/**<br/>   * {</em><strong class="lo hj"><em class="jy">@inheritdoc</em></strong><em class="jy">}<br/>   */<br/>  public function </em>viewElements(FieldItemListInterface $items, $langcode) {<br/>    $element = [];<br/><br/>    <em class="jy">foreach </em>($items <em class="jy">as </em>$delta =&gt; $item) {<br/>      <em class="jy">// Render each element as markup.<br/>      </em>$element[$delta] = ['#markup' =&gt; $item-&gt;fullname];<br/>    }<br/><br/>    <em class="jy">return </em>$element;<br/>  }<br/><br/>}</span></pre></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><p id="b86e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这差不多就是<strong class="ih hj">你需要</strong>基于 Drupal 8 的文本字段自动完成的所有技巧。</p></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="b85b" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">来源</h1><p id="9cf7" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">本文首次为瑞士洛桑的反静电网络机构的博客撰写。一个我作为全栈 Web 开发人员工作的地方。请随意在这里阅读或在那里查看:<a class="ae jd" href="https://antistatique.net/fr/node/682" rel="noopener ugc nofollow" target="_blank">https://antistatique.net/en/node/682</a></p><p id="84f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检索我的 Gist 上的所有代码:<a class="ae jd" href="https://gist.github.com/WengerK/8360688d57567b60e2ce28c8c5184d01" rel="noopener ugc nofollow" target="_blank">https://Gist . github . com/WengerK/8360688d 57567 b 60 e 2e ce 28 c8 c 5184d 01</a></p><p id="8ff1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于大多数好奇的人来说，这里有一些启发了本文创作的额外信息来源。</p><p id="3b32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Purushotam Rai(2016 年 11 月 24 日)。用自定义回调在 Drupal 8 中实现# autocomplete【https://www.qed42.com/blog/autocom...上的<a class="ae jd" href="https://www.qed42.com/blog/autocomplete-drupal-8" rel="noopener ugc nofollow" target="_blank">参见<br/></a></p><p id="308f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">Stijn Berkers</strong>(2018 年 2 月 28 日)。如何在 drupal 8 中生成一个自定义的自动完成字段<br/>参见 https://lucius.digital/en/blog/drupal...<a class="ae jd" href="https://www.lucius.digital/en/blog/drupal-module-conditional-redirect-released-on-drupal-org" rel="noopener ugc nofollow" target="_blank">上的</a></p><p id="0a0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">让我活着</strong>(2014 年 5 月 4 日)。为文本字段添加自动完成功能<br/>请参见 https://drupal.stackexchange.com/.../..<a class="ae jd" href="https://drupal.stackexchange.com/questions/200038/adding-autocomplete-for-text-field" rel="noopener ugc nofollow" target="_blank">上的</a></p><p id="5a5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">Stijn Berkers</strong>(2018 年 7 月 18 日)。如何在 drupal 8 中为文本字段添加自动完成功能:定义自定义路线<br/>参见 https://www.optasy.com/blog/how-add-autocom...的<a class="ae jd" href="https://www.optasy.com/blog/how-add-autocomplete-text-fields-drupal-8-defining-custom-route" rel="noopener ugc nofollow" target="_blank">上的</a></p></div></div>    
</body>
</html>