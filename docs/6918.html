<html>
<head>
<title>Endups: Architecting for Death</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Endups:为死亡而设计</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/endups-architecting-for-death-d34c1f9ec039?source=collection_archive---------6-----------------------#2022-06-16">https://medium.com/nerd-for-tech/endups-architecting-for-death-d34c1f9ec039?source=collection_archive---------6-----------------------#2022-06-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="8314" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">散文中的系统架构</h2><div class=""/><div class=""><h2 id="3b3e" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">当创业公司咽下最后一口气时该怎么办…</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/d9d4fbfaaa8267c08ceb833d67e23dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3gY1gdTSnqqWTibdT-ArKA.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">一天纠正两次？</figcaption></figure><p id="db2b" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi ks translated">在我几十年的系统架构生涯中，有很多次，作为最后一名员工，我被赋予了“关灯”的任务，而我可能是公司的首批雇员之一。这可能是一个痛苦的提醒，即使是独角兽也可能最终成为众所周知的死亡技术和失败想法的垃圾场。</p><p id="834a" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">一个这样的故事今天来到我们面前，就像过去圣诞节的幽灵，在我的记忆中晃动着它的锁链。这是一个时机成熟的时候，空气中充满了兴奋。我被邀请为一家脸书游戏公司设计后台。不受时间和空间的限制，我立即投入到这项任务中，并立即从布鲁克林搬到了东湾。一段时间过去了，我设计了一个非常好的系统，不需要雇佣任何其他人。我利用<a class="ae lb" href="https://www.flexera.com/about-us/press-center/flexera-acquires-top-multi-cloud-management-provider-rightscale" rel="noopener ugc nofollow" target="_blank"> Rightscale(现在的 Flexera) </a>构建了这个系统，能够独自管理超过 250 台服务器，拥有数百万并发用户。自定义监控数据进入 Zabbix，而<a class="ae lb" href="https://www.flexera.com/about-us/press-center/flexera-acquires-top-multi-cloud-management-provider-rightscale" rel="noopener ugc nofollow" target="_blank"> Rightscale </a>通过自定义规则处理自动缩放。Maria db 数据库是前滚恢复的一大亮点，应用服务器位于 haproxy 服务器的后面。部分静态数据从 AWS 的 S3 卸载并提供，其他一切都在 AWS EC2 上运行。</p><p id="9ad3" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我想，也许我的工作做得太好了，因为我也是随叫随到的人。支持者。系统管理员；当然，还有建筑师。当时，我并不在乎。这很令人兴奋，用沃卓斯基的锡安档案馆导师的不朽名言来说，“有一段时间，一切都很好”。</p><p id="b8f1" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">正是在这个时候，脸书改变了局面，导致大多数脸书博彩公司遭受打击。算法的改变，用户再也找不到我们的游戏，游戏也不再有机增长。这影响了整个行业，重创了脸书博彩业。</p><p id="89c3" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">这些变化直接导致了那决定性的一天。每个人都被释放了；我与创始人共进午餐，讨论公司技术资产的安葬安排。今天不是个好日子。在空荡荡的办公室里做最后一名员工感觉很奇怪。这并没有持续很长时间，因为租约很快就终止了，我在家工作来结束一切。</p><p id="6071" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我们仍然有大量的用户。创始人希望保留最后一点数据，所以我们的数据库有数百万亿字节的数据。当时我们使用 TokuDB 来保持数据压缩，我们有相当多的数据库服务器使用各种分片技术。基于这一经历，我在十多年前的<a class="ae lb" href="https://consultent.medium.com/reverse-sharding-unsharding-2a473773287d" rel="noopener">非共享文章</a>中概述了我对我们的数据库采取的一些步骤。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><blockquote class="lj lk ll"><p id="75fb" class="jw jx lm jy b jz ka is kb kc kd iv ke ln kg kh ki lo kk kl km lp ko kp kq kr hb bi translated"><strong class="jy hs">我的指示很明确，一切都靠生命维持系统，只剩下一台服务器的预算。</strong></p></blockquote></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><p id="b2ea" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">我的指示很明确，一切都靠生命维持系统，只剩下一台服务器的预算。所有的东西，我是说所有的东西，都必须在 Softlayer(现在的 IBM)的这台机器上打包。</p><p id="9a11" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">所以我去工作了。尽管热情要低得多(薪酬也是如此)。这是一次令人悲伤和谦卑的经历。带着你所建立的一切。把它浓缩成最基本的东西，塞进一个盒子里，然后钉上钉子。我一如既往地关注这个问题，并提出了一个在我所在行业的另一个领域被广泛使用的东西……虚拟主机。当我四处挖掘，寻找解决方案和廉价主机时，我发现了<a class="ae lb" href="https://lowendbox.com/" rel="noopener ugc nofollow" target="_blank">LowEndBox.com</a>，并注意到一些最便宜的地方正在使用<a class="ae lb" href="https://openvz.org/" rel="noopener ugc nofollow" target="_blank"> OpenVZ </a>提供基于容器的主机。这是在库伯内特之前，在多克之前。但是我了解容器，并且认为 OpenVZ 是解决方案，所以它变成了。</p><p id="8724" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">设法将所有数据库、应用程序、监控和开发服务器打包到一台机器上变得可行。在某种程度上，我甚至能够保留容器的内部自动伸缩，即使现在的限制是机器的物理核心和 ram。</p><p id="fa5e" class="pw-post-body-paragraph jw jx hi jy b jz ka is kb kc kd iv ke kf kg kh ki kj kk kl km kn ko kp kq kr hb bi translated">那天晚上，在和圣诞未来的幽灵好好讨论一番后，我接受了 Rightscale 的一份工作。预订飞往圣巴巴拉的航班时，我最后看了一眼<strong class="jy hs"> <em class="lm"> root# </em> </strong>提示符，在 ssh 会话中最后一次键入<em class="lm"> exit </em>。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><ul class=""><li id="1360" class="lq lr hi jy b jz ka kc kd kf ls kj lt kn lu kr lv lw lx ly bi translated">有些名字、地点和人物是虚构的。一些自由被剥夺了。其他的自由也被赋予了。</li></ul></div></div>    
</body>
</html>