<html>
<head>
<title>A Beginner’s Guide to Generate PDFs with Django - Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Django 生成 pdf 的初学者指南——第 1 部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/a-beginners-guide-to-generate-pdf-s-with-django-part-1-901e258f0f93?source=collection_archive---------3-----------------------#2021-07-17">https://medium.com/nerd-for-tech/a-beginners-guide-to-generate-pdf-s-with-django-part-1-901e258f0f93?source=collection_archive---------3-----------------------#2021-07-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="8995" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">了解如何随时将您的 HTML 代码转换为 PDF。</h2></div><p id="969e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated">最近，我遇到了一种情况，我需要用一些预定义的规则和格式批量打印 Django 数据库记录。然而，我找不到一个涵盖我所寻找的内容的教程。因此，我们在这里，一个整洁的小解决方案，这可能就是你正在寻找的！</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/c26dc9261a8b7c6e1dfd16563800c083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nzeSyoD7twFISw_7"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">照片由<a class="ae ks" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯里德</a>在<a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="d073" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">介绍</h1><p id="9cc1" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">在本教程中，我们将使用<a class="ae ks" href="https://pypi.org/project/xhtml2pdf/" rel="noopener ugc nofollow" target="_blank"> xhtml2pdf </a>，一个基于 Python 的库来快速将 html 代码转换成 pdf。您可以使用以下命令从 PyPi 安装这个包</p><pre class="kd ke kf kg fd lq lr ls lt aw lu bi"><span id="1230" class="lv ku hi lr b fi lw lx l ly lz">pip install xhtml2pdf</span></pre><p id="ac99" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我们在本教程中需要的全部内容。我们开始吧！</p><h1 id="7120" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">一个示例项目</h1><p id="34ba" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">考虑一个名为<strong class="iz hj"> <em class="ma"> project </em> </strong>的典型 Django 项目，带有一个名为<strong class="iz hj"> <em class="ma"> Test </em> </strong> <em class="ma">的 app。</em>使用以下命令开始</p><pre class="kd ke kf kg fd lq lr ls lt aw lu bi"><span id="0eaf" class="lv ku hi lr b fi lw lx l ly lz">django-admin startproject project<br/>cd project<br/>python manage.py startapp Test</span></pre><p id="847f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该项目的目录结构类似于</p><pre class="kd ke kf kg fd lq lr ls lt aw lu bi"><span id="592c" class="lv ku hi lr b fi lw lx l ly lz">.<br/>├── db.sqlite3<br/>├── manage.py<br/>├── project<br/>│   ├── asgi.py<br/>│   ├── __init__.py<br/>│   ├── settings.py<br/>│   ├── urls.py<br/>│   └── wsgi.py<br/>└── Test<br/>    ├── admin.py<br/>    ├── apps.py<br/>    ├── __init__.py<br/>    ├── migrations<br/>    │   ├── 0001_initial.py<br/>    │   └── __init__.py<br/>    ├── models.py<br/>    ├── tests.py<br/>    ├── urls.py<br/>    └── views.py</span></pre><h2 id="fe53" class="lv ku hi bd kv mb mc md kz me mf mg ld jg mh mi lf jk mj mk lh jo ml mm lj mn bi translated">数据库模型</h2><p id="dc97" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">让我们在<strong class="iz hj"> Test/models.py </strong>中为我们的项目创建一个数据库模型，它将包含学生记录，即学生姓名、学号和分数。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="bf24" class="lv ku hi bd kv mb mc md kz me mf mg ld jg mh mi lf jk mj mk lh jo ml mm lj mn bi translated">PDF 样式</h2><p id="73d2" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">现在，让我们从设计 PDF 开始。我们可以使用外部样式表，但这需要一些额外的配置。所以让我们坚持内联样式，为我们所有的记录设计一个小的表格结构</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h1 id="c177" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">生成 PDF</h1><p id="7d4d" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">现在是表演时间了！让我们编写生成 pdf 的核心函数。我们将使用 xhtml2pdf 中的 pisa 来完成所有必要的转换。在<strong class="iz hj">测试</strong>下创建一个新文件<strong class="iz hj"> utils.py </strong>，并使用下面的代码片段。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="b572" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使 PDF 可以直接下载，请在 HTTPResponse 中使用 can you<strong class="iz hj">Content-Disposition</strong>。例如，您可以在 utils.py 中的第 9 行之后添加另一行</p><pre class="kd ke kf kg fd lq lr ls lt aw lu bi"><span id="1609" class="lv ku hi lr b fi lw lx l ly lz">response['Content-Disposition'] = f'attachment; filename="{pdf_name}"'</span></pre><h2 id="ba0e" class="lv ku hi bd kv mb mc md kz me mf mg ld jg mh mi lf jk mj mk lh jo ml mm lj mn bi translated">views.py</h2><p id="ba49" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">我们已经开始运作了。现在是时候为我们的 pdf 写一个视图了。让我们把<strong class="iz hj"> Test/views.py </strong>中的 pdf 结构和 utils.py 连接起来。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="b2ae" class="lv ku hi bd kv mb mc md kz me mf mg ld jg mh mi lf jk mj mk lh jo ml mm lj mn bi translated">urls.py</h2><p id="4cee" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">…当然，我们怎么能忘记 URL 呢？</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h1 id="5b2e" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">结果</h1><p id="b7e4" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">完成所有步骤并填充数据库后，pdf 应该看起来像这样。很漂亮吧？</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es mq"><img src="../Images/456083c1f600a28d48e71584f4a89723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AC5H-isUn5gTbVLAr-XupA.png"/></div></div></figure><h1 id="f7ff" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">第二部分有什么</h1><p id="a761" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">到目前为止，我们已经讨论了如何使用 HTML 和 CSS 定义 PDF 的基本布局。第 2 部分将涵盖其他基本内容，如添加页眉和页脚、页码、定义 a4、letter 和其他格式的布局、批量打印 PDF 和输出为 ZIP 文件。</p><p id="6817" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在那之前，保持快乐，保持安全！</p></div></div>    
</body>
</html>