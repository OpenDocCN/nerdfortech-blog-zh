<html>
<head>
<title>Using Apache POI to Test Banking Transactions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Apache POI 测试银行交易</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/using-apache-poi-to-test-banking-transactions-ea7c1ff9ef5e?source=collection_archive---------32-----------------------#2021-05-29">https://medium.com/nerd-for-tech/using-apache-poi-to-test-banking-transactions-ea7c1ff9ef5e?source=collection_archive---------32-----------------------#2021-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e94f8069e634bf04e5372601b0f23b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdRviRzrx7ARdrO7hr7TQg.png"/></div></div></figure><p id="6180" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated"><span class="l jp jq jr bm js jt ju jv jw di"> O </span>在<strong class="is hj">银行即服务</strong>平台中，最重要的事情之一就是报告和发票。每笔交易的报告都以不同的格式保存，客户可能希望在特定的时间间隔或根据他们的需要使用这些报告。</p><p id="2ab5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我将向您展示如何测试 excel 格式的事务。首先，假设您用 selenium 下载了示例事务。我们来看看如何通过这个交易进行价值比较。</p><p id="982a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们将使用 Apache POI 来完成这项工作。Apache POI 为我们提供了允许我们处理 office 文档格式的文件的库。在本文中，我们将使用工作簿和其他与 excel 相关的界面，因为我们将使用 excel 进行操作。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jx"><img src="../Images/797104d1135051123599720289347f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IpK9Esj9OzA6kIgtmH4nsw.png"/></div></div></figure><p id="6328" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们有一个如下所示的事务文件。现在，让我们开始处理这个下载的文件。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/c88a900b111e128f96402dc1d143ed69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lrndrh0s7fnvxMFqfMZcAA.png"/></div></div></figure><p id="cc5f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们创建一个助手，我们将在其中执行 excel 操作。创建类之后，我们创建如下函数来打开我们的文件并切换到我们想要处理的工作表。我们创建一个文件对象，并通过 WorkbookFactory 将其定义为工作簿对象。然后，通过工作簿接口提供的 getSheet 方法，我们切换到我们想要处理的工作表。我们将其定义为 currentSheet 对象。现在，我们将在当前工作表中执行所有操作。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/5010560b5dc26e023ada6da5054db91e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFyod9I_n-HkWU0OrvGI6A.png"/></div></div></figure><p id="542f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看我们将以什么格式获取数据。excel 中可以有不同数据类型的字段，如布尔型、数值型等。我们希望将它们都作为字符串保存，并对它们进行比较。您也可以使用 switch-case 来实现这一点。通过单元格接口，您可以提取您想要的数据类型的单元格，然后转换它们。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/4b07c405912311ef60d3c9d62a36ae9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*atQ3JQt3sV0oAO2yiDuq1Q.png"/></div></div></figure><p id="ce04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在读取我们的数据之前，让我们首先确定有多少列，并将它们作为 enum 添加到我们的项目中，以便能够更容易地进行比较。我们将它们作为枚举添加的原因是我们将在映射时使用这个枚举。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/43cbe1cebbfcd76f6b860c85af52fed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u0Sk-ca1MPSahNFZK-mwIA.png"/></div></div></figure><p id="7a3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们可以继续阅读我们的数据。这里我们将通过过滤来读取数据。换句话说，我们将能够使用从外部发送的列名和我们想要过滤的值来提取我们想要的行。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/dde82e37a3d52cfda92aa523818ca332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R0tWiG6jtQX2CechGq6rWg.png"/></div></div></figure><p id="cc85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如你在下面看到的，我们通过映射来阅读一切。根据我们从外部提供的过滤器，我们读取 excel 中的数据，匹配列名和值，并将它们分配给一个列表。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/639e9ad379e94365aa339712262ffe16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E31u7VBTZFoqHZHNsoGv8A.png"/></div></div></figure><p id="43cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是时候将我们通过这个 excel 读取的数据与我们将从外部给出的值进行比较了。现在让我们看看如何编写我们的最终方法。我们发送我们的交易数据，我们将从外部进行比较，以及我们从 excel 读取的数据。我们以键、值的形式逐一匹配我们的交易数据，并将其与我们从 excel 中获取的数据进行比较，并检查它们的值是否匹配。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/da6d764d38f229b5e0256cd045a0da03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zUu1x355vswwnuQEwNXWqg.png"/></div></div></figure><p id="0d3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，让我们看看如何从外部发送和断言所有这些值。如您所见，我们需要设置我们将从外部给出的值，就像 key，value 一样。这样我们可以更容易地断言所有字段。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/e18b9660bbdb0bf2a6a83bd4e8b499eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r_mY36liD2rWN0M4z6JMag.png"/></div></div></figure><p id="389a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在已经将值定义为静态的，但是非常重要的是，您的测试是动态的，否则，您可能会错过将来的一些情况。当您在测试中使用这些值时，请注意动态地给出它们。</p><p id="6cac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">享受银行即服务平台测试的乐趣。🎊🎉</p></div></div>    
</body>
</html>