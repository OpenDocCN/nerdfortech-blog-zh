<html>
<head>
<title>Gradient Descent-A Roadmap to the Bottom of the Hill</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">梯度下降——到达山脚的路线图</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/gradient-descent-a-roadmap-to-the-bottom-of-the-hill-b054de1175ce?source=collection_archive---------9-----------------------#2021-05-04">https://medium.com/nerd-for-tech/gradient-descent-a-roadmap-to-the-bottom-of-the-hill-b054de1175ce?source=collection_archive---------9-----------------------#2021-05-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/73c8eadc118d458858bd73e08e71eb95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lOd0BEVd4Nh9qgPD8H0y1A.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">gaspar manuel zaldo 在<a class="ae iu" href="https://unsplash.com/s/photos/free-to-edit-mountain-images?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="3bc3" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">介绍</h1><p id="3bde" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">梯度下降是一种迭代优化算法，用于寻找微分函数的局部/全局最小值。由于该函数的主要目标是找到最小值，因此它被广泛用于机器学习中，以找到使成本值最小化的完美参数。</p><p id="7bed" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在这篇文章中，我们将看到这个算法是如何工作的，这个算法背后的数学，以及梯度下降的类型。</p><h1 id="1a44" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">在机器学习中具体是怎么用的？</h1><p id="e9d2" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">假设我们有一个任务。目标是创建一个算法，可以预测给定的动物图像是否是猫——对于每个输入图像，算法应该给出输出 0(如果不是猫)或 1(如果是猫)。首先，我们将使用一些猫和其他动物的图片来训练算法，以便算法可以创建自己的逻辑来预测新的图像。现在使用这个算法，我们将预测几个新的图像，然后最终计算平均成本，这表明我们的预测有多错误。</p><p id="caa1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">算法执行的很差怎么办？我们如何让它表现得更好？</p><p id="4a58" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">该算法取决于两个因素:我们用来训练该算法的输入值，以及该算法的参数。所以，如果算法表现不好，是因为这两个因素。因此，我们可以改变输入或参数，直到我们得到一个低成本。</p><p id="6c3d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">无论哪种情况，我们都需要最小化成本函数。这就是梯度下降派上用场的地方。<strong class="jv hj">我们将使用梯度下降法找到成本最小的参数</strong>。让我们看看如何。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/e7f37f89cc25a3197a1dc6f2b23fc327.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*tvobQ8XRLaWVx5DrnXYeTQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ix"> <em class="lb"> θ0 </em> </strong>和<strong class="bd ix"> <em class="lb"> θ1 </em> </strong> <em class="lb">是参数，</em> <strong class="bd ix"> <em class="lb"> x </em> </strong> <em class="lb">是输入</em></figcaption></figure><p id="f615" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你想进一步了解代价函数，训练一个算法等等。查看我的另一篇文章，这篇文章简单介绍了机器学习。</p><div class="lc ld ez fb le lf"><a href="https://hrithickgokul.medium.com/machine-learning-a-simple-introduction-5b79a3de802f" rel="noopener follow" target="_blank"><div class="lg ab dw"><div class="lh ab li cl cj lj"><h2 class="bd hj fi z dy lk ea eb ll ed ef hh bi translated">机器学习-简单介绍</h2><div class="lm l"><h3 class="bd b fi z dy lk ea eb ll ed ef dx translated">关于机器学习的一点想法</h3></div><div class="ln l"><p class="bd b fp z dy lk ea eb ll ed ef dx translated">hrithickgokul.medium.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt io lf"/></div></div></a></div><h1 id="a30c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">走下山坡</h1><p id="ed2d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">想象一下，你站在一个山谷的顶部，你需要到达底部，那里有一条河。由于通往底部的道路非常陡峭，你会在坡度较陡的地方走得快一些，在坡度不太陡的地方走得慢一些。所以你通过看你现在的位置来决定下一步有多大，对吗？梯度下降也是这样工作的。它将通过“走下山”达到最小值，并决定采取一大步或一小步，取决于<strong class="jv hj">斜率</strong>。</p><div class="kx ky kz la fd ab cb"><figure class="lu ij lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/09fd3d334d41add7519bc9e54c31573b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*8KeLGXHhkFJCzaduzsKBBw.jpeg"/></div></figure><figure class="lu ij lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/4ac05b054ecdb3f5508c6d7cd2e32d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dUnLAIm26kFTFYkwVc3twA.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx ma di mb mc translated">《走下山坡》</figcaption></figure></div><h1 id="4aac" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">函数的斜率</h1><blockquote class="md me mf"><p id="d29d" class="jt ju mg jv b jw kr jy jz ka ks kc kd mh kt kg kh mi ku kk kl mj kv ko kp kq hb bi translated">斜率的计算方法是找出一条直线上(任何)两个不同点之间的“垂直变化”与“水平变化”之比。</p></blockquote><p id="fa30" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们知道，实变量函数的<strong class="jv hj">导数</strong>测量的是 A 值相对于 B 值的变化量。这里，如果 A 是“垂直变化”, B 是“水平变化”,那么导数将给出斜率。</p><p id="4f28" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你不知道，让我解释一下。其他人可以跳到<a class="ae iu" href="#94ce" rel="noopener ugc nofollow">这部分</a>。</p><p id="213c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">考虑一个函数<strong class="jv hj"> <em class="mg"> f(x) = x . </em> </strong>该函数的图形如下所示。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/dcd435e1c63604da1432dcab938b81ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*hWUkRjavALsRUlrddn5Jcg.jpeg"/></div></figure><p id="5d8e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们放大来看看切线是什么样的。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bf270bb7cbd02acf84755842603d084b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3zBVoVRJ0CGKd-04G2jLw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">这只是一个粗略的图表，因为 d(f) = 0.010 的高度将比宽度<em class="lb"> d(x) = </em> 0.001 长十倍</figcaption></figure><p id="3c4e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这张图显示了导数如何给出切线的斜率。</p><p id="8583" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">当<strong class="jv hj"> <em class="mg"> x = 5 时，f(x) = 25。</em>T15】</strong></p><p id="04a1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在图像中我们可以看到，如果我们将<strong class="jv hj"><em class="mg"/></strong>从 5 移动到 5.001，那么<strong class="jv hj"> <em class="mg"> f(x) </em> </strong>从 25 移动到<strong class="jv hj"><em class="mg">f(</em></strong>5.001<strong class="jv hj"><em class="mg">)</em></strong>=(5.001)= 25.010—值 A ( <strong class="jv hj"> <em class="mg"> f(x) 【T34 因此斜率为 10。</em></strong></p><p id="556f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">同理，我们取一个点<strong class="jv hj"> <em class="mg"> x = 2，</em> </strong>那么<strong class="jv hj"> <em class="mg"> f(x) = 4。</em>T57】</strong></p><p id="9300" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">现在如果我们把<strong class="jv hj"><em class="mg"/></strong>x 从 4 移动到 4.001，那么<strong class="jv hj"> <em class="mg"> f(x) </em> </strong>就变成了<strong class="jv hj"><em class="mg">f(2.001)</em></strong>=(2.002)= 4.004—<strong class="jv hj"><em class="mg">【f(x)</em></strong>移动了 4 倍大于<strong class="jv hj"><em class="mg"/></strong>x，因此值 A 相对于因此斜率为 4。</p><p id="b82d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在这两种情况下，斜率值都是两倍的<strong class="jv hj"> <em class="mg"> x </em> </strong>值(当<strong class="jv hj"> <em class="mg"> x </em> </strong> = 5，斜率= 10；当<strong class="jv hj"> <em class="mg"> x </em> </strong> = 2，斜率= 4)。因此我们可以假设函数<strong class="jv hj"> <em class="mg"> f(x) = x，</em> </strong>的导数为<strong class="jv hj"> <em class="mg"> d(f)/d(x) = 2(x)。</em> </strong></p><p id="404e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">由于<strong class="jv hj"><em class="mg">【f(x)】</em></strong>不是一条直线，切线的斜率在函数的每一点都会不同。</p><h1 id="94ce" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">梯度下降</h1><p id="cac9" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们已经看到梯度下降如何用于机器学习，它如何找到函数的最小值，以及什么是斜率。现在让我们把这些放在一起，看看梯度下降背后的数学——公式。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/0181820b57442f43eae4aa77b5b51e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hAHbLwxDIaK4SmICw_bmmA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">成本函数</figcaption></figure><p id="c7b6" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">对于每个参数<strong class="jv hj"> <em class="mg"> θ0，θ1 </em> </strong>我们将找到它相对于代价函数<strong class="jv hj"> <em class="mg"> J(θ0，θ1)的导数<strong class="jv hj"><em class="mg">【d(θJ)</em></strong>(斜率)。</em>T59】</strong></p><p id="88d4" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">现在，对于每个参数<strong class="jv hj"> <em class="mg"> θj </em> </strong>，如果斜率<strong class="jv hj"> <em class="mg"> d(θj) </em> </strong>不接近 0，那么我们将通过用它的斜率<strong class="jv hj"> <em class="mg"> d(θj)减去它来更新参数<strong class="jv hj"> <em class="mg"> θj </em> </strong>。</em> </strong>这个意思是，如果你站的地方很陡，那么你还没有到达底部。所以，你要向底部前进一步，重复这个动作，直到斜率变成 0。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/77b53f35c3553683026ea5d8f1b01d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*YiAkwR1uRIvoXV68RfdNkw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">每 m 个训练实例更新<strong class="bd ix"> <em class="lb"> θj </em> </strong> <em class="lb"/></figcaption></figure><p id="c8c2" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"><em class="mg">(hθ(x^(i))-y^(i))xj^(i)</em></strong>是<strong class="jv hj"> <em class="mg"> d(θj)的导数。</em>T89】</strong></p><p id="afdf" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果我们重复这个过程几次，关于参数的成本将最终达到最小值，斜率将变为 0，您将到达河流。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/73f6e72310c30e977e4b486e3ddd3246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*76h14dPqKFH90Q1o"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Anthony DELANOIX 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="5eea" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">学习率</h1><p id="8f6b" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj"> α </strong>称为学习率。我们通常将学习率设置为一个小值，否则成本将会迈很大的一步，并最终向顶部发散。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5f5636926074a2b12ddb9818d9cdad95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrUMskk-EQhBH0IK9_SdOw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="1db6" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这种特殊算法的名字也叫做<strong class="jv hj">批量梯度下降。</strong>术语“批量”是指我们正在查看当时所有的培训示例。</p><h1 id="d86b" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">随机梯度下降</h1><p id="b002" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">批量梯度下降的问题是，如果训练样本的数量很大，那么计算导数项<strong class="jv hj"> <em class="mg"> d(θj) </em> </strong>可能会非常昂贵。因为这需要对所有的<strong class="jv hj"> m </strong>个例子求和。</p><p id="4fb6" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">假设我们有数百万个训练样本。因此，为了找到参数相对于成本函数的导数，我们将遍历所有百万个训练样本，累加这些总和，完成所有这些工作只是为了向最小值靠近一步。因此，可能需要很长时间才能让属性收敛。</p><p id="017f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">随机梯度下降</strong>很像批量梯度下降，但它不是等待对所有<strong class="jv hj"> m 个</strong>训练示例的参数求和，而是仅使用一个训练示例更新参数，并开始在改进参数和向全局最小值移动方面取得进展。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/555fd820ee0b40de011c805193019514.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*hJHp6FoloZln2G48U_m2Hw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">为每 m 个训练实例更新<strong class="bd ix"> <em class="lb"> θj </em> </strong> <em class="lb"/></figcaption></figure><h1 id="f147" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">结论</h1><p id="4eb9" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">现在，您应该对以下内容有了更好的理解:</p><ol class=""><li id="eaf3" class="mp mq hi jv b jw kr ka ks ke mr ki ms km mt kq mu mv mw mx bi translated">为什么机器学习要用梯度下降？</li><li id="2f18" class="mp mq hi jv b jw my ka mz ke na ki nb km nc kq mu mv mw mx bi translated">背后的数学。</li><li id="fc8d" class="mp mq hi jv b jw my ka mz ke na ki nb km nc kq mu mv mw mx bi translated">分批下降和随机梯度下降的区别。</li></ol><p id="d2b7" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">梯度下降在机器学习中非常重要。这将有助于找到使成本值最小化的最佳参数集，从而产生良好的结果。</p><h1 id="fbcf" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">谢谢大家！！</h1><p id="d131" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">希望对你有帮助。感谢您花时间阅读到这里。有什么建议就留言评论吧。访问我的 LinkedIn 来了解更多关于我和我的工作。</p></div></div>    
</body>
</html>