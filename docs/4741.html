<html>
<head>
<title>Python pandas: Quick Tips</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">蟒蛇熊猫:快速提示</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/python-pandas-quick-tips-e4e4866e1e14?source=collection_archive---------4-----------------------#2021-08-05">https://medium.com/nerd-for-tech/python-pandas-quick-tips-e4e4866e1e14?source=collection_archive---------4-----------------------#2021-08-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/82deca3df85c26d2db98c04e10d98643.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*tHE3Xbwo_tP436lhP9I2jA.png"/></div></figure><h1 id="0d94" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">关于</h1><p id="db1f" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">这些是我在 pandas 中最常用的一些命令，在此分享以方便参考。这些例子使用了<strong class="jm hj"> python 版本 3.9 </strong>和<a class="ae ki" href="https://pypi.org/project/pandas/" rel="noopener ugc nofollow" target="_blank">T5【熊猫版本 </a> <strong class="jm hj"> 1.3.0 </strong>。</p><h1 id="33d0" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">1)使用“wget”下载一个“csv”文件</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="3e0b" class="ks in hi ko b fi kt ku l kv kw"># import libraries<br/>from pathlib import Path<br/>import pandas as pd</span><span id="acd5" class="ks in hi ko b fi kx ku l kv kw"># create directories, if they don't already exist<br/>Path("data_raw").mkdir(parents=True, exist_ok=True)<br/>Path("data_derived").mkdir(parents=True, exist_ok=True)</span><span id="a661" class="ks in hi ko b fi kx ku l kv kw"># assign variable names to the directories<br/>path_datain = "data_raw/"<br/>path_dataout = "data_derived/"</span><span id="7bc0" class="ks in hi ko b fi kx ku l kv kw">data_url = "<a class="ae ki" href="https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series</a>"<br/>file_name = "time_series_covid19_confirmed_global.csv"</span><span id="46bc" class="ks in hi ko b fi kx ku l kv kw">file_url = data_url + "/" + file_name</span><span id="5e90" class="ks in hi ko b fi kx ku l kv kw"># get the file<br/>!wget -N {file_url} -P {path_datain}</span><span id="0a84" class="ks in hi ko b fi kx ku l kv kw">df = pd.read_csv(path_datain + file_name)</span></pre><h2 id="9585" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">看数据框</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="eefe" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">df.head()</strong></span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ll"><img src="../Images/7cadfa3980f8f6af2c5f7d7b19717c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gm5yVd7oZuC1lWkB9tXMGQ.png"/></div></div></figure><h1 id="4ce3" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">2)读入一个`. csv '文件并创建一个数据帧</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="b847" class="ks in hi ko b fi kt ku l kv kw">df = <strong class="ko hj">pd.read_csv</strong>(path_datain + file_name)</span></pre><h1 id="0be1" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">3)制作数据帧的副本</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="fa49" class="ks in hi ko b fi kt ku l kv kw">df2 = <strong class="ko hj">df.copy()</strong></span></pre><h1 id="76a3" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">4)浏览数据帧</h1><h2 id="360c" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">读入数据</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="3fd1" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, 6, None],<br/>                   "country":["India", "Italy", "Kenya", "Unknown"],<br/>                   "C":[10, 9, 8, 7],<br/>                   "D":[1, 3, None, 5],<br/>                   "E":['2020-01-01', '2020-01-02','2020-01-03', 'NaN']})</span></pre><h2 id="b4de" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">获取数据帧的维度(行数和列数)</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="975b" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">df.shape()</strong></span></pre><p id="a7df" class="pw-post-body-paragraph jk jl hi jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh hb bi translated"><code class="du lv lw lx ko b">(5,5)</code></p><h2 id="3335" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">获取信息</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="5eff" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">df.info()</strong></span></pre><h2 id="a69d" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">&gt;输出</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="3e91" class="ks in hi ko b fi kt ku l kv kw">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 5 entries, 0 to 4<br/>Data columns (total 5 columns):<br/> #   Column   Non-Null Count  Dtype  <br/>---  ------   --------------  -----  <br/> 0   A        4 non-null      float64<br/> 1   country  5 non-null      object <br/> 2   C        5 non-null      int64  <br/> 3   D        4 non-null      float64<br/> 4   E        5 non-null      object <br/>dtypes: float64(2), int64(1), object(2)<br/>memory usage: 328.0+ bytes</span></pre><h2 id="6f75" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">获取数据帧中变量的唯一出现次数</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="b4a9" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, 6, None],<br/>                   "country":["India", "Italy", "Kenya", "India"],<br/>                   "C":[10, 9, 8, 7],<br/>                   "D":[1, 3, None, 5],<br/>                   "E":['2020-01-01', '2020-01-02','2020-01-03', 'NaN']})</span><span id="4f93" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df['country'].unique()</strong></span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ly"><img src="../Images/317112bfae846eafdd317002ebadf278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKtZcAuejxLNqbtyW8dqYA.png"/></div></div></figure><h2 id="5872" class="ks in hi bd io ky kz la is lb lc ld iw jv le lf ja jz lg lh je kd li lj ji lk bi translated">获取数据帧中变量的频率计数</h2><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="6926" class="ks in hi ko b fi kt ku l kv kw">df['country']<strong class="ko hj">.value_counts(normalize=False)</strong></span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/9a9d4276cc0eb0e45d2f629f45303b9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*oSOUwN8HLWVpsMOI-0ru4w.png"/></div></figure><p id="ed81" class="pw-post-body-paragraph jk jl hi jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh hb bi translated">注意:使用<code class="du lv lw lx ko b">normalize=True</code>获得百分比。</p><h1 id="e443" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">5)使用“过滤器”保留变量(列)的子集</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="4504" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, 6],<br/>                   "B":[1, 2, 3],<br/>                   "C":[10, 9, 8],<br/>                   "D":[1, 3, None]<br/>})</span><span id="296e" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">keep_cols = ['A', 'B']</strong></span><span id="9384" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df_v2 = df.filter(keep_cols)</strong></span></pre><h1 id="9ce9" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">6)在数据帧中“删除”一个或多个变量</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="5661" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, 6],<br/>                   "B":[1, 2, 3],<br/>                   "C":[10, 9, 8],<br/>                   "D":[1, 3, None]<br/>})</span><span id="3030" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/194ea8df324b719d12f175077358ffaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*dQ5qxr1rb1D14qatcViBQw.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="249b" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">drop_cols = ['A', 'B']</strong></span><span id="e219" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df.drop(drop_cols, axis=1, inplace=True)</strong></span><span id="6bb9" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/413465236dcca58c85b5fb588e82deb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*Vvhav-h92J8Gz6NlKhLMqw.png"/></div></figure><h1 id="be9f" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">7)获取数据帧中行的子集:使用‘isin’</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="8e90" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, 6],<br/>                   "B":[1, 2, 3],<br/>                   "C":[10, 9, 8],<br/>                   "D":[1, 3, None]<br/>})</span><span id="8fbf" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/9e8616667d8ec869de32615518891aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*8pEUoU_QElQopZ1jbli2OA.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="7593" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">filtered_list = [2, 4]</strong></span><span id="be28" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">check1 = df[df["A"].isin(filtered_list)]</strong></span><span id="0a54" class="ks in hi ko b fi kx ku l kv kw">check1</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/94226b740b50635bb4b20cbdf88b5a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*jtz8UIgFaAEbmgBhKKgLSA.png"/></div></figure><h1 id="5743" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">8)对列重新排序</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="0c4d" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, 6],<br/>                   "B":[1, 2, 3],<br/>                   "C":[10, 9, 8],<br/>                   "D":[1, 3, None]<br/>})</span><span id="12e5" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df.head(2)</strong></span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es md"><img src="../Images/fc632dec42209c20007b8008598ae277.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*5x2Q9mWQLsXMQyRSdGydhg.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="135b" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">new_order = ['D', 'A', 'C', 'B']</strong></span><span id="e433" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df_new = df.reindex(new_order, axis=1)</strong></span><span id="990b" class="ks in hi ko b fi kx ku l kv kw">df_new.head(2)</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es me"><img src="../Images/8c60fa50eddefcd7f6c3e836fd0c2163.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*90DexGYln8dL6ifhBop6mQ.png"/></div></figure><h1 id="db34" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">9)重命名数据帧中的列</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="2b9f" class="ks in hi ko b fi kt ku l kv kw">import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[120, 140, 100],<br/>                   "B":[80, 90, 60],<br/>                   "C":[10, 9, 8],<br/>                   "D":[1, 3, None]<br/>})</span><span id="21e1" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/f9958911a914d0f7ddd15f2dbd52dcd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*mhQa-rLcYznP2JQXj7XB4Q.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="4d27" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">df = df.rename(columns={'A': 'systolic',<br/>                        'B': 'diastolic'<br/>                       })</strong></span><span id="527d" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es mg"><img src="../Images/b710bfe4722d7746b265fba44c63ed2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*8HpX37gtnw1dThWFxBSOXw.png"/></div></div></figure><h1 id="6a5c" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">10)转置数据框架(数据透视表)；使用“融化”</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="7a2e" class="ks in hi ko b fi kt ku l kv kw"># importing pandas as pd<br/>import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"country":["India", "USA", "Mongolia"],<br/>                   "year": [2019, 2020, 2021],<br/>                   "A":[10, 9, 8],<br/>                   "B":[1, 3, None],<br/>                   "C":['2020-01-01', '2018-01-01', 'NaN']})</span><span id="ce02" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/188d623e74ea4aa0ff6ecf3cf94015e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*Nh8EzqGuhRISkptkMSNo2w.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="76ef" class="ks in hi ko b fi kt ku l kv kw">df_long = <strong class="ko hj">df.melt(id_vars=['country', 'year'])</strong></span><span id="58ca" class="ks in hi ko b fi kx ku l kv kw">df_long</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/2a4fe4d566140701ebf667e7220ba4b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*mNzRmIoDSj3dRj3i0zJ43Q.png"/></div></figure><h1 id="b786" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">11)将数据帧写入一个`. csv '文件</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="a29e" class="ks in hi ko b fi kt ku l kv kw"># Takes dataframe "df" and writes it out a csv file named "report.csv"</span><span id="5f58" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df.to_csv</strong>('data_derived/report.csv')</span></pre><h1 id="02ae" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">12)使用“掩码”分配新的数据值</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="deb7" class="ks in hi ko b fi kt ku l kv kw"># importing pandas as pd<br/>import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[2, 4, None],<br/>                   "country":["India", "USA", "Unknown"],<br/>                   "C":[10, 9, 8],<br/>                   "D":[1, 3, None],<br/>                   "event_date":['2020-01-01', '2018-01-01', 'NaN']})</span><span id="2114" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/c88ddd7cc20141886e31e710a43442e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*YZKVPFwonJuqhLNBo0iNJA.png"/></div></figure><p id="cd32" class="pw-post-body-paragraph jk jl hi jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh hb bi translated">更改现有列</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="0a48" class="ks in hi ko b fi kt ku l kv kw"># IF the event_date='2018-01-01', then assign country (existing column in df) to be "United States"</span><span id="0ad8" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df['country'].mask(df['event_date'] == '2018-01-01', 'United States', inplace=True)</strong></span><span id="6244" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/f1dfcf5b965ab3a03700156a097fcd8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*C4Ko6S8B8D5GTM0fim6yhQ.png"/></div></figure><p id="47db" class="pw-post-body-paragraph jk jl hi jm b jn lq jp jq jr lr jt ju jv ls jx jy jz lt kb kc kd lu kf kg kh hb bi translated">创建新列</p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="4c91" class="ks in hi ko b fi kt ku l kv kw"># IF the event_date='2018-01-01', then assign chapter_status (a new column) to be "unbegun"</span><span id="33ea" class="ks in hi ko b fi kx ku l kv kw"># NOTE:  the new column needs to be initialized</span><span id="54b5" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df['chapter_status'] = ""</strong></span><span id="814a" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df['chapter_status'].mask(df['event_date'] == '2018-01-01', 'unbegun', inplace=True)</strong></span><span id="7d88" class="ks in hi ko b fi kx ku l kv kw">df</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es et"><img src="../Images/482e18b5c04606d44a8b664dd8057ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfjjIdBXizMp150_zQ_0RA.png"/></div></div></figure><h1 id="985a" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">13)从字符转换为整数</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="906d" class="ks in hi ko b fi kt ku l kv kw"># importing pandas as pd<br/>import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[12, 4, 5, None],<br/>                   "B":[7, 2, 54, 3],<br/>                   "C":[20, 16, 11, 3],<br/>                   "D":[14.3, 3.5, 5.0, 6.8]})</span><span id="f67d" class="ks in hi ko b fi kx ku l kv kw">df.head()</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/5d5c08f65bb88eba2d8e36e58eeeffeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*p127DiA2JnMG49YBevilzQ.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="3d89" class="ks in hi ko b fi kt ku l kv kw"><strong class="ko hj">df['D_n']= df['D'].astype(int)</strong></span><span id="806b" class="ks in hi ko b fi kx ku l kv kw">df.head()</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/b8618283ea9d7b597d737ae711a54305.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*lYmGrCDhy8PHvjpI8wl3xA.png"/></div></figure><h1 id="c4cd" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">14)用另一个值替换“NaN”</h1><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="b817" class="ks in hi ko b fi kt ku l kv kw"># importing pandas as pd<br/>import pandas as pd<br/>  <br/># Creating the dataframe <br/>df = pd.DataFrame({"A":[12, 4, 5, None, 1],<br/>                   "B":[7, 2, 54, 3, None],<br/>                   "C":[20, 16, 11, 3, 8],<br/>                   "D":[14, 3, None, 2, 6]})</span><span id="3a18" class="ks in hi ko b fi kx ku l kv kw">df.head()</span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/c95c68eed4b01deaaf9f24ae628a7259.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*cJmkh8sJ2Y3y0TAO0I6d0w.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="e227" class="ks in hi ko b fi kt ku l kv kw"># replace the NaN values with 1000</span><span id="c55b" class="ks in hi ko b fi kx ku l kv kw"><strong class="ko hj">df.mask(df.isna(), 1000)</strong></span></pre><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/79f7416697b564bba341cfe04dbfb68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*hDFWVO0IUwLTqdvHJcVrLg.png"/></div></figure><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="9f31" class="ks in hi ko b fi kt ku l kv kw"># NOTE: use inplace=True, so it is permanently replaced in the dataframe. </span><span id="c2b8" class="ks in hi ko b fi kx ku l kv kw">df.mask(df.isna(), 1000, <strong class="ko hj">inplace=True</strong>)</span></pre></div></div>    
</body>
</html>