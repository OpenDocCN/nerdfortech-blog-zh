<html>
<head>
<title>Visualize OD data with Flowmap.blue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flowmap.blue可视化OD数据</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/visualize-od-data-with-flowmap-blue-1f800c70b743?source=collection_archive---------7-----------------------#2021-07-04">https://medium.com/nerd-for-tech/visualize-od-data-with-flowmap-blue-1f800c70b743?source=collection_archive---------7-----------------------#2021-07-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="im in io ip fd iq"><div class="bz dy l di"><div class="ir is l"/></div><figcaption class="it iu et er es iv iw bd b be z dx translated">创作者Ilya Boyandin的Flowmap.blue演示</figcaption></figure><h1 id="0a95" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">什么是Flowmap.blue？</h1><p id="61ef" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><a class="ae kt" href="https://flowmap.blue/" rel="noopener ugc nofollow" target="_blank"> Flowmap.blue </a>是一个开源工具，可以帮助可视化两个地理位置之间的移动。它由创造者伊利亚·博扬丁于2019年首次推出，伊利亚·博扬丁是Teralytics <em class="ku">的数据可视化工程师。</em>如果你对技术细节感兴趣，请点击查看博扬丁的媒体文章<a class="ae kt" rel="noopener" href="/teralytics/visualizing-mobility-data-the-scalability-challenge-2575fe819702">。</a></p><h1 id="0243" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">关于始发地-目的地(OD)数据的详细信息</h1><p id="4fe0" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><a class="ae kt" href="https://cran.r-project.org/web/packages/stplanr/vignettes/stplanr-od.html" rel="noopener ugc nofollow" target="_blank"> OD数据</a>或“流量数据”，用于表示地理运动。它要么以“长”的形式出现，要么以矩阵的形式出现。在第一种情况下，每一行都有OD对(始发地和目的地)以及始发地和目的地之间的出行次数。</p><figure class="im in io ip fd iq er es paragraph-image"><div class="er es kv"><img src="../Images/504643e314bb21e57a4a5b48f9fdd4fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*L7VfDwARWRbH8EywxAlUWQ.png"/></div><figcaption class="it iu et er es iv iw bd b be z dx translated">“长”形数据</figcaption></figure><p id="b289" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">矩阵是一个枢纽。每行包含始发地，每列包含目的地-所有累计的旅行次数将在始发地和目的地之间进行映射。如果有很多起点和终点，这种方法就变得不实用了(注意下图中N/a的数量)。如果是这样的话，最好还是坚持“长”的形式。</p><figure class="im in io ip fd iq er es paragraph-image"><div class="er es ld"><img src="../Images/38e0f8e034ca9a0d3b2d078805c32983.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*ahLi4acbhlKsJorIikOhcQ.png"/></div><figcaption class="it iu et er es iv iw bd b be z dx translated">OD矩阵</figcaption></figure><p id="c109" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">Flowmap.blue有一个<a class="ae kt" href="https://flowmap.blue/od-matrix-converter" rel="noopener ugc nofollow" target="_blank">矩阵转换器</a>，允许您将矩阵转换为长格式，并在电子表格中复制/粘贴表格输出。要在Google Sheets中解算矩阵，可以参考<a class="ae kt" href="https://www.benlcollins.com/spreadsheets/unpivot-in-google-sheets/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>(我就是用的这个)。在Flowmap.blue中，您需要使用长格式数据。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/ca2cb043a54bb49e8cc9e40baf341cab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AHwpOw_EUOSi6_opFG1gw.png"/></div></div><figcaption class="it iu et er es iv iw bd b be z dx translated">Flowmap.blue OD矩阵转换器</figcaption></figure><h1 id="ab90" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">我为什么要关心OD分析？</h1><p id="4a7d" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">OD分析有助于许多原因:城市规划、交通网络设计、房地产投资、供应链物流、人口迁移政策等。移动性数据对于了解现代地理空间中存在哪些低效问题非常重要，有助于制定更好的应对措施:常用路线上的专用自行车道、减少数百万人往返于相同位置的旅行时间、在欢迎大量人口的区域分配资源，以及许多其他使用案例。简而言之，OD分析有助于确定今天的地理差距，以便明天更好地分配资源。</p><p id="e2ab" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">在本文中，我将使用旧金山湾区2021年的<a class="ae kt" href="https://www.bart.gov/about/reports/ridership" rel="noopener ugc nofollow" target="_blank"> BART乘客数据</a>从头到尾向您介绍如何使用Flowmap.blue。我们开始吧！</p><h1 id="74b3" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">使用Flowmap.blue</h1><p id="fa30" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">一旦你选择了你想要处理的数据并清理了数据集，去Flowmap.blue的<a class="ae kt" href="https://flowmap.blue/" rel="noopener ugc nofollow" target="_blank">网站</a>并复制一份<a class="ae kt" href="https://docs.google.com/spreadsheets/d/1aEgwtGUGc0TdnsO0jIm50hshCZ-m4DHms3P0Qq9IYdA/edit#gid=1438429083" rel="noopener ugc nofollow" target="_blank">模板</a>到你的Google Drive。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lj"><img src="../Images/a4e2809d390904b0c1e49394ffba7d8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVcJ57J_Xm6TUxyclwvPzw.png"/></div></div></figure><p id="8ea6" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">您需要填写3个选项卡，“属性”、“位置”和“流量”。让我演示如何为每个必需的部分填充电子表格。</p><h2 id="aed3" class="lk iy hi bd iz ll lm ln jd lo lp lq jh kg lr ls jl kk lt lu jp ko lv lw jt lx bi translated">性能</h2><p id="f2c3" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">properties选项卡是您将要使用Flowmap.blue创建的可视化的元数据。首先，您需要输入关键信息，如图表标题、描述、数据源和您自己的信息。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ly"><img src="../Images/b450f93ef83828f2c43c4939f93630b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RSr8zGs7C-Mr788mzNr36A.png"/></div></div><figcaption class="it iu et er es iv iw bd b be z dx translated">左边是原始数据，右边是最终结果</figcaption></figure><p id="83e6" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">Flowmap.blue是使用Mapbox构建的，所有视觉效果都托管在Flowmap的Mapbox帐户上。如果您将地图嵌入网站并期望高流量，Flowmap.blue鼓励用户使用自己的Mapbox访问令牌。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lz"><img src="../Images/42b86afe8bd7af170eec21c6b14b541d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9u20uJhTqEpmEAAxfio5wg.png"/></div></div><figcaption class="it iu et er es iv iw bd b be z dx translated">为API请求创建自己的地图框访问令牌(可选)</figcaption></figure><p id="7db9" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">接下来，我们将通过为工具箱选择颜色、动画/聚类功能和文字选项来格式化地图。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ma"><img src="../Images/655b0a971a0b0a094476a97d27d42dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nx6H5df-95kVygpAwF9kOA.png"/></div></div></figure><p id="7df9" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">我在这里没有做太多的修改，除了您会注意到flows . sheets“value”单元格包含逗号分隔的值。这些将告知您在下面看到的月/年下拉列表。对于每个下拉框值，您需要在模板上创建一个单独的选项卡。</p><figure class="im in io ip fd iq er es paragraph-image"><div class="er es mb"><img src="../Images/c14c6343a5c6a9c39656a72a366e262f.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*xxZBxDadstCFwGkw6xz34A.png"/></div><figcaption class="it iu et er es iv iw bd b be z dx translated">月/年下拉菜单</figcaption></figure><h2 id="165c" class="lk iy hi bd iz ll lm ln jd lo lp lq jh kg lr ls jl kk lt lu jp ko lv lw jt lx bi translated">位置</h2><p id="b29e" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">填充位置，包括GPS坐标。如果只有位置名称而没有GPS坐标，可以使用Flowmap.blue的<a class="ae kt" href="https://flowmap.blue/geocoding" rel="noopener ugc nofollow" target="_blank">地理编码工具</a>。它将返回您指定位置的经纬度坐标。抽查以确保地理编码工具返回正确的坐标。将结果复制/粘贴到电子表格的“位置”选项卡上。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es mc"><img src="../Images/d7247051ff6af38078c855d83ae76095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Og3rJKoryAXSc-V3T0Dvfw.png"/></div></div><figcaption class="it iu et er es iv iw bd b be z dx translated">Flowmap.blue的地理编码工具</figcaption></figure><p id="dd8b" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">接下来，返回到电子表格，按以下顺序输入数据:id、名称、纬度和经度。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es md"><img src="../Images/0c0d224f99dc4fc726c0bf1294ac3e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*f62yw3JcMWZbBuvkLX2Z5g.png"/></div></div></figure><h2 id="8b72" class="lk iy hi bd iz ll lm ln jd lo lp lq jh kg lr ls jl kk lt lu jp ko lv lw jt lx bi translated">流</h2><p id="2f6f" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">最后,“流量”选项卡将显示出发地和目的地之间的旅行次数。如果您对创建过滤器不感兴趣，您可以简单地填写“流”选项卡。但是，如果您想创建一个下拉菜单，您需要为您想添加到下拉菜单中的每个值创建一个新的选项卡(如下例所示)。</p><figure class="im in io ip fd iq er es paragraph-image"><div class="er es me"><img src="../Images/7fe14ff953ea1b9625a9ed81e0574b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*bPMkjK2k3MqfF9XngQU55A.png"/></div></figure><p id="9701" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">在每个选项卡上，输入始发地、目的地和累计行程数。</p><figure class="im in io ip fd iq er es paragraph-image"><div class="er es mf"><img src="../Images/55f5f109575bba8a0b6e12f4defe2a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*hXd8bpuVF4t8pGXE7ziMGg.png"/></div><figcaption class="it iu et er es iv iw bd b be z dx translated">OD流量</figcaption></figure><p id="379b" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">当你准备好可视化结果时，点击右上角的“分享”按钮，选择“任何有链接的人”</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es mg"><img src="../Images/9a9729d340c5615e322f5c3a3111cb6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*5zlxXcY6-G_JvDCea-O5BQ.png"/></div></div></figure><p id="b083" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated">将链接复制/粘贴到Flowmap.blue上的专用框中。单击“打开”在Flowmap.blue中查看最终结果。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es mh"><img src="../Images/a62b5bfbf19d76969315cf3d727cc487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMNR0MHmhCsO8LaFtmH6rw.png"/></div></div></figure><figure class="im in io ip fd iq er es paragraph-image"><div class="er es mi"><img src="../Images/85d8e6f62cbbb1ed08738d84b2446839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*Ngx9xCheOPLwd9n4HayEVA.png"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="1b99" class="ix iy hi bd iz ja mj jc jd je mk jg jh ji ml jk jl jm mm jo jp jq mn js jt ju bi translated">结论</h1><p id="9ed4" class="pw-post-body-paragraph jv jw hi jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我希望这个教程是有帮助的。在Flowmap.blue上随意查看<a class="ae kt" href="https://flowmap.blue/1Ipp8FUeOTSXcrzXEg9cfW_V3Czpurkt59vvdFk3v1EA" rel="noopener ugc nofollow" target="_blank">我自己的OD地图</a>你可以放大或缩小，使用下拉菜单过滤月份，或者切换设置(左下角)。虽然Flowmap.blue是一个方便、低代码和用户友好的工具，但还有其他工具可以可视化OD数据:ArcGIS、Tableau、R's stplanr库、Kepler.gl等。探索愉快！😊</p><p id="7dfc" class="pw-post-body-paragraph jv jw hi jx b jy ky ka kb kc kz ke kf kg la ki kj kk lb km kn ko lc kq kr ks hb bi translated"><em class="ku">这篇文章最后编辑于2021年7月3日。这里表达的观点仅属于我自己，并不代表我的雇主的观点。</em></p></div></div>    
</body>
</html>