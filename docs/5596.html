<html>
<head>
<title>Your First NodeJS REST API Client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您的第一个NodeJS REST API客户端</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/your-first-nodejs-rest-api-client-59467659ab99?source=collection_archive---------1-----------------------#2021-10-21">https://medium.com/nerd-for-tech/your-first-nodejs-rest-api-client-59467659ab99?source=collection_archive---------1-----------------------#2021-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b993e65e26a7cb8f276f1342ea0e3a35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mQf8HiAow_dU3bB6K9rg8Q.png"/></div></div></figure><p id="091d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的教程中几乎涵盖了所有流行的REST API客户端，比如<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#python" rel="noopener ugc nofollow" target="_blank"> Python </a>、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#php_curl" rel="noopener ugc nofollow" target="_blank"> PHP </a>、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#c-sharp" rel="noopener ugc nofollow" target="_blank"> C# </a>、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#golang" rel="noopener ugc nofollow" target="_blank"> Golang </a>。然而，我们错过了最明显和最受欢迎的one - NodeJS。我们的目标是通过向您展示一个使用Axios的NodeJS RESTful API客户端的简单实现来弥补。本教程假设您对Javascript语法有非常基本的了解，并且有一些基本的编程经验。</p><p id="9ceb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本教程中，您将学习以下内容:</p><ol class=""><li id="31d3" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">下载并安装Nodejs。</li><li id="2748" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">设置NodeJS (node.js)环境</li><li id="8222" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">设置一个免费帐户从REST API获取数据。</li><li id="793c" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">从API中检索数据</li><li id="97ee" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">解析JSON数据并显示输出。</li></ol><p id="68b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始吧！</p><h1 id="9c46" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">下载并安装节点</h1><h1 id="aed1" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Windows和Mac:</h1><ul class=""><li id="c138" class="jp jq hi is b it lb ix lc jb ld jf le jj lf jn lg jv jw jx bi translated">从Nodejs.org下载</li><li id="74bb" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lg jv jw jx bi translated">运行安装并接受默认值</li></ul><h1 id="b320" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Linux:</h1><ul class=""><li id="3d68" class="jp jq hi is b it lb ix lc jb ld jf le jj lf jn lg jv jw jx bi translated">以root用户身份登录或以sudo用户身份运行</li></ul><blockquote class="lh li lj"><p id="ddf1" class="iq ir lk is b it iu iv iw ix iy iz ja ll jc jd je lm jg jh ji ln jk jl jm jn hb bi translated">apt-get安装节点js</p></blockquote><h1 id="0bbf" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">设置NodeJS (node.js)环境</strong></h1><p id="c75d" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">现在您已经安装了NodeJS，通过键入以下命令检查您的安装:</p><blockquote class="lh li lj"><p id="0476" class="iq ir lk is b it iu iv iw ix iy iz ja ll jc jd je lm jg jh ji ln jk jl jm jn hb bi translated">节点v</p></blockquote><p id="5ca4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该看到:</p><blockquote class="lh li lj"><p id="294a" class="iq ir lk is b it iu iv iw ix iy iz ja ll jc jd je lm jg jh ji ln jk jl jm jn hb bi translated">v14.18.1</p></blockquote><p id="b7f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为你的程序创建一个目录。</p><p id="4c39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开命令提示符或终端，获取运行我们的客户机所需的依赖项(库)。我们将使用“axios”库，因为它简化了HTTP请求，所以运行以下代码:</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="703c" class="ma ke hi lw b fi mb mc l md me">npm i axios</span></pre><p id="1c9e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在已经准备好了我们需要的环境。</p><h1 id="7e8d" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">建立一个帐户并获得一个API密钥</h1><p id="3bb0" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">注册并<a class="ae jo" href="https://marketdata.tradermade.com/signup" rel="noopener ugc nofollow" target="_blank">创建一个账户</a>，你将会收到一封欢迎邮件。如果您已经在我们这里注册，请使用这个<a class="ae jo" href="https://marketdata.tradermade.com/myAccount" rel="noopener ugc nofollow" target="_blank">仪表盘</a>获取密钥。</p><h1 id="eeef" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">编写REST客户端并通过REST API检索外汇和CFD数据</h1><p id="0a5c" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">现在，您已经设置好了环境，导航到您创建的目录并创建一个文件，我将调用mine TMSRESTClient.js。</p><p id="501f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，开始编码吧。</p><p id="d4d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们将导入Axios库</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="01f9" class="ma ke hi lw b fi mb mc l md me">const axios = require('axios');</span></pre><p id="a3c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们编写一个get命令并传入实时端点的URL，您将需要在下面的代码中替换您的API键，并更新您希望调用的货币。对于这个例子，我们将调用几个外汇汇率和一个CFD汇率，因为它们返回的数据略有不同。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="fbb1" class="ma ke hi lw b fi mb mc l md me">axios.get('https://marketdata.tradermade.com/api/v1/live?currency=EURUSD,GBPUSD,UK100&amp;api_key=YOUR_API_KEY')<br/>  .then(response =&gt; {<br/>    console.log(response.data);<br/>  })<br/>  .catch(error =&gt; {<br/>    console.log(error);<br/>  });</span></pre><p id="0d02" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要运行该程序，我们在文件所在的目录中打开一个命令提示符，并键入以下命令。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="cf7d" class="ma ke hi lw b fi mb mc l md me">node TMSdataClient.js</span></pre><p id="d803" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该会得到类似如下的输出</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="492a" class="ma ke hi lw b fi mb mc l md me">{<br/>  endpoint: 'live',<br/>  quotes: [<br/>    {<br/>      ask: 1.16411,<br/>      base_currency: 'EUR',<br/>      bid: 1.1641,<br/>      mid: 1.1641,<br/>      quote_currency: 'USD'<br/>    },<br/>    {<br/>      ask: 1.38079,<br/>      base_currency: 'GBP',<br/>      bid: 1.38078,<br/>      mid: 1.38078,<br/>      quote_currency: 'USD'<br/>    },<br/>    { ask: 7199.3, <br/>      bid: 7198.2, <br/>      instrument: 'UK100', <br/>      mid: 7198.75 <br/>    }<br/>    ],<br/>    requested_time: 'Thu, 21 Oct 2021 08:42:21 GMT',<br/>    timestamp: 1634805742<br/>}</span></pre><p id="b74a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">瞧啊。我们现在有了来自REST API的实时数据。然而，这是原始的JSON，所以现在我们将做一些工作来遍历数据，并以更可读的格式输出它。</p><p id="6260" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的JSON可以看出，quotes对象是一个包含键和值的映射数组。但是，CFD映射只有一个工具关键字字段，而货币映射有base_currency和quote_currency关键字。因此，我们将添加一个if语句来检查base_currency，并在base_currency不在地图上时解析该工具。然后，我们从每个报价中抽取出价和要求，并输出它。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="3984" class="ma ke hi lw b fi mb mc l md me">for (quote in response.data.quotes){<br/>        quoteData = response.data.quotes[quote];<br/>        ccy = ""<br/>        if ( quoteData["base_currency"] != undefined){<br/>            ccy = quoteData["base_currency"] + quoteData["quote_currency"]          <br/>        }else{<br/>            ccy = quoteData["instrument"]<br/>        }<br/>        console.log(" Symbol " + ccy + " Bid " + quoteData["bid"] + " Ask " + quoteData["ask"])<br/>}</span></pre><p id="1532" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您再次运行该程序，您应该会看到下面的解析输出。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="a133" class="ma ke hi lw b fi mb mc l md me">Symbol EURUSD Bid 1.16416 Ask 1.16417<br/>Symbol GBPUSD Bid 1.38078 Ask 1.38079<br/>Symbol UK100 Bid 7199.4 Ask 7200.6</span></pre><p id="323f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本例中，我们使用了实时端点，但稍加修改的相同代码将适用于所有其他TraderMade端点、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#historical_rates" rel="noopener ugc nofollow" target="_blank">历史汇率</a>、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#tick_historical" rel="noopener ugc nofollow" target="_blank">分笔历史汇率</a>、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#minute_historical_rates" rel="noopener ugc nofollow" target="_blank">分钟历史汇率</a>、<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#hour_historical_rates" rel="noopener ugc nofollow" target="_blank">小时历史汇率</a>和<a class="ae jo" href="https://marketdata.tradermade.com/docs/restful-api#timeseries" rel="noopener ugc nofollow" target="_blank">时间序列</a>。</p><p id="f0e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请为我们的作品鼓掌并评论。我们对建议和想法持开放态度，我们一直期待着您的反馈。</p></div></div>    
</body>
</html>