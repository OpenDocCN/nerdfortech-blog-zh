# 更好的代码:1。if 和开关

> 原文：<https://medium.com/nerd-for-tech/better-code-1-ifs-and-switches-e27f2c119582?source=collection_archive---------13----------------------->

![](img/6e31f39cff2735c7deb2c939e13b5447.png)

来自 [Pexels](https://www.pexels.com/photo/woman-in-white-dress-shirt-using-white-laptop-computer-3790797/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels) 的 [Andrea Piacquadio](https://www.pexels.com/@olly?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels) 摄影

> 本系列的标题不是“最好的代码”或“让我教你一些东西”，因为那对我来说是荒谬的，也是相当傲慢的。另一方面，你会看到我展示语法变体并表达我对编码实践的观点。当然，这并不意味着我认为我掌握了更好编程的秘密，但是我坚信从这些页面中产生的任何想法或讨论[将/应该/能够]产生更好的代码。也许吧。

在这第一部分中，我们将通过回答一系列有助于我编写更好代码的问题来研究条件语句的可能用途，例如:条件的结果是什么(真正改变的是什么)？我如何保持我的代码可读？我如何避免重复？当变量/选项的数量增加时，它会扩展吗？我把数据、逻辑和 UI 分开了吗？

我认为 if 和 Switches 不需要任何介绍，所以我将继续讨论我为这次讨论选择的任务。

***PS:为了更好的体验，请在新窗口打开 Codesandbox，嵌入属性在编写时无法正常工作。***

# 任务

**TL；DR**:TypeScript 中的一个 React 组件，它呈现一个 HTML <按钮>，该按钮由一个【中/小】大小属性和一个【默认/成功/危险】颜色变量进行样式化。

正如上一节所述，我为前端开发人员选择了一个常见的任务，它应该是不言自明的，但我想花一分钟来证明我在设置上的选择。

*   React 允许我介绍一些我们可以通过在线代码沙箱进行交互的东西，它正在成为业界非常常见的框架；
*   JavaScript 非常受欢迎，被许多人所理解，并且以类型脚本的形式，它允许习惯于强类型转换知识的后端开发人员更好地阅读代码；
*   这种组合应该能吸引尽可能多的观众。

整个项目的结构如下…

入口点是“App.tsx ”,它呈现所有的按钮组件，并管理传递给按钮的随机化大小和变量属性的状态，这对于本文的目的来说不是很有趣。

“components”文件夹包含了我想展示的按钮组件的所有变体。

# 字面上的方法

回到任务，显然两个属性(在 React 的世界中为`props`)size 和 variant 为按钮生成了一个 6 种可能样式的矩阵:

*   中:违约、成功、危险；
*   小:违约，成功，危险；

下面的例子是上面句子的最直译:

组件/按钮 01.tsx

如果你认为这是不好的，丑陋的，或者明显是错误的，我希望我可以告诉你，这是一种夸张，像这样的代码在现实世界中并不存在…但是，你知道它存在。

在所有潜在的错误中，对我来说，有几件事比其他事情更明显:

*   逻辑和 UI 混淆了:开关突然负责通过`return` s 呈现 UI。
*   重复的数量是惊人的:改变的只是我们传递给按钮的样式数组，但是我们一遍又一遍地重写 HTML(准确地说是 JSX)。

解决上述问题的第一次尝试可能会让我们陷入 JavaScript 和其他编程语言中的一种常见模式:将重复的呈现(`return`语句)提取到外部方法/函数中。

组件/按钮 01a.tsx

我提前向所有使用 Java 或 dotNet 的程序员道歉，但是我不得不粗鲁地说，太多的抽象已经困扰编程世界太久了。作为一名 React 前端开发人员，我会去组件的渲染部分寻找…嗯，你知道，渲染了什么，这应该发生在类的`render()`方法或功能组件的`return`语句中。把它移走并没有帮助，但可悲的是，我在任何地方都看到不同背景的人这样做。

我是这样想的:我们正在编写一个迷你组件来处理一个相当小的按钮组件的呈现，而这个组件应该做的就是呈现一个样式化的按钮。对我来说，这听起来不对。

# 数据、逻辑和用户界面的分离。

在这一点上，你可能已经注意到我还没有谈到`if`或`switch`，上面的标题似乎也没有提到它。但是我并不想在这篇文章中解释什么是条件语句或者它们有什么作用:如果你愿意跟随我的思路，你会看到我只是在试图回答这个问题，“对于一个给定的情况，什么是最好的可能实现？”

为了做到这一点，我不得不岔开一分钟，谈论 MVC(模型、视图、控制器)不是作为一种模式，而是作为一种编码风格。

*   让我们称任何与获取数据有关的东西为模型:在 React 中，它将来自于`props`、内部`state`或`global state`，比如 Redux。
*   考虑查看任何可视化的或呈现给用户的内容，并在 React 中显示为类中的`render()`方法或功能组件中的`return`方法的内容。
*   控制器将被拉伸以指示处理逻辑或数据到 UI 的转换的任何东西。

上面的代码都不能区分这些问题。让我来解决。

组件/按钮 02.tsx

即使我们没有真正做太多来简化我们的条件，我们现在已经有了视图和控制器的完全分离。两个简单的属性`props`代表了模型。

简而言之，我认为 MVC 可以在任何地方应用，而且更多的时候，这种思维方式使得代码更加简单和清晰。

# 默认值

在最新的例子中，我为`buttonStyles`引入了一个默认值。

我知道这看起来像是一个很小的附加功能，但对我来说是一个非常强大的功能。一些影响是:

*   默认值在我们函数的顶部有明确的说明；
*   `default`道岔区段简化或空开，不需要`else`；
*   响应条件的“什么变化”是清楚的，并且在顶部；
*   可以在单个入口变量中修改默认值；
*   如果您的代码是错误的，并且未能捕捉到 props 更改，那么您将返回到一个非损坏值。

可能我更喜欢使用 IF 而不是 switch 的唯一原因是 SWITCH 的默认部分，catch-all case，卡在底部。但这是一个小问题，只是下意识地表现出来。

你想听一个关于路由器防火墙的牵强附会的平行案例吗？真是太巧了，事情是这样的:想象一个规则说`block all incoming and outcoming requests.`，从那里，你可以开始处理异常。一般来说，在身份验证和安全性方面是一样的:你不会启动一个没有默认“锁定一切”的程序，因为它容易出现可怕的错误。

从现在开始，我将使用如上所示的默认值，因为它们是我个人最喜欢的，无论如何它们不应该真正改变对话。

# 什么变化:条件的结果。

这个按钮组件的两个属性通过对其应用不同的 CSS 类集来修改`<button>`标签的样式:Small、Success / Danger，加上默认的通用 ButtonStyle。

ButtonStyle 被其他类覆盖，就像在普通 CSS 中一样(从上到下)，因此必须从开头开始；本例中使用的库`classname`只是将一组类转换成一个字符串。

就是这样。这就是由于道具操作而发生的所有变化:发送到`<button>.`的样式类字符串

在处理条件时，“结果”是花费我大部分时间和思想的东西。

让我这样简化组件。

组件/按钮 02a.tsx

用于变量的`switch`和用于尺寸的`if`是独立的，并被视为独立的；默认的`buttonStyles`数组已经包含了`Sizes.medium`和`Variants.default;`条件的目标/结果/变化是一个单独的变量，一个字符串数组，很快就被转换成我们按钮的一组工作类。

由于我对初始值/默认值的热爱，没有`else`和一个空的`default`，但我不认为这是一个强制性的选择，我不会强加给任何人。

关于实际 IFs & Switches 的简要说明:一个`switch`语句比一个`if-else`语句更有性能，但是只有当有许多条件在起作用时才如此；两个以上的案例似乎更具可读性；当需要增加条件数量时，它的伸缩性更好；

在所有其他情况下，我认为这取决于个人喜好。

下面是相同概念的两种变体。

components/Button02b.tsx If 代替开关

components/Button02c.tsx 更好的初始值

# 变体和其他用例。

匹配模式是 IFs & Switches 的一种变体，它们广泛应用于许多语言中，包括 JavaScript，将对象的键(甚至是`enum` s)作为条件变化的设置/选项。

这里有一个例子。

组件/按钮 03.tsx

让我花一点时间来看看将逻辑提取到外部方法的伟大实践，如果有机会在其他地方重用该逻辑，这将非常有用。

我不认为这篇文章的概念需要这样，但这是一个令人惊讶的习惯，所以我也会贴一个例子。

组件/按钮 03a.tsx

# 结论。

感谢您通过这个巨大的职位！我将使结论简明扼要。

我在这篇文章的开头强调了我在[一般编码和]编写条件语句时思考的问题:

*   条件的结果是什么(真正改变的是什么)？
*   我如何保持我的代码可读？
*   我如何避免重复？
*   当变量/选项的数量增加时，它会扩展吗？
*   我把数据、逻辑和 UI 分开了吗？

这些问题基于 MVC，DRY，KISS，天知道还有多少其他的缩写。

你有更好的解决方案或实践可以和我分享吗？我喜欢改进我的代码，我努力在截止日期/RL/工作/愤怒的老板/bug/服务器停机时间允许的情况下尽可能努力地考虑它。

# 常见问题:

我不会说俏皮话。我总是认为我的同事可能是连环杀手。

左花括号应该在顶部，而不是在新的一行。句号。

测试意味着点击按钮，看看会发生什么。不能保证它是一个可行的例子。

是的，对不起，英语不是我的母语。

是的，那是我的真名。再次抱歉。