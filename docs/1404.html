<html>
<head>
<title>How To Send SMS Messages Using Twilio, Rails, and React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Twilio、Rails 和 React 发送短信</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-send-sms-messages-using-twilio-rails-and-react-47b749d21c7f?source=collection_archive---------1-----------------------#2021-03-17">https://medium.com/nerd-for-tech/how-to-send-sms-messages-using-twilio-rails-and-react-47b749d21c7f?source=collection_archive---------1-----------------------#2021-03-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex if ig ih ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="63ed" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">我的朋友凯文(看看他的博客)🤓)和我一直在为一家名为分手空间的公司做一个自由职业项目。他们的任务是阻止通过模板化分手短信鬼混的约会趋势。与一家公司合作，让他们的愿景成为现实，这是一件有趣且值得的事情。</p><p id="5a09" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">在开发这款应用时，我们开发了一个功能，让用户可以向移动设备发送短信。最终我们取消了这个功能，但我认为创建它真的很有趣，并想分享！有许多受欢迎的服务可以使用，我发现了 Twilio，他们有非常容易理解的文档。Twilio 可以做的不仅仅是发送短信，但对于本文，我将只介绍发送文本。</p><h1 id="0f38" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">什么是短信？</h1><figure class="kq kr ks kt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kp"><img src="../Images/cef9a64e2bdf7341bee86aba9f08bbb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PBsp6hCmVH0FmesAf38G8Q.png"/></div></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="675c" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">SMS 代表短消息服务，是一种纯文本标准，通常通过蜂窝网络从一个移动设备发送到另一个移动设备。简单来说就是短信！如果您想了解更多信息，请查看<a class="ae jq" href="https://www.twilio.com/docs/glossary/what-is-an-sms-short-message-service" rel="noopener ugc nofollow" target="_blank"> Twilio 文档</a>。</p><h1 id="91c0" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">Twilio 设置</h1><figure class="kq kr ks kt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es la"><img src="../Images/1719a2ab1dfefb052f98113f4f6cceb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1ybEhGyZFFCkil64.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">Twilio 过程！</figcaption></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="3582" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">如果您没有 Twilio 的帐户，请在这里注册一个<a class="ae jq" href="https://www.twilio.com/try-twilio?_ga=2.31364155.50728295.1615230985-148678736.1614030722" rel="noopener ugc nofollow" target="_blank"/>。接下来，安装<a class="ae jq" href="https://www.twilio.com/docs/sms/quickstart/ruby" rel="noopener ugc nofollow" target="_blank"> Twillio CLI </a>。对于我们的 Rails 后端，我们将需要<code class="du lf lg lh li b">Account Sid</code>、<code class="du lf lg lh li b">Auth Token</code>和您的<code class="du lf lg lh li b">Twilio Number</code>。现在，我们已经完成了 Twilio 的设置。让我们继续设置我们的 Rails 后端！</p><h1 id="ffc1" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">后端设置</h1><p id="1636" class="pw-post-body-paragraph is it hi iu b iv lj ix iy iz lk jb jc jd ll jf jg jh lm jj jk jl ln jn jo jp hb bi translated">让我们首先用以下代码生成一个 Rails 应用程序:</p><pre class="kq kr ks kt fd lo li lp lq aw lr bi"><span id="5edc" class="ls js hi li b fi lt lu l lv lw">rails new twilio-messaging --database=postgresql --api</span></pre><p id="fc9d" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">在<code class="du lf lg lh li b">Gemfile</code>中，我们需要包含一个宝石来整合 Twilio。添加<code class="du lf lg lh li b">gem 'twilio-ruby'</code>，也取消<code class="du lf lg lh li b">gem 'rack-cors'</code>，运行<code class="du lf lg lh li b">bundle install</code>。</p><h2 id="0fa9" class="ls js hi bd jt lx ly lz jx ma mb mc kb jd md me kf jh mf mg kj jl mh mi kn mj bi translated">生成模型和控制器</h2><p id="e376" class="pw-post-body-paragraph is it hi iu b iv lj ix iy iz lk jb jc jd ll jf jg jh lm jj jk jl ln jn jo jp hb bi translated">现在我们需要为<code class="du lf lg lh li b">SmsMessage</code>生成模型，它具有<code class="du lf lg lh li b">mobile_number</code>和<code class="du lf lg lh li b">message</code>的属性，数据类型为 string。</p><pre class="kq kr ks kt fd lo li lp lq aw lr bi"><span id="02d9" class="ls js hi li b fi lt lu l lv lw">rails g model SmsMessage mobile_number:string message:string --no-test-framework</span></pre><p id="df21" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">接下来还将生成控制器:</p><pre class="kq kr ks kt fd lo li lp lq aw lr bi"><span id="6310" class="ls js hi li b fi lt lu l lv lw">rails g controller SmsMessages --no-test-framework</span></pre><p id="71ff" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">一旦我们生成了控制器和模型，让我们创建数据库并进行迁移</p><pre class="kq kr ks kt fd lo li lp lq aw lr bi"><span id="3181" class="ls js hi li b fi lt lu l lv lw">rails db:create &amp;&amp; rails db:migrate</span></pre><h2 id="628d" class="ls js hi bd jt lx ly lz jx ma mb mc kb jd md me kf jh mf mg kj jl mh mi kn mj bi translated">配置文件</h2><p id="3d00" class="pw-post-body-paragraph is it hi iu b iv lj ix iy iz lk jb jc jd ll jf jg jh lm jj jk jl ln jn jo jp hb bi translated">让我们导航到<code class="du lf lg lh li b">config/initializers/cors.rb</code>。在文件中，用<code class="du lf lg lh li b">*</code>替换<code class="du lf lg lh li b">example.com</code>，并取消下面的注释</p><figure class="kq kr ks kt fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="6ab7" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">出于安全考虑，我们需要创建一个<code class="du lf lg lh li b">environment.rb</code>文件来存储我们的 Twilio 信息，并将这个文件名添加到<code class="du lf lg lh li b">.gitignore</code>。这将阻止我们的<code class="du lf lg lh li b">environment.rb</code>文件被提交到 GitHub。</p><p id="5132" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在将您的<code class="du lf lg lh li b">Twilio number</code>、<code class="du lf lg lh li b">Account Sid</code>和<code class="du lf lg lh li b">Auth Token</code>添加到您的<code class="du lf lg lh li b">environment.rb</code>文件中。在<code class="du lf lg lh li b">auth_sid</code>、<code class="du lf lg lh li b">auth_token</code>和<code class="du lf lg lh li b">twilio number</code>字段中，用您自己的 Twilio 信息替换它们！确保它们是字符串格式。</p><figure class="kq kr ks kt fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="ab2a" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">接下来，导航到<code class="du lf lg lh li b">config/routes.rb</code>并为<code class="du lf lg lh li b">sms_messages</code>设置<code class="du lf lg lh li b">create</code>路线:</p><pre class="kq kr ks kt fd lo li lp lq aw lr bi"><span id="a2fc" class="ls js hi li b fi lt lu l lv lw">resources :sms_messages, only: [:create]</span></pre><p id="0fc6" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在让我们实现 Sms 消息的创建。转到您的<code class="du lf lg lh li b">SmsMessagesController</code>并定义方法<code class="du lf lg lh li b">create</code>。</p><h1 id="5886" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">SmsMessagesController</h1><p id="b4a8" class="pw-post-body-paragraph is it hi iu b iv lj ix iy iz lk jb jc jd ll jf jg jh lm jj jk jl ln jn jo jp hb bi translated">在<code class="du lf lg lh li b">SmsMessagesController</code>的<code class="du lf lg lh li b">create</code>方法中，我们想要做的是使用 Twilio API 将消息从客户端发送到提供的手机号码。遵循下面的代码片段。</p><figure class="kq kr ks kt fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><h1 id="4ee0" class="jr js hi bd jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk mo km kn ko bi translated">前端设置</h1><p id="31a0" class="pw-post-body-paragraph is it hi iu b iv lj ix iy iz lk jb jc jd ll jf jg jh lm jj jk jl ln jn jo jp hb bi translated">对于前端，我刚刚创建了一个新的 React 应用程序，并下载了<a class="ae jq" href="https://styled-components.com/" rel="noopener ugc nofollow" target="_blank">样式组件</a>来帮助前端看起来更漂亮😍。我还使用了你应该熟悉的钩子。如果你需要设置 React 应用程序的说明，请点击这里的文档<a class="ae jq" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank">或点击这里的</a>阅读 hooks。</p><p id="5dcb" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">创建一个 SmsForm 组件，它将处理向 Rails API 提交手机号码和文本消息。在<code class="du lf lg lh li b">SmsForm</code>中，我们将创建一个表单、一个手机号码输入、一个消息文本区和一个提交按钮。</p><p id="9eb1" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">一旦点击了提交按钮，我们的应用程序就会向我们的 Rails API 发送一个包含用户输入的 post 请求。需要注意的一件重要事情是，Twilio 需要以<code class="du lf lg lh li b">1</code>为前缀的手机号码。所以在第 12 行，你会看到我给用户提交的手机号码添加了一个<code class="du lf lg lh li b">1</code>。</p><p id="3c97" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">从第 53 行开始，我使用<code class="du lf lg lh li b">styled-components</code>来设计我的 React 应用程序。请随意忽略这部分代码，做自己的样式😊。</p><figure class="kq kr ks kt fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="d654" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">现在，只需将 SmsForm 组件导入到您的<code class="du lf lg lh li b">src/App.js</code>中，就大功告成了！</p><figure class="kq kr ks kt fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><h1 id="bbe1" class="jr js hi bd jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk mo km kn ko bi translated">最终的结果！</h1><p id="cf17" class="pw-post-body-paragraph is it hi iu b iv lj ix iy iz lk jb jc jd ll jf jg jh lm jj jk jl ln jn jo jp hb bi translated">用<code class="du lf lg lh li b">npm start</code>启动您的 React 应用程序，您应该会看到如下所示。</p><figure class="kq kr ks kt fd ii er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mp"><img src="../Images/6331707abb4bc641ed1bb545e98e46b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8bt2aXwzzDX-2_TMLoYGA.png"/></div></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="b578" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">既然我们的前端已经设置好了，我们就可以向 Rails API 提交请求了！首先，如果您还没有用<code class="du lf lg lh li b">rails s</code>启动 Rails API。接下来在你的浏览器中输入你的手机号码和短信，然后点击提交。</p><figure class="kq kr ks kt fd ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure></div><div class="ab cl il im gp in" role="separator"><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq ir"/><span class="io bw bk ip iq"/></div><div class="hb hc hd he hf"><p id="bc20" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">你应该会在手机上收到一条短信。恭喜🎉！现在，您已经正式将 Twilio 集成到您的 Rails API 中。你可以从这个博客查看所有代码，<a class="ae jq" href="https://github.com/slurio/sms-frontend" rel="noopener ugc nofollow" target="_blank">前端</a>和<a class="ae jq" href="https://github.com/slurio/sms-backend" rel="noopener ugc nofollow" target="_blank">后端</a>。</p><p id="a203" class="pw-post-body-paragraph is it hi iu b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp hb bi translated">您还可以利用 Twilio 做更多事情！请随意查看<a class="ae jq" href="https://www.twilio.com/docs/api" rel="noopener ugc nofollow" target="_blank"> Twilio REST API 文档</a>。我想添加的一点是用户输入的验证和错误消息，并添加<a class="ae jq" href="https://www.twilio.com/docs/lookup/api" rel="noopener ugc nofollow" target="_blank">电话号码查找</a>。我希望你喜欢这个博客和快乐编码！</p></div></div>    
</body>
</html>