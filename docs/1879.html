<html>
<head>
<title>A Smart Angular Spinner - Scoping on App as well as Component Level</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能角度微调器——应用程序和组件级别的范围</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/a-smart-angular-spinner-scoping-on-app-as-well-as-component-f9f8dd3e191c?source=collection_archive---------7-----------------------#2021-04-11">https://medium.com/nerd-for-tech/a-smart-angular-spinner-scoping-on-app-as-well-as-component-f9f8dd3e191c?source=collection_archive---------7-----------------------#2021-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="840f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Angular 中创建 spinner 组件在几乎所有的 web 应用程序中都可以完成。第一条经验法则是尽可能避免旋转。有几种聪明的方法可以做到这一点。我将在另一篇文章中讨论这个问题。在这篇文章中，我们将创建相同的老 spinner 的角度，但它的袖子上有一个小技巧。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/20f086177df783f6fa3211c990ff3c6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ishwNQpdIGt2EzCB9ALJZg.png"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="6b05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我与不同跨国公司的前端开发经验中，我见过 spinner 以几种不同的方式实现。</p><ol class=""><li id="20fd" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">创建一个单独的<strong class="ih hj">旋转组件</strong>，并在其他组件中需要使用选择器的地方添加选择器。设置<code class="du kf kg kh ki b">*ngIf</code>标志以显示和隐藏组件内的微调器。</li><li id="dda4" class="jw jx hi ih b ii kj im kk iq kl iu km iy kn jc kb kc kd ke bi translated">创建一个全局微调组件，并通过服务不断调用它。通常，它应用于应用程序级别，在加载数据时，整个 UI 都被阻塞。</li></ol><p id="0f61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的一个项目中，我遇到了一个应用于应用程序级别的 spinner 组件。每当使用 spinner 服务调用它时，整个 UI 都会被阻塞。这是一个简单的实现。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="efce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，一切顺利。但是后来，我意识到很少有包含几个小组件来显示数据的屏幕(<strong class="ih hj">例如:</strong>一个仪表板 UI)。因此，应用程序级别的微调器会限制用户交互时间，直到所有组件的全部数据都被加载。这似乎是一个难以管理的问题，因为除非加载全部数据，否则仪表板 UI 将被阻塞。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="0abc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我决定探索使用一个 Spinner 组件的可能性，它也可以具有应用程序级别和组件级别的范围。我决定重用同一个组件，但是对代码做了一些小小的修改。</p><p id="5f50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我是这样做的:</p><ol class=""><li id="67a3" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">创造了另一个<code class="du kf kg kh ki b">div</code>，里面有造型<code class="du kf kg kh ki b">position: absolute</code><code class="du kf kg kh ki b">spinner.component.html</code>。我添加了一个模板标签<code class="du kf kg kh ki b">#componentSpinner</code></li></ol><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kq kp l"/></div></figure><p id="6de7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.我使用<code class="du kf kg kh ki b">display:none</code>将<code class="du kf kg kh ki b">#componentSpinner</code>从可见性中移除，因此默认情况下它是不可见的。为了实现这一点，我使用了<code class="du kf kg kh ki b">AfterViewInit</code>钩子。一旦我有了<code class="du kf kg kh ki b">ElementRef</code>，我就把它保存在<code class="du kf kg kh ki b">SpinnerService</code>里面。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kq kp l"/></div></figure><p id="7798" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.现在我需要将这个模板添加到我们想要添加范围微调器的目标<code class="du kf kg kh ki b">Component</code>中。一旦加载完成，我还需要删除我动态添加的<code class="du kf kg kh ki b">#componentSpinner</code>模板。</p><p id="6232" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决这个问题，我创建了:</p><ul class=""><li id="1a06" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kr kc kd ke bi translated"><code class="du kf kg kh ki b">startLoadingForComponent(component: ElementRef)</code></li><li id="8481" class="jw jx hi ih b ii kj im kk iq kl iu km iy kn jc kr kc kd ke bi translated"><code class="du kf kg kh ki b">finishLoadingForComponent(component: ElementRef)</code></li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kq kp l"/></div></figure><p id="7533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而且，就是这样！</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="f4ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在组件内部使用它，我们需要向父 div 添加一个<code class="du kf kg kh ki b">#template</code>。这将有助于我们获得整个组件 HTML，并向其中添加我们的小 spinner 代码。</p><p id="7e0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的使用中，我们可以拥有一个带有<code class="du kf kg kh ki b">DashboardComponent</code>的应用。<strong class="ih hj">仪表板组件</strong>可以调用几个 API，也可以有几个小组件，比如<code class="du kf kg kh ki b">OrderCountComponent</code> &amp; <code class="du kf kg kh ki b">UserCountComponent</code>。这些组件可能依赖<code class="du kf kg kh ki b">DashboardComponent</code>来获得一些<code class="du kf kg kh ki b">@Input</code>数据，或者它们可以独立地在内部进行 API 调用。</p><p id="fb38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过将<code class="du kf kg kh ki b">#userTemplate</code>添加到其父<code class="du kf kg kh ki b">div</code>来使用作用域为<code class="du kf kg kh ki b">UserCountComponent</code>的<code class="du kf kg kh ki b">SpinnerComponent</code></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kq kp l"/></div></figure><p id="07dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，使用<code class="du kf kg kh ki b">ElementRef</code>在组件级别显示微调器，如下所示:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kq kp l"/></div></figure><p id="e0c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我增加了一些密集的延迟来模拟缓慢的网络调用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/fda9983065272368bb3b3a2ef9571689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*voZ9mEDeWm_SM7mA3Nnz5A.gif"/></div></div></figure><p id="7f62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我知道它可能不适合所有用例，但它扩展了现有<code class="du kf kg kh ki b">SpinnerComponent</code>的特性。如果你喜欢这个想法或者想进一步改进，请随时给我留言。对我来说，这是一个有趣而独特的实现。</p><p id="aa3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以将<a class="ae kt" href="https://github.com/shashankvivek/" rel="noopener ugc nofollow" target="_blank"> my github profile </a>中的最终代码称为<a class="ae kt" href="https://github.com/shashankvivek/scoped-spinner" rel="noopener ugc nofollow" target="_blank"> scoped-spinner </a>项目。</p><blockquote class="ku"><p id="1d2a" class="kv kw hi bd kx ky kz la lb lc ld jc dx translated">如果你喜欢你所读的，请👏 👏拍手声👏 👏几次鼓励我🐼写这样的文章。干杯！！</p></blockquote></div></div>    
</body>
</html>