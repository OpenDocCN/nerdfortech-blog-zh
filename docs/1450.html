<html>
<head>
<title>Using Dapper In ASP.NET Core Web API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在ASP.NET核心Web API中使用Dapper</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/using-dapper-in-asp-net-core-web-api-1d253e0e16a4?source=collection_archive---------0-----------------------#2021-03-20">https://medium.com/nerd-for-tech/using-dapper-in-asp-net-core-web-api-1d253e0e16a4?source=collection_archive---------0-----------------------#2021-03-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aabbf8f44d88c3e990813d04ab8cbe01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sld1VyV-wbPGx7czSetoCg.png"/></div></div></figure><p id="4753" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo"> F </em> </strong>首先，让我们清楚地了解一下Dapper，以及它将如何在我们的核心API中发挥作用。我想我们大多数人都知道Dapper是什么，但这篇文章是为那些不知道Dapper的人写的。</p><h1 id="1450" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">衣冠楚楚的</h1><p id="d964" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Dapper是一个简单的对象映射器，只不过是对象关系映射(ORM ),负责数据库和编程语言之间的映射，并且在速度方面拥有微型ORM之王的称号。它实际上与使用原始ADO.NET数据读取器和实体框架一样快。</p><p id="d581" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">Dapper是如何工作的？</strong></p><ol class=""><li id="1d8c" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">创建一个IDbConnection对象。</li><li id="021a" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">编写一个查询来执行CRUD操作</li><li id="1fe9" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">在Execute方法中将查询作为参数传递。</li></ol><h1 id="6c3c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">表演</h1><p id="5170" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">与所有对象关系映射相比，Dapper是第二快的ORM。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/cc2d234adf9d41136aea610e6ad6a546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/0*_Yx7W5C4ovYO75QP.jpg"/></div></figure><p id="a267" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Git Hub-Repo </strong></p><div class="ll lm ez fb ln lo"><a href="https://github.com/JayKrishnareddy/Dapper_ORM" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hj fi z dy lt ea eb lu ed ef hh bi translated">JayKrishnareddy/Dapper_ORM</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">github.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc io lo"/></div></div></a></div><p id="d64c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第一步</strong></p><p id="e69b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个ASP.NET核心项目</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/51a7317264c86660fcf6f15815b5f3ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Hvil0WFcHGzvifXd.png"/></div></div></figure><p id="f21d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击下一步按钮。</p><p id="6c89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第二步</strong></p><p id="4145" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">添加项目名称和解决方案名称，将项目保存到所需的任何位置。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/34f9e601748a49da251d99c704c7a6a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A4a0AKDWYuMMR_C_.png"/></div></div></figure><p id="5b00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击创建按钮。</p><p id="cc50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三步</strong></p><p id="a074" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择适当的API版本</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/8d89e521eb0a525891e3512ed443eb8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UAvxho0GxOyyjCkL.png"/></div></div></figure><p id="8109" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击“创建”按钮，将创建一个具有基本设置的示例项目。现在让我们进入我们的项目。</p><p id="79c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个任意名称的空API控制器(Home)</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es me"><img src="../Images/d69d04bd06d1302b763b21b0a0e9974a.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/0*k3eTRjSfLcjHWVpi.png"/></div></figure><p id="1c43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在创建Services文件夹，并向其中添加一个接口(IDapper.cs)和一个类(Dapperr.cs)。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/2741df4f75f5df76ffcc409e718e9961.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/0*AtnKWR-pH1djr5nM.png"/></div></figure><p id="37dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在添加ASP.NET核心库来设置数据库，并从Nuget包管理器将Dapper库添加到我们的项目中。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/979ada3894c10e57c815721899ec1d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SXhnbVQ19ytKkob8.png"/></div></div></figure><p id="4cbc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将IDapper.cs接口中的以下代码添加到我们项目中执行Crud操作的位置。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="9b87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将代码添加到Dapperr.cs文件中，对于我们已经在接口中声明的每个方法，实际的方法实现都发生在该文件中</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="fe60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个DataContext文件夹并在其中添加AppContext类。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/61096bce6d69eb148776eeb73cbf6fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/0*KsjulGufJ2LkOr3j.png"/></div></figure><p id="fb7a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在AppContext.cs文件中添加代码，以连接DbContext并连接数据库。</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="7ba1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在appsettings.json文件中添加连接字符串:</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="129d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Startup.cs文件中进行连接设置。</p><p id="d248" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Startup.cs </strong></p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="459b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">添加Parameters.cs文件，该文件充当与现有SQL数据库的对象映射。</p><p id="86c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Parameters.cs </strong></p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="857c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在SQL DB中创建一个表，使用Dapper从这个核心API中访问表数据，因此我在数据库中创建了一个带有dummy的表名。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/19dc83f288551ee9d6a28694918dc33f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oyt-JXFi3ZN-UIbW.png"/></div></div></figure><p id="4401" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在家庭控制器中添加CRUD方法。</p><p id="47f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> HomeController.cs </strong></p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="0576" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们可以运行应用程序并调用相应的方法来获取数据，或者使用Dapper将数据添加到现有的数据库中。</p><p id="734f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">输出</strong></p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/046ca49f88421e503893e67c5929a022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Gm2AjjKopisCt2Dg.png"/></div></div></figure><p id="383e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你发现这篇文章对你有帮助，请给它一个👏🏻</p><p id="ac2e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">继续学习…！</p></div></div>    
</body>
</html>