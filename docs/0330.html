<html>
<head>
<title>Air pollution level forecasting with Bi-LSTM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用双 LSTM 预报空气污染水平</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/air-pollution-level-forecasting-with-bi-lstm-a459e0619338?source=collection_archive---------0-----------------------#2020-10-01">https://medium.com/nerd-for-tech/air-pollution-level-forecasting-with-bi-lstm-a459e0619338?source=collection_archive---------0-----------------------#2020-10-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fd252edd97374817479bb139d5f79b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sCr1u6jJiE4o3cOJzXFy4A.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">巴勃罗·加西亚·萨尔达尼亚在<a class="ae iu" href="https://unsplash.com/s/photos/direction?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7c44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我之前的<a class="ae iu" rel="noopener" href="/the-innovation/lstm-introduction-in-simple-words-fe544a45f1e7">帖子</a>中，我讨论了 LSTM，在这篇帖子中，我们将看到一个长短期记忆算法的变体(BiLSTM)的实现。双向 LSTM 从时间序列数据两个方向学习/更新权重。下图解释了同样的情况。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/f65fcdc101ea972c47dec0031bf47b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDwyq8f6rA2DFxaFgsFYDg.png"/></div></div></figure><p id="a9c5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将研究北京 PM2.5 数据集。该数据集包含 2010 年 1 月 1 日至 2014 年 12 月 31 日期间美国驻北京大使馆 PM2.5 水平的每小时数据。数据集的前三行如下。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/394c9554e27e549e240615abe2654e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PlctvTqwyVQkySNl4fX2KQ.png"/></div></div></figure><p id="48f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将预测空气污染水平，所以这个问题是回归型的。先说数据准备。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/29ae4654931783ee79dc4bb73ea8ccce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MrX4yCKbzAxrM-T39J_r9g.png"/></div></div></figure><p id="c8f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">特征转换。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/d93308718c06284161995955f25c73fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_siAnbVCcVKn2ZVG5Dk_lA.png"/></div></div></figure><p id="6973" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">编码和缩放后的数据如下所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/75912787e7ceaeab708ae25022cebebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W7NSYl_zWGkLNqoVPK2hdg.png"/></div></div></figure><p id="d271" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">LSTM 模型需要形状输入(样本、时间步长和特征)。因此，下面的代码将过去四个小时的数据转换为一行，其中包含过去四天的所有属性以及下一小时的 PM2.5 值。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/c6214274059d3f2ce709831dd701d88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWhWyimCMzzS2CH7IFEaew.png"/></div></div></figure><p id="07c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在转换之后，我们得到了以下形状的数据集。我们有 37 个属性(9 个特征 x 4 个时间步长+下一个小时的 PM2.5)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/2299a7e12698bcfe9358df4a2e7509b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pe36NCu3yU91RCdyatmSNQ.png"/></div></div></figure><p id="e0bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转换后的数据现在被分成训练、验证和测试数据集。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/cda0d6682edc4d010b250f047efddd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_tVy8-kVulnQLzJW14Z6A.png"/></div></div></figure><p id="be5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">神经网络创建。</p><blockquote class="kf kg kh"><p id="49bb" class="iv iw ki ix b iy iz ja jb jc jd je jf kj jh ji jj kk jl jm jn kl jp jq jr js hb bi translated">model = tf.keras.Sequential()</p><p id="63cd" class="iv iw ki ix b iy iz ja jb jc jd je jf kj jh ji jj kk jl jm jn kl jp jq jr js hb bi translated">model . add(TF . keras . layers . bidirectional(TF . keras . layers . lstm(64，activation= '卢瑟'，return_sequences=True)，input_shape=(n_hours，n_features)))</p><p id="bcc3" class="iv iw ki ix b iy iz ja jb jc jd je jf kj jh ji jj kk jl jm jn kl jp jq jr js hb bi translated">model . add(TF . keras . layers . bidirectional(TF . keras . layers . lstm(64，activation= '卢瑟'，return_sequences=True)))</p><p id="716e" class="iv iw ki ix b iy iz ja jb jc jd je jf kj jh ji jj kk jl jm jn kl jp jq jr js hb bi translated">model . add(TF . keras . layers . bidirectional(TF . keras . layers . lstm(50，activation= '卢瑟'))</p><p id="9b6e" class="iv iw ki ix b iy iz ja jb jc jd je jf kj jh ji jj kk jl jm jn kl jp jq jr js hb bi translated">model . add(TF . keras . layers . dense(1))<br/>model . compile(optimizer = ' Adam '，loss='mse '，metrics=['accuracy'])</p></blockquote><p id="c498" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看神经网络的形状。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es km"><img src="../Images/727d66ed41dca5419ea760aff58ec54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*B3wiHtMDp4_bkuMqEnxoDQ.png"/></div></figure><p id="8bcb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">训练模型。</p><blockquote class="kn"><p id="5e11" class="ko kp hi bd kq kr ks kt ku kv kw js dx translated">history = model.fit(train_X，train_y，epochs=50，batch_size=72，validation_data=(validate_X，validate_y)，verbose=0，shuffle=False)</p></blockquote><p id="05ad" class="pw-post-body-paragraph iv iw hi ix b iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo lb jq jr js hb bi translated">预测后，绘制预测与实际 PM2.5 水平的曲线图。测试数据(过去一年)的 RMSE 约为 19.57。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/ca405aa55d89468dd1261032d0797400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kz-aWE35vevS03PbTfwDQg.png"/></div></div></figure><p id="dc15" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以通过在 LSTM 之前添加一个 CNN 层来探索更多，并比较结果。希望这对你有帮助。</p></div></div>    
</body>
</html>