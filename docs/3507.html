<html>
<head>
<title>Custom React Router Prompt</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自定义React路由器提示</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/custom-react-router-prompt-d325538b4d2b?source=collection_archive---------0-----------------------#2021-06-12">https://medium.com/nerd-for-tech/custom-react-router-prompt-d325538b4d2b?source=collection_archive---------0-----------------------#2021-06-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a357d4e09ea393ee7e8788c4c10e6935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-Mrot3h5AJ9fTFQk"/></div></div></figure><div class=""/><p id="7673" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如何使用<strong class="is hu"> react-router </strong>实现导航自定义提示</p><h1 id="698e" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">自定义提示有什么用？</h1><p id="53f3" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">大多数react项目的组件都遵循UI <a class="ae kr" href="https://uxdesign.cc/everything-you-need-to-know-about-design-systems-54b109851969" rel="noopener" target="_blank">设计系统</a>。为了在整个应用程序中实现相同的设计一致性，他们重用了组件。然而，为了在存在一些未保存的用户数据的情况下阻止导航，默认浏览器提示是阻止用户导航到不同路线的最常见和最容易的方式。但是弹出窗口与您的库组件不匹配。</p><p id="4807" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">没有官方文档明确提到如何使用自定义模态代替默认的<code class="du ks kt ku kv b">react-router</code> <strong class="is hu">提示</strong>。</p><h1 id="c147" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">解决办法</h1><p id="18c0" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">要获得所需的结果，只需遵循几个简单的步骤。每一步都包含100%的工作代码片段。您可以在您的项目中使用它。</p><h2 id="c1c1" class="kw jp ht bd jq kx ky kz ju la lb lc jy jb ld le kc jf lf lg kg jj lh li kk lj bi translated">第一步</h2><p id="3cbd" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们需要禁用或阻止默认的浏览器提示。这可以通过向<strong class="is hu">浏览器</strong>的<code class="du ks kt ku kv b">getUserConfirmation</code>函数属性传递一个空回调来完成。</p><figure class="lk ll lm ln fd hk"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h2 id="aa1d" class="kw jp ht bd jq kx ky kz ju la lb lc jy jb ld le kc jf lf lg kg jj lh li kk lj bi translated">第二步</h2><p id="6ee4" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在让我们使用<code class="du ks kt ku kv b">react-router-dom</code>和<a class="ae kr" href="https://ant.design/components/modal/" rel="noopener ugc nofollow" target="_blank"> ant design </a>组件库中的<code class="du ks kt ku kv b">useHistory</code>钩子为<code class="du ks kt ku kv b">modal</code>组件创建一个定制的<code class="du ks kt ku kv b">RouterPrompt</code>组件。</p><figure class="lk ll lm ln fd hk"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="4a4d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">history.block</code>允许我们阻止导航离开当前页面。向block方法传递空函数或空参数会继续导航，不会阻塞或中断导航。</p><p id="8682" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">useEffect</code>用于处理提示的初始状态，是否使用<code class="du ks kt ku kv b">when</code>道具显示。</p><p id="1cad" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">handleOK</code>和<code class="du ks kt ku kv b">handleCancel</code>回调用于控制导航的确认和取消。</p><h2 id="7bdc" class="kw jp ht bd jq kx ky kz ju la lb lc jy jb ld le kc jf lf lg kg jj lh li kk lj bi translated">第三步</h2><p id="989c" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">让我们创建两个用于页面间导航的示例组件。比如，设第一个分量为<code class="du ks kt ku kv b">Dashboard.jsx</code>，第二个分量为<code class="du ks kt ku kv b">Home.jsx</code>。</p><figure class="lk ll lm ln fd hk"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="3fa8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">home</code>组件包含我们定制的<code class="du ks kt ku kv b">RouterPrompt</code>组件。该提示在页面变化时触发，也基于<code class="du ks kt ku kv b">when</code>属性。<code class="du ks kt ku kv b">when</code>道具用于有条件地触发提示。例如，如果<code class="du ks kt ku kv b">when</code>道具设置为<code class="du ks kt ku kv b">true</code>，则每次页面导航时都会显示提示(从家乡路线到其他路线或向前/向后导航)。</p><figure class="lk ll lm ln fd hk"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="4570" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">onOK</code>和<code class="du ks kt ku kv b">onCancel</code>回调属性必须返回布尔值，以便继续路由。</p><h2 id="6177" class="kw jp ht bd jq kx ky kz ju la lb lc jy jb ld le kc jf lf lg kg jj lh li kk lj bi translated">结果</h2><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lq"><img src="../Images/91d1abb3715c56524535c4449608dce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MqiQkNfvdfbpjYmnEBrshA.png"/></div></div></figure><h2 id="e6f4" class="kw jp ht bd jq kx ky kz ju la lb lc jy jb ld le kc jf lf lg kg jj lh li kk lj bi translated">结论</h2><p id="d903" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">您可以使用任何组件库的模式，甚至是您自己的自定义模式或默认浏览器提示。但是在实现<code class="du ks kt ku kv b">history.block</code>时要小心。</p><p id="3eb3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过遵循上述步骤，您可以获得想要的解决方案。代码100%正常工作。您可以将代码片段复制到您的应用程序中以节省时间。</p><h2 id="62c9" class="kw jp ht bd jq kx ky kz ju la lb lc jy jb ld le kc jf lf lg kg jj lh li kk lj bi translated">参考</h2><ol class=""><li id="41a5" class="lr ls ht is b it km ix kn jb lt jf lu jj lv jn lw lx ly lz bi translated"><a class="ae kr" href="https://reactrouter.com/web/api/Hooks/usehistory" rel="noopener ugc nofollow" target="_blank">https://reactrouter.com/web/api/Hooks/usehistory</a></li><li id="81a7" class="lr ls ht is b it ma ix mb jb mc jf md jj me jn lw lx ly lz bi translated"><a class="ae kr" href="https://reactrouter.com/web/api/history" rel="noopener ugc nofollow" target="_blank">https://reactrouter.com/web/api/history</a></li></ol></div></div>    
</body>
</html>