<html>
<head>
<title>How to Import Forex Data in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在R中导入外汇数据</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-import-forex-data-in-r-ecdceef2108d?source=collection_archive---------2-----------------------#2022-02-11">https://medium.com/nerd-for-tech/how-to-import-forex-data-in-r-ecdceef2108d?source=collection_archive---------2-----------------------#2022-02-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/474f250a02a4fa3fb8266a1a7f01f4b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMW1mTQo0yISwQJ1SuGobA.png"/></div></div></figure><p id="3bc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">了解如何使用REST API在R中导入实时和历史外汇数据。您还将学习如何将JSON响应解析成数据帧。要阅读本教程，你几乎不需要任何r编程知识。也就是说，本教程对有其他编程语言经验的人和想使用我们的REST API的人仍然有帮助。</p><h2 id="86dd" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">我们开始吧</h2><p id="3678" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">您需要注册我们的API，点击<a class="ae ko" href="https://marketdata.tradermade.com/signup" rel="noopener ugc nofollow" target="_blank">免费加入API</a>。一旦你有了钥匙，要保管好它。我们每月提供1000个请求，永远免费！然后你可以访问官方网站<a class="ae ko" href="https://cran.r-project.org/" rel="noopener ugc nofollow" target="_blank">下载R </a>。</p><h2 id="1c9d" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">获取实时外汇汇率</h2><p id="92ab" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">下载完成后，安装库，如下所示</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="b300" class="jo jp hi ku b fi ky kz l la lb"># Installing the packages<br/>install.packages("httr")<br/>install.packages("jsonlite")</span></pre><p id="4a84" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在可以导入刚刚安装的库，并将req变量设置为我们需要数据的URL字符串。我们要求的货币是欧元、美元和GBPUSD。您需要用注册时收到的REST API密钥替换api_key。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9ac2" class="jo jp hi ku b fi ky kz l la lb">library (httr)<br/>library (jsonlite)</span><span id="a42b" class="jo jp hi ku b fi lc kz l la lb">req &lt;- "https://marketdata.tradermade.com/api/v1/live?currency=EURUSD,GBPUSD&amp;api_key=api_key"</span></pre><p id="6464" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在将通过发出Get请求并将其设置为data_raw变量来请求数据。一旦我们有了原始格式的数据，我们将使用content函数将其转换为文本格式。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="d431" class="jo jp hi ku b fi ky kz l la lb">data_raw &lt;- GET(url = req)</span><span id="cba2" class="jo jp hi ku b fi lc kz l la lb">data_text &lt;- content(data_raw, "text", encoding = "UTF-8")</span></pre><p id="c37f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">python用户很容易理解这些代码，但是任何编程技能有限的用户都能够理解下面的代码。我们将把文本转换成JSON，然后创建一个数据框，将数据很好地格式化成我们可以使用的表格。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="306d" class="jo jp hi ku b fi ky kz l la lb">data_json &lt;- fromJSON(data_text, flatten=TRUE)</span><span id="10a5" class="jo jp hi ku b fi lc kz l la lb">dataframe &lt;- as.data.frame(data_json)</span><span id="72fd" class="jo jp hi ku b fi lc kz l la lb">dataframe</span></pre><p id="eaab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦你运行上面的代码，你会看到我们的API提供出价，询问价格，以秒为单位的时间戳。这对于进行波动性分析非常有用。大多数免费资源和许多付费资源不提供买卖差价。</p><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/ceeb029dc2979df15d134e70bcd72172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*juhYmuyux-K6HrAC.png"/></div></div></figure><p id="1939" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还通过我们的API为R用户提供日内外汇数据。这包括对定量分析有用的滴答、分钟和小时速率。</p><h2 id="e926" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">获取历史汇率</h2><p id="5158" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">我们将首先获得历史价格点(API免费提供前4天的历史价格点数据，不包括今天)。我们可以在一个电话中请求的最大值是30分钟，每个电话将使用每月1000个免费请求中的10个。如下所示，我们请求GBPUSD从2022年2月8日08:30到09:00的数据。确保将日期更改为最后四天，否则将返回错误。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="1153" class="jo jp hi ku b fi ky kz l la lb">tick_req &lt;- "https://marketdata.tradermade.com/api/v1/tick_historical_sample/GBPUSD/2022-02-08 08:30/2022-02-08 09:00?api_key=api_key&amp;format=json"</span><span id="5e70" class="jo jp hi ku b fi lc kz l la lb">data_tick_raw &lt;- GET(url = tick_req)</span><span id="1291" class="jo jp hi ku b fi lc kz l la lb">data_tick_text &lt;- content(data_tick_raw, "text", encoding = "UTF-8")</span><span id="fe7c" class="jo jp hi ku b fi lc kz l la lb">data_tick_json &lt;- fromJSON(data_tick_text, flatten=TRUE)</span><span id="2e5a" class="jo jp hi ku b fi lc kz l la lb">dataframe_tick &lt;- as.data.frame(data_tick_json)</span><span id="f77b" class="jo jp hi ku b fi lc kz l la lb">head(dataframe_tick)</span></pre><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/6063550386b5d9836c7dd8ee7ef63092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wwz2OUD4hlRU_cTc.png"/></div></div></figure><p id="ea8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据非常密集，每30分钟大约有2800多条引用，如果你是一个严肃的数据分析师，这很有用。现在您可以看到，从我们的外汇API中获取数据相当容易。让我们再做一次，但是这一次请求每小时数据的OHLC数据(最大历史记录只有从当前日期开始的2个月)。请查看我们的<a class="ae ko" href="https://tradermade.com/tutorials/how-to-import-forex-data-in-r/marketdata.tradermade.com/docs/restful-api" rel="noopener ugc nofollow" target="_blank">文档第</a>页，了解更多关于不同端点的历史记录。</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="2848" class="jo jp hi ku b fi ky kz l la lb">hour_req &lt;- "https://marketdata.tradermade.com/api/v1/timeseries?currency=EURUSD&amp;api_key=api_key&amp;start_date=2022-02-08-00:00&amp;end_date=2022-02-09-12:11&amp;format=records&amp;interval=hourly"</span><span id="8152" class="jo jp hi ku b fi lc kz l la lb">data_hour_raw &lt;- GET(url = hour_req)</span><span id="f09f" class="jo jp hi ku b fi lc kz l la lb">data_hour_text &lt;- content(data_hour_raw, "text", encoding = "UTF-8")</span><span id="7ca6" class="jo jp hi ku b fi lc kz l la lb">data_hour_json &lt;- fromJSON(data_hour_text, flatten=TRUE)</span><span id="5cf4" class="jo jp hi ku b fi lc kz l la lb">dataframe_hour &lt;- as.data.frame(data_hour_json["quotes"])</span><span id="6752" class="jo jp hi ku b fi lc kz l la lb">head(dataframe_hour)</span></pre><figure class="kp kq kr ks fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/7093ba50ea412ad2ff4836bdab267ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7nRH0RcxaU3H5KK8.png"/></div></div></figure><p id="b6ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如您所见，从我们的外汇REST API r中提取无偏见的外汇汇率相当容易。我们每月免费为多达1000个请求提供免费数据，因为为所有人提供外汇数据是我们的使命。你也可以得到CFD数据，详细信息请参考我们的文档页面。</p><p id="7ef2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您有任何问题或想提出建议，请告诉我们。我们一直渴望收到您的来信。还有，拍拍我们的作品，会被高度赞赏的。</p></div></div>    
</body>
</html>