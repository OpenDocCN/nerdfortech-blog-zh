<html>
<head>
<title>VLOOKUP, and a toe in Tableau</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VLOOKUP，和一个脚趾在Tableau</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/vlookup-and-a-toe-in-tableau-36751952cc53?source=collection_archive---------4-----------------------#2021-11-12">https://medium.com/nerd-for-tech/vlookup-and-a-toe-in-tableau-36751952cc53?source=collection_archive---------4-----------------------#2021-11-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每当Excel出现在我与数据界人士的交谈中，我得到的第一个问题是关于VLOOKUP的，这是对我专业知识的一个评估。所以我觉得是时候探索一下这个小功能了。</p><p id="30c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">VLOOKUP有三个必需的参数:</p><ul class=""><li id="3f8d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">您要查找的值，或搜索词</strong></li><li id="070f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">你要搜索的范围</strong></li><li id="6680" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">该范围内的列号。一旦搜索终止于某一行，该函数将返回指定列中该行的值。</strong></li></ul><p id="e0d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这来自Python和JavaScript领域，类似于一个FOR或WHILE循环，在一个列表(或一个数组的数组)中进行搜索。</p><p id="0a31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我制作了一个简单的工作簿来跟踪一家虚构公司的销售情况。仪表板存储总销售额和产品信息:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/3427802b11f62559a80d1814351a6bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7AFjvOG2szzKfZ3CGEf4Lg.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">仪表板的屏幕截图。</figcaption></figure><p id="06f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在另一张表上，任何单个销售记录<em class="kh">从仪表板中查找</em>价格和商品编号信息。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ki"><img src="../Images/998e48bbd4974a55d0c6c97aec7bbbd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8woAIyChQ0C_QXRhl74Sg.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">“销售”选项卡的屏幕截图。</figcaption></figure><p id="f018" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">突出显示的单元格中的公式是:</p><pre class="js jt ju jv fd kj kk kl km aw kn bi"><span id="2d72" class="ko kp hi kk b fi kq kr l ks kt">VLOOKUP(A2, 'Item Dashboard'!$A$2:$C$4, 3)</span></pre><p id="00d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中，我们搜索的是售出的商品(A2或Widget 1)。我们在<em class="kh">项目仪表板</em>表上的小表中进行搜索，并检索第3列中的值。如果这是在Python中，它可能看起来像这样:</p><pre class="js jt ju jv fd kj kk kl km aw kn bi"><span id="809b" class="ko kp hi kk b fi kq kr l ks kt">for l in item_list:</span><span id="ceba" class="ko kp hi kk b fi ku kr l ks kt">     if (l[0] == 'Widget 1'):</span><span id="1501" class="ko kp hi kk b fi ku kr l ks kt">         print(l[2])</span><span id="1ee5" class="ko kp hi kk b fi ku kr l ks kt">         break</span></pre><p id="3aeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(Excel有趣的地方当然是这些小算法一直在并行运行，而不仅仅是顺序运行。)</p><p id="6ef8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，我可以在Excel中看到相同结果的替代路径:IF语句、SWITCH等。但是强大的VLOOKUP很简洁，而且更有趣。</p><p id="6813" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">表格中的分析</strong></p><p id="0f50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最近使用的另一个工具是Tableau。这个强大的应用程序让我在网格中做梦。将我的简单幻想销售数据转储到它的引擎中，会产生这些按月汇总销售数据的可视化效果:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kv"><img src="../Images/c7ab11c4be02b4574650d62b4d260895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MaIKJA6v9zyX1hJvgvY19w.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">显示两年内所有三种产品的总销售额。</figcaption></figure><p id="33b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些过滤器让我们很容易就能发现原本模糊不清的观点。虽然Widget 1(在我编造的数据中)并不是最畅销的，但单从视觉上来看，它在今年年初还是相对受欢迎的:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es kw"><img src="../Images/a4899da119db3440e5280f1c767394d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*a817BDgvul9sQTsY8zgfFw.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">仅显示小部件1的销售额。</figcaption></figure><p id="b08c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">合计所有三种产品揭示了总体趋势:</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es kx"><img src="../Images/9f698016b5de124df0417eb88da31f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*prMtwdhVZedjebWqAk0n0w.png"/></div></figure><p id="7620" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果这个数据是真实的，我们可以对全年的产品需求做出合理的假设。这可以为我们的生产计划提供信息，并确定一年中有增长机会的时间。</p><p id="84ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Finito </strong></p><p id="8605" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多亏了VLOOKUP，我免去了一个杂乱的包含if或SWITCH语句的Excel栏。现在我已经尝到了甜头，我很想用这种技术获得更多的数据，然后把它带到强大的Tableau中做一些分析！</p></div></div>    
</body>
</html>