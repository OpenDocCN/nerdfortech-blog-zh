<html>
<head>
<title>Export Oracle database to PostgreSQL using AWS Glue!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 AWS Glue 将 Oracle 数据库导出到 PostgreSQL！</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/export-oracle-database-to-postgresql-using-aws-glue-551860965c58?source=collection_archive---------3-----------------------#2020-12-24">https://medium.com/nerd-for-tech/export-oracle-database-to-postgresql-using-aws-glue-551860965c58?source=collection_archive---------3-----------------------#2020-12-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><blockquote class="im in io"><p id="74b4" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是 AWS 胶水？</strong></p></blockquote><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es jo"><img src="../Images/db47c1a8b10ab05f571371ab178386a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*6HrXRc5JhH2_lib2vJAcaQ.png"/></div></figure><p id="911c" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">AWS Glue 是一个完全托管的 ETL 服务(提取-转换-加载),它使得在各种数据存储和数据流之间清理数据、分类数据、移动数据、丰富数据变得简单而经济。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><blockquote class="im in io"><p id="10b8" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> AWS 粘合术语与架构图</strong></p></blockquote><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es jz"><img src="../Images/4f88b7edd17629a4662ab67b96b455f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*BuQSvn6fnBKx0lJRkHoMgg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">AWS Glue 的架构图</figcaption></figure><p id="e203" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">数据目录:</strong>持久元数据存储在 AWS Glue 中。包含表定义、作业定义和管理 AWS Glue 环境的其他受控信息。</p><p id="0346" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">分类器</strong>:确定数据的模式。Glue 为 CSV、JSON、XML 等常见文件类型提供了分类器。</p><p id="0998" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">连接</strong>:它包含连接数据存储所需的属性。</p><p id="9e98" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">爬虫</strong>:用表格填充数据目录。这是大多数 AWS Glue 用户使用的主要方法。</p><p id="2427" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">数据库</strong>:数据目录中的数据库是保存表格的容器。手动或通过运行 crawler 在数据库中创建表。</p><p id="7e6e" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">数据存储</strong>:它是一个永久存储您的数据(例如 S3 水桶，RDS)。</p><p id="d7f9" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj"> Job </strong>:执行 ETL 工作所需的业务逻辑。由源数据库、转换脚本和目标数据库组成。</p><p id="8f81" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→ <strong class="is hj">脚本</strong>:包含从数据源提取数据的代码(python、pyspark 或 Scala)——转换数据——将数据加载到目标中。</p><h1 id="3307" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">它是如何实现的？</strong></h1><blockquote class="im in io"><p id="3a39" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="hi">先决条件:</em> </strong></p></blockquote><p id="e8bd" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→需要有一个 AWS 账户。</p><p id="87d1" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→python/pyspark/Scala 的基础知识，用于根据用例编写脚本。</p><p id="29e2" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→确保创建了 Oracle 和 PostgreSQL 数据库。</p><p id="0a11" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→确保您已经为计算环境的公共/私有子网创建了一个 vpc(点击<a class="ae lc" href="https://docs.aws.amazon.com/batch/latest/userguide/create-public-private-vpc.html" rel="noopener ugc nofollow" target="_blank">此处</a>)</p><p id="fdde" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">→创建一个特定于角色的 IAM 来粘合(点击<a class="ae lc" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html" rel="noopener ugc nofollow" target="_blank">此处</a>)</p><blockquote class="im in io"><p id="8acc" class="ip iq ir is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">涉及的步骤:</strong></p></blockquote><h2 id="7eb5" class="ld kf hi bd kg le lf lg kk lh li lj ko jw lk ll ks jx lm ln kw jy lo lp la lq bi translated"><strong class="ak"> *添加胶水连接:</strong></h2><ol class=""><li id="1c0d" class="lr ls hi is b it lt ix lu jw lv jx lw jy lx jn ly lz ma mb bi translated">转到 AWS 控制台中的 Glue Service，然后在导航窗格中的<strong class="is hj">数据目录</strong>下，选择<strong class="is hj">连接。</strong></li><li id="96f1" class="lr ls hi is b it mc ix md jw me jx mf jy mg jn ly lz ma mb bi translated">通过给出<strong class="is hj">连接名称</strong>、<strong class="is hj">连接类型</strong> <em class="ir"> </em>(如 JDBC)和<strong class="is hj">描述</strong> <em class="ir"> </em>(可选)，添加源连接，点击下一步，如下图所示。</li></ol><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mh"><img src="../Images/93ed99e11880fd1656aad32c17d52389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xfh5vrwdCc_jEAjkBEreng.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第二步:身材</figcaption></figure><p id="4744" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">3.添加与您的连接相关的<strong class="is hj"> JDBC URL </strong>和<strong class="is hj">用户名</strong>和<strong class="is hj">密码</strong>以及包含您的数据存储的<strong class="is hj"> VPC </strong>名称。单击下一步并查看更改。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mm"><img src="../Images/0db716a7d0bcaa0736aff935cd206db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Irs0sZgAX4uJ1MyxHOyEwQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第三步:身材</figcaption></figure><p id="bf83" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">4.测试连接。</p><p id="f613" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated"><strong class="is hj"> <em class="ir">按照步骤 1 到 4 为 PostgreSQL(目标数据库)创建连接</em> </strong></p><h2 id="d75d" class="ld kf hi bd kg le lf lg kk lh li lj ko jw lk ll ks jx lm ln kw jy lo lp la lq bi translated">*添加数据库(源和目标)</h2><ol class=""><li id="0b45" class="lr ls hi is b it lt ix lu jw lv jx lw jy lx jn ly lz ma mb bi translated">转到<strong class="is hj">数据目录</strong>中的<strong class="is hj">数据库选项卡</strong>并点击<strong class="is hj">添加数据库</strong>。单击创建。<em class="ir">(目的数据库也是如此)</em></li></ol><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mn"><img src="../Images/c53aff24b0eca062394ee6d9bc2f6b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hxPDRz6ZYuBMl0BzYYnd3Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第一步:身材</figcaption></figure><h2 id="75c4" class="ld kf hi bd kg le lf lg kk lh li lj ko jw lk ll ks jx lm ln kw jy lo lp la lq bi translated"><strong class="ak"> *添加爬虫(源和目的)</strong></h2><p id="a57c" class="pw-post-body-paragraph ip iq hi is b it lt iv iw ix lu iz ja jw mo jd je jx mp jh ji jy mq jl jm jn hb bi translated">1.进入数据目录中的<strong class="is hj">爬虫</strong>，点击<strong class="is hj">添加爬虫</strong>，给<strong class="is hj">一个爬虫名称</strong>，如下图所示。(标签、描述和其他信息是可选的)，单击下一步。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mr"><img src="../Images/58a56a4149547658032c2dc7c122fb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EOEgCcPu3SONUcePURrUyg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第一步:身材</figcaption></figure><p id="72a7" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">2.如下图所示指定<strong class="is hj">爬虫源类型</strong>，然后点击下一步。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es ms"><img src="../Images/f47937b3bf6e67365a845129d578dec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ebrdWLfp2dHimPA52iVQA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第二步:身材</figcaption></figure><p id="4d6b" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">3.添加一个数据存储-&gt;选择一个<strong class="is hj">数据存储作为 JDBC </strong> - &gt;添加连接(例如。test)我们在前面的步骤中创建了- &gt;包含一个路径的表(例如。MyDatabase/Myschema/%)。这里%从 MyDatabase 中抓取所有的表，它的模式名是:MySchema。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mt"><img src="../Images/8b97ade8c754a9d96a046eb0131c8c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JUTEOH_v83ftm8pnVKDZlw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第三步:身材</figcaption></figure><p id="cc3d" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">4.在继续这些步骤之前，选择我们已经创建的 IAM 角色。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mu"><img src="../Images/2a5f9d510bd8ed5968228fe68e610550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ezr7u6vEhygpEhwgRDHYog.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第四步:身材</figcaption></figure><p id="2e5e" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">5.根据您的要求为该爬网程序创建一个计划。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mv"><img src="../Images/93d774bf281ef4dbaee4f71fb1ac6bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDRsZzX-Xct4oJV-RYXxAQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第五步:身材</figcaption></figure><p id="e1f1" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">6.配置爬网程序的输出。添加我们在前面步骤中创建的数据库(例如源数据库)</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mw"><img src="../Images/ccfd41661c50c326fd60a5c2131f7334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1vm4dvX1vURmKRqblNy_gA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第六步:身材</figcaption></figure><p id="108d" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated"><strong class="is hj"><em class="ir"/></strong>按照相同的步骤对目标数据库进行爬网</p><h2 id="2999" class="ld kf hi bd kg le lf lg kk lh li lj ko jw lk ll ks jx lm ln kw jy lo lp la lq bi translated">*添加作业</h2><ol class=""><li id="3913" class="lr ls hi is b it lt ix lu jw lv jx lw jy lx jn ly lz ma mb bi translated">点击<strong class="is hj">添加作业</strong>创建一个 ETL 作业，从源数据库提取、转换和加载相关列到目标数据库。类型是<strong class="is hj"> Spark </strong>在这种情况下(你可以使用 python shell)，你也可以改变胶水版本。(此处<strong class="is hj">胶水版本 1.0 </strong>)。它还提供监控选项(可选)，各种安全配置(可选)更多关于这一点..(点击<a class="ae lc" href="https://docs.aws.amazon.com/glue/latest/dg/add-job.html" rel="noopener ugc nofollow" target="_blank">这里</a>)。</li></ol><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mw"><img src="../Images/f7e1840a321ac0704cc0c7b7de88dfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lmy61QcnucCZG3ntCCJzUg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第一步:身材</figcaption></figure><p id="e097" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">2.在我们的例子(源数据库)中，选择<strong class="is hj">数据源</strong>，即(从源数据库中选择必要的表名)。</p><p id="4577" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">3.同样，选择<strong class="is hj">目标数据源</strong> (PostgreSQL)。</p><p id="5eb2" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">4.验证由 AWS Glue 创建的映射。您可以相应地更改映射。</p><p id="1567" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">5.<strong class="is hj">保存作业。</strong>自动脚本将由 AWS Glue 服务器创建。</p><p id="39f8" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">6.根据您的使用情况编辑作业，然后单击保存并运行！</p><p id="dd1d" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">7.作业启动时间大约是 10 分钟，所以，等到它完成。(如果出错，错误消息将显示在作业控制台/脚本控制台中。对于详细的错误消息，您可以随时转到如下所示的历史选项卡中的日志:)。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mx"><img src="../Images/fdfbf350e79b51d3c5020b85eab0ed12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBPLN9kYyg2CSk1yVLPj1A.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">第七步:身材</figcaption></figure><blockquote class="my"><p id="0055" class="mz na hi bd nb nc nd ne nf ng nh jn dx translated"><strong class="ak">万岁！</strong></p><p id="d9cb" class="mz na hi bd nb nc ni nj nk nl nm jn dx translated"><strong class="ak">你的第一份工作成功了！您已成功将数据从 Oracle 导出到 PostgreSQL。</strong></p></blockquote><p id="885e" class="pw-post-body-paragraph ip iq hi is b it nn iv iw ix no iz ja jw np jd je jx nq jh ji jy nr jl jm jn hb bi translated"><strong class="is hj">谢谢你！</strong></p><p id="5c40" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">希望你喜欢它，并发现它有用！</p><p id="496a" class="pw-post-body-paragraph ip iq hi is b it iu iv iw ix iy iz ja jw jc jd je jx jg jh ji jy jk jl jm jn hb bi translated">如有任何疑问/澄清，请随时评论或发送邮件！我很乐意帮忙:)</p></div></div>    
</body>
</html>