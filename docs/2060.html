<html>
<head>
<title>Hive commands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">配置单元命令</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/hive-commands-b5b6957d8820?source=collection_archive---------8-----------------------#2021-04-19">https://medium.com/nerd-for-tech/hive-commands-b5b6957d8820?source=collection_archive---------8-----------------------#2021-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2469f47fb8c7da7519189fc2c7dffcac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ORN6g5dAP6X-C2Yt"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·斯皮斯克在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="3bb6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于 Hive 的基础知识阅读我的中篇文章，<strong class="ix hj"/><a class="ae iu" href="https://varchasaaggarwal.medium.com/hadoop-hive-734db0169afa" rel="noopener"><strong class="ix hj">Hadoop-Hive</strong></a><strong class="ix hj">。</strong></p><div class="jt ju ez fb jv jw"><a href="https://varchasaaggarwal.medium.com/hadoop-hive-734db0169afa" rel="noopener follow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">Hadoop — Hive</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">Hive 是一个用于分析结构化数据的数据仓库系统。它建立在 Hadoop 之上。那是…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">varchasaaggarwal.medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jw"/></div></div></a></div><p id="f496" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Hadoop 基础——Hive 文章包含下面列出的一些主题。</p><ul class=""><li id="05ae" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">蜂巢建筑</li><li id="43e8" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">蜂巢的功能</li><li id="2cd7" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">蜂巢的局限性</li><li id="6a2d" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">配置单元数据类型</li><li id="8c7e" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">字符串类型</li><li id="a86c" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">复杂类型。</li></ul></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><p id="d9be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">并且，本文由 Hive 命令组成。</p><h1 id="d7b4" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建数据库</h1><ul class=""><li id="b92c" class="kl km hi ix b iy me jc mf jg mg jk mh jo mi js kq kr ks kt bi translated">该命令将创建一个数据库。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="1a82" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create database &lt;database-name&gt;;<br/>For Ex - create database demo;</span></pre><ul class=""><li id="00d0" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">该命令将显示存在的所有数据库。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="4830" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; show databases; </span></pre><ul class=""><li id="196b" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">只有在数据库不存在的情况下，该命令才会创建数据库。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="2b59" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create database if not exists &lt;database-name&gt;;<br/>For ex - create database if not exists demo;</span></pre><ul class=""><li id="aba8" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">以键-值对的形式为数据库分配属性。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="4dc3" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create the database demo<br/>    &gt; WITH DBPROPERTIES ('creator'='Varchasa Aggarwal', 'date'='18-04-2021');</span></pre><ul class=""><li id="26d8" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们检索与数据库相关的信息。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="9ddd" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; describe database extended demo;</span></pre><h1 id="5e15" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">删除数据库</h1><p id="6bec" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">删除已定义的数据库。</p><ul class=""><li id="7e82" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">此命令将删除数据库。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="94d9" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; drop database demo;</span></pre><ul class=""><li id="d603" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">检查数据库是否被删除。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="5760" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; show databases;</span></pre><ul class=""><li id="ea37" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">当且仅当数据库存在时，删除数据库。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="6d1a" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; drop database if exists demo;</span></pre><ul class=""><li id="f136" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">在 Hive 中，不允许直接删除包含表的数据库。在这种情况下，我们可以通过先删除表或在命令中使用 Cascade 关键字来删除数据库。</li><li id="f1ab" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">让我们看看用于删除数据库的 cascade 命令:-</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="a7e0" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; drop database if exists demo cascade. </span></pre><p id="b1a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该命令首先自动删除数据库中的表。</p><h1 id="9292" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">配置单元—创建表格</h1><p id="73d5" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">在 hive 中，我们有两种类型的表—</p><ul class=""><li id="d538" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">内部表</li><li id="2cf4" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">外部表</li></ul><h2 id="f174" class="ms lh hi bd li na nb nc lm nd ne nf lq jg ng nh lu jk ni nj ly jo nk nl mc nm bi translated">内部表</h2><ul class=""><li id="9bb4" class="kl km hi ix b iy me jc mf jg mg jk mh jo mi js kq kr ks kt bi translated">内部表也称为托管表，因为它们的数据生命周期是由配置单元控制的。</li><li id="81f1" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">默认情况下，这些表存储在 hive.metastore.warehouse.dir 定义的目录下的子目录中(即/user/hive/warehouse)。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="7f5e" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create table demo.employee(Id int, Name string, Salary float)<br/>    &gt; row format delimited<br/>    &gt; fields terminated by ',';</span></pre><blockquote class="nn no np"><p id="cd8e" class="iv iw nq ix b iy iz ja jb jc jd je jf nr jh ji jj ns jl jm jn nt jp jq jr js hb bi translated">这里，该命令还包括数据由'，'分隔的信息。</p></blockquote><ul class=""><li id="120f" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们看看创建的表的元数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="c0d9" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; describe demo.employee</span></pre><ul class=""><li id="1f69" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">如果表不存在，让我们创建一个表。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="9e5b" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create table if not exists demo.employee(Id int, Name string, Salary float)<br/>    &gt; row format delimited<br/>    &gt; fields terminated by ','</span></pre><ul class=""><li id="1138" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">创建表格时，我们可以向列添加注释，还可以定义表格属性。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="db10" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create table demo.new_employee(Id int comment 'Employee Id' Name string comment 'Employee Name', Salary float comment 'Employee Salary') comment 'Table Description' TBLProperties ('creator'='Varchasa Aggarwal','created at'='18-04-2021');</span></pre><ul class=""><li id="2a44" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们看看创建的表的元数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="b028" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; describe new_employee;</span></pre><ul class=""><li id="617e" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Hive 允许通过使用现有表的模式来创建新表。</li></ul><blockquote class="nn no np"><p id="c127" class="iv iw nq ix b iy iz ja jb jc jd je jf nr jh ji jj ns jl jm jn nt jp jq jr js hb bi translated">模式是表示整个数据库的逻辑视图的框架结构。它定义了数据是如何组织的以及它们之间的关系是如何关联的。</p></blockquote><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="e0e0" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create table if not exists demo.copy_employee like demo.employee;</span></pre><p id="ded8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我们可以说新表是现有表的副本。</p><h1 id="3785" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">配置单元—加载数据</h1><p id="8595" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">一旦创建了内部表，下一步就是将数据加载到其中。</p><ul class=""><li id="2296" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们使用以下命令将文件的数据加载到数据库中:-</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="3db0" class="ms lh hi mo b fi mt mu l mv mw">load data local inpath '/home/&lt;username&gt;/hive/emp_details'into table demo.employee;</span><span id="a747" class="ms lh hi mo b fi nu mu l mv mw">select * from.demo.employee;</span></pre><h1 id="b3f2" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">配置单元-删除表</h1><p id="e11e" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">让我们从数据库中删除一个特定的表。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="5030" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; show databases;<br/>hive&gt; use demo; <br/>hive&gt; show tables;<br/>hive&gt; drop table new_employee;<br/>hive&gt; show tables;<br/></span></pre><h1 id="3fef" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">配置单元—更改表格</h1><p id="2923" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">在 Hive 中，我们可以在现有的表中执行修改，比如更改表名、列名、注释和表属性。</p><ul class=""><li id="5e11" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">重命名表格</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="d612" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; Alter table &lt;old_table_name&gt; rename to &lt;new_table_name&gt;</span></pre><p id="929b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们检查一下表名是否改变了。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="ceee" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; show tables;</span></pre><ul class=""><li id="7669" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">添加一列—</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="fc2f" class="ms lh hi mo b fi mt mu l mv mw">Alter table table_name add columns(columnName datatype);</span></pre><ul class=""><li id="4010" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">更改列—</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="38d7" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; Alter table_name change &lt;old_column_name&gt; &lt;new_column_name&gt; datatype;</span></pre><ul class=""><li id="5fc1" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">删除或替换列—</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="2f2d" class="ms lh hi mo b fi mt mu l mv mw">alter table employee_data replace columns( id string, first_name string, age int);</span></pre><h1 id="24f3" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">蜂巢划分</h1><p id="c712" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">hive 中的分区可以通过两种方式完成—</p><ul class=""><li id="f7f1" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">静态分区</li><li id="c173" class="kl km hi ix b iy ku jc kv jg kw jk kx jo ky js kq kr ks kt bi translated">动态分区</li></ul><h2 id="3e32" class="ms lh hi bd li na nb nc lm nd ne nf lq jg ng nh lu jk ni nj ly jo nk nl mc nm bi translated">静态分区</h2><p id="c66a" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">在静态或手动分区中，将数据装载到表中时，需要手动传递分区列的值。因此，数据文件不包含分区列。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="20b0" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; use test;<br/>hive&gt; create table student (id int, name string, age int,  institute string)<br/>    &gt; partitioned by (course string)<br/>    &gt; row format delimited<br/>    &gt; fields terminated by ',';</span></pre><ul class=""><li id="169c" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们检索信息。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="5fcc" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; describe student;</span></pre><ul class=""><li id="3938" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">使用以下命令将数据加载到表中，并传递分区列的值</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="6bee" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/student_details1' into table student <br/>partition(course= "python");</span><span id="0db3" class="ms lh hi mo b fi nu mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/student_details1' into table student <br/>partition(course= "Hadoop");</span></pre><ul class=""><li id="db44" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">现在检索数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="e467" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select * from student;<br/>hive&gt; select * from student where course = 'Hadoop';</span></pre><h2 id="3b71" class="ms lh hi bd li na nb nc lm nd ne nf lq jg ng nh lu jk ni nj ly jo nk nl mc nm bi translated">动态分区</h2><p id="7352" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">在动态分区中，分区列的值存在于表中。因此，不需要手动传递分区列的值。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="50f9" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; use show;</span></pre><ul class=""><li id="8975" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">启用动态分区。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="e9ac" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; set hive.exec.dynamic.partition=true;<br/>hive<strong class="mo hj">&gt;</strong> set hive.exec.dynamic.partition.mode=nonstrict;</span></pre><ul class=""><li id="4dd6" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">创建虚拟表。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="457a" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create table stud_demo(id int, name string, age int, institute string, course string)<br/>row format delimited<br/>fields terminated by ',';</span></pre><ul class=""><li id="05b8" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">现在加载数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="8a5b" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/student_details' into table stud_demo;</span></pre><ul class=""><li id="7380" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">创建一个分区表。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="0f30" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; create table student_part (id int, name string, age int, institute string)<br/>partitioned by (course string)<br/>row format delimited<br/>fields terminated by ',';</span></pre><ul class=""><li id="bc93" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">在分区表中插入虚拟表的数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="f9cf" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; insert into student_part<br/>partition(course)<br/>select id, name age, institute, course<br/>from stud_demo;</span></pre><ul class=""><li id="2da7" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">现在，您可以在<em class="nq">选择</em>命令的帮助下查看表格数据。</li></ul><h1 id="b689" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">HiveQL —操作员</h1><p id="5b78" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">HiveQL 运算符有助于执行各种算术和关系运算。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="0b75" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; use hql;<br/>hive&gt; create table employee (Id int, Name string , Salary float)<br/>row format delimited<br/>fields terminated by ',' ;</span></pre><ul class=""><li id="c152" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">现在加载数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="1911" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/emp_data' into table employee;</span></pre><ul class=""><li id="1cde" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">获取数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="08aa" class="ms lh hi mo b fi mt mu l mv mw">select * from employee;</span></pre><h1 id="0bfe" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">Hive 中的算术运算符</h1><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nv"><img src="../Images/e3ac72f88cc2ef660ccf1f904980af5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIBeAmiL3fNBzbBfeKW5pA.png"/></div></div></figure><ul class=""><li id="df6c" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">薪金栏增加 50。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="8428" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select id, name, salary + 50 from employee;</span></pre><ul class=""><li id="851c" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">从薪水栏中减去 50 英镑。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="0e08" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select id, name, salary -50 from employee;</span></pre><ul class=""><li id="2cbd" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">找出每个员工的 10%工资。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="2e25" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select id, name, salary *10 from employee;</span></pre><h1 id="b7bc" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">Hive 中的关系运算符</h1><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nw"><img src="../Images/b5e8a3fd4699a629f7296dd1d0756a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKSSV2tPvBB0fzIJweOgug.png"/></div></div></figure><ul class=""><li id="4877" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">获取工资&gt; =25000 的员工的详细信息。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="a9e1" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select * from employee where salary&gt;=25000;</span></pre><ul class=""><li id="cca9" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">获取有工资的雇员的详细信息&lt;25000.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="d07e" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select * from employee where salary <strong class="mo hj">&lt;</strong> <strong class="mo hj">25000</strong>;</span></pre><h1 id="9eb5" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">Functions in Hive</h1><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="36f1" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; use hql;<br/>hive&gt; create table employee_data (Id int, Name string , Salary float)<br/>row format delimited<br/>fields terminated by ',' ;</span></pre><ul class=""><li id="67b2" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Now load the data.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="65ee" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/employee_data' into table employee;</span></pre><ul class=""><li id="3eae" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Fetch the data.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="66d7" class="ms lh hi mo b fi mt mu l mv mw">select * from employee_data;</span></pre><h2 id="533d" class="ms lh hi bd li na nb nc lm nd ne nf lq jg ng nh lu jk ni nj ly jo nk nl mc nm bi translated">Mathematical Functions in Hive</h2><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nx"><img src="../Images/0414acb88e87434426c5860b9d668936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xmr-kOCk_1DT6FZVoN78dA.png"/></div></div></figure><ul class=""><li id="ac56" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Let’s see an example to fetch the square root of each employee’s salary.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="5597" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select Id, Name, sqrt(Salary) from employee_data ;</span></pre><h2 id="bdda" class="ms lh hi bd li na nb nc lm nd ne nf lq jg ng nh lu jk ni nj ly jo nk nl mc nm bi translated">Aggregate Functions</h2><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ny"><img src="../Images/60a4772efa20a3a2ef022a56bb56244f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jSm2rf2zDdFwwTg_nOpx6w.png"/></div></div></figure><ul class=""><li id="e02e" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Let’s see an example to fetch the maximum/minimum salary of an employee.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="b412" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select max(Salary) from employee_data;<br/>hive&gt; select min(Salary) from employee_data;</span></pre><h2 id="08c2" class="ms lh hi bd li na nb nc lm nd ne nf lq jg ng nh lu jk ni nj ly jo nk nl mc nm bi translated">Other functions in Hive</h2><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nz"><img src="../Images/c4bb3fb35024857113f060cb5a1321d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*036dqiQWqrMBxvKXvqojOw.png"/></div></div></figure><ul class=""><li id="e81c" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Let’s see an example to fetch the name of each employee in uppercase.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="3775" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select Id, upper(Name) from employee_data;</span></pre><ul class=""><li id="9f01" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">Let’s see an example to fetch the name of each employee in lowercase.</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="28f7" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select Id, lower(Name) from employee_data;</span></pre><h1 id="57d8" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">GROUP BY Clause</h1><p id="a117" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">The <strong class="ix hj"> HQL Group By </strong>子句用于根据一个或多个列对来自多个记录的数据进行分组。它通常与聚合函数(如 SUM、COUNT、MIN、MAX 和 AVG)结合使用，对每个组执行聚合。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="3a56" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; use hql;<br/>hive&gt; create table employee_data (Id int, Name string , Salary float)<br/>row format delimited<br/>fields terminated by ',' ;</span></pre><ul class=""><li id="2f87" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">现在加载数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="ba15" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/employee_data' into table employee;</span></pre><ul class=""><li id="99b9" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">获取数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="3b75" class="ms lh hi mo b fi mt mu l mv mw">select department, sum(salary) from employee_data group by department;</span></pre><h1 id="803c" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">HAVING 子句</h1><p id="1b71" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">HQL <strong class="ix hj"> HAVING 子句</strong>通过子句与<strong class="ix hj">组一起使用。其目的是对 GROUP BY 子句产生的数据组应用约束。因此，它总是返回条件为<strong class="ix hj">真</strong>的数据。</strong></p><ul class=""><li id="d894" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们使用以下命令，根据 sum &gt;= 35000 的部门，获取雇员的工资总额:</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="2b88" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; select department, sum(salary) from emp group by department having sum(salary)<strong class="mo hj">&gt;</strong>=35000;</span></pre><h1 id="f429" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">HiveQL — ORDER BY 子句</h1><p id="ff75" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">在 HiveQL 中，ORDER BY 子句执行查询结果集的完整排序。因此，完整的数据通过单个缩减器传递。在执行大型数据集时，这可能需要很长时间。但是，我们可以使用 LIMIT 来最小化排序时间。</p><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="5207" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; use hql;<br/>hive&gt; create table employee_data (Id int, Name string , Salary float)<br/>row format delimited<br/>fields terminated by ',' ;</span></pre><ul class=""><li id="e74c" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">现在加载数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="25f7" class="ms lh hi mo b fi mt mu l mv mw">hive&gt; load data local inpath '/home/&lt;username&gt;/hive/employee_data' into table employee;</span></pre><ul class=""><li id="e7c0" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">获取数据。</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="2c6d" class="ms lh hi mo b fi mt mu l mv mw">select * from emp order by salary desc;</span></pre><h1 id="91b5" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">HiveQL —排序依据子句</h1><p id="4504" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mx ji jj jk my jm jn jo mz jq jr js hb bi translated">HiveQL SORT BY 子句是 ORDER BY 子句的替代。它对每个缩减器中的数据进行排序。因此，它执行局部排序，每个归约器的输出被单独排序。它也可能给出部分有序的结果。</p><ul class=""><li id="355c" class="kl km hi ix b iy iz jc jd jg kn jk ko jo kp js kq kr ks kt bi translated">让我们使用以下命令按降序获取数据:</li></ul><pre class="mj mk ml mm fd mn mo mp mq aw mr bi"><span id="7ffb" class="ms lh hi mo b fi mt mu l mv mw">select * from emp sort by order by salary desc;<br/></span></pre><blockquote class="oa"><p id="224e" class="ob oc hi bd od oe of og oh oi oj js dx translated">这都是关于 HIVE 命令的。希望你从这里学到了一些东西。</p></blockquote><blockquote class="nn no np"><p id="792a" class="iv iw nq ix b iy ok ja jb jc ol je jf nr om ji jj ns on jm jn nt oo jq jr js hb bi translated">发现有用！请留下掌声。想在这个博客上添加一些东西，添加评论。</p></blockquote></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><p id="062c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢你。🙌</p></div></div>    
</body>
</html>