<html>
<head>
<title>Making a Deal with your Database: How to complete a Transaction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与您的数据库进行交易:如何完成交易</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/making-a-deal-with-your-database-how-to-complete-a-transaction-d8bda556e910?source=collection_archive---------12-----------------------#2021-03-20">https://medium.com/nerd-for-tech/making-a-deal-with-your-database-how-to-complete-a-transaction-d8bda556e910?source=collection_archive---------12-----------------------#2021-03-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="28c9" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">保持一个干净而全面的数据库是至关重要的SQL中的事务如何在实现这一点上发挥关键作用</h2></div><p id="20ab" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最近几周，我有幸作为班级导师参与了一个名为“编码梦想”(CTD)的组织。这个机会让我从JavaScript中抽身出来，重新进入Ruby on Rails &amp; SQL的后端世界。</p><p id="19e3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要了解更多关于如何参与梦想编码的信息，请访问他们的网站！<a class="ae ju" href="https://codethedream.org/" rel="noopener ugc nofollow" target="_blank"><em class="jt"/></a></p><p id="198c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我兴奋地再次尝试使用Ruby时，我意外地得知CTD课程的前几周是SQL，即结构化查询语言。</p><p id="6313" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">哦，天啊…我在熨斗学校的时候绝对忽略了这一部分。使用活动记录ORM(或对象关系映射)，我这样做是有道理的。许多开发人员无需编写一行SQL就可以完成他们的任务。毕竟，Active Record或其他ORM(如Django (Python)和Hibernate (Java ))允许开发人员执行CRUD操作，并以各自的语言与数据库通信。</p><p id="8473" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我来了，我被期望成为新生的班级导师，我不仅在半年前学习了一小段时间，而且还浏览了一下，因为我当时觉得这并不太重要。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es jv"><img src="../Images/1b1f6fc15decc19122a99d4a97619b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mi9ADGh53Hrs3jF-"/></div></div></figure><p id="1f88" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我的工作被砍掉了。但回顾这一周，这无疑是塞翁失马焉知非福。</p><p id="8929" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">把ORMs想象成一辆车。当你把钥匙插入点火装置并转动它时(或者我猜对于新的高档车，按一个按钮)，你的车神奇地启动了。当你把脚踩在油门踏板上时，你期望汽车会移动。当你把脚踩在刹车踏板上时，你希望车停下来。</p><p id="60df" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当你做这些动作时，你没有想到的是在引擎盖下发生了什么使这些动作发生。学习SQL的基础知识就像打开引擎盖&amp;理解代码如何与数据库通信的一些基本机制。</p><p id="f6af" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就这一点而言，我诚实地打开了我最后一辆车的引擎盖，可能总共打开了5次。也许这就是它不再存在的原因… </p><p id="d4a4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我假设您对SQL的工作原理和基本语法有一个大致的了解。让我们建立一个基本的数据库开始吧！</p><p id="fbb2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">如果你想学习SQL的基础知识或者需要复习，我推荐SQLBolt进行一些练习:</em><a class="ae ju" href="https://sqlbolt.com/lesson/introduction" rel="noopener ugc nofollow" target="_blank"><em class="jt">https://sqlbolt.com/lesson/introduction</em></a></p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="5739" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">建立我们的数据库</h1><p id="7437" class="pw-post-body-paragraph ix iy hi iz b ja lg ij jc jd lh im jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">假设我们拥有一个简单的图书数据库。看看我的书架，这是我们有的:</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ll"><img src="../Images/67864c175c47cdabe3052b8c2226716f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBq9xNZ0lrkdwHX-LL3fvw.png"/></div></div></figure><p id="a18f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那是一些书架。但看起来我们的收藏中少了一本重要的书。谢天谢地，我们有SQL来帮助我们！</p><p id="5294" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在复习了SQL的一些基础知识之后，我们可以很快地确定我们可以使用INSERT INTO关键字在数据库中创建一行。我们的语句可能看起来像这样:</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lm"><img src="../Images/4ff9d22ac1278dec5694486c6cbb7318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9P1-7hT6KMBe8Cdpv6Ecw.png"/></div></div></figure><p id="841d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那是一个书架！我们的数据库里有全部7本哈利波特。一切都好。</p><p id="21dd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除了…我们犯了一个错误。我不小心拼错了“波特”跑！</p><p id="6316" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在你们这些哈利波特迷开始给我发愤怒的信息之前，我是故意的，我想表达我的观点。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es ln"><img src="../Images/7cfa99fa0dc01aabce53c6de556055c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*LmSuib0FeR02OkqM"/></div></figure><p id="95c0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然我们<em class="jt">可以</em>使用UPDATE关键字创建另一个语句来更新我们的数据库，但假设我们正在处理一个有数千行的数据库，您必须在其中进行大量更改，或者如果您正在为一家新公司将大量数据植入数据库，但由于犯了一些错误，您希望恢复到以前的状态。如果你问我的话，那将是一项相当令人厌倦的任务。</p><p id="103e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">幸运的是，我们可以使用一种叫做交易的东西来使我们的生活变得更容易。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="f5da" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">提交和回滚</h1><p id="c438" class="pw-post-body-paragraph ix iy hi iz b ja lg ij jc jd lh im jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">当编写SQL语句时，我们必须确定我们编写和运行的语句正是我们想要执行的。在生产环境中，如果您和您的团队想要恢复到以前的状态，可能会非常困难。这是因为在大多数情况下，我们的语句是在自动提交模式下运行的，换句话说，它会自动保存到我们的磁盘上。</p><p id="0352" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们正在进行批处理操作，或者一起运行多个语句。最好在运行脚本文件时关闭自动提交，以防遇到任何问题。</p><p id="b1ca" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以通过使用事务来完成。让我们看看这个会是什么样子:</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lo"><img src="../Images/3992769e316d30d93e355f711df48e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QLv0uTzS_bT9Vqccb_cpsA.png"/></div></div></figure><p id="455c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用BEGIN关键字(或者我们也可以使用BEGIN TRANSACTION)向数据库发送信号，以便在我们准备好的时候立即运行所有的语句。换句话说，它告诉我们的数据库关闭自动提交。</p><p id="0e74" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的语句之后，我们使用COMMIT关键字锁定我们的语句，并将我们的更改提交给数据库。<em class="jt">在提交之前，确保一切正常！</em></p><p id="ba38" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，回到我们之前的错误点。比方说，相反，我们的手指很粗，不小心打错了一些字，或者输入了一些错误的日期:</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lp"><img src="../Images/c1c2c0c16fcd0c2e77e1ca41435aa558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYRYX3rJcTblPil41QTzCA.png"/></div></div></figure><p id="e072" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">嗯哦。现在我们做到了！</em></p><p id="5bdd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是没关系。通过在提交之前发出ROLLBACK关键字，我们可以将更改恢复到之前的状态。这是一个有益的交易！</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="714c" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">交易回顾</h1><p id="f859" class="pw-post-body-paragraph ix iy hi iz b ja lg ij jc jd lh im jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">简单地说，事务可以定义为对数据库的任何更改；数据库组件及其包含的数据字段之间的任何“事务”。为了把这个概念讲清楚，让我们请一些专家来帮忙。</p><p id="fdd7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Techopedia解释说，事务是由COMMIT和ROLLBACK SQL语句(如上所示)完成的，这些语句指示事务的开始或结束。ACID缩写定义了数据库事务的属性:</p><p id="1a76" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事务必须完全完成、提交或回滚。<br/> <strong class="iz hj"> C </strong>一致性:事务必须完全符合数据库先前的状态。换句话说，事务不能打破数据库的约束。<br/> <strong class="iz hj"> I </strong> solation:在提交或回滚原始事务之前，事务数据不能用于其他事务。<br/> <strong class="iz hj"> D </strong>可用性:即使在数据库出现故障的情况下，事务数据更改也必须可用。</p><p id="0c05" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们的交易包括所有这些财产，那么我们就成交了。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es lq"><img src="../Images/f09d7a9dd4aae08d9a475e70719a9d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/0*J6IxkeOlHEqrGCyh"/></div></figure></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="8968" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">结论</h1><p id="0907" class="pw-post-body-paragraph ix iy hi iz b ja lg ij jc jd lh im jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">我希望本演练能帮助您更好地理解事务！如果您还没有，我鼓励您花些时间看看“引擎盖下”,并练习编写一些SQL语言，这样您就可以更好地理解一些神奇的东西是如何工作的——很容易想当然。</p><p id="ab7b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请让我知道你的想法——我很乐意听到！</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="803a" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">来源</h1><p id="20a7" class="pw-post-body-paragraph ix iy hi iz b ja lg ij jc jd lh im jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">Techopedia:什么是事务(在数据库中)？<a class="ae ju" href="https://www.techopedia.com/definition/16455/transaction-databases" rel="noopener ugc nofollow" target="_blank">https://www . techopedia . com/definition/16455/transaction-databases</a></p></div></div>    
</body>
</html>