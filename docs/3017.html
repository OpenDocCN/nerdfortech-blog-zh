<html>
<head>
<title>CAP Java Tutorial: Hello World App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CAP Java 教程:Hello World App</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/cap-java-tutorial-1-hello-world-app-66b4435a6e29?source=collection_archive---------1-----------------------#2021-05-27">https://medium.com/nerd-for-tech/cap-java-tutorial-1-hello-world-app-66b4435a6e29?source=collection_archive---------1-----------------------#2021-05-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3761" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何用 SAP 的 CAP Java 框架制作 hello world app</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2e4e749e2028eb94156355f7fff44f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dbyL8vgR6YCRlgHn"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@maxweisbecker?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马克西米利安·魏斯贝克尔</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="9bed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SAP 的新 CAP 框架有相当多的教程，但大多数都是针对框架的 NodeJS 风格；Java 版本似乎落后了。为此，我决定创建自己的 CAP Java 系列教程。本系列假设您对 SAP 一无所知，因此即使是 SAP 初学者也应该能够理解。在这第一部分中，我们将向您展示如何制作一个简单的 Hello World 应用程序。</p><p id="4883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:本教程中使用的代码可以在<a class="ae jt" href="https://github.com/toadslop/cap-helloworld" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="ceea" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">步骤 1:设置开发环境</h1><p id="9107" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">首先，我们需要安装 CAP Java 开发和部署所需的依赖项。仔细阅读下面的列表，确保你都有。</p><ul class=""><li id="7f24" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated"><strong class="ih hj"> Node.js: </strong> <a class="ae jt" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">安装说明</a></li><li id="43dd" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><strong class="ih hj"> @sap/cds-dk </strong> : <code class="du ll lm ln lo b">npm i -g @sap/cds-dk</code></li><li id="3767" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><strong class="ih hj"> Java VM: </strong>至少需要 Java 8。SAP 推荐自己的“<a class="ae jt" href="https://github.com/SAP/SapMachine/releases/latest" rel="noopener ugc nofollow" target="_blank"> SAP 机</a>”。</li><li id="92be" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><strong class="ih hj"> Apache Maven: </strong>至少需要 3.5.0 版本；遵循这些<a class="ae jt" href="https://maven.apache.org/download.cgi" rel="noopener ugc nofollow" target="_blank">说明</a></li></ul><p id="c9b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，在本教程中，我们将使用 VS 代码以及以下支持包。</p><ul class=""><li id="b748" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated"><strong class="ih hj"> VS 代码:</strong> <a class="ae jt" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank">安装说明</a></li><li id="020c" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><strong class="ih hj"> VS 代码 Java 支持:</strong> <a class="ae jt" href="https://code.visualstudio.com/docs/java/java-tutorial" rel="noopener ugc nofollow" target="_blank">安装说明</a></li><li id="fda2" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><strong class="ih hj"> VS 代码光盘支持:</strong> <a class="ae jt" href="https://marketplace.visualstudio.com/items?itemName=SAPSE.vscode-cds" rel="noopener ugc nofollow" target="_blank">安装说明</a></li></ul><h1 id="087e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">步骤 2:生成应用程序</h1><p id="ae51" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">接下来，我们需要生成新的应用程序。既然是 hello world app，那就叫“hello world”吧。</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="96c7" class="lt jv hi lo b fi lu lv l lw lx">cds init helloworld --add java</span></pre><p id="ad92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该会看到以下输出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/20c8ac23b4b04dc96652b5709a2eee44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0W2bf5DXQ1TFN2YoQ01fg.png"/></div></div></figure><p id="7f42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来让我们进入应用程序文件夹:</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="c022" class="lt jv hi lo b fi lu lv l lw lx">cd helloworld</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/f1feffb3568d876f0e0cd83c8c1a4475.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*DVbfFHVX-Yqx46TgNKr2pA.png"/></div></figure><p id="75f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装 Java 依赖项:</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="af7c" class="lt jv hi lo b fi lu lv l lw lx">mvn clean install</span></pre><p id="c6d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将看到相当多的输出，但是如果一切顺利，应该会如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/c95db15c1d1bc88247896d62f5df6bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkqJFeY03jjpDxZxvNuXKQ.png"/></div></div></figure><p id="5cab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开 VS 代码，检查生成的文件和文件夹:</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="44ff" class="lt jv hi lo b fi lu lv l lw lx">code .</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/43b94f4bf8613d40feb64c5665e51396.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*Oy0sc8xqKcmqRbE8uviaBg.png"/></div></figure><p id="fe27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在不需要担心任何事情，除了<strong class="ih hj"> <em class="mc"> srv </em> </strong>文件夹，这是我们项目的后端所在的位置。下一步，我们将建立一个 oData 服务(即遵循<a class="ae jt" href="https://www.odata.org/documentation/" rel="noopener ugc nofollow" target="_blank"> oData 协议</a>的 REST API)。</p><h1 id="609f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">步骤 3 用 CDS 定义服务</h1><p id="e30a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">CAP 的一大优点是建立一个全功能的 REST API 是多么简单。我们来看看怎么做。</p><p id="e10e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先创建一个新文件，命名为<strong class="ih hj"> <em class="mc"> say.cds </em> </strong>。</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="a174" class="lt jv hi lo b fi lu lv l lw lx">touch ./srv/say.cds</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/9d6483686206a64c84c020c832ceac3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*VRkDVj-Oo3juORGEPJTNbw.png"/></div></figure><p id="6d84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在该文件中，添加以下代码:</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="7694" class="lt jv hi lo b fi lu lv l lw lx">service say {<br/>  function hello (to:String) returns String;<br/>}</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/0ed9f0df3c5dd4342bd886c7e4e31a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*1qDvxNvDrBIjx1Mvzn-zDw.png"/></div></figure><p id="8f44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你是 CD 新手，这可能看起来有点奇怪，所以让我们来分解一下。</p><ul class=""><li id="6b3a" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">关键字<em class="mc"> service </em>创建一个 oData 服务。</li><li id="e2c8" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">表示</em>定义了服务的名称。</li><li id="b2ba" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">服务定义包含在{}中。</li><li id="5f92" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">函数</em>正如你可能已经猜到的那样，启动一个函数定义。</li><li id="305d" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">你好</em>是函数的名字。</li><li id="c350" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">()包含输入参数。</li><li id="131d" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">到</em>是参数的名称。</li><li id="4468" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">字符串</em>是输入的类型。</li><li id="f97e" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">返回</em>表示下面将要定义的返回类型。</li><li id="c59f" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><em class="mc">字符串</em>是这个函数的返回类型。</li></ul><p id="a142" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，这里没有函数的逻辑。CDS 仅根据 API 端点、函数预期接收的数据类型以及调用者预期返回的数据类型来定义函数。对输入的实际处理将发生在我们的 Java 文件中，接下来我们将创建这个文件。</p><h1 id="08c7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">步骤 4:在 Java 中创建事件处理程序</h1><p id="29e7" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在一些生成的文件夹中，我们的事件处理程序的位置有点深，所以让我们看看我们的文件夹结构，看看我们的处理程序到底去了哪里。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/d20149b2af7d50f2d153c447c77d7509.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*bnhUm0jzmPzVhSXWNDLFGg.png"/></div></figure><p id="9dd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按照惯例，我们将创建一个名为<strong class="ih hj"> <em class="mc"> handlers </em> </strong>的文件夹来存储我们的处理程序，并创建一个名为<em class="mc">SayHandler.java</em>的文件。请注意，文件名和文件夹名只是约定，您可以随意命名。</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="f157" class="lt jv hi lo b fi lu lv l lw lx">mkdir srv/src/main/java/customer/helloworld/handlers<br/>touch srv/src/main/java/customer/helloworld/handlers/SayHandler.java</span></pre><p id="4f4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看结果:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/2a078ef51b81fdf6934052249c2c0d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*uv5R-9Ei681d0xE8iUj_kQ.png"/></div></div></figure><p id="f38b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您的开发环境设置正确，那么您应该会看到已经生成了下面的框架。如果没有，复制粘贴进去。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/4018facba7d5a1403822dd763b5f282e.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*lAadEIN3I0Jn9DA5nW1Wpw.png"/></div></figure><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="e45f" class="lt jv hi lo b fi lu lv l lw lx">package customer.helloworld.handlers;</span><span id="c699" class="lt jv hi lo b fi mi lv l lw lx">public class SayHandler {</span><span id="f8a9" class="lt jv hi lo b fi mi lv l lw lx">}</span></pre><p id="8151" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们必须通过实现 EventHandler 类将这个基本类转换成事件处理程序，EventHandler 类是 Java CDS SDK 的一部分。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mj"><img src="../Images/b443f054e42969faeac13ba0ecf0ce3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*oFTSbol4xA7VpzLY1-fWsQ.png"/></div></figure><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="f624" class="lt jv hi lo b fi lu lv l lw lx">import com.sap.cds.services.handler.EventHandler;</span><span id="a93c" class="lt jv hi lo b fi mi lv l lw lx">public class SayHandler implements EventHandler {</span><span id="9498" class="lt jv hi lo b fi mi lv l lw lx">}</span></pre><p id="da3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们必须添加一些装饰来链接这个通用事件处理程序和我们在上一步中定义的 oData 服务。不过，在此之前，我们必须生成一些支持文件来帮助我们。再次运行<em class="mc"> mvn 全新安装</em>。您应该看到生成了以下文件夹和文件:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/57b6fb39dca9bb8804f185af7625f518.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*NJdxCzSqxLodJ4Jrn7GKgA.png"/></div></figure><p id="5774" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看里面的‘Say _’。java。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ml"><img src="../Images/6346a7cbccd7b7e79ad4d99215167ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*txy-4jr8GQ01hMUhT-mZ1g.png"/></div></figure><p id="667c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里没有什么可看的，只有一个包含字符串 CDS_NAME 的简单接口，该字符串解析为值“say”，即我们服务的名称。这是为了让我们更容易地编写程序，而不会在字符串文字中出现拼写错误。</p><p id="9a54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们回到 SayHandler.java，将我们的类装饰如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mm"><img src="../Images/1f5abeafe4f52c2f6722ca584cebea0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*ucj7r9lhfH7oz8fD8KgcRA.png"/></div></figure><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="b2d1" class="lt jv hi lo b fi lu lv l lw lx">// ...<br/>import org.springframework.stereotype.Component;<br/>import com.sap.cds.services.handler.annotations.ServiceName;<br/>import cds.gen.say.Say_;</span><span id="26b8" class="lt jv hi lo b fi mi lv l lw lx">@Component<br/>@ServiceName(Say_.CDS_NAME)<br/>public class SayHandler implements EventHandler {</span><span id="eebb" class="lt jv hi lo b fi mi lv l lw lx">}</span></pre><p id="20d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们从 SpringBoot 添加@Component 注释。这里没有时间深入讨论它的作用，但是如果你很好奇，可以看看这篇文章。</p><p id="eb6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们添加来自 CDS SDK 的@ServiceName 注释，并将来自 Say_ class 的 CDS_NAME 值作为它的参数传递，我们在前面已经看到了(解析为“Say”)。这就是 CAP 如何用“say”服务来标识这个特定的处理程序。</p><p id="ee91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们得到了我们真正想要的:处理我们在上一步中在 CDS 中定义的函数的逻辑。添加以下代码:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/58d3a299d5b4dad36bce707e5136f64b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*JPljpvXQ0G_29-MKBVkx4A.png"/></div></figure><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="499f" class="lt jv hi lo b fi lu lv l lw lx">// ...<br/>import cds.gen.say.HelloContext;<br/>import com.sap.cds.services.handler.annotations.On;</span><span id="b40f" class="lt jv hi lo b fi mi lv l lw lx">@Component<br/>@ServiceName(Say_.CDS_NAME)<br/>public class SayHandler implements EventHandler {</span><span id="566e" class="lt jv hi lo b fi mi lv l lw lx">@On(event = HelloContext.CDS_NAME)<br/>  public void sayHello(HelloContext context) {<br/>  }</span><span id="ceb9" class="lt jv hi lo b fi mi lv l lw lx">}</span></pre><p id="1d93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在顶部，我们导入了 HelloContext，它是前面与 Say_.java 一起自动生成的。我们还导入了上的服务处理程序注释，它允许我们修饰一个函数来指示它将处理某个事件。</p><p id="db33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们添加带有参数<strong class="ih hj"> event = HelloContext 的<strong class="ih hj"> @On() </strong>注释。CDS_NAME </strong>。如果我们检查 HelloContext.java 文件，我们可以看到它包含值“hello ”,这是我们在上一步中定义的函数的名称。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/89d734efee8e54681cc6925ef0dedb6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*DQZKqZ45EDiidET0s2Sx2A.png"/></div></figure><p id="494b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这个注释，我们告诉 CAP 框架在每次触发“hello”事件时运行这段代码，或者换句话说，每当我们之前在 CDS 文件中创建的 API 端点被命中时，运行这段代码。</p><p id="d6a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们声明了一个名为“sayHello”的没有返回值的公共方法。注意，函数的名称根本不重要——框架知道如何通过@On 注释将它连接到 CDS 函数定义。另外，请注意，我们没有指明返回类型。这是因为结果会通过其他方式传递出去，我们稍后会看到。</p><p id="897d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们做的下一件事是传入 HelloContext 的一个实例作为输入。您会注意到 HelloContext.java 文件中有一个“create()”方法。在幕后，CAP 调用这个方法来创建一个上下文，然后将它传递给这个函数。这个上下文变量将包含输入参数，我们将在函数体中处理它。</p><p id="c842" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，这是我们的逻辑:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mp"><img src="../Images/d521782e8f624e480609b5f6f47beb2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*AnQuJnRFRLiwC-EK0PPOlg.png"/></div></figure><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="03b2" class="lt jv hi lo b fi lu lv l lw lx">// ...</span><span id="fa76" class="lt jv hi lo b fi mi lv l lw lx">@On(event = HelloContext.CDS_NAME)<br/>public void sayHello(HelloContext context) {<br/>  String name = context.getTo();<br/>  String greeting = "Hello " + name + "!";<br/>  context.setResult(greeting);<br/>}</span></pre><p id="526f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第 18 行，我们调用“context”上的函数“getTo()”来获取 API 调用中传递的输入(查看<strong class="ih hj">HelloContext.java</strong>以了解详细信息)。我们将这个变量命名为“name ”,因为假设“to”的值是一个人的名字。</p><p id="22f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第 19 行，我们创建了一个名为“greeting”的新字符串，它将包含我们的最终结果。假设“to”的值是“Bob”，那么我们会得到“Hello Bob！”。</p><p id="a624" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们使用 setResult()方法设置上下文的结果，将“greeting”作为参数传入。注意，这个函数不需要返回值。通过设置上下文的结果，结果将被传递回框架，框架将把它解析成 JSON 并返回给调用者。让我们实际运行这段代码并检查结果！</p><h1 id="e6b3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">第五部分:检查结果</h1><p id="8394" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">要启动我们的应用程序，请运行以下命令:</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="5847" class="lt jv hi lo b fi lu lv l lw lx">mvn spring-boot:run</span></pre><p id="c118" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，您会看到一条相当神秘的错误消息:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/4d6c9a46782e2b72e4b46b6fba10e30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIrMK0SFBsZzt7FiseJFNQ.png"/></div></div></figure><p id="8a85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">失败的原因是 CAP Java 确实想建立一个数据库，但是因为我们还没有建立数据模型，框架没有任何东西可以用来创建数据库，所以失败了。让我们做一个简单的数据模型，只是为了让框架高兴。我们将在后面的教程中讨论更多关于定义数据模型的内容。</p><p id="e7cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">找到名为<em class="mc"> db </em> <strong class="ih hj"> </strong>的文件夹，在那里创建一个名为<em class="mc"> User.cds </em>的文件。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mr"><img src="../Images/b9813f4d81701e7cfcb3ec52eaf70a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*jGy67j1Z1Xoye-WYd9SkyQ.png"/></div></figure><p id="5d65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在文件内，复制以下代码:</p><pre class="je jf jg jh fd lp lo lq lr aw ls bi"><span id="605c" class="lt jv hi lo b fi lu lv l lw lx">define entity User {<br/>  name : String;<br/>}</span></pre><p id="5327" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将创建一个简单的用户数据库表，其中包含一个名为“name”的字段。有了这个，CAP 就开心了。尝试再次运行启动命令(mvn spring-boot-run)。</p><p id="0897" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你以此结束，那么一切都很好:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/b4d530cb0b583f543af569cbcf87ff6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MON7BOYohArhwHlwIkMtww.png"/></div></div></figure><p id="ffb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，应用程序在 localhost:8080 上启动。单击下面的链接进行尝试:</p><p id="78d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="http://localhost:8080/odata/v4/say/hello(to='Tommy')" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/odata/v4/say/hello(to = ' Tommy ')</a></p><p id="6df8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该会得到以下结果:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/668659063a94bf339e3ca1a5d27f39b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cmd53VsirB-Nu3Fy4nk0oA.png"/></div></div></figure><p id="666d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尝试将 Tommy 替换为您喜欢的任何名称，以查看不同名称的问候语。</p><h1 id="3720" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="e70e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在本课中，我们学习了如何使用 SAP 的 CAP Java 框架制作一个简单的 hello world 应用程序。</p><p id="d3bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您正在寻找更高级的东西，请查看我的关于使用 CAP Java 连接到 S/4 HANA 系统的 6 篇教程<a class="ae jt" href="https://bnheise.medium.com/sap-tutorial-serving-data-from-an-on-premise-system-in-a-cap-java-application-part-1-2426175ad4fa" rel="noopener">。</a></p></div></div>    
</body>
</html>