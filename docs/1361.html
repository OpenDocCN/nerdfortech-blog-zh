<html>
<head>
<title>Running Flutter Apps on Ubuntu Core</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu Core上运行Flutter应用</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/running-flutter-apps-on-ubuntu-core-31453d4fed2a?source=collection_archive---------12-----------------------#2021-03-15">https://medium.com/nerd-for-tech/running-flutter-apps-on-ubuntu-core-31453d4fed2a?source=collection_archive---------12-----------------------#2021-03-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="470e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自2000年以来，Qt一直统治着需要UI的嵌入式Linux设备。最近，Flutter在x11和/或Wayland上引入了原生Linux支持。因此，现在甚至有可能在嵌入式Linux上运行Flutter应用程序。</p><p id="d2e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文介绍了如何在Ubuntu Core上运行任何Flutter应用。作为第一步，我们将看到一个Flutter应用程序在桌面上运行。然后，我们将创建一个快照包，最后，我们将进行调整，使其能够在Ubuntu核心设备上运行。让我们开始吧。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="bdb6" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">先决条件</strong></h1><ul class=""><li id="c5e1" class="ki kj hi ih b ii kk im kl iq km iu kn iy ko jc kp kq kr ks bi translated">假设您熟悉快照。Snap是由Canonical开发的软件打包和部署系统。你可以在<a class="ae kt" href="https://snapcraft.io/docs" rel="noopener ugc nofollow" target="_blank"> Snapcraft </a>上找到更多关于它的信息</li><li id="db79" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">假设你已经知道Ubuntu Core，但如果你不知道，它是Canonical的Linux发行版，目标是嵌入式和物联网设备，完全基于snaps，并承诺安全性作为一个区分因素。更多信息，可以访问<a class="ae kt" href="https://ubuntu.com/core/docs" rel="noopener ugc nofollow" target="_blank"> Ubuntu核心文档</a>。</li><li id="6c50" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">假设您已经在Ubuntu核心设备上安装并运行了mir-kiosk。Mir基于Wayland协议提供安全的客户端-服务器通信。强烈推荐阅读官方<a class="ae kt" href="https://mir-server.io/" rel="noopener ugc nofollow" target="_blank">网站</a>和艾伦·格里菲思的帖子<a class="ae kt" href="https://snapcraft.io/blog/mir-kiosk-uses-mir" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae kt" href="https://ubuntu.com/blog/creating-graphical-shells-try-mir-in-a-virtual-machine" rel="noopener ugc nofollow" target="_blank">这里</a>。</li><li id="44ee" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">假设您已经安装了snapcraft。`<code class="du kz la lb lc b">sudo snap install snapcraft --classic</code></li><li id="fa55" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">假设你已经安装了Flutter。我强烈推荐使用snap包通过一个命令来安装它；<code class="du kz la lb lc b">sudo snap install flutter --classic</code></li><li id="fc69" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">建议使用lxd来创建快照。可以用<code class="du kz la lb lc b">sudo snap install lxd</code>安装，用<code class="du kz la lb lc b">lxd init</code>初始化。欲了解更多信息，请访问官方<a class="ae kt" href="https://linuxcontainers.org/lxd/getting-started-cli/#ubuntu" rel="noopener ugc nofollow" target="_blank">文档</a>。</li></ul></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="3065" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建和构建Flutter应用</h1><p id="b5f0" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">默认情况下，Flutter不启用桌面支持。你必须使用下面的命令<code class="du kz la lb lc b">flutter config --enable-linux-desktop</code>来明确地配置你的Flutter CLI工具。剩下的就是创建项目并运行它。很简单。</p><pre class="lg lh li lj fd lk lc ll lm aw ln bi"><span id="81f1" class="lo jl hi lc b fi lp lq l lr ls">$ flutter config --enable-linux-desktop<br/>$ flutter create flutterdemo<br/>$ cd flutterdemo<br/>$ flutter run -d linux </span></pre><p id="2493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是了</p><figure class="lg lh li lj fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lt"><img src="../Images/90a310f8d79c81db82e02aba63d35e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1cxZ334n_TNLCL4PsSGwQ.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">运行在Linux上的标准Flutter应用</figcaption></figure><p id="0a49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">等等，我们还没说完。我们必须在Ubuntu核心上运行它。因此，我们必须让这个应用程序能够与Ubuntu Core和mir-kiosk一起运行。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="04fe" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">创建快照</h1><p id="3d6c" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">由于有了<code class="du kz la lb lc b">snapcraft</code> CLI工具，从现有应用程序创建快照包变得非常容易。</p><pre class="lg lh li lj fd lk lc ll lm aw ln bi"><span id="ef24" class="lo jl hi lc b fi lp lq l lr ls">$ cd your-app-directory<br/>$ snapcraft init</span></pre><p id="e2e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，它需要一点点关注。这是我们应用程序的初始版本的<code class="du kz la lb lc b">snapcraft.yaml</code>文件。让我们称我们的应用程序为超级酷的应用程序:)</p><figure class="lg lh li lj fd lu"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="7f10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的<code class="du kz la lb lc b">snapcraft.yaml</code>已经可以建造了。建议在构建快照时使用lxd，这样您的机器就不会被污染。</p><pre class="lg lh li lj fd lk lc ll lm aw ln bi"><span id="db34" class="lo jl hi lc b fi lp lq l lr ls">$ snapcraft --use-lxd</span></pre><p id="783e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一切顺利，您将在目录中拥有您的snap包。您可以使用以下命令安装它。我们必须使用<code class="du kz la lb lc b">dangerous</code>标志，因为我们没有将应用程序部署到商店。</p><pre class="lg lh li lj fd lk lc ll lm aw ln bi"><span id="1810" class="lo jl hi lc b fi lp lq l lr ls">$ sudo snap install &lt;your-app-name.snap&gt; --dangerous<br/>$ super-cool-app</span></pre><p id="fa21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您应该能够看到它在桌面上工作。太好了。您将应用程序转换为snap包格式，并使其可以在桌面上运行:)</p><p id="8b00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，我们必须调整我们的<code class="du kz la lb lc b">snapcraft.yaml</code>文件，通过利用mir-kiosk让它在Ubuntu核心上运行。</p><h1 id="aa37" class="jk jl hi bd jm jn mh jp jq jr mi jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh bi translated">Ubuntu核心的调整</h1><p id="304a" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">为了在Ubuntu Core上运行Flutter应用程序，我们需要注意三点。</p><ul class=""><li id="25d5" class="ki kj hi ih b ii ij im in iq mm iu mn iy mo jc kp kq kr ks bi translated">目前，Ubuntu核心平台没有Flutter应用程序所需的字体。</li><li id="2a9d" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">UI应用程序通常必须在启动时可用，因此为了满足这一点，我们必须创建一个守护进程。</li><li id="388d" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated">由于Flutter应用程序运行在mir-kiosk之上，我们必须对mir集成进行必要的调整。</li></ul><p id="32e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是解决所有提到的问题的<code class="du kz la lb lc b">snapcraft.yaml</code>。</p><figure class="lg lh li lj fd lu"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="5388" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">修改后重新创建快照，现在我们准备在Ubuntu Core上测试它。</p><p id="b339" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用qemu和预构建的<a class="ae kt" href="https://cdimage.ubuntu.com/ubuntu-core/18/stable/current/" rel="noopener ugc nofollow" target="_blank"> Ubuntu Core18 </a>或<a class="ae kt" href="https://cdimage.ubuntu.com/ubuntu-core/20/stable/current/" rel="noopener ugc nofollow" target="_blank"> Ubuntu Core20 </a>映像来测试生成的快照。</p><figure class="lg lh li lj fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mp"><img src="../Images/10703051f6adba83dedac564e8c677fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yuz9eyA0gPql45ZxbP-VrA.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">我们的应用程序运行在Ubuntu Core yey上！</figcaption></figure><p id="6860" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您正在寻找更高级的应用程序，这里就是</p><figure class="lg lh li lj fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mq"><img src="../Images/40f17e49a97a1df3d362b34020cf258f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oiqWhb8hdTrt1NFwoDb7og.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">颤振廊应用</figcaption></figure><figure class="lg lh li lj fd lu er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mp"><img src="../Images/0d0554cadfa86422c414164ed8da2331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GEbMQCXraW9IyW1jZS3J8Q.jpeg"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">来自Flutter Gallery的个人理财应用程序Rally</figcaption></figure><p id="1038" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里你可以找到GitHub库。</p><ul class=""><li id="294b" class="ki kj hi ih b ii ij im in iq mm iu mn iy mo jc kp kq kr ks bi translated"><a class="ae kt" href="https://github.com/bugraaydogar/flutterdemo" rel="noopener ugc nofollow" target="_blank">https://github.com/bugraaydogar/flutterdemo</a></li><li id="581a" class="ki kj hi ih b ii ku im kv iq kw iu kx iy ky jc kp kq kr ks bi translated"><a class="ae kt" href="https://github.com/kenvandine/flutter-gallery-snap" rel="noopener ugc nofollow" target="_blank">https://github.com/kenvandine/flutter-gallery-snap</a></li></ul><h1 id="41c3" class="jk jl hi bd jm jn mh jp jq jr mi jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh bi translated">摘要</h1><p id="4959" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">正如所解释的，在Ubuntu Core上运行Flutter应用程序是非常容易的。看起来Qt现在在嵌入式Linux市场上有了一个竞争对手，我真的很好奇随着这些发展，嵌入式Linux市场在未来会如何发展…</p><h1 id="fbc6" class="jk jl hi bd jm jn mh jp jq jr mi jt ju jv mj jx jy jz mk kb kc kd ml kf kg kh bi translated">参考</h1><p id="8da0" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">[1]<a class="ae kt" href="https://flutter.dev/docs/deployment/linux" rel="noopener ugc nofollow" target="_blank">https://flutter.dev/docs/deployment/linux</a></p><p id="6a4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2]<a class="ae kt" rel="noopener" href="/flutter/announcing-flutter-linux-alpha-with-canonical-19eb824590a9">https://medium . com/flutter/announcing-flutter-Linux-alpha-with-canonical-19eb 824590 a9</a></p></div></div>    
</body>
</html>