<html>
<head>
<title>Migrating to Cloud Spanner ? Here’s what you need to know.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移到云扳手？以下是你需要知道的。</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/migrating-to-cloud-spanner-heres-what-you-need-to-know-215259c46d34?source=collection_archive---------9-----------------------#2021-06-30">https://medium.com/nerd-for-tech/migrating-to-cloud-spanner-heres-what-you-need-to-know-215259c46d34?source=collection_archive---------9-----------------------#2021-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/635a15e44acb3bf263ad052b67865b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0pA-2q9byLgnZEa8kcIAQ.jpeg"/></div></div></figure><p id="0b2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">云扳手</strong>在适当的情况下可能是一个很好的选择，但如果没有经过适当的调查就选择了它，很多事情都会出错，使它成为一个糟糕的选择。</p><p id="431f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">像其他迁移一样，不能将数据库转移到 Spanner 上。</p><p id="e38d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用传统 RDBMS 的组织将具有某些特性，例如:</p><ul class=""><li id="4adc" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">顺序</li><li id="0cfb" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">外键</li><li id="b061" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">UDF(用户定义的函数)</li><li id="e87d" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">扳机</li><li id="9ae3" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">存储过程</li><li id="de91" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">美国学术团体委员会</li></ul><p id="03a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还有一些已经实现了。将这些传统数据库迁移到 Cloud Spanner 需要我们了解 Spanner 是否提供相同的功能，如果不提供，有哪些等效功能。</p><p id="4a0a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看几个例子:</p><h2 id="eec8" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">顺序</h2><p id="1360" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">顾名思义，<strong class="is hj">序列</strong>是分配给表中每一行的唯一整数值，以确保唯一性。云扳手不支持 RDBMS 之类的序列。</p><p id="360b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是因为 Cloud Spanner 通过主键按字母数字顺序存储数据，然后该表被拆分到不同的机器上。</p><p id="c03f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，当您使用一个<strong class="is hj">序列</strong>作为主键来排序您的表时，数据总是进入同一个分割，并增加一个分割的负载，从而导致<strong class="is hj">热点</strong>。</p><blockquote class="lc ld le"><p id="025d" class="iq ir lf is b it iu iv iw ix iy iz ja lg jc jd je lh jg jh ji li jk jl jm jn hb bi translated"><strong class="is hj">不要选择值单调递增或递减的列作为高写入速率表的第一个关键部分。</strong></p></blockquote><h2 id="ea06" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">外键</h2><p id="c73d" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">Cloud Spanner 支持像 RDBMS 这样的外键来定义两个表之间的关系。或者，Cloud Spanner 的表交叉也有助于定义两个表之间的关系。</p><p id="fbf6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以选择交错或外键，但不能两者都选。</p><p id="ba52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">交错和外键是一样的吗？答案是<strong class="is hj">否</strong></p><ul class=""><li id="2b52" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">表交错只支持一个父代，而外键支持任意数量的父代。</li><li id="78b6" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">交错仅在使用主键时发生，但在定义外键时，用户可能会也可能不会选择使用主键。</li><li id="ea08" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">交叉存取时，父表和子表的数据位于同一位置，这与外键的情况不同。</li><li id="2d10" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">交错的问题是，要删除它，必须删除整个子表，而外键则不是这样。</li></ul><h2 id="d5d6" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">触发器、存储过程和 UDF</h2><p id="4a3e" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">云扳手不支持触发器，存储过程和 UDF 的。</p><p id="29bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您的生产数据库有很多这样的东西，那么您可能需要重新考虑迁移到 Cloud Spanner。</p><h2 id="83ea" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">访问控制列表</h2><p id="2dda" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">与 RDBMS 不同，在 RDBMS 中，ACL 甚至可以应用于表或行级别，Spanner 只支持数据库级别的访问控制。</p></div></div>    
</body>
</html>