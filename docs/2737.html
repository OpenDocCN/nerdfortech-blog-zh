<html>
<head>
<title>Integrate Google Maps In Android Dialog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android对话框中集成谷歌地图</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/integrate-google-maps-in-android-dialogfragment-a8536c581e95?source=collection_archive---------6-----------------------#2021-05-18">https://medium.com/nerd-for-tech/integrate-google-maps-in-android-dialogfragment-a8536c581e95?source=collection_archive---------6-----------------------#2021-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c429" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj">谷歌地图</strong> &amp; <strong class="ih hj">公开天气API </strong>获取固定位置天气。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/170c793fc7d2c4376cb320f68a7f61c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkWmlpRuedX5xOMOWgqnug.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@geojango_maps?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> GeoJango Maps </a>在<a class="ae jt" href="https://unsplash.com/s/photos/map-pin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="563b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">🚀嗨，在这篇文章中，我们将把谷歌地图整合到安卓对话框中。我们将构建一个应用程序，用户将从对话框屏幕锁定一个位置，并使用<strong class="ih hj">开放天气API </strong>显示该地区的当前天气。</p><p id="1cc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">匆匆忙忙！这是给你的项目链接。</p><div class="ju jv ez fb jw jx"><a href="https://github.com/iamnaran/bloomweather" rel="noopener  ugc nofollow" target="_blank"><div class="jy ab dw"><div class="jz ab ka cl cj kb"><h2 class="bd hj fi z dy kc ea eb kd ed ef hh bi translated">伊姆纳兰/布卢姆韦瑟</h2><div class="ke l"><h3 class="bd b fi z dy kc ea eb kd ed ef dx translated">天气应用程序。在GitHub上创建一个帐户，为iamnaran/bloomweather的发展做出贡献。</h3></div><div class="kf l"><p class="bd b fp z dy kc ea eb kd ed ef dx translated">github.com</p></div></div><div class="kg l"><div class="kh l ki kj kk kg kl jn jx"/></div></div></a></div><p id="36f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始吧。</p><p id="baa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先让我们为谷歌地图和开放天气API获取<strong class="ih hj"> API键</strong>。</p><ol class=""><li id="0eda" class="km kn hi ih b ii ij im in iq ko iu kp iy kq jc kr ks kt ku bi translated"><a class="ae jt" href="https://developers.google.com/maps/documentation/android-sdk/get-api-key" rel="noopener ugc nofollow" target="_blank">获取API密钥</a> —谷歌地图</li><li id="fcb7" class="km kn hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated"><a class="ae jt" href="https://openweathermap.org/api" rel="noopener ugc nofollow" target="_blank">获取API密钥</a> —打开天气API</li></ol><p id="b54d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简单起见，本教程是用Java-Android &amp;使用改型&amp; RxJava编写的</p><blockquote class="la lb lc"><p id="92b9" class="if ig ld ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">项目结构</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/2a2426f2ff2a5ef5b90fef9467f59d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*0dG_9MKSdsL4xcXTf0nRlA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">项目结构</figcaption></figure><p id="cb8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我假设我们都有地图和天气API键。复制您的API密钥，并将<strong class="ih hj">BASE _ URL</strong>&amp;<strong class="ih hj">WEATHER _ API _ KEY</strong>添加到(<strong class="ih hj">build . gradle)build config</strong></p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="1a3a" class="ln lo hi lj b fi lp lq l lr ls">BASE_URL == https://api.openweathermap.org/</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lt"><img src="../Images/1d9a7dbb43bdb1752e60ecaa151242a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*0On7KPMHLkYhKBBmWjIUag.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">添加基本URL和天气API密钥</figcaption></figure><p id="9fb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，添加您的地图API密钥</p><p id="5cb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在你的<strong class="ih hj"> local.properties </strong>中添加MAPS_API_KEY</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="59ed" class="ln lo hi lj b fi lp lq l lr ls">MAPS_API_KEY=AIzaSyBoOA6wz0XayigGxsR7sA0TdpVeo1hpiOo</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/b8e5126bebf99f8c025b35f84360a583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*d3KxGDMRgJCqGd0PkhWSdA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">地图API键</figcaption></figure><p id="4d7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要将这些MAPS_API_KEY导出到我们的应用程序中，请将它们添加到您的<strong class="ih hj"> build.gradle </strong>(应用程序模块)中</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="1da8" class="ln lo hi lj b fi lp lq l lr ls">plugins <strong class="lj hj">{<br/>    </strong>id 'com.android.application'<br/>    id 'com.google.secrets_gradle_plugin' version '0.5'</span><span id="6e24" class="ln lo hi lj b fi lv lq l lr ls"><strong class="lj hj">}</strong></span><span id="a001" class="ln lo hi lj b fi lv lq l lr ls">implementation 'com.google.android.gms:play-services-maps:17.0.1'<br/>implementation 'com.google.android.gms:play-services-location:18.0.0'</span></pre><p id="58ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并将它们添加到应用程序标签内的<strong class="ih hj"> AndroidManifest.xml </strong>中。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="29e5" class="ln lo hi lj b fi lp lq l lr ls">&lt;meta-data<br/>    android:name="com.google.android.gms.version"<br/>    android:value="@integer/google_play_services_version" /&gt;<br/><br/>&lt;meta-data<br/>    android:name="com.google.android.geo.API_KEY"<br/>    android:value="${MAPS_API_KEY}" /&gt;</span></pre><p id="15e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，所有凭证设置都已完成。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/5bc31d708ac4da9dcffa9cc017ba8602.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*6JHz0eaasPkh0tii.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">资料来源:Giphy</figcaption></figure><p id="1379" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在对话框中集成谷歌地图。在此之前，让我们为我们的开放天气API创建API服务。</p><blockquote class="la lb lc"><p id="7ae6" class="if ig ld ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">天气预报服务</p></blockquote><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="2f59" class="ln lo hi lj b fi lp lq l lr ls">public interface WeatherApiService {<br/><br/>    @Headers("x-api-key: " + BuildConfig.<em class="ld">WEATHER_API_KEY</em>)<br/>    @GET("data/2.5/forecast")<br/>    Observable&lt;WeatherData&gt; requestWeather(<br/>            @Query("lat") String lat, @Query("lon") String lon, @Query("units") String units, @Query("cnt") String count<br/>    );<br/><br/>}</span></pre><blockquote class="la lb lc"><p id="d0b7" class="if ig ld ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">其中WeatherData是从开放气象API响应中为我们的应用程序自动生成的模型。<a class="ae jt" href="https://gist.github.com/iamnaran/d4316619c0d2f27ce509faf443f38efd" rel="noopener ugc nofollow" target="_blank">参见型号</a></p></blockquote><p id="35dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们创建一个控制器来调用我们的开放天气API。</p><blockquote class="la lb lc"><p id="1559" class="if ig ld ih b ii ij ik il im in io ip le ir is it lf iv iw ix lg iz ja jb jc hb bi translated">WeatherController.java</p></blockquote><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="7b50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，是时候将谷歌地图集成到我们的对话片段中了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/179ec7482c41cdc7188c5d3bf367f568.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*HFx5xf3miMbMpqNn.gif"/></div></figure><p id="f1de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要这些权限来使我们的地图视图工作。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="c9af" class="ln lo hi lj b fi lp lq l lr ls">&lt;uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" /&gt;<br/>&lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /&gt;</span></pre><p id="318b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获得固定位置纬度和经度，我们创建了一个简单的接口。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="b6ce" class="ln lo hi lj b fi lp lq l lr ls">public interface OnLocationSelectedListener {<br/>    void onLocationSelected(Double lat, Double lng);<br/>}</span></pre><p id="6a55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且我们可以从<strong class="ih hj">FusedLocationProviderClient</strong>获取设备位置。</p><pre class="je jf jg jh fd li lj lk ll aw lm bi"><span id="5c39" class="ln lo hi lj b fi lp lq l lr ls">private FusedLocationProviderClient fusedLocationProviderClient;<br/><br/>fusedLocationProviderClient = LocationServices.<em class="ld">getFusedLocationProviderClient</em>(getActivity());</span></pre><p id="df38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我是这样做的。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="f888" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅此而已。从下面抓取源代码。</p><div class="ju jv ez fb jw jx"><a href="https://github.com/iamnaran/bloomweather" rel="noopener  ugc nofollow" target="_blank"><div class="jy ab dw"><div class="jz ab ka cl cj kb"><h2 class="bd hj fi z dy kc ea eb kd ed ef hh bi translated">伊姆纳兰/布卢姆韦瑟</h2><div class="ke l"><h3 class="bd b fi z dy kc ea eb kd ed ef dx translated">天气应用程序。在GitHub上创建一个帐户，为iamnaran/bloomweather的发展做出贡献。</h3></div><div class="kf l"><p class="bd b fp z dy kc ea eb kd ed ef dx translated">github.com</p></div></div><div class="kg l"><div class="kh l ki kj kk kg kl jn jx"/></div></div></a></div><p id="3152" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢你。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/bbb5e68aaf0d5fe447a0d68e0f6f48de.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*lnz__w23Id6BkBXg.gif"/></div></figure></div></div>    
</body>
</html>