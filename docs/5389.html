<html>
<head>
<title>Helm Quick Start — The Package Manager for Kubernetes (K8S)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Helm 快速入门—Kubernetes(K8S)的软件包管理器</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/helm-quick-start-the-package-manager-for-kubernetes-k8s-242a03ea959f?source=collection_archive---------2-----------------------#2021-09-26">https://medium.com/nerd-for-tech/helm-quick-start-the-package-manager-for-kubernetes-k8s-242a03ea959f?source=collection_archive---------2-----------------------#2021-09-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从 Kubernetes 的快速介绍开始:</p><p id="f33c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetes (K8S)是一个开源的容器编排工具，它通过自动化部署、扩展和管理容器化的应用程序来减少手动流程。</p><p id="e2ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetes 的基本组件:</p><blockquote class="jd je jf"><p id="f031" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">- <strong class="ih hj">控制平面</strong> —控制 K8S 节点并分配任务。<br/> - <strong class="ih hj">节点</strong>-执行请求任务的实际机器。<br/>-<strong class="ih hj">Pod</strong>-K8S 的最小单元，其中一个或多个容器部署到一个 K8S 节点。<br/> - <strong class="ih hj">命名空间</strong>-它就像是一个虚拟集群，我们可以在其中创建 K8S 对象。<br/> - <strong class="ih hj">服务</strong>-它是集群中的 pod 的逻辑集合，定义了一种负载平衡的抽象方式，并公开部署在 pod 上的应用程序。<br/> - <strong class="ih hj">复制集</strong>-表示要在 K8S 集群中运行的 pod 的副本数量。<br/> - <strong class="ih hj">部署</strong>-它运行应用程序的一个或多个副本，并自动替换失败的实例。<br/>-<strong class="ih hj">Kubectl</strong>-K8S 的命令行工具。<br/>-<strong class="ih hj">Minikube</strong>-运行本地 K8S 集群。</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/6e5c06d6b87f778230e8647d1d0c1bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nCzitf9JN0-k-TJ_"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">照片由<a class="ae ka" href="https://unsplash.com/@loik_marras?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Loik Marras </a>在<a class="ae ka" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d9e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Helm 是 Kubernetes 的一个包管理器，它自动化了创建 Kubernetes 清单的大部分重复性工作。</p><p id="eba3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用赫尔姆的话来说，图表不过是 K8s 包。Helm 帮助我们创建新的图表，并将其打包到一个档案中，或者利用图表库中的现有图表(如下所述)。</p><p id="8886" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Helm-2 客户端-服务器架构</strong></p><blockquote class="jd je jf"><p id="af28" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">Helm 客户端(CLI 工具)<br/>-Tiller-服务器组件</p></blockquote><p id="56ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用上述两个组件在 K8S 集群上部署和管理应用程序包。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kb"><img src="../Images/144c00613d688a76a24fa77d3c112dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAVIYUcn1ghN4S_0zdvvJg.png"/></div></div></figure><p id="5f95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Helm Client 将帮助我们部署和管理与 Tiller server 通信的版本——将图表和配置合并到一个版本中，该版本通过维护其发布状态在 Kubernetes 集群上创建所有 K8S 资源。Tiller 还在同一个名称空间的配置映射中维护所有发布信息，这在升级过程中有助于 Helm。</p><p id="9112" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Helm-3 架构(仅客户端架构)</strong></p><p id="b756" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Helm-3 的主要变化是，出于安全原因，Tiller(服务器组件)从版本 3 中删除</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kc"><img src="../Images/0b5efe5c684c79c3a3940fdbf0183152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3YQgFjXm32f6A62nzeU7w.png"/></div></div></figure><p id="ab2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Helm 应用程序包被称为图表—与包含配置信息的 config 结合，并合并到图表中以创建版本(应用程序的运行实例)。</p><p id="f42f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以根据需要创建自己的图表并保存在本地磁盘上，或者我们可以利用 github 上已有的图表——由@<a class="ae ka" href="https://github.com/helm/charts/tree/master/stable" rel="noopener ugc nofollow" target="_blank">https://github.com/helm/charts/tree/master/stable</a>社区维护</p><p id="84e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jg">分两步为 windows 上的 Kubernetes 添加头盔包(假设 Minikube 已经安装</em> </strong>):</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kd"><img src="../Images/e084a94d795f76437fc8489882d1fdab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*UYq5ooOQS3sezzLQzvkBeA.png"/></div></figure><ul class=""><li id="98b0" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">安装 Chocolatey 软件包管理器</li></ul><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="6407" class="ks kt hi ko b fi ku kv l kw kx">Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))</span></pre><p id="f7a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以验证 Chocolatey 安装:“choco -v”</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ky"><img src="../Images/a2d68c4066e02ffc35ba5b306eaba43d.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*0Le49T8mYGTXWsKWbQdbpg.png"/></div></figure><p id="dc02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用巧克力检查过期的包装:“巧克力过期”</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kz"><img src="../Images/45483917a1a8ef4cf2f925bcfe3b0f58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-gEE8KedsaaVRDzP0VDIyg.png"/></div></div></figure><p id="82b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要使用 choco 命令升级 Minikube 和 Kubernetes-cli 过时的软件包:</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="c8ca" class="ks kt hi ko b fi ku kv l kw kx"><strong class="ko hj">choco upgrade minikube<br/>choco upgrade kubernetes-cli</strong></span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es la"><img src="../Images/8c61e1532e1b737fd9b701b34003b130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qz1MbxXPliucagxNyoV4yg.png"/></div></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lb"><img src="../Images/ce933b2bc107263cb63527d8a92963aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GUV2L8cM1XgKf3B4BCr4Q.png"/></div></div></figure><ul class=""><li id="9b4d" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">安装带巧克力的头盔</li></ul><p id="5579" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在以管理员模式打开的 powershell 上运行 choco 命令。</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="f51c" class="ks kt hi ko b fi ku kv l kw kx"><strong class="ko hj">choco install kubernetes-helm</strong></span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es la"><img src="../Images/b5de1799677ddc1c59a6279d3183156f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zSsdJvlMG0pMCMcUvkpq_g.png"/></div></div></figure><p id="1d9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jg">验证舵版本:</em></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lc"><img src="../Images/6d1170b64620dcee25387d7f120834cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpTcD25-CZnGy6HQm6_aew.png"/></div></div></figure><p id="5a99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们举一个在 K8S 集群中运行 MySQL 数据库的例子，这里我们可以从现有的 Helm 图表列表中搜索，而不是从头开始编写 Kubernetes 清单文件。我们只需要在本地机器上克隆 Git repo (charts)并运行以下命令。</p><p id="7485" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Git 图表:<a class="ae ka" href="https://github.com/helm/charts/tree/master" rel="noopener ugc nofollow" target="_blank">https://github.com/helm/charts/</a></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ld"><img src="../Images/7765bcd04dd27c8fcca30ec980f3d653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNR5S8YTk-IpfPWGd7ROpA.png"/></div></div></figure><p id="f72d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下载后，我们可以从源目录运行命令: "..\图表\稳定"</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="17d9" class="ks kt hi ko b fi ku kv l kw kx"><strong class="ko hj">helm install shashir-db mysql</strong></span></pre><p id="3788" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Helm 将负责创建正确运行 MySQL 实例所需的 Kubernetes 对象(部署、复制集、服务、Pod)。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es le"><img src="../Images/2ce79f721a1f3211f05f624cfce52434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gl9SbDXirmp9F32LrMWg1Q.png"/></div></div></figure><p id="61a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们运行 kubectl 命令来获取所有 K8S 对象，并验证所有 Kubernetes 对象都是用'<strong class="ih hj"><em class="jg">helm install shashir-db MySQL</em>'</strong>命令自动创建的。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lf"><img src="../Images/0da559055ae8119066453597d6900f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRLVMoYmBdpIIZ7yP0cEVA.png"/></div></div></figure><p id="3317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要连接 MySQL 实例，我们可以使用以下步骤:</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="f3ee" class="ks kt hi ko b fi ku kv l kw kx">PS C:\Users\srs\Desktop\SRS_2021\HELM_Charts\charts\stable&gt; <strong class="ko hj">helm install shashir-db mysql</strong><br/>WARNING: This chart <strong class="ko hj">is </strong>deprecated<br/>NAME: shashir-db<br/>LAST DEPLOYED: Sat Sep 25 17:48:09 2021<br/>NAMESPACE: default<br/>STATUS: deployed<br/>REVISION: 1<br/>NOTES:<br/>MySQL can be accessed via port 3306 on the following DNS name from within your cluster:<br/>shashir-db-mysql.default.svc.cluster.local<br/><br/>To get your root password run:<br/><br/>MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace default shashir-db-mysql -o jsonpath=<strong class="ko hj">"{.data.mysql-root-password}" </strong>| base64 --decode; echo)<br/><br/>To connect to your database:<br/><br/>1. Run an Ubuntu pod that you can use <strong class="ko hj">as </strong>a client:<br/><br/><strong class="ko hj"><em class="jg">kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il</em></strong><br/><br/>2. Install the mysql client:<br/><br/><strong class="ko hj"><em class="jg">$ apt-get update &amp;&amp; apt-get install mysql-client -y</em></strong><br/><br/>3. Connect using the mysql cli, then provide your password:<br/><strong class="ko hj"><em class="jg">$ mysql -h shashir-db-mysql -p</em></strong><br/><br/>To connect to your database directly from outside the K8s cluster:<br/>MYSQL_HOST=127.0.0.1<br/>MYSQL_PORT=3306<br/><br/># Execute the following command to route the connection:<br/><strong class="ko hj"><em class="jg">kubectl port-forward svc/shashir-db-mysql 3306<br/><br/>mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD}</em></strong></span></pre><p id="267c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">验证部署—“ku bectl get deployment”</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lg"><img src="../Images/2311dfeb4ed796253d36f2447965d1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*og1ZPmBQGZ8VlWk8KirtdQ.png"/></div></div></figure><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="fd45" class="ks kt hi ko b fi ku kv l kw kx"><strong class="ko hj">helm get all shashir-db</strong></span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lh"><img src="../Images/62faa75a1b446cf68aa57e4cd91becad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*RNJF71wFhIsTPmYfa-f8lQ.png"/></div></figure><p id="9c48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你已经发现这篇文章对开始掌舵有帮助。在这里，我们开始使用 Chocolatey 和 HELM 组件安装 HELM——如何使用它来部署现有的 HELM 图表——例如，在我们的例子中是 MySQL。</p><p id="046d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><p id="ea54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ka" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank">https://kubernetes.io/</a><br/>T17】https://helm.sh/</p></div></div>    
</body>
</html>