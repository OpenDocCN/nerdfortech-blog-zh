<html>
<head>
<title>Making sense of the Fetch API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解获取API</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/making-sense-of-the-fetch-api-a7354fefb87f?source=collection_archive---------20-----------------------#2021-05-31">https://medium.com/nerd-for-tech/making-sense-of-the-fetch-api-a7354fefb87f?source=collection_archive---------20-----------------------#2021-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9c44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最近开始走上漫长而曲折的道路，成为一名软件工程师。老实说，这条路有时似乎仍然令人生畏，但我已经爱上了软件工程中包含日常工作的动手解决问题的部分。我也非常喜欢到目前为止我学到的材料。在过去的几天和几周里，我一直在讨论的一个话题是Fetch API。在这篇博客中，我将回顾Fetch API的基础知识。但是，首先我将解释什么是API，它是如何工作的，以及数据传输过程pre-fetch()。这将有助于突出Fetch API的独特功能，尤其是相对于它的AJAX前身XMLHttpRequest。</p><h1 id="467e" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">什么是API？</h1><p id="d8c1" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">API代表应用程序编程接口。IBM在其网站上将API解释为“一组定义好的规则，解释了计算机或应用程序如何相互通信。API位于应用程序和web服务器之间，充当处理系统间数据传输的中间层”(参见IBM网站<a class="ae kg" href="https://www.ibm.com/cloud/learn/api" rel="noopener ugc nofollow" target="_blank">这里</a>)。作为一个初学软件开发的人，这个想法是有意义的API作为“中间层”的想法允许数据从一个系统传递到另一个系统。IBM再一次提供了一个简单而有效的描述，描述了<em class="kh">一个基本API是如何工作的。</em></p><blockquote class="ki kj kk"><p id="9f77" class="if ig kh ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">1.<strong class="ih hj">客户端应用程序启动API </strong>调用来检索信息，也称为<em class="hi">请求</em>。这个请求通过API的统一资源标识符(Uniform Resource Identifier，URI)从应用程序发送到web服务器，包括请求动词、请求头，有时还包括请求体。</p><p id="70e3" class="if ig kh ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">2.<strong class="ih hj">收到有效请求</strong>后，API调用外部程序或web服务器。</p><p id="5e2f" class="if ig kh ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">3.<strong class="ih hj">服务器向API发送一个<em class="hi">响应</em> </strong>，其中包含所请求的信息。</p><p id="2a1d" class="if ig kh ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">4.<strong class="ih hj">API将数据</strong>传输到最初发出请求的应用程序。</p><p id="ca9e" class="if ig kh ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated"><em class="hi">(这些步骤摘自</em><a class="ae kg" href="https://www.ibm.com/cloud/learn/api" rel="noopener ugc nofollow" target="_blank"><em class="hi"/></a><em class="hi">站点)</em></p></blockquote><p id="fd77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们对API是什么以及它是如何工作的有了一个基本的了解，让我们看看在fetch()出现之前这种请求-响应风格的数据传输是如何发生的。</p><h1 id="8bf3" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">互联网预取()</h1><p id="b0c5" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Fetch API及其前身<strong class="ih hj"> XMLHttpRequest </strong>的创建是基于一个革命性概念<a class="ae kg" href="https://www.w3schools.com/whatis/whatis_ajax.asp" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">【AJAX】</strong></a>(<strong class="ih hj">异步JavaScript和</strong> <a class="ae kg" href="https://www.w3schools.com/xml/xml_whatis.asp" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> XML </strong> </a>)的开发和实现。本质上，AJAX允许网页异步更新。这意味着网页的特定部分可以在“幕后”交换数据时更新。在AJAX出现之前，数据交换甚至需要对网页进行最小的更新，这就需要刷新整个页面，这使得AJAX在增强用户体验和数据传输能力方面都取得了巨大的突破。XMLHttpRequest对象成为创建AJAX请求的第一种方法——从URL中检索数据，只更新部分网页而无需刷新。XMLHttpRequest对象可以检索任何类型的数据(顾名思义，不仅仅是XML)。</p><h1 id="bb7a" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">获取API</h1><p id="b4e3" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Fetch是在XMLHttpRequest之后开发的本地JavaScript API，它利用了AJAX编程。以下是取自<a class="ae kg" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" rel="noopener ugc nofollow" target="_blank"> MDN </a>的基本获取请求的结构:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="490a" class="kx je hi kt b fi ky kz l la lb">fetch('http://example.com/movies.json')<br/>  .then(response =&gt; response.json())<br/>  .then(data =&gt; console.log(data));</span></pre><p id="4531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们回顾一下这段代码中发生了什么。首先，<strong class="ih hj">获取</strong>正在从URL <code class="du lc ld le kt b"><a class="ae kg" href="http://example.com/movies.json" rel="noopener ugc nofollow" target="_blank">http://example.com/movies.json</a></code>检索数据。然后fetch返回一个<strong class="ih hj">承诺</strong>(关于承诺的更多信息，请查看Jake Archibald的这篇非常有用的文章，在这里找到<a class="ae kg" href="https://web.dev/promises/" rel="noopener ugc nofollow" target="_blank"/>)。不管数据是否被成功检索，fetch都将返回一个Promise对象。承诺然后解析为一个<strong class="ih hj">响应</strong>对象。接下来，第一个<strong class="ih hj">。然后</strong>函数将获取这个响应对象，并使用内置的<strong class="ih hj">将其转换为<strong class="ih hj"> JSON </strong>。json() </strong>方法(有关json的更多信息，请查看<a class="ae kg" href="https://www.w3schools.com/whatis/whatis_json.asp" rel="noopener ugc nofollow" target="_blank">这个</a>页面)。最后，第二个<strong class="ih hj">。然后</strong>取之前转换成JSON的对象。然后console.log的那个对象。另外，一个<strong class="ih hj">。catch() </strong>函数可以添加到上面的代码中，以便在请求失败时接收一个<strong class="ih hj">错误</strong>对象。</p><p id="d10e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">fetch()方法还接受可选的第二个参数——一个<strong class="ih hj">配置(或init)对象</strong>。配置对象允许以多种不同的方式检索和操作后端数据。MDN提供了一个使用配置对象的获取请求的有用示例(在这里可以找到<a class="ae kg" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" rel="noopener ugc nofollow" target="_blank"/>)。然而，在其核心，配置对象不仅允许fetch()检索数据，还允许<strong class="ih hj">c</strong>create、<strong class="ih hj"> r </strong> ead、<strong class="ih hj"> u </strong> pdate和<strong class="ih hj">d</strong>delete数据(简称CRUD)。我们期望现代API能够执行CRUD功能。如前所述，fetch()方法通过指定“请求动词、头，有时还有请求体”来满足这些期望。例如，可以使用fetch()和包含请求动词<strong class="ih hj"> POST </strong>的配置对象来创建数据，通过包含请求动词<strong class="ih hj"> GET </strong>来读取数据，通过包含<strong class="ih hj">补丁</strong>来更新数据，或者通过包含<strong class="ih hj"> DELETE </strong>来删除数据。还有其他类型的请求，但这四种是最基本的。在完成挑战和构建小型项目时，我几乎完全依赖这些请求。</p><h1 id="2606" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">是什么让Fetch API比XMLHttpRequest好？</h1><p id="748b" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">其他博客已经专门讨论了这个问题，但是我将简要概述使用fetch()相对于XMLHttpRequest的主要优势。首先，Fetch API比使用XMLHttpRequest对象简单。它需要较少的逻辑硬编码到请求中(特别是在处理响应和错误时)。此外，在Fetch API中使用承诺和定义良好的请求和响应对象，有助于创建相对于同等的XMLHttpRequest代码更干净、更容易理解的代码。总的来说，Fetch API相对于XMLHttpRequest“提供了更强大、更灵活的特性集”(参见<a class="ae kg" href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank"> MDN Fetch API </a>)。如果你对fetch()和XMLHttpRequest有兴趣，请查看Swapnil Bangare的博客<a class="ae kg" rel="noopener" href="/beginners-guide-to-mobile-web-development/the-fetch-api-2c962591f5c#:~:text=The%20Fetch%20API%20makes%20it,modern%20JavaScript%20features%20like%20promises%20."><em class="kh">Fetch API</em></a>，以及相关的<a class="ae kg" href="https://developers.google.com/web/ilt/pwa/working-with-the-fetch-api" rel="noopener ugc nofollow" target="_blank"> Google开发者文档</a>。</p><h1 id="53ca" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论</h1><p id="d298" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在这篇博客中，我谈到了几个不同的主题——都围绕着Fetch API。首先，我提供了对API的基本理解。第二，我将Fetch API放在请求-响应周期的更广泛的背景中，这个周期描述了我们作为客户端如何与网站进行交互以访问和操作数据。随着AJAX的出现，这个循环现在是异步的。第三，我概述了fetch()的基础知识。最后，我简要比较了fetch()和它的前身XMLHttpRequest。我希望你从我的博客中学到了一些关于Fetch API的知识。我喜欢学习API以及数据如何从一个系统传输到另一个系统，随着我作为软件工程师的不断学习和成长，我期待着定期发布任何启发我的新软件工程想法或主题！</p></div></div>    
</body>
</html>