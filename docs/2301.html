<html>
<head>
<title>Unity: Playing sound through code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Unity:通过代码播放声音</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/unity-playing-sound-through-code-98f385402b6?source=collection_archive---------9-----------------------#2021-04-30">https://medium.com/nerd-for-tech/unity-playing-sound-through-code-98f385402b6?source=collection_archive---------9-----------------------#2021-04-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="af7f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">让东西爆炸！然后砰！只要你需要！</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/54355e72b74dc526df5a5a21b006d933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vM8nCIuNWOfDUKGH"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">西蒙·因佩伊在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2ff0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们现在已经讨论了如何在 Unity 中开始使用音乐，并且在不需要代码的情况下添加了一些不错的背景音乐！但是，在某些情况下，我们不想一直播放音频文件，并且希望控制<em class="kk">在</em>播放特定的声音。我们可以通过代码实现这一点！我们开始吧！</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="4cd6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">设置玩家游戏对象<br/> </strong>当我们从玩家脚本中实例化激光时，最好也在这个脚本中设置与激光相关的所有音频。由于我们可以分配任何我们想要的剪辑(并因此操纵音频剪辑)，播放器本身也需要一个<em class="kk">音频源</em>组件。我们需要在源游戏对象中分配一个音频剪辑，这就是音频源的来源。还记得<em class="kk">音频剪辑</em>槽吗？</p><p id="e295" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">确保取消选中<em class="kk">唤醒时播放</em>复选框！否则，你会在游戏开始后就听到声音，甚至不用发射激光。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ks"><img src="../Images/7450c059af14803b257c8266e28448c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ePG-_oxJwLyP5pFAll9rZA.gif"/></div></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="a96a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">设置 Player.cs 脚本<br/> </strong>接下来要做的是为我们想要播放的音频片段创建一个变量。当我们存储一个音频剪辑时，我们需要的变量类型是类型<em class="kk"> AudioClip。另外，<em class="kk"> </em>我们还需要在播放器上添加一个<em class="kk">音源</em>组件。我们这样做是因为我们希望能够改变一些额外的设置，如所需剪辑的<em class="kk">音量</em>或<em class="kk">音高</em>。</em></p><p id="93f0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，在脚本中添加音频剪辑和音频源的变量:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kt"><img src="../Images/9723bb0a22e15fc60ff79d1febffcab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AMTN6ECKcAG5fw1P9hm4aw.png"/></div></div></figure><p id="e390" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后，返回编辑器，分配你在发射激光时喜欢听到的音频剪辑:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ku"><img src="../Images/f67301ce9343b0fb20acb531b91d99b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*I10wwKn7WiXtR1MOnLua2g.gif"/></div></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="6682" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">通过代码<br/> </strong>播放声音为了播放声音，我们必须添加所需的代码。</p><p id="280c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，我们需要一个音源的参考。我们还想对它进行空检查。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kv"><img src="../Images/d7a77bb5bacdfa82f7daf6c7e9a95e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bb6eh04qKsTFhyyyex1e2w.png"/></div></div></figure><p id="7df5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们希望在我们发射激光的同时播放这个片段。因此，我们应该将代码添加到<em class="kk"> InstantiateLaser() </em>方法内部。</p><p id="68b9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了以正确的方式做到这一点，让我们考虑一下我们在这里必须做什么:</p><ul class=""><li id="d844" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">我们需要分配音频源应该播放的剪辑</li><li id="68ab" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">由于播放器脚本已经有了我们想要的剪辑的变量，我们可以只使用这个变量</li><li id="b1cc" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">音频源应该播放声音</li></ul><p id="1a9e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这将导致以下代码:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lk"><img src="../Images/d47d61bee41308b5264f5ce640f7a980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQvRvhp9G02VhOxhVhRFwA.png"/></div></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="955f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">敌人爆炸的声音<br/> </strong>我们刚刚学会了如何播放我们发射激光时的音效。至于敌人，只是我们打中了就消失了。我们破坏的时候加个爆炸声吧！</p><p id="940d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们通过使用刚才使用的相同方法来实现这一点。</p><ul class=""><li id="8a1e" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">首先我们需要在敌人<br/> <em class="kk">上加一个<em class="kk">音源</em>组件提示:切记敌人是预制的！要么直接在上面添加组件，要么“应用”您后来所做的更改！</em></li><li id="46ad" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">取消选中<em class="kk">唤醒时播放</em>复选框</li><li id="bda0" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">在敌人. cs 脚本中设置<em class="kk">音频剪辑</em>和<em class="kk">音频源</em>变量</li><li id="c2ee" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">创建句柄并对它们进行空值检查</li><li id="747f" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">在编辑器中分配所需的音频片段</li></ul><p id="e268" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">由于我们想播放敌人被激光击中后的声音，我们应该在<em class="kk"> Enemy.cs </em>脚本中添加逻辑。在我们讨论将代码放在哪里之前，让我们先看看当前的代码:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ll"><img src="../Images/9165bef3826cf645eef7a79b155ebbd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7CFcTqgpJKZQhSlEvtH3Ng.png"/></div></div></figure><ul class=""><li id="9e24" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">首先，我们摧毁<em class="kk"> BoxCollider2D </em>以避免再次被击中</li><li id="352f" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">之后，我们将速度设置为 0，以避免敌人进一步移动</li><li id="9535" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">在那之后，我们给动画师触发播放爆炸动画</li><li id="1251" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">最后，我们在动画结束后消灭敌人</li></ul><p id="cf5e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在就来想想播放爆炸音效的最佳时刻吧。在动画播放之前播放爆炸声就没意义了吧？因此，我们首先应该给动画师开始播放动画的信号。在那之后，我们应该在敌人被摧毁之前播放声音。</p><p id="b510" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在我们已经确定了添加代码的最佳位置，让我们继续添加它。这和之前在播放器上的程序是一样的。</p><ul class=""><li id="e6fb" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">将音频剪辑指定给爆炸声音剪辑</li><li id="3885" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">告诉音频源播放声音</li></ul><p id="9956" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">完整的代码将如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lm"><img src="../Images/b0075d9a9b59582f52f24365c71caa14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhBWXhSUKY5Jbg-Zvq7Phg.png"/></div></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="6514" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">添加开机音效<br/> </strong>如果我们想为开机画面添加音效，我们需要使用另一种方法。我们为玩家和敌人使用的实现在电源上不起作用。当玩家触摸它时，我们破坏了电源，因此也会破坏它上面的音源。</p><p id="d772" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有很多方法可以解决这个问题。例如，您可以</p><ul class=""><li id="3fc4" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">在指定的时间后摧毁游戏对象，并在它被摧毁前播放声音</li><li id="ab08" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">使用<em class="kk">播放剪辑点</em>，它基本上创建了一个一次性音源来播放声音</li><li id="a5bb" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">创建一个拥有<em class="kk">音频源</em>的游戏对象，并用它来播放声音</li></ul><p id="eddc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因为我们想完全控制声音播放的音量，所以我们选择第三个选项。</p><ul class=""><li id="c9df" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">创建一个游戏对象"<em class="kk"> PowerUp_AudioManager" </em></li><li id="eda9" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">添加一个<em class="kk">音源</em>组件</li><li id="2d9e" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">在<em class="kk">加电预置</em>和<em class="kk">音源</em>处分配<em class="kk">音频剪辑</em></li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ln"><img src="../Images/5d1ccea4270399794b6e204f62b34672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Cmd9suXNkQPcpn4Brhfk1g.gif"/></div></div></figure><p id="4344" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，开始准备<em class="kk"> PowerUp.cs </em>脚本。和以前一样的程序。</p><ul class=""><li id="a674" class="kw kx hi jq b jr js ju jv jx ky kb kz kf la kj lb lc ld le bi translated">创建对音频源的引用</li><li id="66d4" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">创建对音频剪辑的引用</li><li id="8262" class="kw kx hi jq b jr lf ju lg jx lh kb li kf lj kj lb lc ld le bi translated">空检查引用</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lo"><img src="../Images/85232a45813de3f1431b2b08a94a7c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ge_XoSGmKvcy6VnEtAmCzw.png"/></div></div></figure><p id="d848" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">其余的也与先前的过程相同。我们想在加电和播放器碰撞后播放音效。由于冲突是在<em class="kk"> OnTriggerEnter2D() </em>方法中检查的，我们在那里添加了代码:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lp"><img src="../Images/586bcb4bff43d0b04c3f07f98f45c019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQVJeU2qnhTLy2ak14RmcQ.png"/></div></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="750f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">就是这样！太空射击游戏中的音效！那些只是一些简单的效果，但是对于游戏的手感非常有效！</p></div></div>    
</body>
</html>