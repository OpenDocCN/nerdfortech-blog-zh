<html>
<head>
<title>How to clear Data Analyst Interview round 1: part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过第一轮数据分析师面试:第 2 部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/how-to-clear-data-analyst-interview-round-1-part-2-437abad73e?source=collection_archive---------22-----------------------#2021-06-27">https://medium.com/nerd-for-tech/how-to-clear-data-analyst-interview-round-1-part-2-437abad73e?source=collection_archive---------22-----------------------#2021-06-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/94aa9f1ecf596b67b4fcb2ff1ed347f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Q5TjZza_KYpLAqa"/></div></div></figure><p id="b994" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在<a class="ae jo" rel="noopener" href="/nerd-for-tech/how-to-clear-the-data-analyst-interview-round-1-99010a1f93fd"> <strong class="is hj">上一篇文章</strong> </a>中，我分享了我在第一轮数据分析师访谈中被问到的问题，我想写第二部分，因为我在过去几天接受了更多的访谈，并被一些我想分享/记录的非常聪明的问题所困惑。</p><p id="cf4e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你打算在任何领域追求你的职业生涯，哪怕是稍微接近数据科学的领域，你必须精通你的 SQL 技能。我个人会推荐你练习所有这些问题。如果你能从上一篇文章中回答出这些问题，你将 100%被第一轮面试选中。</p><h1 id="5d89" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">问题 1</h1><p id="699a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><strong class="is hj">语句</strong>:使用以下连接后，输出中将出现多少行</p><ol class=""><li id="1481" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">左连接</li><li id="5283" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">右连接</li><li id="aaf9" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">内部连接</li><li id="cfef" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">外部连接</li></ol><blockquote class="lg lh li"><p id="9f2d" class="iq ir lj is b it iu iv iw ix iy iz ja lk jc jd je ll jg jh ji lm jk jl jm jn hb bi translated">我将使用 pandas 来显示表并确定行数，因为我发现它比在数据库中创建新表更容易操作。</p></blockquote><p id="0358" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">给出的表格</strong></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/740ac3795659236db4ff2daf337b222f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IzBzmIzSOxckfASKeYmYeQ.png"/></div></div></figure><p id="a110" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">回答:</strong></p><p id="c1b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">左连接:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/401f1740518efcd0eb9ef060324b444a.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*3u9ckP3uTWTHQ4Dp00AcnA.png"/></div></figure><p id="0530" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">右连接:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/8d8635cb3ff25f5a456761418246b09f.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*IRP2m5i_Ors8rcw5_Omqvw.png"/></div></figure><p id="7124" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">内部联接:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/4783bcd5cb30ce6fb8f8a54b6cbb0bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*jxGrg8r299C7JviFkC4-Ig.png"/></div></figure><p id="1a92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">外部联接:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/bec947e0c7d12a8038399b34842139ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*Qw4ffymuN8x2ku2-SLzz_A.png"/></div></figure><p id="1a71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个棘手的问题，因为我们有一个有很多重复的值“x ”,我在回答这个问题时完全糊涂了，所有的答案都错了。诀窍是表 1 中的每个“x”都将与表 2 中的 3 个“x”连接起来。这就是为什么 left join 有 7 行。</p><h1 id="f71a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">问题 2</h1><p id="6793" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><strong class="is hj">语句</strong>:UNION 和 UNION ALL 的区别是什么，也给出下面的表在应用 UNION 运算后的输出？</p><p id="a0f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">给出的表格</strong></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/77b9d6dcfb93017357c3c3a6aefcbe75.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*7W4j0blBDNUqlnBhjL0TfQ.png"/></div></div></figure><p id="74da" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">回答</strong> : <strong class="is hj"> Union </strong>将按行连接两个表，但只添加唯一的行值，而<strong class="is hj"> union all </strong>将添加所有的行。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/ea606c42c5f6aa7d0ce7e0e563079328.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*lmL_e_2WgpetiY2-dTGeLQ.png"/></div></figure><blockquote class="lg lh li"><p id="0a9c" class="iq ir lj is b it iu iv iw ix iy iz ja lk jc jd je ll jg jh ji lm jk jl jm jn hb bi translated">除了表 2 中的 id 7，所有 id 都将显示。</p></blockquote><h1 id="1683" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">问题 3</h1><p id="a335" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><strong class="is hj">表给定</strong></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/a5c5317d79bc4ddbd76f3bcccde55d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*qgHuRAItS7g-yqAMILMm0Q.png"/></div></figure><p id="9a49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">说法</strong>:找出分数不随时间增长的同学。(我不确定这是否是确切的问题陈述，但我希望您理解其中的问题)表名是“marks”</p><p id="9b33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">回答</strong>:</p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="2c77" class="me jq hi ma b fi mf mg l mh mi">select distinct answer<br/>from <br/>(select <br/>case <br/>    when diff&lt;0 then "id"<br/>end as answer<br/>from </span><span id="5dd3" class="me jq hi ma b fi mj mg l mh mi">(select *,<br/>marks-lag(marks,1)<br/>over(partition by id) as diff<br/>from marks)a) b</span></pre><p id="4b6e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">说明</strong>:我们在这里使用了<strong class="is hj">窗口</strong>功能<strong class="is hj">滞后</strong>。首先，我会试着找出标记和滞后值的区别。滞后值是上面一行的行值，所以我可以减去上面一行的值来评估分数是否在递增。为了说明检查下面的照片。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/d114ac69fdfd4996f304edffbcaa4021.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*jY0k9ok5o8AcRMok3_h2Tg.png"/></div></figure><p id="c6f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后我们将使用“case when”来查找是否有 diff 小于 0(负值)的值，当我们找到该值时，我们将在列中添加值“id”。</p><p id="993f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将输出 case-when 列中所有不同的 id 值。</p></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><blockquote class="lg lh li"><p id="4ea3" class="iq ir lj is b it iu iv iw ix iy iz ja lk jc jd je ll jg jh ji lm jk jl jm jn hb bi translated">接下来采访中提出的几个问题可以在编码平台上找到，所以我在那里解决了它们。所有问题都是自测题，测试你的 SQL 函数知识。</p></blockquote><h1 id="ee75" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">问题 4</h1><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/b68fb053bd473fce0710db16590c5b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iI7Dq4B4yFqkKuqDlINs_Q.png"/></div></div></figure><p id="6db6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">答案:</strong></p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="9c56" class="me jq hi ma b fi mf mg l mh mi">select floor(avg(salary)), floor(max(salary))<br/>from salaries<br/>where substr(name,1,1)="a";</span></pre><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/5218ede611b5ca01e1008110f96b5ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*nKk7aWBfTTG5z_QnoZlX0A.png"/></div></figure><h1 id="e5f8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">问题 5</h1><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/60ce19218bf1174d560bdeddbd214a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*ob_iaYU1GcHOSIfY5mBzFQ.png"/></div></figure><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/5a99d649f06abd0567bb1d5d1e230e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N4pcLsGk5GPihbNyH_dyjA.png"/></div></div></figure><p id="7dbe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">回答:</strong></p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="df6c" class="me jq hi ma b fi mf mg l mh mi">select name, count(name)<br/>from match_data<br/>where batting_status=0<br/>group by name<br/>order by name;</span></pre><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/bc95c1ff9e63e5601c298f52e507ba01.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*SYauJBtX55-YswYUKWnEfw.png"/></div></figure><h1 id="a9fc" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">问题 6</h1><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/9ff87b77d6517fdb4f5ca50811f389dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4G9Dm74nkmY3au9OXqmgw.png"/></div></div></figure><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es my"><img src="../Images/8d3eef9f90152829b3494dc6f3d5b632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*QvzGtikNmd5ukSNOmXWZpw.png"/></div></figure><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/5709967871433e33e5447b46f71d9754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NDE4gyPFwNCy05zE-ekoiQ.png"/></div></div></figure><p id="6c5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">回答:</strong></p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="1f19" class="me jq hi ma b fi mf mg l mh mi">select a.personid, a.name, count(b.personid), sum(c.score)<br/>from person a<br/>inner join friend b<br/>on a.personid=b.personid<br/>inner join person c<br/>on c.personid=b.friendid<br/>group by a.personid<br/>having sum(c.score)&gt;100<br/>order by a.personid;</span></pre><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es na"><img src="../Images/0c7bd7afb9d80ce3bb84a1702639e959.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*ldhZ7xQcmigh8GEdmlaw6w.png"/></div></figure><p id="e893" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个自连接的问题，这是 SQL 数据分析最重要的主题之一。我建议你彻底练习自我联结。</p><h1 id="4566" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="1a9e" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在所有的访谈中，一些常见的问题都与加入后的输出有关。第二高的薪水问题已经被问了 5 次了。内部连接也非常重要。请务必阅读这些主题，并定期练习。</p></div></div>    
</body>
</html>