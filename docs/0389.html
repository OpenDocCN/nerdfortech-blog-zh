<html>
<head>
<title>Setting Up VS Code for Scala Development on WSL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 WSL 上为 Scala 开发设置 VS 代码</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/setting-up-vs-code-for-scala-development-on-wsl-258386a31c23?source=collection_archive---------5-----------------------#2020-11-20">https://medium.com/nerd-for-tech/setting-up-vs-code-for-scala-development-on-wsl-258386a31c23?source=collection_archive---------5-----------------------#2020-11-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6762" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio Code </a> (VS Code)多年来一直是我最喜欢的编辑器。随着大量的扩展和社区支持，VS Code 已经成为最受欢迎的编程编辑器之一。<a class="ae jd" href="https://docs.microsoft.com/en-us/windows/wsl/" rel="noopener ugc nofollow" target="_blank">Linux 的 Windows 子系统</a> (WSL)让开发者直接在 Windows 上运行 Linux 环境。这两者的强大结合为程序员提供了一个编写软件的好方法。</p><p id="d29c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">VS 代码有优秀的语言支持，包括 Scala。大多数 Scala 开发者使用<a class="ae jd" href="https://www.jetbrains.com/idea/" rel="noopener ugc nofollow" target="_blank"> IntelliJ </a>作为他们的开发工具。因此，使用 VS 代码作为 Scala 开发工具的教程并不多。这篇文章是关于在 WSL 上为 Scala 编程设置 VS 代码的简短教程。希望它能为设置 Scala 开发环境提供有用的信息。</p><h1 id="76fc" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">假设和要求</h1><p id="9727" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">本教程是使用以下设置编写的:</p><ul class=""><li id="1426" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">Windows 10 2004(主机操作系统)</li><li id="09ab" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">带有扩展的 Visual Studio 代码 1.51:用于 Scala 编程的 Scala (Metals) 1.9.6，以及用于 WSL 远程开发的<a class="ae jd" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack" rel="noopener ugc nofollow" target="_blank">远程开发</a> 0.20.0</li><li id="d299" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><a class="ae jd" href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions#whats-new-in-wsl-2" rel="noopener ugc nofollow" target="_blank">用于 Linux 的 Windows 子系统 2 </a> (WSL2)</li><li id="8b5f" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><a class="ae jd" href="https://ubuntu.com/wsl" rel="noopener ugc nofollow" target="_blank">wsl 2 上的 Ubuntu 20.04</a></li><li id="f1c6" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">Java ( <a class="ae jd" href="https://adoptopenjdk.net/" rel="noopener ugc nofollow" target="_blank"> OpenJDK 11 </a>)</li><li id="1b13" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">SBT 1 . 4 . 1</li><li id="b0e3" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><a class="ae jd" href="https://github.com/scala/scala/releases/tag/v2.13.3" rel="noopener ugc nofollow" target="_blank"> Scala 2.13.3 </a></li><li id="c6ec" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated"><a class="ae jd" href="https://mobaxterm.mobatek.net/" rel="noopener ugc nofollow" target="_blank">mobax term</a>20.5 Windows 访问 WSL2 的增强终端。</li></ul><h1 id="0b5b" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">步骤 1:设置 WSL2</h1><p id="f777" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">最新的 WSL 版本 WSL2 是用完整的 Linux 内核构建的，由 Windows updates 提供服务。WSL2 不仅提高了文件 IO 性能，还提供了完整的系统调用兼容性。如果你的 Windows 10 比 1903 Build 18362 新，强烈推荐使用 WSL2。</p><p id="a97d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要在 Windows 10 上设置 WSL2，请遵循以下说明:<a class="ae jd" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener ugc nofollow" target="_blank">Windows 10</a>的 Windows Subsystem for Linux 安装指南。确保<a class="ae jd" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10#step-2---update-to-wsl-2" rel="noopener ugc nofollow" target="_blank"> WSL2 </a>已启用。WSL 安装完成后，从 Windows Store 安装<a class="ae jd" href="https://www.microsoft.com/en-us/p/ubuntu-2004-lts/9n6svws3rx71?rtc=1&amp;activetab=pivot:overviewtab" rel="noopener ugc nofollow" target="_blank"> Ubuntu 20.04 </a>。</p><h1 id="3c38" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">第二步:在 Windows 10 上安装 VS 代码和相关软件</h1><p id="2670" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在 Windows 10 上，安装 VS 代码和 Scala 以及远程开发扩展。</p><ol class=""><li id="9878" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc kv kn ko kp bi translated">从<a class="ae jd" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">https://code.visualstudio.com/</a>下载 VS 代码。</li><li id="091d" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">按照说明安装 VS 代码。</li><li id="5266" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">点击<a class="ae jd" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack" rel="noopener ugc nofollow" target="_blank">安装</a>并按照其说明安装远程开发。</li><li id="1793" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">执行与上一步相同的操作，安装<a class="ae jd" href="https://marketplace.visualstudio.com/items?itemName=scalameta.metals" rel="noopener ugc nofollow" target="_blank"> Scala(金属)</a>延长件。</li></ol><p id="d3aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，从 MobaXterm 的官方网站<a class="ae jd" href="https://mobaxterm.mobatek.net/download-home-edition.html" rel="noopener ugc nofollow" target="_blank">https://mobaxterm.mobatek.net/download-home-edition.html</a>安装它。访问 WSL2 的另一个选项是<a class="ae jd" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10#install-windows-terminal-optional" rel="noopener ugc nofollow" target="_blank"> Windows 终端</a>。本教程使用 MobaXterm。</p><h1 id="7391" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">步骤 3:在 Ubuntu 上安装 Java、sbt 和 Scala(wsl 2)</h1><p id="9d46" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">启动已安装的 MobaXterm 并单击 WSL 会话。MobaXterm 自动检测系统中的 WSL。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/8af26c8abadf6ed7b1fa235cf0b748a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cvln4y2NPXaLjjt9.png"/></div></div></figure><p id="c0ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们应该看到 Ubuntu bash shell。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/2886ed796378f8ef8a0ceec2f299a4a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Sp0z025FocX1q5Ac.png"/></div></div></figure><ul class=""><li id="8c47" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">安装 OpenJDK 11</li></ul><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="de39" class="ln jf hi lj b fi lo lp l lq lr">$ sudo apt install openjdk-11-jdk</span></pre><p id="9318" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，VS 代码使用<code class="du ls lt lu lj b">JAVA_HOME</code>环境变量来定位<em class="lv"> java </em>可执行文件。为了确保 VS 代码使用正确的 JDK 版本，建议设置<code class="du ls lt lu lj b">JAVA_HOME</code>。给<code class="du ls lt lu lj b">~/<em class="lv">.bashrc</em></code>加上下面一行。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="b6c6" class="ln jf hi lj b fi lo lp l lq lr">export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64/</span></pre><p id="66c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，如果安装不同的 JDK，路径可能会不同。</p><ul class=""><li id="e504" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">安装 sbt</li></ul><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="ea6d" class="ln jf hi lj b fi lo lp l lq lr">$ sudo apt install sbt</span></pre></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><ul class=""><li id="b3f1" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">安装 Scala</li></ul><p id="443c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没有必要安装 Scala，因为当我们构建一个 Scala 程序时，sbt 会下载一个合适的版本。然而，如果需要使用 Scala REPL(命令行 shell ),运行下面的命令来安装它。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="5714" class="ln jf hi lj b fi lo lp l lq lr">$ sudo apt install scala</span></pre><h1 id="3e89" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">步骤 4:使用 VS 代码创建一个示例项目</h1><p id="613b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">教程用于演示的示例项目具有以下布局。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="ac2f" class="ln jf hi lj b fi lo lp l lq lr">scala-sample-code<br/> ├── .scalafmt.conf<br/> ├── build.sbt<br/> ├── project<br/> │   └── build.properties <br/> └── src<br/>     ├── main<br/>     │   └── scala<br/>     │       └── Sample.scala<br/>     └── test<br/>         └── scala<br/>             └── SampleSpec.scala</span></pre><p id="8fdf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们启动 VS 代码之前，使用 mobaXterm Ubuntu shell 在 Ubuntu WSL2 上创建一个项目文件夹。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="4c8a" class="ln jf hi lj b fi lo lp l lq lr">$ cd ~ <br/>$ mkdir scala-sample-code</span></pre><p id="0dc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦创建了项目文件夹，我们就可以关闭 mobaXterm 并启动 VS 代码。</p><p id="9ced" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击左下方图标连接 WSL，选择 WSL 中的<em class="lv">打开文件夹，如下图所示，打开我们刚刚创建的<code class="du ls lt lu lj b">scala-sample-code</code>文件夹。</em></p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/932134a8cd36c4db15869937013764fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fMzxFLaPQd64cjEf.png"/></div></div></figure><p id="990c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 VS 代码打开<code class="du ls lt lu lj b">scala-sample-code</code>文件夹后，我们可以看到左下角的图标变成了<code class="du ls lt lu lj b">WSL: Ubuntu,</code>，我们可以开始创建文件夹和文件。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/445490616c8ae181a45c9d42455ddcb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YQvseQwgGAtkCWHR.png"/></div></div></figure><p id="6dd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先用以下内容创建<code class="du ls lt lu lj b">build.sbt</code>。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="0253" class="ln jf hi lj b fi lo lp l lq lr">ThisBuild / scalaVersion := "2.13.3" <br/>ThisBuild / version := "0.0.1" </span><span id="3de7" class="ln jf hi lj b fi md lp l lq lr">lazy val sample = (project in file("."))<br/>  .settings(<br/>    name := "Sample Project",<br/>    libraryDependencies += "org.scalatest" %% "scalatest" % "3.2.2" % Test, <br/>)</span></pre><p id="51e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦创建了<code class="du ls lt lu lj b">build.sbt</code>文件，VS 代码的 Metals 扩展就会自动检测到这个变化，并弹出一个导入构建的窗口。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/807bc6e59d79734a83d3d92b43a2ac5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jbAelP64rpdrJoL4.png"/></div></div></figure><p id="7f34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入过程会自动创建一些 sbt 构建文件夹和文件。我们可以不断地创建我们的项目文件夹和文件。</p><p id="3dbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> .scalafmt.conf </strong></p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="ada3" class="ln jf hi lj b fi lo lp l lq lr">version = "2.7.4" <br/>align.preset = more <br/>maxColumn = 100</span></pre><p id="acd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Sample.scala </strong></p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="fc98" class="ln jf hi lj b fi lo lp l lq lr">object Sample extends Greeting with App {<br/>  println(greeting)<br/>}<br/><br/>trait Greeting { lazy val greeting: String = "hello" }</span></pre><p id="7c07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> SampleSpec.scala </strong></p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="7f88" class="ln jf hi lj b fi lo lp l lq lr">import org.scalatest.wordspec._<br/><br/>class SampleSpec extends AnyWordSpec {<br/>  "The sample code" should {<br/>    "say hello" in {<br/>      assert(Sample.greeting.startsWith("h"))<br/>    }<br/>  }<br/>}</span></pre><p id="6bf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建示例项目后，布局看起来像下面 VS 代码中的图片。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es me"><img src="../Images/989072510f4c4da12504439487876766.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/0*LX_h0xLn7dWzsLQl.png"/></div></figure><p id="1eea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意<code class="du ls lt lu lj b">.bloop</code>、<code class="du ls lt lu lj b">.metlas</code>、<code class="du ls lt lu lj b">.vscode</code>是由 VS 代码和 Metals 扩展生成的。如果我们使用 Git 这样的版本控制系统，我们应该将这些文件夹添加到<code class="du ls lt lu lj b">.gitignore</code>中。</p><p id="57f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(样本代码也可在<a class="ae jd" href="https://github.com/shunsvineyard/scala-sample-code" rel="noopener ugc nofollow" target="_blank">https://github.com/shunsvineyard/scala-sample-code</a>获得)</p><h1 id="1d77" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">VS 代码使用</h1><p id="28cb" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">下面的小节展示了使用 VS 代码进行 Scala 开发的一些日常用例。</p><h1 id="6038" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">代码格式</h1><p id="b659" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">Metals 支持<a class="ae jd" href="https://scalameta.org/scalafmt/" rel="noopener ugc nofollow" target="_blank"> Scalafmt </a>进行代码格式化。要格式化代码，右击我们想要格式化的 Scala 文件，选择<code class="du ls lt lu lj b">Format Document</code>来格式化文件，如图所示。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/c7725a6c7528f9d744489626867a34fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ReezE4lt4MfLuz3F.png"/></div></div></figure><p id="33ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，Metals 基于项目目录根目录下的<code class="du ls lt lu lj b">.scalafmt.conf</code>文件格式化 Scala 文档。可以从金属延伸配置修改路径。参见<strong class="ih hj">配置</strong>部分更改设置。</p><h1 id="b108" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">运行并调试</h1><p id="731e" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">有两种方法可以运行和调试 Scala 代码。</p><h2 id="b291" class="ln jf hi bd jg mf mg mh jk mi mj mk jo iq ml mm js iu mn mo jw iy mp mq ka mr bi translated">1.使用代码镜头</h2><p id="dcb2" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">对于每个主要或测试类别，金属显示主要类别的代码透镜<code class="du ls lt lu lj b">run | debug</code>和测试类别的代码透镜<code class="du ls lt lu lj b">test | test debug</code>。点击<code class="du ls lt lu lj b">run</code>或<code class="du ls lt lu lj b">test</code>运行或测试 Scala 程序。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/1b52f8876bf505f77c493923a55e0043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IWYyBUolJN23XbAa.png"/></div></div></figure><h2 id="2f55" class="ln jf hi bd jg mf mg mh jk mi mj mk jo iq ml mm js iu mn mo jw iy mp mq ka mr bi translated">2.使用 launch.json 配置</h2><p id="c510" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">另一种方法是为 VS 代码定义<code class="du ls lt lu lj b">launch.json</code>来运行或调试程序。</p><p id="5cff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按照图中的步骤创建<code class="du ls lt lu lj b">launch.json</code>配置文件。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/0143328236c90c99b7a6fb5add5845a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eSzHCShGuS66mzWK.png"/></div></div></figure><p id="a4c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在步骤 3 之后，VS 代码会再问几个问题。我们可以将它们全部留空，并在 JSON 文件创建后编辑<code class="du ls lt lu lj b">launch.json</code>文件。创建配置文件后，我们可以填充配置并运行或调试程序。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/f32cf2a54d74a6c038f74ed6e152e416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2CiixUSWhM4hfSq5.png"/></div></div></figure><h1 id="50de" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">配置</h1><p id="e3fe" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">除了最常见的用例、代码格式、运行和调试之外，还有许多其他事情我们可以配置 Metals 以我们想要的方式工作。</p><p id="8e3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要打开设置，按<code class="du ls lt lu lj b">[File -&gt; Preference -&gt; Settings]</code>打开设置。这些设置有三个范围:用户、远程和工作区。选择适合我们需要的。并选择<code class="du ls lt lu lj b">Extensions -&gt; Metals</code>来修改设置。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/58ac394b7491da246cd2f37ef7c39103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*seFgxbI1_NzbnQwm.png"/></div></div></figure><h1 id="c7a6" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">解决纷争</h1><p id="cd65" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">有时金属扩展可能无法正常工作。我们可以检查 Metals 的输出，以获得更多的信息来解决它，或者至少向 google 发送更好的错误消息。</p><p id="3581" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，如果我们安装的 JDK 版本不支持 JDI(这将导致调试器不工作)，当我们尝试运行调试器时，将会得到以下错误消息。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="d369" class="ln jf hi lj b fi lo lp l lq lr">Couldn't find a debug adapter descriptor for debug type 'scala' (extension might have failed to activate)</span></pre><p id="340f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不幸的是，错误消息没有给出关于这个问题的足够信息。在这种情况下，我们可以检查金属产量。见下图。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/1da1c30351470bb0376024f7c7c699b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SzyZkqbYqNfDeJxd.png"/></div></div></figure><p id="bdd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它给了我们更多关于这个问题的信息。</p><pre class="kx ky kz la fd li lj lk ll aw lm bi"><span id="0ed1" class="ln jf hi lj b fi lo lp l lq lr">Message: Debugging is not supported because bloop server is running on a JRE /usr/lib/jvm/java-8-openjdk-amd64/jre with no support for Java Debug Interface: 'JDI implementation is not provided by the vendor'. To enable debugging, install a JDK and restart the bloop server.</span></pre><p id="f622" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们知道 JDK 是问题所在，需要解决。</p><h1 id="0a3c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">sbt 命令的终端</h1><p id="2f4e" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">值得一提的一个有用的 VS 代码特性是集成终端。通过集成的终端，我们可以在 WSL 上运行 shell。对于 Scala 开发，终端提供了一种在 VS 代码中运行 sbt 命令的便捷方式。</p><p id="38c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du ls lt lu lj b">Ctrl+Shift+P</code>调出<code class="du ls lt lu lj b">Command Palette</code>并键入<code class="du ls lt lu lj b">terminal</code>。它应该显示一些终端选项。选择<code class="du ls lt lu lj b">Create New Integrated Terminal (In Active Workspace)</code>。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/0945bde2cc4527afadff0d44f89ef3bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H1ka7S_ZxSdnhCd-.png"/></div></div></figure><p id="6a08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将在项目目录中打开 WSL shell。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/9b7e716e20fc0290e1d5577297d97d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rDG9691JtSA-xjzT.png"/></div></div></figure><p id="4894" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这个功能，我们就可以不用 Windows 终端或 MobaXterm 等外部工具来使用终端了。</p><h1 id="9724" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论</h1><p id="cf1f" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">本文提供了使用 VS 代码编写 Scala 代码的基本设置和常见用例。虽然它演示了 Linux 的 Windows 子系统上的配置，但是<strong class="ih hj"> VS 代码使用</strong>部分也适用于 Windows、Linux 和 MacOS。</p><p id="fbf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">VS 代码可能不是 Scala 编程最流行的编辑器，但是有了 Metals 等强大的扩展支持，VS 代码可以成为 Scala 开发的有用工具。特别是对于使用多种语言的人来说，VS 代码可能是满足你所有需求的。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="ea51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lv">原载于 2020 年 11 月 20 日</em><a class="ae jd" href="https://shunsvineyard.info/2020/11/20/setting-up-vs-code-for-scala-development-on-wsl/" rel="noopener ugc nofollow" target="_blank"><em class="lv">https://shunsvineyard . info</em></a><em class="lv">。</em></p></div></div>    
</body>
</html>