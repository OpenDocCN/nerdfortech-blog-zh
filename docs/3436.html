<html>
<head>
<title>Showing a Progress Indicator easily in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在颤动中容易地显示进度指示器</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/showing-a-progress-indicator-easily-in-flutter-aa564eb0df5c?source=collection_archive---------7-----------------------#2021-06-10">https://medium.com/nerd-for-tech/showing-a-progress-indicator-easily-in-flutter-aa564eb0df5c?source=collection_archive---------7-----------------------#2021-06-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a2260c351c05970da4942423cce5bcf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*k7bp5v6ZkkKKm7Eb"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">迈克·范·登博斯在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2cd0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事实上，异步操作对于我们编写的几乎每个应用程序都是必要的。有时，用户必须等到操作完成才能再次与应用程序交互，这正是进度指示器的目的，向用户提供反馈，以便他们可以知道正在处理的事情。</p><p id="aa36" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">防止用户在异步操作加载时与应用程序进行交互，方法是使用对话框。在Flutter中显示对话框最简单的方法是调用函数showDialog()，它接收一个上下文和一个生成器:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="715e" class="kc kd hi jy b fi ke kf l kg kh">show(BuildContext context, {String text = 'Loading...'}) {<br/>  showDialog&lt;void&gt;(<br/>      context: context,<br/>      barrierDismissible: false,<br/>      builder: (BuildContext context) {<br/>        _context = context;<br/>        isDisplayed = true;<br/>        return WillPopScope(<br/>          onWillPop: () async =&gt; false,<br/>          child: SimpleDialog(<br/>            backgroundColor: Colors.white,<br/>            children: [<br/>              Center(<br/>                child: Column(<br/>                  mainAxisSize: MainAxisSize.min,<br/>                  children: [<br/>                    Padding(<br/>                      padding: const EdgeInsets.only(left: 16, top: 16, right: 16),<br/>                      child: CircularProgressIndicator(),<br/>                    ),<br/>                    Padding(<br/>                      padding: const EdgeInsets.all(16),<br/>                      child: Text(text),<br/>                    )<br/>                  ],<br/>                ),<br/>              )<br/>            ] ,<br/>          ),<br/>        );<br/>      }<br/>  );<br/>}</span></pre><p id="119d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上下文对于告诉flutter哪个小部件被调用为对话框是必要的，而构建器是我们为对话框定义UI的地方。我们还有参数barrierDismissible，当我们将这个参数定义为false时，我们可以防止用户通过触摸对话框外的屏幕区域来关闭对话框。但是这个参数并不阻止用户通过点击android设备中的硬件后退按钮来关闭对话框，为了避免这种情况，我们用WillPopScope包装了SimpleDialog，当调用回调onWillPop时，它返回false。</p><p id="13c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好了，我们已经定义了showDialog函数来显示进度对话框，现在我们只需要一个简单的方法来在代码中的任何地方重用它。为了实现这一点，我们将创建一个类来封装我们的函数，并且我们将使用singleton模式来避免每次我们想要调用函数时创建一个新的对象。我们的类将看起来像这样:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="2cf0" class="kc kd hi jy b fi ke kf l kg kh">import 'package:flutter/material.dart';<br/>import 'package:flutter/widgets.dart';<br/><br/>class LoadingIndicatorDialog {<br/>  static final LoadingIndicatorDialog _singleton = LoadingIndicatorDialog._internal();<br/>  late BuildContext _context;<br/>  bool isDisplayed = false;<br/><br/>  factory LoadingIndicatorDialog() {<br/>    return _singleton;<br/>  }<br/><br/>  LoadingIndicatorDialog._internal();<br/><br/>  show(BuildContext context, {String text = 'Loading...'}) {<br/>    if(isDisplayed) {<br/>      return;<br/>    }<br/>    showDialog&lt;void&gt;(<br/>        context: context,<br/>        barrierDismissible: false,<br/>        builder: (BuildContext context) {<br/>          _context = context;<br/>          isDisplayed = true;<br/>          return WillPopScope(<br/>            onWillPop: () async =&gt; false,<br/>            child: SimpleDialog(<br/>              backgroundColor: Colors.white,<br/>              children: [<br/>                Center(<br/>                  child: Column(<br/>                    mainAxisSize: MainAxisSize.min,<br/>                    children: [<br/>                      Padding(<br/>                        padding: const EdgeInsets.only(left: 16, top: 16, right: 16),<br/>                        child: CircularProgressIndicator(),<br/>                      ),<br/>                      Padding(<br/>                        padding: const EdgeInsets.all(16),<br/>                        child: Text(text),<br/>                      )<br/>                    ],<br/>                  ),<br/>                )<br/>              ] ,<br/>            ),<br/>          );<br/>        }<br/>    );<br/>  }<br/><br/>  dismiss() {<br/>    if(isDisplayed) {<br/>      Navigator.of(_context).pop();<br/>      isDisplayed = false;<br/>    }<br/>  }<br/>}</span></pre><p id="dbd9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您阅读代码，您会发现在show()方法中，我们将对话框生成器上下文的值赋给了一个类成员私有变量_context。这个变量的目的是保存调用对话框的上下文。然后，在dissolve()方法中，我们可以使用该上下文弹出()对话框。此外，我们还显示了变量is。这个变量将阻止我们显示对话框两次，并帮助我们避免试图关闭一个不存在的对话框。</p><p id="c5de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们准备在代码中的任何位置显示进度指示器，如下所示:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="3bf1" class="kc kd hi jy b fi ke kf l kg kh">LoadingIndicatorDialog().show(context);<br/>await asynchronousOperation();<br/>LoadingIndicatorDialog().dismiss();</span></pre><p id="f180" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！现在，我们可以在代码中的任何地方轻松地显示进度指示器。希望这些信息对你有所帮助。另一个故事再见。</p></div></div>    
</body>
</html>