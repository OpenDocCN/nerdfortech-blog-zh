<html>
<head>
<title>Deploying RabbitMQ on Kubernetes using RabbitMQ Cluster Operator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 RabbitMQ 集群操作器在 Kubernetes 上部署 RabbitMQ</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/deploying-rabbitmq-on-kubernetes-using-rabbitmq-cluster-operator-ef99f7a4e417?source=collection_archive---------0-----------------------#2021-03-07">https://medium.com/nerd-for-tech/deploying-rabbitmq-on-kubernetes-using-rabbitmq-cluster-operator-ef99f7a4e417?source=collection_archive---------0-----------------------#2021-03-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5e69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Kubernetes 上运行 RabbitMQ，并使用一个简单的 Golang 应用程序进行测试。</p><p id="aed8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，RabbitMQ 这个词在整个 DevOps 时代都很常见。因此，在我们开始理解什么是 RabbitMQ 之前，让我们先理解什么是消息传递代理。消息代理是一种软件，它使应用程序、服务能够相互通信并交换数据。这些消息传递代理软件的一些例子是</p><ol class=""><li id="2246" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">阿帕奇卡夫卡</li><li id="69b7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">亚马逊 MQ</li><li id="1beb" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Oracle 消息代理</li><li id="24da" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Apache 活动 MQ</li><li id="0dd8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Rabbit MQ(我们将在本文中深入探讨 Rabbit MQ)</li></ol><p id="3c17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RabbitMQ 是一个开源的消息代理。它是部署最广泛的开源消息代理。RabbitMQ 是轻量级的，易于在内部和云中部署。让我们看看 RabbitMQ 官方页面上提到的 RabbitMQ 必须提供的各种特性</p><ol class=""><li id="be56" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">支持多种消息协议，如 AMQP、STOMP、MQTT 等。</li><li id="a425" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">高可用性和高吞吐量的分布式开发。</li><li id="c44d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">支持多种工具和插件。</li><li id="c0d5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">用于管理和监控的交互式 UI 和 HTTP-API。</li><li id="88ac" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">对各种语言的丰富支持，如(Python、Java、Go、Ruby、C#等)。</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/8e7b0e172f4e8fd4ef3f1b46ff66b0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sA9_qmipC2wO5y5y"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图片来源:<a class="ae jr" href="https://www.rabbitmq.com/" rel="noopener ugc nofollow" target="_blank"> RabbitMQ </a></figcaption></figure><h1 id="256c" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">整个故事是关于什么的？(TLDR)</h1><ol class=""><li id="2cda" class="jd je hi ih b ii lc im ld iq le iu lf iy lg jc ji jj jk jl bi translated">在 Kubernetes 上安装 RabbitMQ 操作器。</li><li id="bd3d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">使用 CRD(自定义资源定义)创建一个<strong class="ih hj"> RabbitmqCluster </strong>。</li><li id="6704" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">使用舵图部署一个用 Golang 编写的简单 Hello World 应用程序。</li><li id="cc47" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">通过向队列发送消息并从客户端接收消息来测试设置。</li></ol><h1 id="077b" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">先决条件</h1><ol class=""><li id="9c2d" class="jd je hi ih b ii lc im ld iq le iu lf iy lg jc ji jj jk jl bi translated">Kubernetes 集群(可以是本地、AKS、EKS、GKE、Kind)。</li><li id="28d0" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">头盔 3 安装在你的 Kubernetes 集群中(安装指南:<a class="ae jr" href="https://helm.sh/docs/intro/install/" rel="noopener ugc nofollow" target="_blank">https://helm.sh/docs/intro/install/</a>)。</li></ol><h2 id="e1aa" class="lh kf hi bd kg li lj lk kk ll lm ln ko iq lo lp ks iu lq lr kw iy ls lt la lu bi translated">故事资源</h2><ol class=""><li id="09a3" class="jd je hi ih b ii lc im ld iq le iu lf iy lg jc ji jj jk jl bi translated">GitHub 链接:<a class="ae jr" href="https://github.com/pavan-kumar-99/medium-manifests" rel="noopener ugc nofollow" target="_blank">https://github.com/pavan-kumar-99/medium-manifests</a></li><li id="d728" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">GitHub 分支:rabbitmq</li></ol><h2 id="3899" class="lh kf hi bd kg li lj lk kk ll lm ln ko iq lo lp ks iu lq lr kw iy ls lt la lu bi translated">在 Kubernetes 上安装 RabbitMQ 操作符</h2><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="9aa1" class="lh kf hi lw b fi ma mb l mc md"><strong class="lw hj">###Install the RabbitMQ operator </strong><br/>kubectl apply -f <a class="ae jr" href="https://github.com/rabbitmq/cluster-operator/releases/latest/download/cluster-operator.yml" rel="noopener ugc nofollow" target="_blank">https://github.com/rabbitmq/cluster-operator/releases/latest/download/cluster-operator.yml</a></span><span id="2d81" class="lh kf hi lw b fi me mb l mc md"><strong class="lw hj">###Check if the components are healthy in the rabbitmq-system namespace</strong></span><span id="f52f" class="lh kf hi lw b fi me mb l mc md">kubectl get all -o wide -n rabbitmq-system</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mf"><img src="../Images/ae0895da57c600f75f5d434d09c7d851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mz-GaIBp5aUl95i-MKQBwA.png"/></div></div></figure><p id="8b78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦 rabbitmq-cluster-operator 运行良好，并且创建了所有相关的组件，现在让我们继续在我们的 Kubernetes 中安装 rabbitmq 集群。现在让我们为清单克隆我的回购协议。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="62ff" class="lh kf hi lw b fi ma mb l mc md">$ git clone <a class="ae jr" href="https://github.com/pavan-kumar-99/medium-manifests.git" rel="noopener ugc nofollow" target="_blank">https://github.com/pavan-kumar-99/medium-manifests.git</a> <br/>-b rabbitmq </span><span id="1f76" class="lh kf hi lw b fi me mb l mc md">$ cd medium-manifests/ </span><span id="1040" class="lh kf hi lw b fi me mb l mc md">$ kubectl apply -f rabbitmqcluster.yaml </span></pre><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="9f2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们更多地了解一下我们用来创建 RabbitmqCluster 的清单文件。</p><ol class=""><li id="4852" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">kind: RabbitmqCluster(由 RabbitMQ 集群操作器安装的 CRD。)</li><li id="1f01" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">metadata . name:rabbit MQ cluster 的名称。</li><li id="55ac" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">spec.replicas:创建 RabbitMQ 集群的 RabbitMQ 副本的数量。</li><li id="1c56" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">resources . requests/resources . limits:<a class="ae jr" href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/" rel="noopener ugc nofollow" target="_blank">https://kubernetes . io/docs/concepts/configuration/manage-resources-containers/</a></li><li id="9ca2" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">rabbit MQ . additional config:rabbit MQ 集群的附加配置。(参考:https://www.rabbitmq.com/configure.html#config-file<a class="ae jr" href="https://www.rabbitmq.com/configure.html#config-file" rel="noopener ugc nofollow" target="_blank"/>)</li><li id="3a57" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">service.type:用于公开 RabbitMQ 集群的 Kubernetes 服务类型。(这里我们使用 LoadBalancer 类型)。</li></ol><p id="a531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们检查一下 RabbitmqCluster 的状态。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="70fc" class="lh kf hi lw b fi ma mb l mc md">$ kubectl describe RabbitmqCluster production-rabbitmqcluster </span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mm"><img src="../Images/9ef8832794ee75f64adf8e88832ba46f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9mcpqsL9_m0_mKn0w2tqCg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">RabbitMQ 集群的状态</figcaption></figure><p id="de6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在上面的 RabbitMQ 集群清单中，我们已经将默认用户名和密码指定为 guest/guest。然而，RabbiMQ 集群操作符也为我们创建了一个 Kubernetes 秘密，这样也可以从那里提取用户名和密码。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="cbbd" class="lh kf hi lw b fi ma mb l mc md"><strong class="lw hj">###Username</strong></span><span id="9d53" class="lh kf hi lw b fi me mb l mc md">$ kubectl get secret production-rabbitmqcluster-default-user -o jsonpath='{.data.username}' | base64 --decode</span><span id="05c6" class="lh kf hi lw b fi me mb l mc md"><strong class="lw hj">###Password</strong></span><span id="a5a8" class="lh kf hi lw b fi me mb l mc md">$ kubectl get secret production-rabbitmqcluster-default-user -o jsonpath='{.data.password}' | base64 --decode</span></pre><p id="5a1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们探索由 RabbitMqCluster 创建的资源</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="2589" class="lh kf hi lw b fi ma mb l mc md">$ kubectl get all -l app.kubernetes.io/part-of=rabbitmq</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mn"><img src="../Images/4d783eaed533c84c1912b0082735906c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3Atb7GLCKbOd-PIq8JSug.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">Rabbitmq 资源</figcaption></figure><p id="4f3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您现在应该看到一个有状态集(RabbitMQ 总是使用有状态集来创建集群)、一个 headless 服务(用于集群节点发现)和一个 Kubernetes 负载平衡器(用于访问 RabbitMQ WebUI)。</p><h2 id="8f03" class="lh kf hi bd kg li lj lk kk ll lm ln ko iq lo lp ks iu lq lr kw iy ls lt la lu bi translated">复制/集群管理</h2><p id="23e3" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq mo is it iu mp iw ix iy mq ja jb jc hb bi translated">现在我们已经看到了 RabbitMQ 创建的所有组件，让我们了解 RabbitMQ 集群的一些重要方面。让我们使用检查集群的状态(您可以进入任何有状态的 set pod)</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="ecd0" class="lh kf hi lw b fi ma mb l mc md">$ kubectl exec production-rabbitmqcluster-server-0 -- /bin/sh -c "rabbitmqctl cluster_status --formatter json" | jq</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mr"><img src="../Images/4a8d2d4aa4ae9e302992c7f6db84e1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcsoXn47AvVGZ9HTol2jLw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">RabbitMQ 集群状态</figcaption></figure><p id="d43a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们检查集群中的节点。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="8152" class="lh kf hi lw b fi ma mb l mc md">$ kubectl exec production-rabbitmqcluster-server-0 -- /bin/sh -c "rabbitmqctl cluster_status --formatter json" | jq -r .running_nodes</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es ms"><img src="../Images/c3ec3e1219807a4bbac23803bd1f08dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7e_YVtVU2ASq9bhO0UVaw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">集群节点</figcaption></figure><p id="e75f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，够了黑绿色终端。现在让我们转向一些丰富多彩的东西。RabbitMQ 在端口 15672 公开了一个集群管理 Web UI。让我们通过以下方式获得负载平衡器的 IP 地址</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="52e9" class="lh kf hi lw b fi ma mb l mc md">$ kubectl get svc production-rabbitmqcluster -o jsonpath='{.status.loadBalancer.ingress[0].ip}'</span><span id="3a0f" class="lh kf hi lw b fi me mb l mc md">192.168.29.166 ( Since I am using a local cluster my LoadBalancer Ip start with 192* ) </span><span id="cb0c" class="lh kf hi lw b fi me mb l mc md"><strong class="lw hj">###Let us access the WEBUI from </strong><a class="ae jr" href="http://192.168.29.166:15672" rel="noopener ugc nofollow" target="_blank"><strong class="lw hj">http://192.168.29.166:15672</strong></a><strong class="lw hj"> and login using guest/guest. </strong></span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mt"><img src="../Images/f7f799dcabefc63d98f66a228e32b6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eQqv-J8wNS6JSZeMcOAww.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">RabbitMQ Web 用户界面</figcaption></figure><h2 id="25d2" class="lh kf hi bd kg li lj lk kk ll lm ln ko iq lo lp ks iu lq lr kw iy ls lt la lu bi translated">在 Golang 中部署一个简单的 Hello World 应用程序。</h2><p id="cbb7" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq mo is it iu mp iw ix iy mq ja jb jc hb bi translated">为了测试这个设置，我编写了一个简单的 Golang 应用程序，对它进行了 DockerHub 化，并将图像推送到我的<a class="ae jr" href="https://hub.docker.com/repository/docker/greypavan/medium-manifests" rel="noopener ugc nofollow" target="_blank"> DockerHub 注册表中。</a></p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mu"><img src="../Images/5531e17f1f91b7ba02d608613030297c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LiR6jgP-GaOj4iC6ZhKmEg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">码头枢纽</figcaption></figure><p id="8551" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能想知道为什么图像的尺寸这么小。我已经通过在 Docker 中使用<a class="ae jr" href="https://docs.docker.com/develop/develop-images/multistage-build/" rel="noopener ugc nofollow" target="_blank">多阶段构建</a>减小了尺寸。这个设置的所有代码和 Docker 文件都已经在 GitHub repo 中。现在，让我们从部署 send microservice helm 图表开始(这将为我们创建一个 WebUI 来发布消息)。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="11fd" class="lh kf hi lw b fi ma mb l mc md">$ git clone <a class="ae jr" href="https://github.com/pavan-kumar-99/medium-manifests.git" rel="noopener ugc nofollow" target="_blank">https://github.com/pavan-kumar-99/medium-manifests.git</a> <br/>-b rabbitmq</span><span id="463d" class="lh kf hi lw b fi me mb l mc md">$ cd medium-manifests/</span><span id="fcdc" class="lh kf hi lw b fi me mb l mc md">$ helm install send-service rabbitmq-helm/send-service --set configmap.rmq_url="amqp://guest:guest@192.168.29.165:5672/"<br/></span></pre><p id="8940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在您已经安装了 send-service，您应该找到部署、服务(类型:LoadBalancer)和一个水平 Pod Autoscaler，并且创建了 RabbitMQ URL 的 configmap 并将其作为环境变量挂载到 Pod。现在让我们导航到端口 8080 的发送服务 WEB UI。请忽略我真的很烂的 HTML 技能。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="cdd5" class="lh kf hi lw b fi ma mb l mc md">$ kubectl get svc send-service-rabbitmq-helm -o jsonpath='{.status.loadBalancer.ingress[0].ip}'</span><span id="3bf7" class="lh kf hi lw b fi me mb l mc md">192.168.29.166 </span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mv"><img src="../Images/e25ded60a5e7a77134cd8aeedce08bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQUIeFt9sNfV81xAqHhXcg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">发送服务 Web 用户界面</figcaption></figure><p id="0bf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在消息部分键入一条消息，看看会发生什么。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mw"><img src="../Images/500ce5bf1c54dd95ceb60dd19b656849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4aJB5KxZT33Ih8ZTcIasxg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">发送服务日志</figcaption></figure><p id="5790" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我一发送消息，我的发送服务就成功地将消息发送到 RabbitMQ 队列。让我们从 RabbiMQ UI 验证同样的情况。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mx"><img src="../Images/28c51f3485360ff74710f2bff3c52a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxLJbH4oE3B8TZT4glNG_Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">来自用户界面的消息</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es my"><img src="../Images/34256d23995ea5624086b3936a99ac70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvfYL2ju_TGp-VjcJRtjNA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">从 RabbitMQ 控制台可以看到该消息</figcaption></figure><p id="b7d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们安装接收服务微服务，它将接收来自 RabbitMQ 服务器的消息。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="d2da" class="lh kf hi lw b fi ma mb l mc md">$ git clone <a class="ae jr" href="https://github.com/pavan-kumar-99/medium-manifests.git" rel="noopener ugc nofollow" target="_blank">https://github.com/pavan-kumar-99/medium-manifests.git</a> <br/>-b rabbitmq</span><span id="6114" class="lh kf hi lw b fi me mb l mc md">$ cd medium-manifests/</span><span id="74fd" class="lh kf hi lw b fi me mb l mc md">$ helm install receive-service rabbitmq-helm/receive-service --set configmap.rmq_url="amqp://guest:guest@192.168.29.165:5672/"</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mz"><img src="../Images/ebb17ed9065ee9fa5816270fc24c0cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHITgN6O2sIHGcX672ZWyw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">接收器服务日志</figcaption></figure><p id="46db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您应该看到接收微服务正在读取消息。</p><p id="f648" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，现在让我们发送一些批量请求，看看我们的微服务是否按预期工作。</p><pre class="jt ju jv jw fd lv lw lx ly aw lz bi"><span id="b3b5" class="lh kf hi lw b fi ma mb l mc md">$ git clone <a class="ae jr" href="https://github.com/pavan-kumar-99/medium-manifests.git" rel="noopener ugc nofollow" target="_blank">https://github.com/pavan-kumar-99/medium-manifests.git</a> <br/>-b rabbitmq</span><span id="75ee" class="lh kf hi lw b fi me mb l mc md">$ cd medium-manifests/</span><span id="eb9c" class="lh kf hi lw b fi me mb l mc md">$ sh test_rmq.sh ( This will send 10 curl requests with the iterator as the message ). </span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es na"><img src="../Images/0cba2c030b4401ddd8e272bf3dfa6721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9e5_mitMD2MIcrBm5KyK3w.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">发送服务日志</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es nb"><img src="../Images/cd554a43a539eb75aa5d92c74ff4b1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WW_svPQ8T4h8uLV3ykcu7Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">接收服务日志</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es nc"><img src="../Images/d6bfdf3dc604a8a7fb44723e897465db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/0*Itu5ChQSfvTE4Xrm.gif"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">最终部署...</figcaption></figure><p id="2230" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个非常基本的场景。RabbitMQ 支持许多其他场景，如复杂的工作队列、选择性路由、发布/订阅等。可能还有许多其他复杂的用例及场景。请随意在评论区发表它们。</p><p id="894f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">直到下次……</p><h1 id="de6c" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">结论</h1><p id="fbe3" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq mo is it iu mp iw ix iy mq ja jb jc hb bi translated">感谢阅读我的文章。希望你喜欢它。以下是我的一些其他文章，你可能会感兴趣。</p><h1 id="34aa" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">被推荐的</h1><div class="nd ne ez fb nf ng"><a rel="noopener follow" target="_blank" href="/swlh/introduction-to-jenkins-operator-f4cb7ebc2e0b"><div class="nh ab dw"><div class="ni ab nj cl cj nk"><h2 class="bd hj fi z dy nl ea eb nm ed ef hh bi translated">詹金斯算子简介</h2><div class="nn l"><h3 class="bd b fi z dy nl ea eb nm ed ef dx translated">Kubernetes 中的 Jenkins 运算符入门</h3></div><div class="no l"><p class="bd b fp z dy nl ea eb nm ed ef dx translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu jy ng"/></div></div></a></div><div class="nd ne ez fb nf ng"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/introduction-to-crossplane-2f873ae0f9f3"><div class="nh ab dw"><div class="ni ab nj cl cj nk"><h2 class="bd hj fi z dy nl ea eb nm ed ef hh bi translated">交叉平面简介</h2><div class="nn l"><h3 class="bd b fi z dy nl ea eb nm ed ef dx translated">如何使用 Kubernetes 清单和 Crossplane 在云上创建任何资源。</h3></div><div class="no l"><p class="bd b fp z dy nl ea eb nm ed ef dx translated">medium.com</p></div></div><div class="np l"><div class="nv l nr ns nt np nu jy ng"/></div></div></a></div><div class="nd ne ez fb nf ng"><a rel="noopener follow" target="_blank" href="/faun/introduction-to-bitnami-sealed-secrets-bb5ae74d9a25"><div class="nh ab dw"><div class="ni ab nj cl cj nk"><h2 class="bd hj fi z dy nl ea eb nm ed ef hh bi translated">比特纳米密封秘密介绍</h2><div class="nn l"><h3 class="bd b fi z dy nl ea eb nm ed ef dx translated">如何使用 Sealed Secrets 和 Kubese 在 GitHub 中存储您的秘密</h3></div><div class="no l"><p class="bd b fp z dy nl ea eb nm ed ef dx translated">medium.com</p></div></div><div class="np l"><div class="nw l nr ns nt np nu jy ng"/></div></div></a></div><div class="nd ne ez fb nf ng"><a rel="noopener follow" target="_blank" href="/faun/introduction-to-external-dns-in-kubernetes-654aa4cf38e6"><div class="nh ab dw"><div class="ni ab nj cl cj nk"><h2 class="bd hj fi z dy nl ea eb nm ed ef hh bi translated">Kubernetes 中的外部 DNS 简介</h2><div class="nn l"><h3 class="bd b fi z dy nl ea eb nm ed ef dx translated">如何使用外部 DNS 在 Kubernetes 中自动创建 DNS 记录</h3></div><div class="no l"><p class="bd b fp z dy nl ea eb nm ed ef dx translated">medium.com</p></div></div><div class="np l"><div class="nx l nr ns nt np nu jy ng"/></div></div></a></div><h1 id="5918" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">参考</h1><div class="nd ne ez fb nf ng"><a href="https://www.rabbitmq.com/kubernetes/operator/operator-overview.html" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab dw"><div class="ni ab nj cl cj nk"><h2 class="bd hj fi z dy nl ea eb nm ed ef hh bi translated">Kubernetes 的 RabbitMQ 集群运算符</h2><div class="nn l"><h3 class="bd b fi z dy nl ea eb nm ed ef dx translated">rabbit MQ Cluster Kubernetes Operator 是一个 Kubernetes 操作员，它可以自动进行配置、管理和操作…</h3></div><div class="no l"><p class="bd b fp z dy nl ea eb nm ed ef dx translated">www.rabbitmq.com</p></div></div></div></a></div></div></div>    
</body>
</html>