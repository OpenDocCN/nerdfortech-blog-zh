<html>
<head>
<title>Ionic React: Implementing Custom Page Transition Animation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ionic React:实现自定义页面过渡动画</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/ionic-react-implementing-custom-page-transition-animation-48aa3086e9da?source=collection_archive---------6-----------------------#2021-06-01">https://medium.com/nerd-for-tech/ionic-react-implementing-custom-page-transition-animation-48aa3086e9da?source=collection_archive---------6-----------------------#2021-06-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="24ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">老实说，Ionic 中的默认页面转换工作得很好，但有时您的项目需要自定义页面转换——这在 Ionic 文档中没有很好地记录。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f5a7d48dd740336c0889f43e1d21fb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p31kRT5WTVHtUDBgYWaDlg.png"/></div></div></figure><h1 id="e911" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">先决条件</h1><p id="21b6" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">首先确保您使用的是 Ionic React 和 Ionic React 路由器的版本 5.6.0 或更高版本，因为早期版本不支持自定义页面转换。</p><pre class="je jf jg jh fd ks kt ku kv aw kw bi"><span id="9227" class="kx jq hi kt b fi ky kz l la lb">npm install <a class="ae lc" href="http://twitter.com/ionic/react" rel="noopener ugc nofollow" target="_blank">@ionic/react</a>@^5.6.0<br/>npm install <a class="ae lc" href="http://twitter.com/ionic/react-router" rel="noopener ugc nofollow" target="_blank">@ionic/react-router</a>@^5.6.0</span></pre><h1 id="0f6f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是 AnimationBuilder？</h1><p id="42e0" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">AnimationBuilder 本质上是一个函数，它接受一个基本元素和 options 对象，为给定的输入计算正确的动画，并返回一个 Ionic 动画元素。</p><p id="2377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Ionic 文档中，它被模糊地定义为:<code class="du ld le lf kt b">(baseEl: any, opts?: any) =&gt; Animation</code>。所以我们来深究一下。</p><p id="8198" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">巴塞尔</strong></p><p id="813b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个输入，<code class="du ld le lf kt b">baseEl</code>，指的是 AnimationBuilder 附加到的元素。在我们的例子中，它将是<code class="du ld le lf kt b">IonRouterOutlet</code>，因为我们覆盖了默认的页面转换动画，但是你也可以覆盖很多不同组件上的动画，比如 IonModal、IonAlert、IonPopover 等等。</p><p id="5f94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> opts </strong></p><p id="71c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个输入，<code class="du ld le lf kt b">opts</code>，options 的缩写，保存 Ionic 框架提供的选项，以便正确地计算动画。例如，如果用户向前导航，框架将包括<code class="du ld le lf kt b">direction: "forward"</code>或者<code class="du ld le lf kt b">direction: "back"</code>，如果用户向后导航到上一页。这允许您相应地调整动画。</p><p id="5d23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里列出了在<code class="du ld le lf kt b">IonRouterOutlet</code>上覆盖动画时，选项对象中最重要的属性。</p><ul class=""><li id="a047" class="lg lh hi ih b ii ij im in iq li iu lj iy lk jc ll lm ln lo bi translated"><code class="du ld le lf kt b">animated: boolean</code> —指定是否应该制作过渡动画</li><li id="9f46" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated"><code class="du ld le lf kt b">direction: "forward" | "back"</code> —指定导航方向</li><li id="1f41" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated"><code class="du ld le lf kt b">enteringEl: Element</code> —指输入元素，通常为<code class="du ld le lf kt b">IonPage</code></li><li id="7610" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated"><code class="du ld le lf kt b">leavingEl: Element</code> —指离开元素，通常为<code class="du ld le lf kt b">IonPage</code></li><li id="2f11" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated"><code class="du ld le lf kt b">mode: "ios" | "md"</code></li></ul><h1 id="3d36" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">创建动画生成器</h1><p id="ba74" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">覆盖页面过渡动画的第一步是创建自己的 AnimationBuilder，它将取代当前动画。</p><p id="06d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个简单的 AnimationBuilder 的例子，它只返回一个空的动画。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="0804" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们修改这个动画来创建一个渐变页面过渡。</p><p id="8ae1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要通过调用动画对象上的<code class="du ld le lf kt b">.addElement(opts.enteringEl)</code>来附加进入元素。</p><p id="6b5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们需要设置渐变效果:<code class="du ld le lf kt b">.fromTo('opacity', 0, 1)</code></p><p id="0987" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后我们设置持续时间:<code class="du ld le lf kt b">.duration(250)</code></p><p id="cc74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重复上述步骤，只需将<code class="du ld le lf kt b">opts.enteringEl</code>替换为<code class="du ld le lf kt b">opts.leavingEl</code>，并切换<code class="du ld le lf kt b">fromTo</code>值，使其从 1 渐变为 0。</p><p id="45e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们希望应用这两个动画，以便进入的元素淡入，离开的元素淡出。我们可以通过创建另一个空动画并调用<code class="du ld le lf kt b">.addAnimation()</code>方法来实现。</p><p id="dcc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该会得到这样的结果:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="c924" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多高级动画请参考<a class="ae lc" href="https://ionicframework.com/docs/utilities/animations" rel="noopener ugc nofollow" target="_blank">离子文档</a>。</p><h1 id="4276" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">在应用程序级别覆盖</h1><p id="8ecd" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">现在我们已经准备好了 AnimationBuilder，是时候覆盖页面转换动画了。要在应用程序层面做到这一点，找到你的<code class="du ld le lf kt b">IonRouterOutle</code>(通常在<code class="du ld le lf kt b">App.tsx</code>)并将动画生成器传递给<code class="du ld le lf kt b">IonRouterOutlet</code>的<code class="du ld le lf kt b">animation</code>道具。</p><pre class="je jf jg jh fd ks kt ku kv aw kw bi"><span id="df5f" class="kx jq hi kt b fi ky kz l la lb">&lt;IonRouterOutlet animation={animationBuilder}&gt;<br/>  &lt;Route path="/" component={Home} /&gt;<br/>  ...<br/>&lt;/IonRouterOutlet&gt;</span></pre><h1 id="ef5e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">在路线级别覆盖</h1><p id="17bf" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">您也可以仅在过渡到特定页面或从特定页面过渡时覆盖页面过渡动画。可以通过将 AnimationBuilder 传递给<code class="du ld le lf kt b">IonRouterLink</code>元素的<code class="du ld le lf kt b">routerAnimation</code>属性来实现。</p><pre class="je jf jg jh fd ks kt ku kv aw kw bi"><span id="4b61" class="kx jq hi kt b fi ky kz l la lb">&lt;IonRouterLink<br/>  routerLink="/contact-us"<br/>  routerAnimation={animationBuilder}<br/>&gt;<br/>  Contact Us<br/>&lt;/IonRouterLink&gt;</span></pre><h1 id="395f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">覆盖其他组件上的动画</h1><p id="5b9e" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">现在您已经知道如何创建动画生成器，您也可以覆盖其他组件上的动画。比如:IonModal、IonAlert、IonPopover 等。请记住，在 AnimationBuilder 中传递给<code class="du ld le lf kt b">opts</code>对象的属性可能不同。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><h1 id="b7a2" class="jp jq hi bd jr js md ju jv jw me jy jz ka mf kc kd ke mg kg kh ki mh kk kl km bi translated">想和我去喝杯咖啡吗？</h1><p id="6e09" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">这篇文章把你从一整天的谷歌搜索中解救出来了吗？厉害！你可以在这里给我买杯咖啡:<a class="ae lc" href="https://www.buymeacoffee.com/goranlisak" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/goranlisak</a></p><p id="ef74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还需要帮助吗？你可以在这里和我预约会面:<a class="ae lc" href="https://www.buymeacoffee.com/goranlisak/extras" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/goranlisak/extras</a></p></div></div>    
</body>
</html>