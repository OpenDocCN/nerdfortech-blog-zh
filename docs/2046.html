<html>
<head>
<title>Tutorial: create api with authentication using loopback IBM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:使用回送 IBM 创建带身份验证的 api</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/tutorial-create-api-with-authentication-using-loopback-ibm-5fb8d396cb6b?source=collection_archive---------14-----------------------#2021-04-18">https://medium.com/nerd-for-tech/tutorial-create-api-with-authentication-using-loopback-ibm-5fb8d396cb6b?source=collection_archive---------14-----------------------#2021-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dcaff3fd197204022d2603663f4bea47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LFIY43hsxqAadgDm0q0OPA.jpeg"/></div></div></figure><p id="8a48" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一步是复制我们以前的项目或创建一个新的项目，你可以访问我以前的教程<a class="ae jo" rel="noopener" href="/nerd-for-tech/tutorial-create-api-with-loopback-ibm-ef06234f8635">这里</a>。</p><p id="257a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从打开 Noddejs 命令提示符开始，键入以下命令:</p><blockquote class="jp jq jr"><p id="e0e4" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated"><code class="du jw jx jy jz b">lb4 example todo</code></p><p id="66b4" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated"><code class="du jw jx jy jz b">cd loopback4-example-todo</code></p></blockquote><p id="8840" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并安装身份验证扩展:</p><blockquote class="jp jq jr"><p id="2aa2" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated"><code class="du jw jx jy jz b">npm i --save @loopback/authentication @loopback/authentication-jwt</code></p></blockquote><p id="74aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装完成后，进入我们项目的<strong class="is hj">根</strong>文件夹，打开<strong class="is hj"> src </strong>文件夹，用 notepad++打开<strong class="is hj"> application.ts </strong>文件。</p><p id="c163" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意这一步，文件必须有下面的代码，修改它，使它看起来像这样:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/46cee503852eef2bd3842790029f60b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yp69wHS0rp1guEsbQFB5pA.png"/></div></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/4dff4e0ff6427cf20c2bbd5d682a5a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*5khRpDMmGV2fSn4UK6QcrQ.png"/></div></figure><p id="5573" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是创建一个控制器，在 nodejs 提示符下输入命令:</p><blockquote class="jp jq jr"><p id="2be2" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated">lb4 控制器</p></blockquote><p id="1169" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">控制器的名称是:</p><blockquote class="jp jq jr"><p id="71a5" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated">用户</p></blockquote><p id="73b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后选择选项:</p><blockquote class="jp jq jr"><p id="b306" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated">空控制器</p></blockquote><p id="759a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是向 UserController 添加端点。</p><p id="b385" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到我们项目的<strong class="is hj">根</strong>文件夹，打开<strong class="is hj"> src </strong>文件夹、<strong class="is hj">控制器</strong>文件夹，打开文件<strong class="is hj"> user.controller.ts </strong>，编辑成这样:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/eea8eab49e6011d6dc388bc018551514.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*elVDeEqL1wyTmBAA8wP-8w.png"/></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/94279bc9a341422e7610b41a555401e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*dgOuS1JCHrd00P0NScctqg.png"/></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/08017e7cf0a946bb7df0fb0c2f37f378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*qk0my4O8L98i2nrvFxZXRA.png"/></div></figure><p id="b40d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是保护我们的 api，打开 src 文件夹和 controllers 文件夹，编辑 todo.controller.ts，如下所示:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/38f267748e54d0a421c926483432ed53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKmbWbYP8_da281XchKxAQ.png"/></div></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/ec6aeee4f4d9ac41d885995131cff8de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZSXkpaXQexAgLMuGP7GIxA.png"/></div></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kl"><img src="../Images/448e6de16984944d5e5a45aebb4853b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKipHnvbz9bfm_FNbyUl8A.png"/></div></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/3e2a312d729af57ffc2cf444ed04372e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f9kf7MKjAz3CoW7vg5VzvA.png"/></div></div></figure><p id="62ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，去测试我们的 API:</p><p id="d360" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在 nodejs 提示符下键入:</p><blockquote class="jp jq jr"><p id="eaa1" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated">npm 开始</p></blockquote><p id="7e65" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以及前往:</p><p id="2640" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="http://localhost:3000/explorer." rel="noopener ugc nofollow" target="_blank">http://localhost:3000/explorer。</a></p><p id="93c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们用户控制器的输出应该是这样的:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/1d496433f58d7f7b059b069c9ce143de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*-_Vqv_-OQlVMz6bZ5mKunA.png"/></div></figure><p id="20de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要测试 POST/signup，请使用以下命令并检查其是否有效:</p><pre class="kb kc kd ke fd ko jz kp kq aw kr bi"><span id="4433" class="ks kt hi jz b fi ku kv l kw kx">{<br/>  "email": "testuser2@abc.com",<br/>  "password": "testuser2"<br/>}</span></pre><p id="0346" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要测试我们的 POST/users/login，请复制以下令牌并转到 API Explorer 的顶部，单击“Authorize”按钮。</p><pre class="kb kc kd ke fd ko jz kp kq aw kr bi"><span id="24f2" class="ks kt hi jz b fi ku kv l kw kx">{<br/>  "token": "aaaaaaaaa.aaaaaaaaaaaaaaaaa"<br/>}</span></pre><p id="56fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将您之前复制的令牌粘贴到“值”字段，然后单击授权。</p></div></div>    
</body>
</html>