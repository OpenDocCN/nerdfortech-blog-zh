<html>
<head>
<title>Understanding CAP theorem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解CAP定理</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/understand-cap-theorem-751f0672890e?source=collection_archive---------4-----------------------#2021-02-24">https://medium.com/nerd-for-tech/understand-cap-theorem-751f0672890e?source=collection_archive---------4-----------------------#2021-02-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c6da86efc19295cc612fe9da5fa7a672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Br1FrvKnK3hU6Xl_LbDkwg.png"/></div></div></figure><h1 id="3d96" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是CAP定理？</h1><p id="43b2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">CAP有时表现为一致性、可用性、分区容差三选二。</p><p id="0526" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">不幸的是，这样说是有误导性的，因为网络分区是一种错误，所以它们不是你可以选择的事情:不管你喜欢与否，它们都会发生。当网络正常工作时，系统可以提供一致性和可用性。</p><p id="bd39" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">当网络出现故障时，您必须在一致性或总体可用性之间做出选择。因此，描述CAP的更好的方法是在分区时保持一致或可用。</p><h1 id="7082" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">CAP定理中的‘CAP’是什么？</h1><p id="4171" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">CAP定理是指分布式系统中的三个特征</p><h2 id="a679" class="kr ir hi bd is ks kt ku iw kv kw kx ja jz ky kz je kd la lb ji kh lc ld jm le bi translated">一致性</h2><p id="df78" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">一致性意味着所有客户端同时看到相同的数据，无论它们连接到哪个节点。为此，每当数据写入一个节点时，都必须立即转发或复制到系统中的所有其他节点，才能认为写入“成功”</p><h2 id="450e" class="kr ir hi bd is ks kt ku iw kv kw kx ja jz ky kz je kd la lb ji kh lc ld jm le bi translated">有效性</h2><p id="a726" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">可用性是指系统在给定时间运行的概率。设备实际运行的时间占总运行时间的百分比。高可用性系统可能以每年停机时间的分钟数或小时数来报告可用性。可用性功能使系统即使在发生故障时也能保持运行。</p><h2 id="7437" class="kr ir hi bd is ks kt ku iw kv kw kx ja jz ky kz je kd la lb ji kh lc ld jm le bi translated">分区容差</h2><p id="d029" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">系统的两个节点(<em class="lf">分区</em>)在其网络出现临时通信故障时继续运行的能力。随着分区容忍度的提高，数据库对客户端来说更加可用，但是可访问的数据不太一致，反之亦然</p><h1 id="f2e8" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">理解CAP定理的真实例子</h1><p id="7983" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我们考虑一家有两只股票和一个报价的公司。公司股票可以支撑</p><p id="f294" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">三种不同的操作:</p><ol class=""><li id="f66e" class="lg lh hi jq b jr km jv kn jz li kd lj kh lk kl ll lm ln lo bi translated">下订单</li><li id="993e" class="lg lh hi jq b jr lp jv lq jz lr kd ls kh lt kl ll lm ln lo bi translated">检查产品总可用数量</li></ol><p id="720e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在这位员工走向一只股票。如果一切正常，那么这个系统就相对简单。如果员工销售了一些产品，公司需要更新系统上的数量，然后完成跟踪。这涉及到对产品数量的一致看法，因为它在每个库存系统中都是相同的。作为一名雇员，他喜欢用他想要的任何操作来操作系统，也喜欢在他想要的任何时候操作系统。股票系统需要对他可用。我们将考虑下面的负面情景。</p><h1 id="65b2" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">一致性设计的股票</h1><p id="5fd3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">如果股票选择了一致的设计，那么分行将通知:<strong class="jq hj">我现在不能接受卖出，因为我不能更新另一只股票的数量。</strong>这可能会很烦人，因为你会让顾客等着检查总量是否足够他们的订单</p><h1 id="6a4e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">库存与可用性设计</h1><p id="2dd0" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在可用性设计中，当你走到股票前说，我不能和另一个股票系统说话。但是我会允许你下订单，并会跟踪发生了什么，然后当分区愈合与其他股票，帐户数量将在另一个股票更新。因此，通过这种设计，即使库存在产品数量的存储上不一致，它也更加可用。简而言之，当你设计系统的可用性时，这就是上限定理。</p><h1 id="00da" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">具有一定一致性和可用性的库存设计</h1><p id="12ae" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在现实世界中，我们还可以考虑一致性程度和可用性程度。还有，做取舍。</p><p id="d290" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">例如，当一个分区发生时，我们可以有股票:</p><ul class=""><li id="c534" class="lg lh hi jq b jr km jv kn jz li kd lj kh lk kl lu lm ln lo bi translated">接受部分订单</li><li id="179e" class="lg lh hi jq b jr lp jv lq jz lr kd ls kh lt kl lu lm ln lo bi translated">不提供全面的服务。</li></ul><p id="ff82" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">股票也可以提供有关数量的信息，但只能提供暂定的数量信息。这意味着，我们不确定这是否是正确的数量，但如果你没有在股票之间跑，它可能是正确的。</p><p id="57c6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">简而言之，股票决定赚钱。为了让员工获得更高的可用性，您希望为您的系统增加多少复杂性？因为一致的设计往往更容易构建和理解。复杂的可用性设计会带来冲突，变得更加难以解决，甚至无法解决。</p><h1 id="942b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">CAP定理如何影响数据库决策？</h1><p id="ab4e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">尽管CAP定理可能感觉很抽象，但它有实际的、真实的后果。从技术和商业的角度来看，这种权衡将引导您思考一些非常重要的问题。没有正确的答案。最终，它将与数据库的运行环境、业务需求以及用户的期望和需求息息相关。</p><p id="c297" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">你将不得不考虑这样的事情:</p><ul class=""><li id="1c64" class="lg lh hi jq b jr km jv kn jz li kd lj kh lk kl lu lm ln lo bi translated">避免在客户端抛出错误很重要吗？</li><li id="1a3d" class="lg lh hi jq b jr lp jv lq jz lr kd ls kh lt kl lu lm ln lo bi translated">还是我们愿意牺牲可见的用户体验来保证一致性？</li><li id="58d5" class="lg lh hi jq b jr lp jv lq jz lr kd ls kh lt kl lu lm ln lo bi translated">一致性是用户体验中真正重要的一部分吗</li><li id="3c74" class="lg lh hi jq b jr lp jv lq jz lr kd ls kh lt kl lu lm ln lo bi translated">或者，我们真的可以用关系数据库做我们想做的事情，并且完全避免分区容错的需要吗？</li></ul><p id="09d7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如你所见，这些最终都是用户体验问题。为了正确理解这些，您需要对项目的总体目标保持敏感，并且如上所述，对数据库解决方案运行的环境保持敏感。(它是否为内部分析仪表板提供动力？还是支持广泛使用的面向外部的网站或应用程序？)</p><h1 id="8ab6" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">参考</h1><p id="bbe9" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">B <a class="ae lv" href="http://dl.acm.org/citation.cfm?id=564601" rel="noopener ugc nofollow" target="_blank"> rewer的猜想和一致的、可用的、分区容忍的web服务的可行性</a></p><p id="f994" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">CAP <a class="ae lv" href="https://www.infoq.com/articles/cap-twelve-years-later-how-the-rules-have-changed" rel="noopener ugc nofollow" target="_blank">十二年后:规则如何改变</a></p><p id="735b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">请停止调用数据库cp或ap </p></div></div>    
</body>
</html>