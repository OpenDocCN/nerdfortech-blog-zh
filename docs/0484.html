<html>
<head>
<title>Windows functions in SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL中的Windows函数</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/windows-functions-in-sql-9bf03127d867?source=collection_archive---------2-----------------------#2020-12-28">https://medium.com/nerd-for-tech/windows-functions-in-sql-9bf03127d867?source=collection_archive---------2-----------------------#2020-12-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9ea4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分区依据:</strong></p><p id="6894" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT雇员标识，年(雇用日期)，部门标识，薪金，</p><p id="e7a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总计超过()的金额，</p><p id="0ac0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为dept_sal的总和(薪金)(按department_id划分)</p><p id="d72e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="7e41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ORDER BY employee_id、year(聘用日期)、department_id、薪金；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2d22b96cd9ca8468e122b50eacc30f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*HHfwHNPzEhYNSmo0c5BAAA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">分组依据的替代</figcaption></figure><p id="b625" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Row_number() </strong></p><p id="89e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，聘用日期，薪金FROM雇员ORDER BY薪金。</p><p id="1fd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="4d30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROW_NUMBER()超过()作为薪金_级别</p><p id="98c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/dfb3a0f365876c427d03c16e29d3eef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*wCCFr_txiJUFhVIChH67ng.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">默认情况下，整个数据的等级</figcaption></figure><p id="e548" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="59bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROW _ NUMBER()OVER(ORDER BY salary)AS salary _ rank</p><p id="317e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/647c87e0c4c16deec39884d86f1b0abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*HKUqWIAvG42jNBFWlUVGXw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">条目的薪金级别</figcaption></figure><p id="6ea1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，部门标识，</p><p id="4acf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROW_NUMBER() OVER(按部门标识划分)AS salary_rank</p><p id="872b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/004971d0f6b16d28436ed7d640b2a006.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*VsqGPQC9qlsT6n01ZmV5XQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">按部门标识级别分组</figcaption></figure><p id="bf8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">具有row_number()的唯一行</strong></p><p id="14a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建表temp1(</p><p id="ad8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">id INT，</p><p id="25c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">name VARCHAR(10)不为空</p><p id="dd0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">);</p><p id="dcd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">插入到temp1(id，name)</p><p id="1bb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">值(1，' A ')，</p><p id="19a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2，' B ')，</p><p id="4876" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(3，' C ')，</p><p id="8fc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(4，‘D’)；</p><p id="67e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT * FROM temp1</p><p id="322e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT雇员标识，薪金，部门标识，</p><p id="491e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROW _ NUMBER()OVER(PARTITION BY department _ id，salary ORDER BY salary)作为row_num</p><p id="ab77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jw"><img src="../Images/dd1e88e96f6831bcfca10dae523f1cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*iwnizu0bHYSmLMaP0y6BMQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">按特定顺序分组</figcaption></figure><p id="1062" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Rank() </strong></p><p id="cfbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="a182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">排名()超过(按薪金排序)作为薪金_排名</p><p id="992d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/e69cd2dd0fe4183f7bdfe0e004e4ed5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*cG4b4GR_TBXY8NQsjB7J_A.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">完整数据等级</figcaption></figure><p id="ef35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="ce10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RANK()over(PARTITION BY YEAR(hire _ date)ORDER BY salary)作为salary_rank</p><p id="29a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jy"><img src="../Images/f4a625cad7f7220238016662f981cf6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*NJX6kty0x6oS2oawbZ0gSw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">按等级分组</figcaption></figure><p id="bf7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Dense_rank() </strong></p><p id="08cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="4c71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DENSE_RANK()超过(按薪金排序)salry_rank</p><p id="90f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/9622fd10295ff3309b42ad918a2f4293.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*nKaRfS_RbIC0SuyL-C9YEw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最佳排名</figcaption></figure><p id="7c28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="7e48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DENSE _ RANK()OVER(PARTITION BY YEAR(hire _ date)ORDER BY salry _ RANK)</p><p id="5fca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/a09ece51b318854e4303122e757cb314.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*3we5a_YjpxgdbeHJ15H_Fw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">按排名分组</figcaption></figure><p id="4bb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Percent_rank() </strong></p><p id="c631" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="99b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PERCENT_RANK()超过(按薪金排序)salry_rank</p><p id="51e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/4016380563c60553ef37500a16db24ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*TqRgL-KedyIw2EKQynSVCQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">完整数据集(0–1)%</figcaption></figure><p id="7380" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，部门标识，薪金，</p><p id="9fe2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PERCENT _ RANK()OVER(PARTITION BY department _ id ORDER BY salry _ RANK)</p><p id="4f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kc"><img src="../Images/4bc51c2df3292a531409c795d2fb2938.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*YxO39zcAxkCqO0ituEU2Ww.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">组内百分比</figcaption></figure><p id="53c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">累计距离()</strong></p><p id="cca6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，薪金，</p><p id="f6df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DIST CUME()以上(按薪金排序)累计</p><p id="952d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kd"><img src="../Images/ee576470ddd2c8923bd314c7598f46d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*7SnZUpUL4XjFL77LLtLo5A.png"/></div></figure><p id="83af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇用日期，部门标识，薪金，</p><p id="103f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CUME_DIST()以上(按部门分区_id按薪金排序)累计</p><p id="33bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/5c5d195f52a7a717fe787e81bb11723c.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*cfqOjRZCabRafjWGqOxwHA.png"/></div></figure><p id="fd89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">滞后()</strong></p><p id="e970" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT姓氏，名字，部门标识，雇用日期，</p><p id="f152" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">LAG(first_name，1，“无正文”)OVER(按部门id分区</p><p id="f637" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按雇佣日期排序)前一雇佣日期</p><p id="24a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="d26a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ORDER BY部门标识、聘用日期、姓氏、名字。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kf"><img src="../Images/153afc424d0c875487520265272023da.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*r0cxIvtorKwNIQUL9wjtZA.png"/></div></figure><p id="da15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">铅()</strong></p><p id="85e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT姓氏，名字，部门标识，雇用日期，</p><p id="33c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">LAG(hire_date，1，null) OVER(按部门标识划分</p><p id="b1d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按雇佣日期排序)前一雇佣日期，</p><p id="de56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">销售线索(聘用日期，1，空)超过(按部门标识划分</p><p id="a658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按雇佣日期排序)在雇佣日期之后</p><p id="10e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="e52e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ORDER BY部门标识、聘用日期、姓氏、名字。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/ca2f6c0ba0f7cc1bd1d9143deb390380.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*MEGMQ_ZuyXPXsD9mcVig_w.png"/></div></figure><p id="170a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> first_value() </strong></p><p id="40f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员id，薪金，</p><p id="332a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FIRST_VALUE(名字)OVER(按薪金排序)</p><p id="821d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="16af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按工资排序；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kh"><img src="../Images/02ae77cd73e5ff78a91b5982f81396fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*JTo0obInzZafPNGQigc9yA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">然后提取第一个名字</figcaption></figure><p id="728d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员标识，薪金，部门标识，</p><p id="6130" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FIRST_VALUE(first_name) OVER(按部门id分区，按薪金排序)</p><p id="8c49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="2613" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按部门排序_id，薪资；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ki"><img src="../Images/c0a11320cb5f9b826cdb5c0d3159cdf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*WQdWHhKl68laQsRVEKZyNw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">GRUOP wise名字</figcaption></figure><p id="623f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> last_value() </strong></p><p id="049c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员标识，薪金，部门标识，</p><p id="19a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">姓氏(名字)超过(按薪金排序)</p><p id="1a9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="0a6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按工资排序；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/1ca01fb2bbb3510a2ddd8b377f170b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*m6LuEtzNrSPHHk-EHh3oAA.png"/></div></figure><p id="980d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员标识，薪金，部门标识，</p><p id="9e7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">姓氏值(名字)超过(按部门id划分，按薪金范围排序介于</p><p id="209f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无界前置AND</p><p id="2e01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无界追随)</p><p id="892a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="cee3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按部门排序_id，薪资；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/d8609b0cdf4d6c08f45fd849c794a96f.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*Ke1v4CeCRErC3vnEumq_3w.png"/></div></figure><p id="0f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第n _ value()</strong></p><p id="b5f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员id，薪金，</p><p id="bbbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">n _ VALUE(first _ name，3)超过(按薪金排序)</p><p id="cb0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="f82e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按工资排序；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/481545b6692794296695eb8987e4cab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*MQ_6-77fkz3d7QQsOC9LLQ.png"/></div></figure><p id="21d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员标识，薪金，部门标识，</p><p id="2101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">n _ VALUE(first _ name，3) OVER(按部门id分区，按薪金排序)</p><p id="0b81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="3339" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按部门排序_id，薪资；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/a2c3222d158a3d7dae62bfcd4cb1af83.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*K9iRuCaf2ipnn5gSxgY4rQ.png"/></div></figure><p id="24a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ntile() — </strong>这将把数据集分成几个部分。</p><p id="02a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员id，薪金，</p><p id="0bc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NTILE(3)以上(按工资排序)</p><p id="6a28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从员工按工资排序；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/54ccf01312268c81b5a42286d221ded5.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*Sj9K1amQVGljKPQbOHFV9w.png"/></div></figure><p id="7376" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT名字，雇员标识，薪金，部门标识，</p><p id="6925" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NTILE(3) OVER(按部门划分_id按薪金排序)</p><p id="523f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自员工</p><p id="37ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按部门排序_id，薪资；</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/c530a73aefa160e595b2f0618999ab0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*ufA20pZ2UZRogTZ-Uvy7dg.png"/></div></figure><p id="d6b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">信息模式:</strong></p><p id="82b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SELECT约束名称，</p><p id="07af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">唯一约束名称，</p><p id="f6ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MATCH_OPTION</p><p id="6019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更新规则，</p><p id="ee70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">删除规则，</p><p id="8122" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">表名，</p><p id="c6ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">引用的表名</p><p id="ffb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自INFORMATION_SCHEMA。参考约束</p><p id="cee7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中CONSTRAINT _ SCHEMA = ' HR</p></div></div>    
</body>
</html>