<html>
<head>
<title>Demystify reverse engineering CTF challenge — Blade</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开逆向工程 CTF 挑战赛的神秘面纱——刀锋</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/demystify-reverse-engineering-ctf-challenge-blade-40c45e7933c0?source=collection_archive---------0-----------------------#2019-10-23">https://medium.com/nerd-for-tech/demystify-reverse-engineering-ctf-challenge-blade-40c45e7933c0?source=collection_archive---------0-----------------------#2019-10-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7f1708d331ffef75003c3ef326c9c4d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4h-p1NCFaAzQAMyAkNzmpg.jpeg"/></div></div></figure><p id="5bbc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有没有试过<strong class="is hj">逆向工程</strong>？？？</p><p id="171c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一天，我的朋友在解决 CTF<a class="ae jo" href="https://ctftime.org/ctf-wtf/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"/></a>竞赛中的一个挑战时，在逆向工程部分卡住了。我想尝试一下，我能够解决这个挑战。可以吗？？？试试看。</p><p id="9ff5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">任何开始逆向工程的人都可以解决这个挑战。</p><p id="9f10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我想分享我解决这个挑战的方法。</p><div class="jp jq ez fb jr js"><a href="https://drive.google.com/open?id=1oTERzqyVPbK8TImkkZyWsrnPfRNGYygN" rel="noopener  ugc nofollow" target="_blank"><div class="jt ab dw"><div class="ju ab jv cl cj jw"><h2 class="bd hj fi z dy jx ea eb jy ed ef hh bi translated">刀片二进制</h2><div class="jz l"><h3 class="bd b fi z dy jx ea eb jy ed ef dx translated">试试吧！！！</h3></div><div class="ka l"><p class="bd b fp z dy jx ea eb jy ed ef dx translated">drive.google.com</p></div></div></div></a></div><h1 id="d536" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">检查文件类型</h1><p id="dbe8" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">我的第一步是确定文件类型。我打开终端，键入<code class="du le lf lg lh b">file blade</code>,得到了这个输出</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/7d6f06aebff56a9c34bc8b600484659b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUUuZ5tESGJnbpe64mQBWg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">32 位可执行文件</figcaption></figure><p id="4f47" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为，这是一个可执行文件，我们可以在任何反汇编程序中打开，如 IDA pro，radare2，binary ninja 和 ghidra 等。但是在用反汇编程序打开它之前，我执行了二进制文件来检查它接受的所有输入是什么？</p><h1 id="9aa4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">执行二进制文件</h1><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/72ce0c00c2db6761d9f17d4ef518b73a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*XBe4WiwUeJ8iclrW95JQFw.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">二进制执行</figcaption></figure><p id="18ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如您所看到的，在执行 binary 时，它只接受一个输入，不打印任何内容。此时，我认为当输入正确时，它可能会打印一些字符串或实际的标志。</p><h1 id="20ee" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">打印二进制文件中的字符串</h1><p id="5924" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">为了打印二进制文件中的所有字符串，我使用了<code class="du le lf lg lh b">strings</code>,下面是输出。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/26d37d33b7a40d9054e529dc050ae93c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xMZ5kcTkHtx5vsWugFFZwg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">字符串命令输出</figcaption></figure><p id="c706" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，你知道当我们执行二进制时，它会问一个问题，我们必须输入。根据经验，我的猜测是“说点什么”可能是正确的输入。让我们检查反汇编程序。</p><h1 id="e9fe" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">IDA-Pro 反汇编程序</h1><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/eb57420dedddd5a05f4672bfbc3e185d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*OVX6Qo_w_mW_b7WFZ70jBQ.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">IDA Pro 反汇编程序</figcaption></figure><p id="ba44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我赶紧下载安装了 IDA pro 反汇编程序，打开二进制。使用 IDA pro 反汇编程序的原因是我用起来很舒服。我知道它的基本原理。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/9fa9cf9c90a54dbcc26ab33950d76712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2hKFJQoSsxr_ibu76EDu3A.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">主函数的图形视图</figcaption></figure><p id="011c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们所看到的，有一个对 strcmp 函数的调用，它接受我们之前找到的字符串和输入变量。如果你知道 strcmp 函数，如果两个字符串相等，它将返回 0，如果 strcmp 返回非零值，有一个指令<code class="du le lf lg lh b">jnz</code>跳转，否则它将调用‘print _ flag’函数。这就是我想看的。</p><p id="057d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们输入字符串并获得我们的第一个标志。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/89a1c0eb06406a2e8a9abb7126a21e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*usa6atUz-8jo3QH3VPNp8Q.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">标志输出</figcaption></figure><h2 id="2378" class="lw kc hi bd kd lx ly lz kh ma mb mc kl jb md me kp jf mf mg kt jj mh mi kx mj bi translated">耶！！！我得到了我的第一面旗帜:)</h2><h1 id="7db7" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">print_flag 里面有什么？？？？</h1><p id="0895" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">出于好奇，我想看看' print_flag '函数中有什么，以及当我们使用 string 命令时为什么没有打印出标志。我迅速导航到“print_flag”功能并开始探索。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/653b69c771f221eb9acbb2891bc42b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEWJxvYY1qWeupP9O8-yNw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">Print_flag 函数图形视图</figcaption></figure><p id="100b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">起初，这个函数似乎很长，但后来我意识到这个函数很简单。我们来分析一下这个函数是干什么的。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/a7d63dc3013123ce42d7ebe06a3842cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VV2XXVNVeRvIp7jwyjKTGw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">print_flag 函数的逻辑</figcaption></figure><p id="5139" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们在这里看到的，有一个循环，循环内部有 xor 指令。这个循环将逐字符打印标志。</p><p id="f691" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">这个挑战的 Python 代码应该是这样的</strong></p><figure class="lj lk ll lm fd ij"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="3e74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">理解组装是这次挑战的主要<strong class="is hj">难点</strong>。这个挑战非常有趣。</p><p id="33de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你喜欢:)</p><p id="f4ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是的，将来还会有类似的文章，敬请关注！</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/e94367f284702bb56a3b2f37e9d4b512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKlp-ABEplpn6sZw_bimOA.jpeg"/></div></div></figure><p id="3407" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">永远感谢@ <a class="ae jo" href="https://www.instagram.com/deepank.srivastava/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> Deepank </strong> </a>对他的目光和他在这件作品上的笔记。</p></div></div>    
</body>
</html>