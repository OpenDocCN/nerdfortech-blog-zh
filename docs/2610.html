<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/angular-new-project-boilerplate-workspace-unit-testing-pre-commits-hooks-custom-library-eslint-fcc40873698a?source=collection_archive---------7-----------------------#2021-05-13">https://medium.com/nerd-for-tech/angular-new-project-boilerplate-workspace-unit-testing-pre-commits-hooks-custom-library-eslint-fcc40873698a?source=collection_archive---------7-----------------------#2021-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="c974" class="hg hh hi bd hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie bi translated">一篇文章中的所有项目配置</h2><p id="bdca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">开始一个新项目可能会令人困惑，因为你需要很多不同的设置，所以我决定在一个简单的6步指南中收集所有你需要的配置。</p><figure class="jb jc jd je fd jf er es paragraph-image"><div class="er es ja"><img src="../Images/cd551e971817ea59b5be3820325b1d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*DJKqwKt-1-YYwfGoDps6ZQ.jpeg"/></div></figure><h2 id="2850" class="hg hh hi bd hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie bi translated">在本文中，我将演示创建新的Angular项目时需要的所有必要设置:</h2><ol class=""><li id="85b6" class="ji jj hi ih b ii ij im in hs jk hw jl ia jm iz jn jo jp jq bi translated">将项目设置为工作区，对于跨多个应用程序的代码共享和公共设置非常有用。</li><li id="7419" class="ji jj hi ih b ii jr im js hs jt hw ju ia jv iz jn jo jp jq bi translated">在我们的角度项目中使用自定义角度库。</li><li id="3a35" class="ji jj hi ih b ii jr im js hs jt hw ju ia jv iz jn jo jp jq bi translated">Karma &amp; Jasmine单元测试的一些定制配置。</li><li id="7d43" class="ji jj hi ih b ii jr im js hs jt hw ju ia jv iz jn jo jp jq bi translated">设置一个预提交挂钩，用ESLint+appearlier来lint我们的stages文件。</li><li id="771f" class="ji jj hi ih b ii jr im js hs jt hw ju ia jv iz jn jo jp jq bi translated">使用Typescript设置别名路径。</li><li id="1439" class="ji jj hi ih b ii jr im js hs jt hw ju ia jv iz jn jo jp jq bi translated">设置多个环境:本地、临时、生产+将process.env变量注入到我们的项目中。</li></ol><h1 id="edee" class="jw hh hi bd hj jx jy jz hn ka kb kc hr kd ke kf hv kg kh ki hz kj kk kl id km bi translated">1.工作空间:</h1><p id="9999" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">工作区是管理多个应用程序的非常方便的方式，其中一个好处是用一个package.json来管理项目的依赖关系。</p><p id="b767" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">创建一个空工作区:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="8877" class="hg hh hi kt b fi kx ky l kz la">ng new my-workspace --create-application false</span></pre><p id="7ce6" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">在工作区中创建一个空应用程序。</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="6d54" class="hg hh hi kt b fi kx ky l kz la">cd my-workspace<br/>ng g application my-app --prefix ma --style scss --routing</span></pre><p id="50ca" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">这将创建一个具有SCSS样式和路由的新应用程序。</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="35a9" class="hg hh hi kt b fi kx ky l kz la">// angular.json<br/>{<br/>  //...<br/>  "my-app": {<br/>      "projectType": "application",<br/>      "schematics": {<br/>          "<a class="ae lb" href="http://twitter.com/schematics/angular" rel="noopener ugc nofollow" target="_blank">@schematics/angular</a>:component": {<br/>              "style": "scss",<br/>              "changeDetection": "OnPush"<br/>          }<br/>      },<br/>   }<br/>}</span></pre><p id="ce67" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">上面的代码会将应用程序中的默认变更检测更改为“onPush”。</p><h1 id="3aa1" class="jw hh hi bd hj jx jy jz hn ka kb kc hr kd ke kf hv kg kh ki hz kj kk kl id km bi translated">2.图书馆:</h1><p id="431b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">库使得为你的应用程序放置所有的公共代码变得容易，例如:服务、组件、指令、管道等等。</p><p id="d03c" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">与核心模块相比，我更喜欢使用库，因为您可以发布它，并将其提供给公司中的其他开发人员，他们通常与您有相同的核心用途。</p><p id="ce97" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">这篇文章是创建一个很好的指南:<a class="ae lb" rel="noopener" href="/@tomsu/how-to-build-a-library-for-angular-apps-4f9b38b0ed11">https://medium . com/@ tomsu/how-to-build-a-library-for-angular-apps-4 F9 b 38 b 0 ed 11</a>。</p><p id="c550" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">如果您没有在将库发布到npm时插入，则可以使用以下内容来使用它:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="52cc" class="hg hh hi kt b fi kx ky l kz la">//package.json<br/>....<br/>"optionalDependencies": {<br/>  "my-app": "file:dist/my-app"<br/>}</span></pre><p id="335f" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">我还建议为库添加一个监视脚本，这样它将在每次代码更改时重建，在单独的终端选项卡中运行下面的npm脚本。</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="e77b" class="hg hh hi kt b fi kx ky l kz la">///package.json<br/>...<br/>"build": "ng build my-lib --watch",</span></pre><h1 id="3e3b" class="jw hh hi bd hj jx jy jz hn ka kb kc hr kd ke kf hv kg kh ki hz kj kk kl id km bi translated">3.单元测试:</h1><p id="10c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">Angular自带了单元测试配置，但是您可以添加一些设置来使您的生活变得更加轻松。</p><p id="9f3f" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">添加以下脚本:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="7ee7" class="hg hh hi kt b fi kx ky l kz la">//package.json<br/>...<br/>scripts: {</span><span id="3054" class="hg hh hi kt b fi lc ky l kz la">"unit-test:my-app:code-coverage": "ng test --project=my-app --code-coverage --reporters=spec",<br/>    "unit-test:my-app": "ng test --project=my-app  --reporters=spec,kjhtml"</span><span id="2203" class="hg hh hi kt b fi lc ky l kz la">}</span></pre><p id="5213" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">使用标志“code-coverage”会生成一个index.html，向您显示每个组件/服务的所有覆盖率的细分。</p><p id="b850" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">这是我的配置文件:</p><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="b808" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">你需要安装所有的插件。(JUnit代表CI渠道)</p><p id="70d5" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">这也将在开发工具打开的情况下全屏打开chrome。</p><h1 id="6583" class="jw hh hi bd hj jx jy jz hn ka kb kc hr kd ke kf hv kg kh ki hz kj kk kl id km bi translated">4.预提交:</h1><p id="b818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">我们将创建一个预提交钩子，它将在每次提交时运行ESLint +。</p><p id="f574" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">安装ESlint:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="f182" class="hg hh hi kt b fi kx ky l kz la">npm install --save -dev eslint</span></pre><p id="0afc" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">配置文件:(如果使用这个文件，您将需要安装所有的扩展)</p><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="fbe7" class="hg hh hi kt b fi kx ky l kz la">Install husky:</span><span id="b49c" class="hg hh hi kt b fi lc ky l kz la">npm install --save -dev husky<br/>npm install --save -dev lint-staged</span></pre><p id="6ae5" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">添加以下脚本和配置:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="d247" class="hg hh hi kt b fi kx ky l kz la">/package.json<br/>...<br/>"scripts": {<br/>    "lint:my-app": "ng lint --fix --project=my-app",<br/>    "lint:my-lib": "ng lint --fix --project=my-lib",<br/>    ...<br/>}<br/>...<br/>"husky": {<br/>  "hooks": {<br/>      "pre-commit": "lint-staged --relative"<br/>    }<br/>},<br/>"lint-staged": {<br/>   "*.{js,ts}": [<br/>      "eslint --fix"<br/>   ],<br/>   "*.{html,scss}": [<br/>      "prettier --write"<br/>   ]<br/>},</span></pre><p id="727b" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">更漂亮的配置:</p><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure><h1 id="857d" class="jw hh hi bd hj jx jy jz hn ka kb kc hr kd ke kf hv kg kh ki hz kj kk kl id km bi translated">5.路径别名:</h1><p id="46d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">定义路径别名使得在项目中移动文件变得容易，并且导入路径看起来更好。</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="160c" class="hg hh hi kt b fi kx ky l kz la">//tsconfig.json<br/>...<br/>"paths": {<br/>   "<a class="ae lb" href="http://twitter.com/environments" rel="noopener ugc nofollow" target="_blank">@environments</a>/*": ["projects/my-app/src/environments/*"],<br/>   "<a class="ae lb" href="http://twitter.com/pages" rel="noopener ugc nofollow" target="_blank">@pages</a>/*": ["projects/my-app/src/app/pages/*"],<br/>   "my-lib": ["dist/my-lib"]  <br/>}</span></pre><h1 id="8270" class="jw hh hi bd hj jx jy jz hn ka kb kc hr kd ke kf hv kg kh ki hz kj kk kl id km bi translated">6.多种环境:</h1><p id="6127" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip hs iq ir is hw it iu iv ia iw ix iy iz hb bi translated">设置多种环境，例如:生产环境、暂存环境和本地环境。此外，我将展示如何支持过程环境变量，例如CI构建号，以便在您的项目中可用。</p><p id="0470" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">在我的应用程序/环境下创建以下文件:</p><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="31c5" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">在根目录下创建脚本:</p><figure class="jb jc jd je fd jf"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="a52a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">更改Angular.json:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="caf5" class="hg hh hi kt b fi kx ky l kz la">//angular.json</span><span id="8d5c" class="hg hh hi kt b fi lc ky l kz la">"projects": {<br/>    "my-lib": {<br/>      ...<br/>    },<br/>    "my-app": {<br/>      ...<br/>      "architect": {<br/>        "build": {<br/>          ...<br/>          "configurations": {<br/>            "staging": {<br/>              "fileReplacements": [<br/>                {<br/>                  "replace": "projects/my-app/src/environments/environment.ts",<br/>                  "with": "projects/my-app/src/environments/environment.staging.ts"<br/>                }<br/>              ],<br/>              ...<br/>            },<br/>            "production": {<br/>              "fileReplacements": [<br/>                {<br/>                  "replace": "projects/my-app/src/environments/environment.ts",<br/>                  "with": "projects/my-app/src/environments/environment.production.ts"<br/>                }<br/>              ],<br/>              ....<br/>            }<br/>       ...<br/>}</span></pre><p id="2dce" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated">最后添加到您的package.json:</p><pre class="jb jc jd je fd ks kt ku kv aw kw bi"><span id="059a" class="hg hh hi kt b fi kx ky l kz la">//package.json<br/>...<br/>scripts: {<br/>...<br/>"build-dynamic-env": "ts-node -O '{\"module\": \"commonjs\"}' ./generate-dynamic-env.ts",<br/>"build:production": "npm run build-dynamic-env &amp;&amp; ng build --project=my-app --configuration=production",<br/>    "build:staging": "npm run build-dynamic-env &amp;&amp; ng build --project=my-app --configuration=staging",<br/>}</span></pre><p id="8928" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip hs kp ir is hw kq iu iv ia kr ix iy iz hb bi translated"><strong class="ih lm">感谢阅读！如果你有任何问题，请在评论中告诉我。</strong></p></div></div>    
</body>
</html>