<html>
<head>
<title>Simple AWS S3 Logging in Python3 Using Boto3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Boto3在Python3中进行简单的AWS S3日志记录</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/simple-aws-s3-logging-in-python3-using-boto3-cfbd345ef65b?source=collection_archive---------1-----------------------#2021-08-03">https://medium.com/nerd-for-tech/simple-aws-s3-logging-in-python3-using-boto3-cfbd345ef65b?source=collection_archive---------1-----------------------#2021-08-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/71d4c5548b0d8b2be740175cd698df9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TfpIaPVlP_8T8o69"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">斯文·舍尔梅尔在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="a2c3" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">用Python3实现S3日志的简单方法</h2></div><p id="2508" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">软件框架的一个关键方面是记录必要的信息并保存它们。使用boto3和本地python logger，很容易将日志保存到python程序内的AWS S3中。</p><p id="8739" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">日志将有助于调试、监控、审计和理解框架在任何给定时间点的行为。当谈到云中的应用程序时，我们不会将重要信息存储在本地机器上，而是存储在像AWS S3这样的云存储服务中。</p><p id="a4a2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">最近，我一直在研究一个使用python来自动化大数据ETL部署的框架。要求是将日志保存到S3以备将来参考，而不需要使用复杂的代码或做太多的代码更改。要求是不能在S3实时记录日志。</p><p id="c872" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我的意图是利用我一直用于所有python代码的现有Python日志记录器和Boto3 SDK与AWS S3进行交互。这里有一个将Python logger生成的日志存储到S3的简单方法。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="d8b8" class="kq kr hy bd ks kt ku kv kw kx ky kz la je lb jf lc jh ld ji le jk lf jl lg lh bi translated">方法</h1><p id="d74b" class="pw-post-body-paragraph jn jo hy jp b jq li iz js jt lj jc jv jw lk jy jz ka ll kc kd ke lm kg kh ki hb bi translated"><strong class="jp hz">创建字符串输入/输出记录器:</strong></p><p id="8ea8" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Python logger允许我们添加不同种类的处理程序。我们可以利用它来添加一个字符串I/O流处理程序，它基本上是一个字符串缓冲区，可以存储logger.info或logger.error函数生成的所有日志。</p><figure class="ln lo lp lq fd hk"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="a662" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">把内容放到S3: </strong></p><p id="5a17" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Boto3是一个python SDK，用于与AWS服务进行交互。在这里，我创建了一个函数put_content_to_s3()，把给定的内容放在指定的s3路径中。此函数还将备份密钥作为参数，如果文件已经存在于指定的S3位置，它将根据指定的备份策略备份备份文件夹或备份文件中的旧内容。这种备份策略可以根据需要进行定制。</p><p id="0251" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">运行代码的实例应该对指定的S3路径具有读写权限。</p><figure class="ln lo lp lq fd hk"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="e49f" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">如何使用S3测井:</strong></p><p id="3902" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">该代码的主要功能是创建一个字符串I/O缓冲区和字符串I/O记录器。代码将有一个带有logger.info和logger.error的正常流程。</p><p id="061b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在finally块中，调用put_content_to_s3()函数将日志内容从字符串I/O缓冲区放入s3。</p><figure class="ln lo lp lq fd hk"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="2052" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是使用现有的python logger和Boto3在Python3中实现S3日志记录的简单易行的方法之一。在开放源码中，很少有用于此目的的库，但这里的目的是不使用任何不可信的python库，也不使事情过于复杂。</p><p id="f32d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">编码快乐！</p></div></div>    
</body>
</html>