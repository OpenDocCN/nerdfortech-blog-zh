<html>
<head>
<title>I wrote a Web App and I liked it</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我写了一个网络应用程序，我喜欢它</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/i-wrote-a-web-app-and-i-liked-it-da7247add06b?source=collection_archive---------10-----------------------#2021-08-01">https://medium.com/nerd-for-tech/i-wrote-a-web-app-and-i-liked-it-da7247add06b?source=collection_archive---------10-----------------------#2021-08-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a0e7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">但是我没有用JavaScript或者CSS。以下是对这次经历的详细描述</h2></div><p id="e90e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯，就是这样。我退休了。对我来说，烟斗和拖鞋，或者大量的阅读，大量的骑自行车，尝试意大利语甚至钢琴的机会。</p><p id="693c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“我有事情要你做……”</p><p id="7590" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我是现在的W夫人。我现在很紧张。这将是那些“从上到下油漆整个房子”的工作之一。好吧，准备好惊喜吧…</p><p id="cfe5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">"你可以写一个链式家庭模拟器，就像Bawdsey的那样."</p><p id="c246" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">砰。就是这样；我完全同意。</p><p id="5f41" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无线电测向(又名雷达)，在其最早的化身之一。它是悬崖顶上的大天线，广播兆瓦的无线电波，希望一个微小的回声能揭示纳粹轰炸机的存在。那是波瓣，增益，极化，相位。很多好东西需要计算。</p><p id="4d99" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们有一本很好的参考手册。令人惊讶的是，在TTW国家档案馆的宝藏中，我们可以找到“RDF主管手册”，[空军部，1943年4月，AIR10/4114]。</p><p id="4a7a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在1月10日的第一份笔记中，我画了各种各样的叶片形状，以及可能可行的近似形状。同时，已经在考虑数据结构和坐标系统。根本没有想过我实际上可能如何产生一个应用程序，所有早期的想法都是关于问题域的。这是应该的，遵循逐步细化的指导方针。</p><p id="d2ae" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一周，没有代码，只有几页笔记。</p><p id="daf7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">几天后出现一个非常基本的UI草图。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/a8c804a3d2968543c1bc8ea1a955a008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXWSzN2aqRL_gWYTNc6yYw.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">用户界面的第一张草图</figcaption></figure><p id="dfe9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里没有发明，只是简化了Mk 5接收器的典型控制面板。</p><p id="b13c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">硬件的变化速度非常快；在任何时候，海岸周围的所有站都没有一个相同的基地。在任何时候，都可能有几个实验在进行；那些成功的方法被应用到其他地方。不仅仅是雷达技术，还有工作实践、通信协议等等。可以说，这一切都是活着“编造”出来的。</p><p id="ee70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们从手册的内容中提炼出RDF的核心——我们的程序实际上会做什么？有一串脉冲从110米高的发射塔发出，传播到100英里以外的海面，击中一架飞机，被吸收和再辐射(本身是一种复杂的量子现象)，其中的一部分返回到100英里以外的接收塔。在那里，他们遇到两个90度设置的接收天线。这在天线中感应出微小的电流，其强度和相位编码了飞机的距离和方位。操作员旋转控制器(“测角仪”)，该控制器混合来自交叉天线的信号，并提供输出以偏转阴极射线管上的电子束。</p><p id="ef1d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为，当这些脉冲有目的地在海洋上传播时，回到CH站，电子束已经开始在阴极射线管(CRT)上水平画一条线。定时是这样的，返回信号(为简单起见，我们称之为回波)到达，通过接收器和测角仪，并进入CRT电路，屏幕上的位置与平面的范围成比例。</p><p id="f95b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在任何给定的时刻，不仅会有可能来自敌方轰炸机的回声，也会有来自友军飞机、船只、建筑物、雨水的回声；任何能引起回声的东西。所有这些都被“计算”并混合成一个单一的输出。这是由热离子阀制成的专用电路进行的模拟计算。就像海浪穿过海洋，撞击沙滩一样，一些回声会结合起来，相互加强，形成更大的波浪，一些回声会结合起来，相互抵消。</p><p id="23f8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在加倍好奇:首先，关于操作者如何能从这种喧嚣中提取有意义的信息，允许皇家空军保卫我们的土地；第二，我们究竟如何在现代数字计算机上模拟它，合理地忠实于物理学，但在我们的实现中是实用的？</p><h2 id="7434" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">什么语言和框架？原生还是Web？</h2><p id="de51" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">迟早，我们必须开始尝试我们最初的想法。我们将如何实现这一点？用什么语言，用什么工具，来构建我们的用户界面和所有的数学逻辑。</p><p id="cfd5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将在这里简单地声明，我选择使用Elm作为语言和框架。Elm，因为它干净(类似Haskell)的语法和简洁的表达能力，这是一种功能优先的语言(与“以功能方式”使用语言X相反)。应用程序框架，因为它完美地将纯功能性与非纯功能性(JavaScript)分开。我根本不会考虑使用我见过的最流行的框架之一，我对此毫无兴趣。如果有什么突出了我的处境的简单美丽，那就是这个。我觉得很棒；我想用它；我承受任何后果；决定已经做了。</p><p id="ea99" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">git日志告诉我们，在1月17日，随着第二次提交，我们有了“我的第一次画线尝试”。把它描述为原始是很慷慨的。它揭示了当时我们制图能力的程度。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="58f6" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">-- This is dummy line for me to practise with floats and trig.<br/>myLineData = List.map <br/>  (\x -&gt; ( x, truncate &lt;| ((*) 100) &lt;| sin &lt;| toFloat &lt;| x * t ))<br/>  (List.range 1 800)<br/><br/>stringifyPoint (x, y) = (String.fromInt x )++ <br/>    "," ++ <br/>    (String.fromInt y) ++ " "<br/><br/>polyLineFromCoords coords = List.foldr (++) "" <br/>  (List.map stringifyPoint coords)<br/><br/>...<br/>    , polyline<br/>        [ points (polyLineFromCoords m.lineData)<br/>        , fill "none"<br/>        , stroke "lightgreen"<br/>        , strokeWidth "4"<br/>        ]<br/>        []</em></span></pre><p id="2432" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">呜-呼！我们应该能够看到随时间变化的正弦曲线，由可缩放的矢量图形呈现。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lt"><img src="../Images/36fc6ca192817e126849302a84b73152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gP0T4o3TtIsWfipPl7ZFpA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">我们有图像了！</figcaption></figure><p id="0076" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这正是我们所看到的，而且它正随着时间快速变化。这是忧虑地图上的一个标记。</p><p id="ae05" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">受到我们早期成功的鼓舞，我们有信心开始将我们初步的领域模型转移到代码中。从哪里开始？对于数据类型，是。Elm是一种强类型语言(带有类型推断)，拥有正确的结构将使我们保持正确的方向。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="b221" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">type alias Target = { latitude : Float<br/>                    , longitude : Float<br/>                    , height : Float<br/>                    , bearing : Float<br/>                    , speed : Float<br/>                    , iff : Bool }</em></span></pre><p id="5b0c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这让我们可以模拟敌人:</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="2bb9" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">bomber = { latitude = 2.0<br/>         , longitude = 51.993661<br/>         , height = 20<br/>         , bearing = 270<br/>         , speed = 200<br/>         , iff = False }</em></span></pre><p id="2079" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加一些动作和更新我们的模型，使用模型作为我们的SVG行的源，并尝试我们的第一个可见“回声”,这并不需要很长时间。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lu"><img src="../Images/12a4734ecd5532ccb8b7d62f64469da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QarKbGlKL86hORYEMdXxag.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">首次CRT跟踪尝试</figcaption></figure><p id="0836" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它在那里。它会动。简直垃圾。为什么是垃圾？因为我认为将我们的时基建模为一系列“桶”是个好主意。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="26b8" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">bucketize : List PolarTarget -&gt; List (Int, Int)<br/>bucketize targets =<br/>  let emptyLineArray = Array.repeat 1000 (toFloat 0)<br/>      filledLineArray = List.foldl addSignal emptyLineArray targets<br/>      asList = Array.toIndexedList filledLineArray<br/>  in<br/>      List.map (\(i,x)-&gt;(i,truncate x)) asList</em></span></pre><p id="8a54" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我的思考过程是因为我们知道，无论如何，我们必须结合多重回声。将它们放入桶中，这样相同的回声就可以合并起来，这似乎是一个不错的起点。视觉上，这是一场灾难，因为即使是每像素一桶，它也太“数字化”了，而且这个动作令人恶心。没想到会这样。还没有完全准备好放弃bucketization，因为它们可能会在信号组合方面帮助我们，并且我们可能能够修复视觉问题。这只是编码的第二天。</p><p id="f6df" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在乐观中结束了这一天。通过一些简单的平滑，我们有两个来自目标的回波。桶是可见的(运动不平滑)，但它是可以忍受的。笔记包含了更多关于定相、测角仪操作和信号如何组合的讨论。笔记上写着19日晚了。</p><blockquote class="lv lw lx"><p id="7376" class="ix iy kj iz b ja jb ij jc jd je im jf ly jh ji jj lz jl jm jn ma jp jq jr js hb bi translated"><strong class="iz hj">桶化</strong> <br/>产生不可避免的‘数字化’表象。…怀疑这是否可以避免，当然是用SVG。也许通过一些更微妙(和复杂)的反别名渲染。？？WebGL</p></blockquote><p id="ce1a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">三个小时后，无桶画线。不是很好，但很有效。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="2d59" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">deriveTrace : List PolarTarget -&gt; LineData<br/>deriveTrace signals =<br/>  -- Let's put the targets in a dictionary, indexed by range (probably unique!).<br/>  -- Then we need a sorted list of edges (front and back).<br/>  -- Sorted list will index into the dictionary, for easy access to each target.<br/>  let allSignals = List.foldl (\p a -&gt; Dict.insert p.r p a) Dict.empty signals<br/>      activeSignals = Dict.empty<br/>      theLine = [(0.0,0.0)]<br/>      leadingEdges = List.map (\p -&gt; (p.r, p.r, True)) signals<br/>      trailingEdges = List.map (\p -&gt; (p.r + 200, p.r, False )) signals<br/>      allEdgesSorted = List.sortBy (\(a,b,c) -&gt; a) &lt;| leadingEdges ++ trailingEdges<br/>      extractLineData (line, _, _) = line<br/>  in<br/>      ((::) (1000.0, 0.0)) &lt;| extractLineData &lt;| List.foldl processEdge (theLine, activeSignals, allSignals) allEdgesSorted</em></span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lu"><img src="../Images/8dbd4ff90ce987a8279d7df7aa3ce589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_s5qzHwsnwR4qOCqKLs8w.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">两条痕迹，没有桶，运动平稳</figcaption></figure><h2 id="f260" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">1月20日—添加带相位的回声</h2><p id="cf60" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">现在是20号晚上，看起来我们又开始编码了。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="b90e" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">combineEchoes : Dict Float Echo -&gt; Float<br/>combineEchoes activeEchoes = <br/>  --Dict.foldl (\_ e acc -&gt; e.amplitude + acc) 0.0 activeEchoes<br/>--  100.0 * toFloat (Dict.size activeEchoes)  --OK!<br/>  -- Treat amplitude and phase as vector, sum components, convert back, use amplitude.<br/>  let asPolar = Dict.map (\_ e -&gt; (e.amplitude, e.phase) ) activeEchoes<br/>      asRect  = Dict.map (\_ p -&gt; fromPolar p)  asPolar<br/>      combinedAsRect = Dict.foldl (\_ (x, y) (xAcc, yAcc) -&gt; (x + xAcc, y + yAcc) ) (0.0,0.0) asRect<br/>      combinedAsPolar = toPolar combinedAsRect<br/>  in<br/>      100.0 * first combinedAsPolar</em></span></pre><p id="2e1d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">启动它，我们看到它基本上是有效的。在两个回波在距离轴上重叠的地方，我们看到轨迹有更深的下降。这随着信号的同相和异相而波动，就像海滩上的波浪一样。令人担忧的是，已经有证据表明我的一个通病，过早优化。</p><p id="94ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">"为什么要用字典，皮特？"</p><p id="cf7d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">"因为迭代将自然地按范围排序，所以它避免了排序."</p><p id="2048" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">"当然，但你是在假设这个系列的独特性."</p><p id="1362" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“我知道(叹气)。它<em class="kj">可能</em>没问题，因为它们是浮子，所以碰撞不太可能，所以我想我应该试试。”</p><p id="502b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们知道，不是吗，读者，这不会有好结果。是件大事。不，但这是症状。</p><blockquote class="mb"><p id="c3d3" class="mc md hi bd me mf mg mh mi mj mk js dx translated">过早的优化每次都让你痛苦不堪。</p></blockquote><figure class="ml mm mn mo mp jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lu"><img src="../Images/9fde29c9ae0ee8af55d0e6c9ac4011ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LD5POMBSQMyVrH6nX_xQvQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">通过相位相加来合并轨迹</figcaption></figure><p id="7437" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在第二张图中，两小时后，我们看到波瓣形状对信号强度的影响。我们在飞！</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lu"><img src="../Images/b145b14000509b15d07eed332622b791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qnV3rjC1U6u3rI93_gJtUg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">现在没有什么能阻止我们…</figcaption></figure><h2 id="5af7" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">1月22日— CRT不做垂直线</h2><p id="b657" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">跳过两天，我们看到关于避免痕迹中明显垂直线的注释。鉴于CRT显示器是基于偏转从左向右快速扫描的电子束，而热离子阀不是靠魔法工作的，我们不能像这样画垂直线。在现实生活中，线的倾角是“V”形的，有圆角。简单的几页笔记，一个git提交，上面写着“对平滑不满意”和悲伤的评论:</p><blockquote class="lv lw lx"><p id="fbe5" class="ix iy kj iz b ja jb ij jc jd je im jf ly jh ji jj lz jl jm jn ma jp jq jr js hb bi translated">我仍然相信我缺少一些更优雅的东西。</p></blockquote><p id="0ae2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有时候，你只是把它停好，继续前进，然后改天再来。这仍然是编码的第一个完整的星期；让我们不要惊慌。</p><h2 id="78c9" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">1月23日</h2><p id="5395" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们已经添加了一个范围标尺，这很漂亮，但跟踪仍然是哼哼。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lu"><img src="../Images/b5045acb01160bb573661ab2561c02bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfZjTdMEUAFDuIQK-Asvpw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">CRT顶部的量程刻度</figcaption></figure><p id="f35c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">笔记和git日志都表明我们仍然对“Skyline算法”不满意。这就是我们如何把一束回声变成一条连续的轨迹在阴极射线管上画出来的。意识到这有点像夜晚城市的天际线。当建筑的细节消失后，剩下的只是连续的轮廓。天际线算法告诉我们如何通过(基本上)从左到右对边缘进行排序，然后在我们遇到边缘时跟踪最高的建筑物来构建它。我们在上面提到了Dict的使用，我们看到在24号，我们已经切换到了列表。虽然没有特别的原因，但代码足够简单。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="ba40" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">deriveSkyline : Float -&gt; List Echo -&gt; List EdgeSegment<br/>deriveSkyline maxX allEchoes =<br/>  -- Let's put the echoes in a dictionary, indexed by range (probably unique!).<br/>  -- Then we need a sorted list of edges (front and back).<br/>  -- Sorted list will index into the dictionary, for easy access to each target.<br/>  let activeEchoes = []<br/>      leadingEdges = List.map (\e-&gt; (e.r, e, True) ) allEchoes<br/>      trailingEdges = List.map (\e -&gt; (e.r + pulseWidth, e, False )) allEchoes <br/>      allEdges = List.sortBy (\(r,_,_) -&gt; r) (leadingEdges ++ trailingEdges)<br/>      -- We have one in hand so we need to flush it out<br/>      (roofline, remainingEchoes, ((lastX, lastY))) = List.foldl processEdge ([], activeEchoes, (0.0,0.0)) allEdges<br/>      finalY = combineEchoes remainingEchoes<br/>  in<br/>      ((lastX, finalY), (maxX, finalY)) :: roofline</em></span></pre><p id="b5e1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过限制轨迹上的斜率，一个体面的视觉出现。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mq"><img src="../Images/0865b5156fb6748e850358ed5e1ab06c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_QxZlHigZwDOUgiGmXm_w.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">天际线算法改善了信号的组合</figcaption></figure><p id="4a94" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不久之后，我们进行了第一次大规模突袭。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mr"><img src="../Images/e69b78dcf9255bfbf8b380c509b708cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PN3DDxIwqmK1F9Ws8mx9Ag.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">85英里处的大型突袭</figcaption></figure><p id="4f14" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在27号，我们有一个逻辑测角仪，通过按Q和A键来“转动”。这影响了信号在交叉的接收偶极子处组合的方式，并允许确定raid的方位。(当测角仪设置与raid的方位对齐时，轨迹中的倾角最小。)</p><p id="03f5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在这个月末迎来了一个大事件。随着一个用SVG制作的、可以用鼠标拖动的角度计的加入，UI开始成形。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ms"><img src="../Images/cccfd85ad75be1196707028e21a3aae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mekHOvgvXwfv5kWrjdDz_A.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">基本测角仪控制</figcaption></figure><p id="5192" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感觉从这里应该都是下坡路了。还是路途会有坎坷？</p><h2 id="8c28" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">2020年2月—第二个月</h2><p id="db46" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">现在我们已经有了一个UI的雏形，并且我们知道如何与之交互，拥有一个raid类型的菜单会很有用。两个原因。第一，我们可以测试不同的回声组合。第二，我们需要为最终用户提供一些选择。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ms"><img src="../Images/7a1d1e342ef247099598919ba4dff0d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSN3xblnsciebzEB91rxjg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">UI的元素出现了</figcaption></figure><p id="64c3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到目前为止，我们的“观点”仍然很简单:</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="fe5a" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">view : Model -&gt; Html Msg<br/>view m = <br/>  div [] <br/>  [ <br/>  --  showGonio m<br/>  --, Html.br [] []<br/>    Html.text "Emulation of Chain Home RDF receiver by Pete Ward"<br/>  , targetSelector m.activeConfigurations<br/>  , clickableGonioImageStyles m<br/>  , crt m <br/>  , div [] (debugInfo m)<br/>  ]</em></span></pre><p id="13b7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在需要考虑一个问题。随着事态的发展，我们将如何控制布局？我们会支持不同的设备格式吗？颜色怎么样？我们要手工制作HTML和CSS吗？</p><p id="89c2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">碰巧的是，Elm社区对此有一个答案——Elm-ui包。它提供了一个声明性的表单，用于定义与Elm应用程序架构完美契合的布局，隐藏了大部分CSS(但在您需要时提供访问)，并创建了超快速的呈现(与虚拟DOM和diffing有关，对此我不需要担心)。</p><p id="7c57" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这正合我的口味。没有太多要切换的，切换也不难(反正你可以只包装HTML元素)，所以到了4号，我们现在的观点是:</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="2b8c" class="kk kl hi ll b fi lp lq l lr ls"><em class="kj">view : Model -&gt; Browser.Document Msg<br/>view model =<br/>    { title = "VisExp"<br/>    , body =<br/>        [ layout [] &lt;|<br/>            column [ width fill, spacingXY 0 20 ]<br/>                [ navBar<br/>                , inputPage model<br/>                ]<br/>        ]<br/>    }</em></span></pre><p id="2699" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到了这个想法column函数将在编译时生成CSS样式。我只需要把布局想象成嵌套的行和列，这对这个项目来说很好。CH接收器很难称得上是UI设计的典范；它们由不同的制造商以组件的形式建造，并在现场栓接在一起。在某些情况下，前面板后面还有细绳和橡皮筋。</p><p id="083f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这现在看起来像什么？</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mt"><img src="../Images/0f2ebca1fe0e5b6b7220aa9f0d92a480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxQJ2-35O08tOeVVQvTV-Q.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">样式，不处理CSS</figcaption></figure><h2 id="e3a7" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">2月9日——它长大了</h2><p id="6f97" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">有了一个简单但有效的框架，UI开始开发更有说服力的外观和操作。我们在CRT的顶部有一个范围滑块和一些谢妮管来显示范围和方位设置。(这些是时代错误，将被删除，但它们相当可爱。)</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mu"><img src="../Images/293a1e979ca5080ad789e50438e5493c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LFMtvxkXzzHebwIe0VAKqg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">SVG控件和CRT，带可爱的数码管读数</figcaption></figure><p id="691b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意力暂时回到领域模型，现在UI方法已经确定了。那个时期的训练视频强调“跳动”信号的重要性。这意味着来自相同距离目标的回波会干扰可识别的模式。它们以几秒钟的规则时间尺度“跳动”(增长和减少)。如果转动测角仪，它们都消失了，那就是两个目标在方位上靠得很近。如果跳动停止，但稳定的信号仍然存在，他们是在不同的轴承之一，你刚刚发现。</p><p id="cf5e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，对于这个模拟器来说，复制“跳动”效果是很重要的。但是是什么导致了这种情况，我们是把它嵌入到我们的数学中，还是我们作弊了。我曾希望变化的信号相位将是足够的，他们几乎是，但没有区分这两个完全不同的场景。据我所知，建模并不简单；反思的过程是一种简化。正如我们之前提到的，无线电波被目标吸收，建立了某种共振，并出现了返回信号。由于“复杂的量子物质”,这两个目标并不是独立的，即使是分开的。任何物理学家都会告诉你，能量量子不会直线传播并反弹回来。啊啊。实际上，它们采用了源(雷达站)和目的地(雷达站)之间的每一条可能的路径。<strong class="iz hj">然后</strong>他们结合。</p><h2 id="6258" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">2月16日，介绍一个小骗局</h2><p id="1f4a" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">所以…他们可以在飞机之间跳跃，离开大海，离开天空，绕过公共汽车站，穿过药店，请穿过二十个罗斯曼，然后再回家。是的，我们要作弊一下。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="80f5" class="kk kl hi ll b fi lp lq l lr ls"><strong class="ll hj">combineEchoes</strong><em class="kj"> : </em><strong class="ll hj">Int</strong><em class="kj"> -&gt; </em><strong class="ll hj">List Echo</strong><em class="kj"> -&gt; </em><strong class="ll hj">Float<br/>combineEchoes</strong><em class="kj"> time activeEchoes =<br/>    -- Treat amplitude and phase as vector, sum components, convert back, use amplitude.<br/>    let<br/>        </em><strong class="ll hj">asRect</strong><em class="kj"> =<br/>            List.map<br/>                (\e -&gt;<br/>                    fromPolar<br/>                        ( e.amplitude<br/>                        , toFloat e.sequence * 2 * pi * (toFloat &lt;| modBy 2000 time) / 2000<br/>                        )<br/>                )<br/>                activeEchoes<br/><br/>        </em><strong class="ll hj">combinedAsRect</strong><em class="kj"> =<br/>            List.foldl <br/>             (\( x, y ) ( xAcc, yAcc ) -&gt; ( x + xAcc, y + yAcc )) <br/>             ( 0.0, 0.0 ) <br/>             asRect<br/><br/>        ( </em><strong class="ll hj">mag</strong><em class="kj">, </em><strong class="ll hj">phase</strong><em class="kj"> ) =<br/>            toPolar combinedAsRect<br/>    in<br/>    mag</em></span></pre><p id="7747" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du mv mw mx ll b">e.sequence</code>以特定频率的变化信号的形式给每个目标一个独特的信号。这在视觉上模仿了我们所寻求的跳动效果。几乎可以肯定的是，当时的一名操作员会指出这是错误的。可悲的是，尽管从某种意义上说我们是幸运的，但很少有人还能对此发表评论。</p><p id="611d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里有许多增量开发，因为新的按钮被添加到UI中来控制tarsnsitter和receiver的不同方面。这主要是关于以不同的组合来组合发射机和接收机波瓣函数。操作员可以切换天线，启用反射器，在方位和高度模式之间切换。这些都没有给我们提供任何见解，主要是与产品负责人的持续对话(是的，又是W夫人，作为常驻专家)。</p><h2 id="1ac6" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">2020年3月</h2><p id="77f9" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">三月，空气中弥漫着春天的气息，一些有趣的变化正在发生。老实说，细节很难回忆起来，笔记中也没有什么帮助，但有一段时间我觉得SVG行太临床了。我们需要注入更多的电路噪声。这受到实际镜头的影响。噪声和抖动的数量是相当大的，这使得(大部分)WAAF操作员能够提取任何有用的信息更加令人印象深刻。</p><p id="9c11" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们推断，WebGL有一些改动，因为突然在3月7日，有一个新的CRT模块，CRT_WebGL。它有一个顶点着色器，复制了我们的SVG绘制函数的功能，一个最小片段着色器，和一些分形噪声。</p><p id="edf5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除了它的存在，我对OpenGL和它的表亲WebGL一无所知。它将图形渲染卸载到GPU。为了实现这一点，可以用c语言编写“着色器”。有两种着色器:顶点着色器和片段着色器。两者都指三角形网格。顶点着色器替换三角形的顶点并给它们分配颜色；片段着色器定义了三角形上任意点的颜色，也正是它定义了图像中任意像素的颜色。</p><p id="146e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我的第一个WebGL模仿了SVG的操作。我们想象这条线由成百上千个三角形组成。我们将顶点垂直偏移以反映信号强度，并将三角形着色以模仿CRT光束形状。</p><p id="0ac6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你用Elm，写一个着色器有多难？不算太坏。你不能避免学习GL着色器语言(GLSL ),但是你可以非常灵活地将它嵌入Elm。</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="773b" class="kk kl hi ll b fi lp lq l lr ls"><strong class="ll hj">vertexShader</strong><em class="kj"> : </em><strong class="ll hj">WebGL.Shader Vertex Uniforms</strong><em class="kj"> { vcolor : </em><strong class="ll hj">Vec3</strong><em class="kj">, stretch : </em><strong class="ll hj">Float</strong><em class="kj"> }<br/></em><strong class="ll hj">vertexShader</strong><em class="kj"> =<br/>    {-<br/>       Our vertex shader will have special cases <br/>       built in to give convincing trace patterns<br/>       for our supported formations. We will not <br/>       support variable numbers of raids, as Elm<br/>       does not support array Uniforms, so we will <br/>       some presets that we<br/>       basically turn on and off, just by setting zero amplitude.<br/>       Hence the vertex shader is long and inelegant. <br/>       It is what it is.<br/>    -}<br/>    [glsl|<br/>        attribute vec3 position;<br/>        attribute vec3 color;<br/>...<br/>            gl_Position = <br/>                perspective * camera * rotation * vec4(newPos, 1.0);<br/>            vcolor = color;<br/>            stretch = abs(stretch);<br/>        }<br/>  |]</em></span></pre><p id="bc2d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">退一步说，也有缺点。没有可变大小的数组，所以我们必须决定可以传入多少次raids。最糟糕是没有从WebGL获取编译消息的途径。所以如果你不小心写了类似<code class="du mv mw mx ll b">float x = 0</code>的东西，你得到的只是一个黑屏；因为需要<code class="du mv mw mx ll b">float x = 0.0</code>。</p><p id="942b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">值得吗？是的，它是。我们可以在信号中加入噪声，SVG肯定不会处理这种情况。结合我们其他的UI添加和改进，我们现在有了一个非常合适的接收器模型。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es my"><img src="../Images/ddb92078515f3176e96e8b88adff99e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZhJH9q7AzQWPmlYvHgw7PA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">使用WebGL为CRT更新了用户界面</figcaption></figure><h2 id="8fe3" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">3月10日—电子计算器</h2><p id="b51e" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们把注意力集中在接收器面板上，操作员通过操纵几个旋钮和开关，并仔细研究CRT，试图确定来袭(或实际上是来袭)突袭的位置。这些信息是如何呈现的，以便能够传递给战斗机控制？</p><p id="7040" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个问题的答案，就像这个领域的任何事情一样，各不相同。英国战役前后，电子计算器的使用是一个典型的例子。这是一种硬连线的模拟设备，类似于类固醇上的惠斯通电桥，它从操作员输入中获取值，并将它们转换为地图位置和高度读数。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es my"><img src="../Images/d328cb41b8c7666262e0954a6cee58aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NW96VNWkJ8iZvuDIMOWX0A.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">电子计算器面板</figcaption></figure><p id="e47d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该显示指定一次突袭在方格N，东26，北56，高度30000英尺，预计强度3。</p><h2 id="73a4" class="kk kl hi bd km kn ko kp kq kr ks kt ku jg kv kw kx jk ky kz la jo lb lc ld le bi translated">夏天——精炼，精炼，精炼</h2><p id="3e65" class="pw-post-body-paragraph ix iy hi iz b ja lf ij jc jd lg im jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们将快速浏览CH接收器的剩余故事，因为没有什么新内容要添加。嗯，有一个完整的教程模式，屏幕上的帮助，许多错误修复和角度仪在通过+180/-180边界时不断出现的问题。我好像在纠结角度。</p><p id="8b80" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事实上，我们从git日志中看到，使教程变得强大需要我们在三月底，那时我们有一个关于页面，五个教程和三个游戏模式，计算器和一个模拟在操作室中看到的地图视图(但也显示了突袭的真实位置)。</p><p id="6d70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">四月将增加更多的帮助文本，然后在夏天:支持肖像模式，iPads上的触摸支持，以及无人值守的信息亭模式。</p><p id="7ce9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">没有什么值得注意的，直到9月27日，突然出现了一个WebGL的替代实现。这里的信息是，我们不会停止尝试简化和改进，只是因为我们发现了一些有用的东西，即使它足够有用。我一直在浏览其他着色器，有一些相似之处，并有一些示波器仿真。令我震惊的是，他们只用一个片段着色器；他们不会建立一个网。屏幕只是一个(x，y)坐标的数组。着色器最好被想象为一个进程，它为屏幕上的每个像素并行运行，并根据x、y和时间计算要显示的颜色。</p><p id="d08c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对我来说，这是一个令人兴奋的时刻，整个着色器足够短，可以在这里复制:</p><pre class="ju jv jw jx fd lk ll lm ln aw lo bi"><span id="19b1" class="kk kl hi ll b fi lp lq l lr ls"><strong class="ll hj">fragmentShader</strong><em class="kj"> : </em><strong class="ll hj">WebGL.Shader</strong><em class="kj"> {} </em><strong class="ll hj">Uniforms</strong><em class="kj"> { vFragCoord : </em><strong class="ll hj">Vec2</strong><em class="kj"> }<br/></em><strong class="ll hj">fragmentShader</strong><em class="kj"> =<br/>    [glsl|<br/>        precision mediump float;<br/><br/>        varying vec2 vFragCoord;<br/>        uniform vec3 iResolution;<br/>        uniform float iTime;<br/>        uniform int numRaids;<br/>        uniform vec3 raid0;<br/>        uniform vec3 raid1;<br/>        uniform vec3 raid2;<br/>        uniform vec3 raid3;<br/>        uniform vec3 raid4;<br/>        uniform vec3 raid5;<br/>        uniform vec3 raid6;<br/>        uniform vec3 raid7;<br/>        uniform vec3 raid8;<br/>        uniform vec3 raid9;<br/>        uniform vec3 raid10;<br/>        uniform vec3 raid11;<br/>        uniform vec3 raid12;<br/>        uniform vec3 raid13;<br/>        uniform vec3 raid14;<br/>        uniform vec3 raid15;<br/><br/>        vec3 COL1 = vec3(1.0,0.0,0.0);<br/>        vec3 COL2 = vec3(0.0,1.0,0.0);<br/><br/>        float cubicPulse( float c, float w, float x ) {<br/>            x = abs(x - c); // NOTE 0 &lt;= x &lt;= +w<br/>            if (x &gt; w) return 0.0;<br/>            x /= w; // 0 &lt;= x &lt;= +1 (width is actually 2w)<br/>            return 1.0 - x * x * (3.0 - 2.0 * x);<br/>        }<br/><br/>        void mainImage( out vec4 fragColor, in vec2 fragCoord )<br/>        {<br/>            vec2 uv = fragCoord.xy/iResolution.xy;<br/>            vec2 uvn = 2.0 * uv - 1.0;<br/><br/>            // Think of this as a single target "field"<br/>            float f1 = -3.0;<br/><br/>            // A "two plane" field<br/>            float f2 = f1 - (3.0 * sin(iTime * 3.0));<br/><br/>            // Think of this as a mass raid "field".<br/>            float mrf = f1 + f2 - 6.0;<br/>            mrf += 2.0 * sin(uv.x * 256.0 + 0.0) * sin(iTime * 8.0);<br/>            mrf += 2.0 * sin(uv.x * 128.0 + 0.0) * sin(iTime * 6.0);<br/>            mrf += 2.0 * sin(uv.x * 128.0 + 0.5) * sin(iTime * 5.0);<br/>            mrf += 1.0 * sin(uv.x * 64.0 + 0.1) * sin(iTime * 4.0);<br/>            mrf += 1.0 * sin(uv.x * 32.0 + 0.2) * sin(iTime * 3.0);<br/>            mrf /= 2.0;<br/><br/>            // Add a noise field (use our existing one).<br/>            // Lower the resolution of the x line to make <br/>            // the noise less noisy.<br/>            // add time to the noise parameters so it's animated.<br/>            // I want a component that is more 'spikey'.<br/>            float noise = 0.0;<br/>            noise += sin(uv.x * 256.0 + 0.0) * sin(iTime * 7.0);<br/>            noise += sin(uv.x * 512.0 + 0.0) * sin(iTime * 5.0);<br/>            noise += sin(uv.x * 1024.0 + 0.0) * sin(iTime * 11.0);<br/>            noise /= 8.0;<br/><br/>            // Spikey looking noise.<br/>            float lumpy = 0.0;<br/>            lumpy += sin(uv.x * 256.0);<br/>            lumpy = 0.0 - float(lumpy &lt; -0.8);<br/>            float lumpyTime = 0.0;<br/>            lumpyTime += sin(iTime * 11.0) + sin(iTime * 19.0);<br/>            lumpyTime = float(lumpyTime &gt; 1.9);<br/><br/>            float sawtooth = 0.0;<br/>            sawtooth = abs(0.5 - fract(uv.x * 20.0));<br/>            float bumps = 5.0 * lumpy * lumpyTime * sawtooth;<br/><br/>            // Now expose a section of the field where we have raids.<br/>            // Note pulse width sqrt(N)/100 looks ok.<br/>            float raid1 = f1 * cubicPulse(0.15, 0.01, uv.x); <br/>            float raid2 = f2 * cubicPulse(0.3, 0.014142, uv.x);  <br/>            float raid3 = mrf * cubicPulse(0.5, 0.0200, uv.x); <br/>            float raid4 = mrf * cubicPulse(0.7, 0.1000, uv.x); <br/><br/>            float beamY = bumps + noise + raid1 + raid1 + raid2 + raid3 + raid4;<br/><br/>            // Fiddle with coordinate (needs some work).<br/>            beamY = beamY/50.0 + 0.9;<br/><br/>            //create the beam by simple y distance that falls off quickly. (? smoothstep ?)<br/>            float i = pow(1.0 - abs(uv.y - beamY), 20.0);<br/>            //float i = cubicPulse(beamY, 0.04, uv.y);<br/><br/>            vec3 col = vec3(i) * mix(COL1,COL2,i);<br/><br/>            fragColor = vec4(col,1.0);<br/>        }<br/><br/>        void main() {<br/>          mainImage(gl_FragColor, vFragCoord);<br/>        }<br/><br/>  |]</em></span></pre><p id="2e9c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这大约是前一个顶点着色器线计数的40%,并且输出更加丰富。它会发光。(忽略范围刻度的位置，这很容易解决。)</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mz"><img src="../Images/8cbd2dc2b035610b595d6dfcecfcea23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g36xovSEQFKv3X16pBYw2A.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">华丽的发光与新的片段着色器</figcaption></figure><p id="7992" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终提交记录在10月6日。这断断续续花了九个月的时间。在Elm开发web应用程序的过程中，我们学到了什么，特别是这个？</p><p id="9cca" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">好事</strong></p><blockquote class="lv lw lx"><p id="f68f" class="ix iy kj iz b ja jb ij jc jd je im jf ly jh ji jj lz jl jm jn ma jp jq jr js hb bi translated">强类型避免了许多错误，并且错误消息是极好的。编译真的很快，出来的代码也很快。<br/> elm-ui让布局变得轻而易举。<br/>从一开始就使用git是一个好的举措，即使我有时会搞砸。</p></blockquote><p id="7b9c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">坏事</strong></p><blockquote class="lv lw lx"><p id="6f79" class="ix iy kj iz b ja jb ij jc jd je im jf ly jh ji jj lz jl jm jn ma jp jq jr js hb bi translated">知道如何构造代码很难，拥有一个千行主模块很容易。</p></blockquote><p id="25a2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">更多好东西</strong></p><blockquote class="lv lw lx"><p id="ab1f" class="ix iy kj iz b ja jb ij jc jd je im jf ly jh ji jj lz jl jm jn ma jp jq jr js hb bi translated">带有Elm插件的JetBrains IDEA是一种乐趣。<br/>你有1000线主模块也没关系。WebGL没有你想象的那么可怕。只是有点吓人。</p></blockquote><p id="a476" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们最后看一下我们的交付成果:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es na"><img src="../Images/1ceba9d79c543bec59383aaca084f44d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q838Ofbz_qzCLB2W7jBUaw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">最终用户界面，显示解释性覆盖</figcaption></figure><p id="2850" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了这个经验，接下来会发生什么呢？</p></div></div>    
</body>
</html>