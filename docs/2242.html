<html>
<head>
<title>An opinionated Kotlin backend service - Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">固执己见的 Kotlin 后端服务框架</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/an-opinionated-kotlin-backend-service-part-1-87f814e3dffd?source=collection_archive---------0-----------------------#2021-04-28">https://medium.com/nerd-for-tech/an-opinionated-kotlin-backend-service-part-1-87f814e3dffd?source=collection_archive---------0-----------------------#2021-04-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/300f0b8cd58ec4037f925b8035508ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1h-kFjn29wFvSdVb.jpg"/></div></div></figure><h1 id="1960" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">TL；DR；</h1><p id="6337" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">本系列文章解释了基于 Kotlin / Ktor 的后端服务的搭建。它阐述了以下主题:</p><ul class=""><li id="277d" class="km kn hi jq b jr ko jv kp jz kq kd kr kh ks kl kt ku kv kw bi translated"><a class="ae kx" rel="noopener" href="/p/87f814e3dffd">固执己见的科特林后端服务框架</a></li><li id="c0cd" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" rel="noopener" href="/p/480ab5e6cdb2">固执己见的科特林后端服务——构建&amp;部署</a></li><li id="b787" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" rel="noopener" href="/p/1e4b02aa6245">固执己见的 Kotlin 后端服务——API 路由和文档</a> <br/> + <a class="ae kx" rel="noopener" href="/p/d57879ec5ab0">使用 Ktor 生成 open API</a>+<br/>+<a class="ae kx" rel="noopener" href="/p/c7e02b5dabc">在 Ktor/Kotlin </a> <br/> + <a class="ae kx" rel="noopener" href="/p/feae3d06eadb">在 Ktor 中进行 JSON 序列化</a></li><li id="955e" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" rel="noopener" href="/p/52527ce3228">固执己见的 Kotlin 后端服务——数据库/迁移/ ORM </a></li><li id="528a" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated">待写:<a class="ae kx" rel="noopener" href="/p/87f814e3dffd">一个固执己见的 Kotlin 后端服务测试</a></li></ul><h2 id="3ab5" class="ld ir hi bd is le lf lg iw lh li lj ja jz lk ll je kd lm ln ji kh lo lp jm lq bi translated">快速启动</h2><ul class=""><li id="16ea" class="km kn hi jq b jr js jv jw jz lr kd ls kh lt kl kt ku kv kw bi translated">克隆<a class="ae kx" href="https://github.com/1gravity/Ktor-Template" rel="noopener ugc nofollow" target="_blank">回购</a></li><li id="b7d1" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated">cd 进入<em class="lu"> Ktor-Template </em></li><li id="e9b8" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated">运行<code class="du lv lw lx ly b">docker-compose up</code>(或<code class="du lv lw lx ly b">sudo docker-compose up</code>)</li><li id="67e4" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated">打开<a class="ae kx" href="http://localhost:2000" rel="noopener ugc nofollow" target="_blank"> http://localhost:2000 </a></li></ul><p id="5cdb" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">您应该看到 OpenAPI 文档:</p><figure class="md me mf mg fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/084b7bf70ccbfe94fc08ccc2ce540ffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*ZyLmoFbpLMX1aqJRAuvRBQ.png"/></div></figure><p id="10d3" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">或者打开:<a class="ae kx" href="https://ktor-template-app.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://ktor-template-app.herokuapp.com</a>那里的应用程序也在运行。</p><h1 id="c5c6" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">间奏曲</h1><p id="b366" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在深入研究技术细节之前，我想谈谈我的研究背后的动机，以及我正在寻找的技术堆栈的要求。</p><h2 id="50d8" class="ld ir hi bd is le lf lg iw lh li lj ja jz lk ll je kd lm ln ji kh lo lp jm lq bi translated">动机</h2><p id="f9be" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我喜欢新技术。新技术通常比旧技术更好。它让我创建更少的错误，更健壮，更安全，更易维护，更易改变，更快等等。软件以及所有代码行更少的东西。</p><p id="55e6" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">人们可能不同意，有一篇关于绿色和棕色编程语言的好文章让我想到了这里的<a class="ae kx" href="https://earthly.dev/blog/brown-green-language" rel="noopener ugc nofollow" target="_blank"/>。我将在系列文章的最后回到那篇文章。</p><h2 id="f078" class="ld ir hi bd is le lf lg iw lh li lj ja jz lk ll je kd lm ln ji kh lo lp jm lq bi translated">要求</h2><p id="1f1b" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">作为一名软件架构师，我使用<a class="ae kx" href="https://iso25000.com/index.php/en/iso-25000-standards/iso-25010" rel="noopener ugc nofollow" target="_blank"> ISO 25010 软件质量模型</a>来定义一个组件需要具备的重要质量特征。</p><figure class="md me mf mg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/008579c1fb51796851f9b2d98c378f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fgFMZXjaoFei4tBb"/></div></div></figure><p id="5411" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">在我的情况下，我想要(按优先顺序):</p><ol class=""><li id="d707" class="km kn hi jq b jr ko jv kp jz kq kd kr kh ks kl mi ku kv kw bi translated"><strong class="jq hj">可维护性:</strong>模块化软件，易于分解，遵循单一责任原则，关注点分离，可测试</li><li id="23a1" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl mi ku kv kw bi translated"><strong class="jq hj">可移植性:</strong>不受运行时/部署环境的限制，可在内部或任何云计算提供商处部署，可容器化，无供应商限制，尽可能开源</li><li id="19a8" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl mi ku kv kw bi translated"><strong class="jq hj">可靠性:</strong>生产就绪型技术，健壮，故障恢复能力强，高可用性</li></ol><p id="9c4d" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">带着这些需求，我开始研究后端框架的巨大市场。在本系列文章的最后，我将回到上面的需求，并讨论我可以勾选哪些框。</p><h1 id="19a4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">后端框架</h1><p id="9115" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我使用不同的语言研究了不同的技术栈，阅读了大量的资料，还用一些最流行的框架(Spring Boot，Node.js)进行了测试，但最终决定走一条新的路线。我想使用一种可维护且使用起来有趣的语言，对我来说，与 Go、Swift 或 Kotlin 等语言相比，Java、JavaScript/TypeScript 或 Ruby 都不是很有吸引力。以我作为 Android 开发人员的背景，Kotlin 是显而易见的选择。</p><p id="e095" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">即使范围缩小到 Kotlin 框架，仍然有很多选择:</p><ul class=""><li id="e98a" class="km kn hi jq b jr ko jv kp jz kq kd kr kh ks kl kt ku kv kw bi translated"><a class="ae kx" href="https://spring.io/projects/spring-boot" rel="noopener ugc nofollow" target="_blank">春天(开机)</a></li><li id="a357" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" href="https://vertx.io/docs/vertx-core/kotlin/" rel="noopener ugc nofollow" target="_blank">科特林的垂直 x 轴</a></li><li id="7368" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" href="https://javalin.io/" rel="noopener ugc nofollow" target="_blank">爪哇林</a></li><li id="d6f0" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" href="https://www.http4k.org/" rel="noopener ugc nofollow" target="_blank"> http4k </a></li><li id="8f84" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated"><a class="ae kx" href="https://ktor.io/" rel="noopener ugc nofollow" target="_blank"> Ktor </a></li></ul><p id="cc14" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">还有更多…</p><figure class="md me mf mg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/b11ea8894ce34777fc169de0778ebedd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kTYd4TqoENmxeLkWadLQjw.png"/></div></div></figure><p id="cb1b" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">来源:<a class="ae kx" href="https://resources.jetbrains.com/storage/products/kotlinconf2018/slides/1_Komparing%20Kotlin%20Server-Side%20Frameworks.pdf" rel="noopener ugc nofollow" target="_blank"> Kotlin 服务器端框架</a></p><h2 id="d50c" class="ld ir hi bd is le lf lg iw lh li lj ja jz lk ll je kd lm ln ji kh lo lp jm lq bi translated"><a class="ae kx" href="https://spring.io/projects/spring-boot" rel="noopener ugc nofollow" target="_blank">弹簧(靴子)</a></h2><p id="eeff" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Spring Boot 很容易被淘汰。它是在考虑 Java 的情况下制作的，这体现在冗长和配置对代码的使用上(无尽的注释……)。感觉很难读(很难维护)，沉重(冗长)而且找不到更好的词…旧:</p><figure class="md me mf mg fd ij"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="3a5e" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">与 Ktor 应用程序的优雅和简洁相比:</p><figure class="md me mf mg fd ij"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h2 id="1990" class="ld ir hi bd is le lf lg iw lh li lj ja jz lk ll je kd lm ln ji kh lo lp jm lq bi translated"><a class="ae kx" href="https://vertx.io/docs/vertx-core/kotlin/" rel="noopener ugc nofollow" target="_blank">垂直 x 轴</a></h2><p id="e671" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我喜欢编写反应式应用程序(我曾经是 RxJava 的超级粉丝)，我的一个副业是构建一个反应式后端堆栈(一直到数据库)。</p><p id="7db7" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">为了<em class="lu">这个</em>研究的目的，我决定不将反应式编程的复杂性添加到其他所有事情之上(我认为反应式编程的复杂性源于我的大脑更习惯于命令式编程的事实，但这对于大多数软件工程师来说可能是真实的- &gt;可维护性需求)。</p><p id="0752" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">无论如何，我决定放弃 Vert.x，但一旦我着手我的反应式后端堆栈“项目”,它肯定会是一个热门的竞争者。</p><h2 id="3430" class="ld ir hi bd is le lf lg iw lh li lj ja jz lk ll je kd lm ln ji kh lo lp jm lq bi translated"><a class="ae kx" href="https://javalin.io/" rel="noopener ugc nofollow" target="_blank">爪哇林</a>，<a class="ae kx" href="https://www.http4k.org/" rel="noopener ugc nofollow" target="_blank"> http4k </a>，<a class="ae kx" href="https://ktor.io/" rel="noopener ugc nofollow" target="_blank"> Ktor </a></h2><p id="14b7" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">老实说，我没有用 Javalin 或 http4k 做深入的测试。我决定使用 Ktor 主要是基于这样一个事实，即它是由 Kotlin 发明者创建的框架，希望这意味着它将获得一些牵引力，不会很快消失。Github 上的流行似乎支持了这一希望(截至 2011 年 4 月 29 日):</p><ul class=""><li id="bde7" class="km kn hi jq b jr ko jv kp jz kq kd kr kh ks kl kt ku kv kw bi translated">http4k: 29 个守望者，1.7k 星，156 叉</li><li id="eb95" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated">贾瓦林:106 个守望者，4.7k 星，411 个分叉</li><li id="2b3f" class="km kn hi jq b jr ky jv kz jz la kd lb kh lc kl kt ku kv kw bi translated">Ktor: 175 守望者，82k 星，675 叉</li></ul><p id="6088" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">我喜欢 Javalin 的一个特性是它的<a class="ae kx" href="https://javalin.io/plugins/openapi#openapioptions" rel="noopener ugc nofollow" target="_blank"> OpenAPI 生成器</a>。为了用 Ktor 获得 OpenAPI 文档，我不得不跳过一些关卡(见这里的<a class="ae kx" rel="noopener" href="/nerd-for-tech/openapi-generation-with-ktor-d57879ec5ab0"/>)。</p><p id="0ce6" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">在选定了作为后端框架的<strong class="jq hj"> Ktor 之后，</strong>我的第一步是构建和部署并运行，这就引出了本系列的第二篇文章:<a class="ae kx" rel="noopener" href="/p/480ab5e6cdb2">一个固执己见的 Kotlin 后端服务——构建&amp;部署</a>。</p><p id="a2d4" class="pw-post-body-paragraph jo jp hi jq b jr ko jt ju jv kp jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl hb bi translated">感谢您阅读本文，并像往常一样随时提供反馈。编码快乐！</p><h1 id="4b51" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">类似文章</h1><div class="mm mn ez fb mo mp"><a rel="noopener follow" target="_blank" href="/swlh/architecture-proposal-to-build-servers-with-ktor-1069bfaf2926"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">使用 Ktor 构建服务器的架构提案</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">本文的目的是展示如何创建一个具有清晰和可测试架构的 Ktor 服务器。</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd io mp"/></div></div></a></div><div class="mm mn ez fb mo mp"><a rel="noopener follow" target="_blank" href="/swlh/how-to-deploy-a-ktor-server-using-docker-dd01f4883c30"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">如何使用 Docker 部署 Ktor 服务器</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">关于如何使用 Docker &amp; Docker compose 部署 Ktor 服务器的完整描述。</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">medium.com</p></div></div><div class="my l"><div class="ne l na nb nc my nd io mp"/></div></div></a></div><div class="mm mn ez fb mo mp"><a href="https://github.com/mathias21/KtorEasy" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">mathias21/KtorEasy</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">这是一个展示建议的 Ktor 架构的项目。它包括与 Ktor，MariaDB 的后端实现…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="nf l na nb nc my nd io mp"/></div></div></a></div></div></div>    
</body>
</html>