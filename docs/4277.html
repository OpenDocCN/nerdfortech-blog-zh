<html>
<head>
<title>The Open Movie Database(OMDb) for fetching movie data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于获取电影数据的开放式电影数据库(OMDb)</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/the-open-movie-database-omdb-for-fetch-movie-data-bc5ff46bec8?source=collection_archive---------1-----------------------#2021-07-14">https://medium.com/nerd-for-tech/the-open-movie-database-omdb-for-fetch-movie-data-bc5ff46bec8?source=collection_archive---------1-----------------------#2021-07-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a9e7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">为互联网电影数据库(IMDB)/OMDB制作自己的门户网站</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/14ea877866e8ee4d743daba304fda11c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9f1rsJfzfCDvLoIUVC2aVw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">从IMDb获取电影数据的角度应用程序</figcaption></figure><p id="acd0" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">虽然IMDb是所有电影信息的权威来源，但他们没有公共API。因此，为了检索电影信息，我们可以使用关于电影的开放数据库，例如<a class="ae kj" href="http://www.omdbapi.com/" rel="noopener ugc nofollow" target="_blank">开放电影数据库</a> (OMDB)。本文是关于为OMDb创建自己的门户。OMDB API是一个RESTful web服务，用于检索电影或连续剧信息(标题、情节、演员、年份、海报等)。让我们通过使用第三方API实现一个获取远程服务器响应的应用程序来测试知识。使用Angular的HttpClientModule进行HTTP调用，并使用RxJS库来控制用户在与服务器通信时对服务器API的点击，从而限制网络资源。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="8c87" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">Angular入门</h1><p id="defe" class="pw-post-body-paragraph jn jo hi jp b jq lj ij js jt lk im jv jw ll jy jz ka lm kc kd ke ln kg kh ki hb bi translated">首先运行<code class="du lo lp lq lr b">npm</code>命令设置angular CLI，如下所示:</p><pre class="iy iz ja jb fd ls lr lt lu aw lv bi"><span id="77f2" class="lw ks hi lr b fi lx ly l lz ma">$ npm install -g @angular/cli</span></pre><p id="f5ca" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后在angular的最新版本中，通过执行如下的<code class="du lo lp lq lr b">ng</code>命令创建一个Angular项目。示例项目是使用版本12.0.2的<a class="ae kj" href="https://github.com/angular/angular-cli" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>生成的。</p><pre class="iy iz ja jb fd ls lr lt lu aw lv bi"><span id="2605" class="lw ks hi lr b fi lx ly l lz ma">$ ng new potal<br/>$ cd potal</span></pre><h1 id="9c97" class="kr ks hi bd kt ku mb kw kx ky mc la lb io md ip ld ir me is lf iu mf iv lh li bi translated">从OMDB API web服务获取数据</h1><p id="6c3d" class="pw-post-body-paragraph jn jo hi jp b jq lj ij js jt lk im jv jw ll jy jz ka lm kc kd ke ln kg kh ki hb bi translated">首先，获取您的OMDb API密钥。为此，你必须在他们的网站上注册。如果你还没有，在http://www.omdbapi.com/apikey.aspx注册一个账户。您将收到一个包含API密钥的验证链接。单击链接将其激活。就是这样！您现在可以访问OMDb API了。</p><p id="c2ef" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">接下来，创建您的OMDb/IMDb API请求URL。我们可以按照<a class="ae kj" href="https://www.omdbapi.com" rel="noopener ugc nofollow" target="_blank"> OMDb API文档</a>来搜索关于电影的信息。将API根和查询字符串放在一起，我们可以获得完整的API请求URL。</p><p id="bc2a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du lo lp lq lr b">http://www.omdbapi.com/?apikey=[YOUR_KEY]&amp;</code></p><p id="b69e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">只要代入你自己的API键，你就可以搜索字符串。</p><p id="f042" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">对于每个JSON项，API返回:</p><ul class=""><li id="f84d" class="mg mh hi jp b jq jr jt ju jw mi ka mj ke mk ki ml mm mn mo bi translated">标题</li><li id="6467" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">发布年份</li><li id="eb01" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">IMDb身份证</li><li id="244a" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">类型(电影、连续剧或剧集)</li><li id="e8b4" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">电影海报图像</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mu"><img src="../Images/2e2ac09c95b55abb6347a07850c40ca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZvtLqTBVvHHGydCvmiByw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">chrome中搜索字符串的JSON响应</figcaption></figure><p id="2eef" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里可以使用<a class="ae kj" href="http://www.omdbapi.com/" rel="noopener ugc nofollow" target="_blank"> OMDb API </a>来获取匹配搜索查询(JSON)的前10个结果。</p><p id="5a63" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">更新App组件</strong>:</p><p id="25e4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">替换<strong class="jp hj">app.component.html</strong>文件中的以下HTML。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="da2a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了进行搜索，输入字段控件与模板变量<code class="du lo lp lq lr b">#movieSearchInput </code>一起使用，以使用RxJs <code class="du lo lp lq lr b">fromEvent</code>方法绑定keyUp事件。Angular <code class="du lo lp lq lr b">*ngFor</code>指令迭代搜索电影列表，并为每部电影创建angular material卡片。<code class="du lo lp lq lr b">"Searching..."</code>消息由<code class="du lo lp lq lr b">isSearching</code>布尔标志显示，指示API命中进度。</p><p id="fb42" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">用下面的代码更新<strong class="jp hj"> app.component.ts </strong>文件。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="7afc" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du lo lp lq lr b">@ViewChild</code> decorator使用类型为<code class="du lo lp lq lr b">ElementRef</code>的输入控件上的模板变量<code class="du lo lp lq lr b">#movieSearchInput</code>获取引用。由于我们将在<code class="du lo lp lq lr b">ngOnInit()</code>组件挂钩中绑定事件，因此<code class="du lo lp lq lr b">@ViewChild</code>将设置<code class="du lo lp lq lr b">{static:true}</code>。</p><p id="cad8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在输入控制上，使用RxJS的<code class="du lo lp lq lr b">fromEvent</code>方法绑定<code class="du lo lp lq lr b">keyUp</code>事件。<code class="du lo lp lq lr b">pipe()</code>仅当输入值的长度超过2时，使用<code class="du lo lp lq lr b"><strong class="jp hj">filter()</strong></code>触发事件，使用<code class="du lo lp lq lr b"><strong class="jp hj">debounceTime()</strong></code>管理用户停止键入前按键事件之间的时间，使用<code class="du lo lp lq lr b"><strong class="jp hj">distinctUntilChanged()</strong></code>检查当前输入是否来自先前输入的值，使用<code class="du lo lp lq lr b"><strong class="jp hj">searchGetCall()</strong></code>在通过我们实现的所有场景后，对服务器进行HTTP调用。</p><h1 id="38a9" class="kr ks hi bd kt ku mb kw kx ky mc la lb io md ip ld ir me is lf iu mf iv lh li bi translated">获取更多OMDb API数据</h1><p id="c8f1" class="pw-post-body-paragraph jn jo hi jp b jq lj ij js jt lk im jv jw ll jy jz ka lm kc kd ke ln kg kh ki hb bi translated">要查看Internet电影数据库的更多详细信息，请请求一部电影，如下所示:</p><p id="20a0" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">按标题:<code class="du lo lp lq lr b">http://www.omdbapi.com/?apikey=[YOUR_KEY]&amp;t=[MOVIE_TITLE]</code></p><p id="90ae" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">由IMDb ID: <code class="du lo lp lq lr b">http://www.omdbapi.com/?apikey=YOUR_KEY&amp;i=[IMDB_ID]</code></p><p id="f5a7" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里，可选参数包括:</p><ul class=""><li id="5f17" class="mg mh hi jp b jq jr jt ju jw mi ka mj ke mk ki ml mm mn mo bi translated">一、IMDb身份证</li><li id="bba2" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">t —电影标题</li></ul><p id="e4cb" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">该端点将返回关于IMDb ID或您想到的电影名称的更详细的结果。在这里，我用IMDb的ID请求了一部电影，如下所示。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="7a05" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">添加<code class="du lo lp lq lr b">getDetails(obj)</code>函数作为<strong class="jp hj">细节</strong>按钮的点击函数，通过IMDb ID获取特定电影的更多细节，所选电影作为函数的参数给出。</p><pre class="iy iz ja jb fd ls lr lt lu aw lv bi"><span id="f2e7" class="lw ks hi lr b fi lx ly l lz ma">&lt;button mat-raised-button color="primary" (click)="getDetails(this.movie)"&gt;Details&lt;/button&gt;</span></pre><p id="9b37" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后让show hidden div元素显示那些检索到的细节。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="6ab4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">该函数具有更全面的结果，包括:</p><ul class=""><li id="3be3" class="mg mh hi jp b jq jr jt ju jw mi ka mj ke mk ki ml mm mn mo bi translated">标题</li><li id="8579" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">发布年份</li><li id="98f0" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">评级</li><li id="839e" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">出厂日期</li><li id="69fd" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">运行时间</li><li id="e1e2" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">流派</li><li id="017d" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">董事</li><li id="f9c6" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">作者</li><li id="48f6" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">演员</li><li id="c7d5" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">情节摘要</li><li id="c5ac" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">语言</li><li id="0711" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">一个/多个国家</li><li id="4b9d" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">获奖情况</li><li id="7cd7" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">电影海报(电影图像的URL)</li><li id="f475" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">收到的评分</li><li id="d7d4" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">Metascore</li><li id="3e1d" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">IMDb评级</li><li id="d696" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">IMDb投票</li><li id="42ac" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">IMDb身份证</li><li id="d530" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">类型(电影、连续剧或剧集)</li><li id="7d9c" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">DVD信息</li><li id="21b9" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">票房成绩</li><li id="6dce" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">制作公司</li><li id="3ce5" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">网站</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/d51729b5df4f834c73928a746f3ad2d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2NJfP9D1qaUpLXqz51RuQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">chrome中对IMDb ID的电影请求的JSON响应</figcaption></figure><p id="81f6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在角度应用中实现OMDb-Search的步骤可以总结如下:</p><ul class=""><li id="706c" class="mg mh hi jp b jq jr jt ju jw mi ka mj ke mk ki ml mm mn mo bi translated">使用<a class="ae kj" href="http://www.omdbapi.com/" rel="noopener ugc nofollow" target="_blank"> OMDb API </a>获取与您的搜索查询(JSON)匹配的前10个结果。</li><li id="5c54" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">创建一个带有一个输入字段的界面，用于按标题搜索电影。</li><li id="c0a8" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">实时呈现结果，并在用户键入搜索查询时更新界面。</li><li id="5816" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">如果搜索查询没有结果，则显示OMDb API错误</li><li id="b440" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">一旦结果被显示，允许用户点击任何特定的电影来查看其细节。</li><li id="5733" class="mg mh hi jp b jq mp jt mq jw mr ka ms ke mt ki ml mm mn mo bi translated">对于特定的电影，细节视图显示更多的电影信息。</li></ul><p id="abf8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">应用程序的完整代码可以在<a class="ae kj" href="https://github.com/Isurie/OMDB-potal" rel="noopener ugc nofollow" target="_blank">这里</a>访问。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/101017c13ff6af44723865082506e61c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzJbU2u_MhJFB8ro-pP0jg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">电影门户的界面，搜索电影并显示电影的详细信息。</figcaption></figure></div></div>    
</body>
</html>