<html>
<head>
<title>cattr_accessor vs class_attribute in Rails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rails中cattr _ accessor vs class _ attribute</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/cattr-accessor-vs-class-attribute-in-rails-7aa8a7a0c258?source=collection_archive---------0-----------------------#2021-11-10">https://medium.com/nerd-for-tech/cattr-accessor-vs-class-attribute-in-rails-7aa8a7a0c258?source=collection_archive---------0-----------------------#2021-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2d2f4e4967f673a71b9afb3d3bb8d27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cHZp157hEzXqZODzGmNtFw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@nate_dumlao" rel="noopener ugc nofollow" target="_blank">内森·杜姆劳</a>通过<a class="ae iu" href="https://unsplash.com/photos/ewGMqs2tmJI" rel="noopener ugc nofollow" target="_blank">unsplash.com</a>拍摄</figcaption></figure><p id="b9a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">几周前，我偶然发现一些代码使用了一些我从未见过的rails“魔法”。代码使用了一种叫做<code class="du jt ju jv jw b">cattr_accessor</code>的东西。我不确定这是什么，也不知道它是如何工作的，但我知道我想了解更多。</p><p id="a726" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">原来,<code class="du jt ju jv jw b">cattr_accessor</code>实际上只是类属性访问器的简称。在阅读这些类属性访问器时，我学到了另一种访问类属性的方法:<code class="du jt ju jv jw b">class_attribute</code>。如果你和我一样，你可能想知道为什么有两种不同的方法来访问类属性？</p><p id="504a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了回答这个问题，我决定做一些研究，并写这篇文章来帮助巩固这种内在的学习，并希望帮助其他人理解这种差异。</p><h1 id="b7a1" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">cattr _访问器</h1><p id="16d2" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">首先，让我们看看<code class="du jt ju jv jw b">cattr_accessor</code>及其工作原理。根据<a class="ae iu" href="https://apidock.com/rails/Class/cattr_accessor" rel="noopener ugc nofollow" target="_blank"> API Dock </a>本，</p><blockquote class="la lb lc"><p id="8601" class="iv iw ld ix b iy iz ja jb jc jd je jf le jh ji jj lf jl jm jn lg jp jq jr js hb bi translated">“为类属性定义类和实例访问器”。</p></blockquote><p id="d186" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ld">快速补充说明，</em> <code class="du jt ju jv jw b"><em class="ld">cattr_accessor</em></code> <em class="ld">实际上只是</em> <code class="du jt ju jv jw b"><em class="ld">mattr_accessor</em></code> <em class="ld">的别名，但是我更喜欢使用</em> <code class="du jt ju jv jw b"><em class="ld">cattr_accessor</em></code> <em class="ld">，因为在我看来它作为一个类属性访问器更容易识别。使用时可用的选项列表可以在</em> <a class="ae iu" href="https://apidock.com/rails/Module/mattr_accessor" rel="noopener ugc nofollow" target="_blank"> <em class="ld">这里</em> </a> <em class="ld">找到。</em></p><p id="fe0e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">太好了，但这意味着什么？我喜欢通过这样做来学习，让我给你看一个例子。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/741d2cbf59c71740a4efd0b1d62ed32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*Auma2hzHifohjoH2EwJQpg.png"/></div></figure><p id="5d97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我建立的一个非常简单的类，叫做Animal。动物可以有名字，动物类有属性<code class="du jt ju jv jw b">number_of_species</code>。<code class="du jt ju jv jw b">cattr_accessor</code>允许我们在类或实例级别获取和设置这个属性。下面是这些不同交互的例子。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/a44f6d5647081c84b27c90cc0cdc6ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*YxH_nRPO5jkcIajc57B-9A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">获取和设置类级别的物种数量。</figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/2103ca2e36fc1ac4b191204c448dd3f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SrEYpUpVw73Ev5AjJoBhWg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">获取实例级别的物种数量。</figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/e42420e972f56d664ac08c4996b9e5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*B4nkvLljLrAi3oEC5J4GJQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">在实例级别设置物种数量。</figcaption></figure><p id="e5fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如您所看到的，实例<code class="du jt ju jv jw b">Animal</code>和类<code class="du jt ju jv jw b">Animal</code>可以获取和设置相同的属性。很酷吧？我想是这样的，但是如果你在一个将被任何其他类继承的类中使用它，就有一个很大的警告，如下所示。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/14893dca5523cb0ae875c9c267f01b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4yjVTF9m_yzsH5c5uPFtA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">子类可以改变父类属性。</figcaption></figure><p id="fd17" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du jt ju jv jw b">number_of_species</code>类属性既可以由Animal类设置，也可以由child Dog类设置，但是没有显示任何一个实例设置它的能力。如果你想严格遵循OOP原则，那么你会想避免这一点，因为让孩子修改父类是一个大禁忌。</p><h1 id="d8dc" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">类别属性</h1><p id="ebee" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">如果你想避免上面的陷阱，我建议你使用<code class="du jt ju jv jw b">class_attribute</code>来代替。<code class="du jt ju jv jw b">class_attribute</code>允许这个属性被子类继承，但是当子类设置那个类属性时，它只为那个类设置，父类属性保持不变。</p><p id="5a8e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用上面的同一个例子来看看这一点。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/fe10fb93adfa04df626888de9321638e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFZJZH0Dtg7QPBiGh2bh-A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">如果直接设置，class_attribute允许继承的类有单独的类属性值。</figcaption></figure><p id="d224" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">利用<code class="du jt ju jv jw b">class_attribute</code>而不是<code class="du jt ju jv jw b">cattr_accessor</code>允许子类继承它们的父类属性，但是如果需要的话，在不改变它们的父类的情况下覆盖它们。</p><p id="cc05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你在一个小项目中工作，或者在你的一个类中没有使用继承，或者由于某种原因需要一个子类来改变一个父类，那么<code class="du jt ju jv jw b">cattr_accessor</code>就是为你准备的。否则，我会推荐默认为<code class="du jt ju jv jw b">class_attribute</code>作为一种保守的方法，只有在必要时才重构为<code class="du jt ju jv jw b">cattr_accessor</code>。</p><p id="7f6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望现在您已经对这两个类属性访问器如何工作以及何时使用它们有了更好的了解。我很乐意在下面的评论中听到你们使用<code class="du jt ju jv jw b">cattr_accessor</code>多于<code class="du jt ju jv jw b">class_attribute</code>的次数。我想不出任何好的例子来说明什么时候这样更好，但是必须有一个用例，否则rails可能不会把它包含在他们的“魔法”中！</p></div></div>    
</body>
</html>