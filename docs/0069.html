<html>
<head>
<title>The Debian Series: LVM with lvm2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Debian 系列:LVM 与 lvm2</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/the-debian-series-lvm-with-lvm2-cc1d6f9a6474?source=collection_archive---------6-----------------------#2019-11-11">https://medium.com/nerd-for-tech/the-debian-series-lvm-with-lvm2-cc1d6f9a6474?source=collection_archive---------6-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7c07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">磁盘管理工作对于充分利用存储资源极其重要。我已经在 Debian 系列的前几篇文章中讨论了如何执行磁盘分区系列、分区的配置文件系统、交换供应等等。</p><p id="930f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是时候谈谈我们如何优化磁盘空间，使其对操作系统来说是最佳和有用的了。我很确定创建逻辑卷可以通过某种方式使用实用程序来“硬”完成。在我的情况下，我将使用 LVM，以及个人指南，将遵循通过实现目标。</p><p id="0d79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个<strong class="ih hj"> LVM </strong>或<strong class="ih hj">逻辑卷管理器</strong>是一个帮助你添加具有不同特性的卷或硬盘的工具。</p><p id="b623" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你需要使用<code class="du jd je jf jg b">aptitude</code>来安装它，就像这样</p><p id="a992" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">aptitude install lvm2</code></p><p id="268a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:<code class="du jd je jf jg b">aptitude</code>在 Debian 9+实例中不存在。我一直在 VirtualBox 虚拟机上使用虚拟化的 Debian 7 实例。</p><h2 id="103e" class="jh ji hi bd jj jk jl jm jn jo jp jq jr iq js jt ju iu jv jw jx iy jy jz ka kb bi translated">我们到底要做什么？</h2><p id="7664" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在实际场景中，我们有<strong class="ih hj">物理卷</strong>(基本上是硬盘)，就像<code class="du jd je jf jg b">/etc/sdb, /etc/sdc, /etc/sdd</code>一样，对吗？</p><p id="53f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还有<strong class="ih hj">卷组</strong>，它们代表一组<strong class="ih hj">物理卷的占位符名称。</strong>根据<a class="ae kh" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/logical_volume_manager_administration/volume_group_overview" rel="noopener ugc nofollow" target="_blank"> RedHat 定义</a>，VGs“创建一个磁盘空间池，从中可以分配逻辑卷。”</p><p id="f5ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这表明我们可以将不同大小的<strong class="ih hj">物理磁盘</strong>分组，也可以作为卷组引用，因为<strong class="ih hj">分组的磁盘</strong>创建了一个<strong class="ih hj">卷</strong></p><p id="9aaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这对我来说很酷，这是我能做的解释 LVM 做什么的最简单的方法。</p><h2 id="fc5e" class="jh ji hi bd jj jk jl jm jn jo jp jq jr iq js jt ju iu jv jw jx iy jy jz ka kb bi translated">创建逻辑卷</h2><p id="5b73" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在这种情况下，我们将使用<strong class="ih hj"> LVM </strong>对分别具有 5 和 10 千兆字节的 2 个磁盘进行分组。目标:利用操作系统中的组空间。</p><p id="335e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">优点:我们可以使用不同功能的磁盘，它们被组合成一个单元。</p><p id="a89d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这些都可以通过 6 个步骤完成，我们将使用<code class="du jd je jf jg b">lvm2</code>命令、实用程序，如<code class="du jd je jf jg b">fdisk</code>、<code class="du jd je jf jg b">mkfs</code>和著名的<code class="du jd je jf jg b">/etc/fstab</code>(这一点上没有什么新的东西)</p><p id="4893" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从用<code class="du jd je jf jg b">fdisk</code>创建<strong class="ih hj"> LVM </strong>分区开始，所以:</p><p id="e172" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">fdisk /dev/sdb</code>按照向导，我们将只创建一个占用整个扇区大小的主分区，棘手的部分是将磁盘类型设置为<code class="du jd je jf jg b">LINUX LVM</code></p><p id="5e2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a 将暂停一会儿，因为如果您从头开始看这个系列，您会注意到我们有 3 个磁盘在运行。为了以最佳方式执行它，我们需要将这个完全相同的配置复制到安装的其他两个磁盘上。</p><p id="71b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，说了这么多，让我们使用<code class="du jd je jf jg b">pvcreate</code>创建一个<strong class="ih hj">物理卷</strong>，如下所示:</p><p id="5167" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">pvcreate /dev/sdb1</code></p><p id="2c56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你需要检查你的进度，你可以使用<code class="du jd je jf jg b">pvdisplay</code>，这将列出安装的硬盘。</p><p id="2bec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我们现在用<code class="du jd je jf jg b">vgcreate</code>命令创建<strong class="ih hj">卷组</strong></p><p id="5417" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">vgcreate volname /dev/sdb1 /dev/sdc1 /dev/sdd1</code></p><p id="3dce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于显而易见的原因，<code class="du jd je jf jg b">sda</code>是不可触及的。</p><p id="fa7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们创建<strong class="ih hj">逻辑卷</strong></p><p id="f860" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">lvcreate -L 5G volname</code></p><p id="89a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这创建了具有 5gb 的逻辑卷<strong class="ih hj">(大小可以改变)</strong></p><p id="61f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，让我们用<code class="du jd je jf jg b">mkfs</code>设置文件名类型</p><p id="5b52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">mkfs ext4 /dev/volgroup/volname</code></p><p id="6209" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们需要以持久的方式<code class="du jd je jf jg b">mount</code>分区。</p><pre class="ki kj kk kl fd km jg kn ko aw kp bi"><span id="0e29" class="jh ji hi jg b fi kq kr l ks kt">cd /<br/>mkdir grouped<br/>mount /dev/mapper/volgroup-lvol0 /grouped<br/>nano /etc/fstab<br/>...</span></pre><p id="3a40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这一点上，你将需要添加结果 UUID，就像我们在前面的故事。</p><p id="efdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">毕竟记得重启。</p><p id="f505" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个艰难的故事。我将在一段时间内重温这一点，并试图以最有效的方式扩展它。</p><p id="a17e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随意投稿。错了就修。并分享它。</p><p id="e13a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">带着<strong class="ih hj"> Crontab </strong>和<strong class="ih hj"> Anacrontab </strong>移动到<strong class="ih hj"> cronjobs </strong>旁边。</p><p id="0c4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">敬请关注。</p><p id="3765" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐编码:)</p></div></div>    
</body>
</html>