<html>
<head>
<title>PowerBI in Python Jupyter notebooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Jupyter笔记本中的PowerBI</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/powerbi-in-python-jupyter-notebooks-500ee152f083?source=collection_archive---------12-----------------------#2021-05-29">https://medium.com/nerd-for-tech/powerbi-in-python-jupyter-notebooks-500ee152f083?source=collection_archive---------12-----------------------#2021-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fd56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，PowerBI发布了PowerBI client Python包，以便在Jupyter笔记本中进行Power BI分析。新的软件包可以让你轻松地在Jupyter笔记本中嵌入Power BI报告、仪表盘或Q &amp; A。由于这是一个最近发布的特性，关于通过这个python库访问报告的步骤，互联网上没有太多有用的资源，所以我将通过本文分享我的学习</p><p id="8b58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过pip安装程序安装很简单</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="63fd" class="jn jo hi jj b fi jp jq l jr js">pip install jupyter<br/>pip install powerbiclient<br/>#open jupyter notebook<br/>jupyter notebook</span></pre><p id="e47a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过三种模式连接到PowerBI并获取令牌:</p><ol class=""><li id="d70b" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated">提供用户名和密码的基本身份验证</li><li id="21f1" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">使用嵌入令牌的身份验证。</li><li id="9c46" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">DeviceCodeLoginAuthentication。这是默认的身份验证模式</li></ol><p id="0377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为本博客的一部分，将重点介绍基本的身份验证。使用您的Power BI登录凭据进行身份验证，并获取令牌。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="aa19" class="jn jo hi jj b fi jp jq l jr js">from powerbiclient.authentication import MasterUserAuthentication<br/>from powerbiclient import Report<br/>auth_token = MasterUserAuthentication(username=YOUR_POWERBI_USER, password=YOUR_PASSWORD)</span></pre><p id="3482" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进一步访问需要组和报告id。要了解group_id和report_id，请在浏览器中打开powerbi报告。检查URL中的特定文本“组”和“报告”,并提取组和报告id。</p><figure class="je jf jg jh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es kh"><img src="../Images/3878ee63513657dd84113756f7f215f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NN0JP3G7-lGnboOMnTAdA.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">用于查找组和报告id的PowerBI URL</figcaption></figure><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="b18c" class="jn jo hi jj b fi jp jq l jr js">#to access a powerbi report<br/>report = Report(group_id="7dba7cca-9d80-41a8-81ef-3a50bab1c9f6", report_id="9aed5949-33a6-415a-82ff-ccd6888a5528", auth=auth_token)<br/>report # you need to embed the report by calling this. Critical step</span></pre><h2 id="5c77" class="jn jo hi bd kt ku kv kw kx ky kz la lb iq lc ld le iu lf lg lh iy li lj lk ll bi translated">注意:您需要将报告嵌入到jupyter笔记本中，以便执行后续步骤。我错过了上述代码的最后一行，并得到了错误。花了一些时间才发现</h2><p id="80af" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">一旦报表嵌入到jupyter notebook中，您可以通过调用get_pages函数找到报表中可用的报表页面列表。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="044b" class="jn jo hi jj b fi jp jq l jr js">report_pages=report.get_pages()<br/>for report_page in report_pages:<br/>    print(f"Page_id: {report_page['name']}, Page_Name: {report_page['displayName']}")</span></pre><figure class="je jf jg jh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es lr"><img src="../Images/f29d5b9cb7a9ed81bed0ad65ffbedbae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tC6-6y6VCXUL6MTUmUkOtw.png"/></div></div></figure><p id="c1fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过将page_id传递给get_visuals函数，查找特定报表页面中可用的视觉效果列表</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="1a2b" class="jn jo hi jj b fi jp jq l jr js">report_page_id = "ReportSectionf5832aa68570e3831034"<br/>report_visuals=report.visuals_on_page(report_page_id)<br/>for report_visual in report_visuals:<br/>    #all vizzes would not have title enabled, so wrap in a try except clause<br/>    try:<br/>        title = report_visual['title']<br/>    except:<br/>        title = None<br/>        <br/>    print(f"Visual ID: {report_visual['name']}, Visualization Type:{report_visual['type']}, Title: {title}")</span></pre><figure class="je jf jg jh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ls"><img src="../Images/f5b59a6e2985046764a92632894c5892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArycCh47eyonsWwqhkm5tw.png"/></div></div></figure><p id="1c89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在通过调用export_visual_data导出可视化中的数据。导出的数据将是字符串类型，使用字符串操作将其转换为列表以便进一步转换</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="9280" class="jn jo hi jj b fi jp jq l jr js">visualization_id = “41d586df3a002d0e33c2”<br/>viz_data=report.export_visual_data(report_page_id,visualization_id, rows=20)<br/>print(viz_data)</span></pre><figure class="je jf jg jh fd ki er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es lt"><img src="../Images/b74931c52861b9007bf7919a99cafbf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWp93V7ci6MtsHgfqiI0Ew.png"/></div></div></figure><p id="014d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除此之外，我们可以获得过滤器和更新过滤器。我会在下一篇博文中讨论这个问题</p><p id="d91d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦数据被导出到Jupyter notebook中，我们可以使用pandas，numpy进行进一步的转换。使用matplotlib，我们可以基于转换后的数据生成图表。我觉得下面是缺失的部分，这可能会影响更广泛的受众的采用。</p><ol class=""><li id="1982" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated">虽然这绝对是强大的，但应该有一种机制来与powerbi应用程序用户共享创建的可视化。</li><li id="6557" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">数据更新仍然局限在Power BI生态系统中。应该有一种机制来触发jupyter笔记本的数据刷新。</li><li id="4038" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">能够访问报告中呈现的特定可视化内容。这将更有帮助</li></ol><p id="aedd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此处提供了示例代码文件:</p><div class="lu lv ez fb lw lx"><a href="https://github.com/balajigv/powerbi/blob/master/powerBiConnectivity.py" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">balajigv/powerbi</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">在GitHub上创建一个帐户，为balajigv/powerbi开发做贡献。</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">github.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml kn lx"/></div></div></a></div><p id="964e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae mm" href="https://github.com/balajigv/powerbi/blob/master/powerBiConnectivity.py" rel="noopener ugc nofollow" target="_blank">https://github . com/balajigv/power bi/blob/master/powerbi connectivity . py</a></p><p id="fc83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#powerbi #jupyter #python</p></div></div>    
</body>
</html>