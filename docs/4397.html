<html>
<head>
<title>A journey with flutter native plugin development for iOS &amp; Android 🤩</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS和Android的flutter原生插件开发之旅🤩</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/a-journey-with-flutter-native-plugin-development-for-ios-android-3f0dd4ab8061?source=collection_archive---------15-----------------------#2021-07-19">https://medium.com/nerd-for-tech/a-journey-with-flutter-native-plugin-development-for-ios-android-3f0dd4ab8061?source=collection_archive---------15-----------------------#2021-07-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dcfd8e62aada383f6c4edab8fc84d4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33uGqRAiGBPYWVWM0TB0Iw.jpeg"/></div></div></figure><h2 id="4c45" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">动机</h2><p id="7aa0" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">几天前，我在我心爱的#flutter项目中遇到了一个问题。问题是我必须实现一个<strong class="jq hj">“文档扫描仪”</strong>又名边缘检测/文档选择&amp; <strong class="jq hj">用来自<strong class="jq hj">相机</strong>或<strong class="jq hj">图库</strong>的扫描图像生成一个PDF </strong>。</p><p id="ae87" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">问题是，我找到的唯一稳定且有效的例子是ScanBot SDK，它不是开源的。所以我决定以此为契机，开始探索它的插件生态系统。</p><h2 id="89fe" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">构建解决方案</h2><p id="64f3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">由于我有原生Android和iOS开发的经验，它帮助我用flutter engine快速完成工作。</p><p id="e893" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">如果你想学习如何编写特定于平台的代码，这里有一个指南:<a class="ae ko" href="https://flutter.dev/docs/development/platform-integration/platform-channels" rel="noopener ugc nofollow" target="_blank">https://flutter . dev/docs/development/platform-integration/platform-channels</a></p><p id="67d2" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">我在这里惊讶地看到，flutter在连接平台API和它的dart框架方面做得非常好😍。几年前我对React Native做了同样的事情，这是一个大问题。但是在flutter中，我感觉像是在用本地代码工作😍当我和swift一起工作时，构建真的很快。</p><h2 id="1881" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">挑战</h2><ol class=""><li id="23e1" class="kp kq hi jq b jr js jv jw jb kr jf ks jj kt ki ku kv kw kx bi translated">第一个挑战是我没有太多的时间独自在两个平台上编写文档扫描仪(从头开始)。比如用OCV或类似的东西。所以我决定使用已经可以用于android和iOS原生应用的库。iOS一号是<a class="ae ko" href="https://github.com/WeTransfer/WeScan" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">威斯康</strong> </a> <strong class="jq hj">😍</strong>由<a class="ae ko" href="https://github.com/WeTransfer/WeScan" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> WeTransfer </strong> </a> <strong class="jq hj">。</strong>但是对于Android 🥺，我没有发现任何一个库在没有GRADLE编译问题的情况下保持稳定😒。所以这真的很有挑战性。所以我拿了那个演示的基本回购(因为它被400多个用户分叉了😱)作者:<a class="ae ko" href="https://github.com/jhansireddy/AndroidScannerDemo" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj">jhansireddy</strong></a><strong class="jq hj">。并开始修改其遗留的JAVA代码。现在，当我完成修改它时，一个想法出现在我的脑海中，既然没有好的解决方案，为什么不把它作为android库发布呢？所以我用<a class="ae ko" href="https://jitpack.io/#ishaquehassan/AndroidDocumentScanLibrary/1.8.2" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> jitpack </strong> </a> <strong class="jq hj">做了🎊。如果你是一个寻找类似东西的安卓开发者&amp;，你可以在这里使用它😉:<a class="ae ko" href="https://jitpack.io/#ishaquehassan/AndroidDocumentScanLibrary/1.8.2" rel="noopener ugc nofollow" target="_blank">https://JIT pack . io/# ishaquehassan/AndroidDocumentScanLibrary/1 . 8 . 2</a></strong></strong></li><li id="5b89" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki ku kv kw kx bi translated">扫描图像转换为PDF！所以我决定在颤振端做，因为我在<a class="ae ko" href="https://pub.dev" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> pub </strong> </a>用<a class="ae ko" href="https://pub.dev/packages/pdf" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj">pdf</strong></a><strong class="jq hj"/>包🥳.找到了一个很好的解决方案这里的重点是，我在原生iOS和Android上做的唯一一件事就是打开Activity(在Android上)&amp; ViewController on(在iOS上)并通过flutter中的<a class="ae ko" href="https://api.flutter.dev/flutter/services/MethodChannel-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">方法通道</strong> </a> <strong class="jq hj"> </strong>将扫描结果返回给dart。因此，无论是android还是iOS，在获得扫描图像后，我都可以通过这种机制在两个平台上以相同的方式处理响应😎。</li><li id="7301" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki ku kv kw kx bi translated">插件中的自定义选项，如配置、文本等。这是由<a class="ae ko" href="https://api.flutter.dev/flutter/services/MethodChannel/invokeMethod.html" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj">invoke method</strong></a><strong class="jq hj"/>完成的，它提供了一种漂亮而简单的方式将参数和方法名一起传递给本机代码。我使用dart <a class="ae ko" href="https://api.flutter.dev/flutter/dart-core/Map-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">映射</strong></a><strong class="jq hj"/>&amp;<a class="ae ko" href="https://dart.dev/guides/language/language-tour#enumerated-types" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj">枚举</strong> </a>将这些配置从用户端代码指定到库dart文件，然后指定到本机swift &amp; Kotlin/java类。</li></ol><h2 id="1ba8" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结果🤩</h2><p id="2dff" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">经过所有这些努力，我设法使它像预期的那样工作，并在pub上发表了它</p><p id="d643" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">我真的很高兴我有这个机会来学习深度的颤动，是的，插件在这里，too🥳🤩</p><p id="0ded" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><a class="ae ko" href="https://pub.dev/packages/document_scanner_flutter" rel="noopener ugc nofollow" target="_blank">https://pub.dev/packages/document_scanner_flutter</a></p><p id="90b2" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">这个插件确实有一些棘手的事情在进行，但是最好的部分是它在安全无效的情况下工作得很好！</p></div></div>    
</body>
</html>