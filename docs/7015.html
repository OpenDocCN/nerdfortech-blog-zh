<html>
<head>
<title>Multi Class Classification Using Auto-Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自动分类器的多类分类</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/multi-class-classification-using-auto-keras-9e90684f99aa?source=collection_archive---------1-----------------------#2022-07-05">https://medium.com/nerd-for-tech/multi-class-classification-using-auto-keras-9e90684f99aa?source=collection_archive---------1-----------------------#2022-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/80a833b51e32dfc0d14c2e84d3b611c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*7nfAmQsYXRZ8ebWMhKL2VA.jpeg"/></div></div></figure><p id="4224" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将讨论如何使用 Auto Keras 来解决多类分类机器学习问题。这里的问题陈述是根据手机功能预测手机的价格范围。这反映了一个真实的世界问题，即一个企业想要以相对于具有类似产品特征的其他产品有竞争力的价格推销其产品。这里给出的解决方案通过使用 Auto Keras 库保持简单。这里用于问题的数据是从 Kaggle 获得的(见参考文献)。开始时，我们将打开 Jupyter 笔记本，接下来我们将安装并导入 auto Keras 库以及 tensorflow 库，这些库将用于获取模型以进行训练，并用于以后的预测。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/8337e3c1efe520347468e1c8c5b7e9e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*F9zShDyKFZRT_uQk6TAKAw.jpeg"/></div></figure><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="10c9" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">!pip install autokera<br/>import tensorflow as tf<br/>import autokeras as ak</em></strong></span></pre><p id="863a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在那之后，我们将进口熊猫和 numpy 图书馆。这些基本库将分别用于数据帧的操作和数学函数的使用。我们将利用的其他库很少，这些将在后面解释。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="f73f" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</em></strong></span></pre><p id="6596" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将导入数据集。为了简单起见，从 Kaggle 下载数据集，将其保存在本地机器中，在执行命令时运行下面给定的命令(用本地驱动器中的文件位置替换“”下的文本)。这些文件将从本地驱动器加载到 Jupyter 笔记本中。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="05f0" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">df_train = pd.read_csv('C://mobile-price-classification//train.csv')<br/>df_test = pd.read_csv('C://mobile-price-classification//test.csv', index_col= 'id')</em></strong></span></pre><p id="2669" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上传的文件为 CSV 格式。要从这个 CSV 文件创建一个名为 df_train 的数据帧，请在单元中执行以下命令。当我们使用命令 df.head()时，显示新创建的数据帧用于分析。为了分析数据集，我们使用命令 df.info()和 df.describe()。由于数据已经清理完毕，我们将跳过这里的数据清理步骤。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="102c" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">df_train.head()<br/>df_train.info()<br/>df_train.describe()</em></strong></span></pre><p id="60ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将分离功能(电话功能)和标签(具体价格范围-这里分为一、二、三等。).df 数据框现在分别用于创建 X(要素)和 y(实际值)数据集。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="d00d" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">X= df_train.iloc[:,:-1]<br/>y= df_train.iloc[:,-1:]</em></strong></span></pre><p id="eff1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了继续进行，我们将把数据集(X 和 y)分成训练集和验证集。这些将分别用于训练模型，然后在验证数据集上验证模型的有效性。sklearn 库有一个 train_test_split()函数，用于帮助拆分数据集。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="b205" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">from sklearn.model_selection import train_test_split<br/>train_X, Val_X, train_y, Val_y = train_test_split(X,y, test_size= 0.25, random_state=14)</em></strong></span></pre><p id="be96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">若要继续，请使用 Auto Keras 库导入 Auto Keras 分类算法。Auto-Keras 是用于自动机器学习的开源软件库。它是由<strong class="is hj">德克萨斯 A &amp; M 大学</strong>的<strong class="is hj">数据实验室</strong>和<strong class="is hj">社区贡献者</strong>开发的。Auto-Keras 提供了自动搜索深度学习模型的架构和超参数的功能，从而增强了机器学习采用的自动化和便利化。Keras 型号<strong class="is hj"> <em class="ke"> ak。StructuredDataClassifier()</em></strong><em class="ke">是</em>导入、训练的，训练完成后模型会根据精度自动选择最合适的模型。在当前情况下，模型达到 0.87%的精度，这是相当好的预测。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="10c8" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">clf = ak.StructuredDataClassifier(overwrite=True, max_trials=3) <br/>clf.fit(train_X, train_y, epochs=10)<br/>predict_Val_y= clf.predict(Val_X)<br/>predict_Val_y=predict_Val_y.astype(int)</em></strong></span></pre><p id="a29d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，通过传递验证数据集(Val_X)，该模型用于进行预测(predict_Val_y)。接下来，我们将使用<strong class="is hj"> sklearn.metrics </strong>库<strong class="is hj">到</strong>检查<strong class="is hj"> </strong>预测验证值(predicted_Val_y)与实际值(Val_y)的差异，从而获得分类报告。接下来是打印最佳模型的摘要——它给出了最佳的精确度。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="f35d" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">from sklearn.metrics import classification_report<br/>print(classification_report(Val_y,predict_Val_y))</em></strong></span><span id="4aa8" class="jy jz hi ju b fi kf kb l kc kd"><strong class="ju hj"><em class="ke">model = clf.export_model()<br/>model.summary()</em></strong></span></pre><p id="1aee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了使事情更简单，我们将创建一个新的数据帧，命名为<strong class="is hj">结果</strong>。它将由预测值(预测值)和实际值(值)组成。最后，我们将使用 pickle 文件保存模型，以便将来可以加载模型以供使用。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="72ca" class="jy jz hi ju b fi ka kb l kc kd"><strong class="ju hj"><em class="ke">Result=pd.DataFrame(predict_Val_y,index= Val_X.index, columns=['Predicted'])<br/>Result['Price']= Val_y<br/>Result.to_csv('Predicted_Price.csv')</em></strong></span><span id="c4ac" class="jy jz hi ju b fi kf kb l kc kd"><strong class="ju hj"><em class="ke">import pickle<br/>Pkl_Filename = "ClF.pkl"  <br/>with open(Pkl_Filename, 'wb') as file:  <br/>    pickle.dump(clf, file)</em></strong></span></pre><p id="f50b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献</strong></p><ol class=""><li id="2bbc" class="kg kh hi is b it iu ix iy jb ki jf kj jj kk jn kl km kn ko bi translated"><a class="ae kp" href="https://www.kaggle.com/datasets/iabhishekofficial/mobile-price-classification" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/iabhishekofficial/mobile-price-class ification</a>数据集</li><li id="0ac8" class="kg kh hi is b it kq ix kr jb ks jf kt jj ku jn kl km kn ko bi translated">https://autokeras.com/汽车官方网站</li><li id="8a70" class="kg kh hi is b it kq ix kr jb ks jf kt jj ku jn kl km kn ko bi translated"><a class="ae kp" href="https://www.kaggle.com/code/rajeevbhadola/automl-using-auto-keras" rel="noopener ugc nofollow" target="_blank">https://www . kaggle . com/code/rajeevbhadola/automl-using-auto-keras</a>用于活动笔记本，代码在 ka ggle 中</li></ol><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/80a833b51e32dfc0d14c2e84d3b611c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*7nfAmQsYXRZ8ebWMhKL2VA.jpeg"/></div></div></figure></div></div>    
</body>
</html>