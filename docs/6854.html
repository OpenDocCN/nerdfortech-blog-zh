<html>
<head>
<title>Fastlane with React Native — Part-2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">浪子与React Native —第2部分</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/fastlane-with-react-native-part-2-a1adea3321aa?source=collection_archive---------0-----------------------#2022-05-29">https://medium.com/nerd-for-tech/fastlane-with-react-native-part-2-a1adea3321aa?source=collection_archive---------0-----------------------#2022-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7805" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di"> S </span> o，在第一部分中，我们确实谈到了fastlane如何与iOS协同工作，以及它如何帮助自动化构建过程。</p><p id="5495" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第二部分中，我们将看到如何手动构建android，以及fastlane如何帮助实现android构建过程的自动化。</p><h2 id="db6b" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated">在初始设置中，</h2><p id="07f0" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">我们通常建造APK，即:我们的应用程序(就像我们上传到Google play控制台的可执行文件)。这和我们为iOS打造的IPA是一样的。<br/>我们接下来要做的是在本地机器上生成一个私钥，稍后在初始上传和持续部署时会用到它。<br/>完成上述工作后，我们在代码签名过程中使用APK和私钥。我们可以把它看作是用私钥加密某种代码。<br/>代码签名流程主要是为了让谷歌知道，我是上传初始APK的人，也是通过持续部署策略推动后续更新的人。</p><p id="1968" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重要:</strong> <em class="km">不要丢失私钥，否则我们将无法进行连续部署。</em></p><h1 id="8233" class="kn jn hi bd jo ko kp kq js kr ks kt jw ku kv kw jz kx ky kz kc la lb lc kf ld bi translated"><strong class="ak">如果我们丢失或泄露了私钥，该怎么办？</strong></h1><p id="dc5b" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">如果您丢失了您的私钥，或者它已经被破坏，您可以<a class="ae le" href="https://support.google.com/googleplay/android-developer/answer/9842756#create" rel="noopener ugc nofollow" target="_blank"> <em class="km">创建一个新的</em> </a>，然后要求您的帐户所有者<a class="ae le" href="https://support.google.com/googleplay/android-developer/contact/key" rel="noopener ugc nofollow" target="_blank"> <em class="km">联系支持人员以重置密钥</em> </a> <em class="km">。</em>联系支持人员时，请确保您的帐户所有者附上了<code class="du lf lg lh li b">upload_certificate.pem</code>文件。在我们的支持团队注册新的上传密钥后，您会收到一封电子邮件，然后您可以更新您的密钥库并向API提供商注册您的密钥。</p><p id="88f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重要提示:</strong> <em class="km">重置您的上传密钥不会影响Google Play在将apk交付给用户之前用于重新签名apk的应用签名密钥。</em></p><h2 id="767a" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated">在下一步中，</h2><p id="e903" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">我们需要通过Google开发者控制台将签名的APK上传到谷歌Play商店，这是一个极其简单的过程。</p><p id="4c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成所有这些过程后，我们将私钥分发给所有不同的成员，并在一些安全的地方保存备份，如Google Drive、Dropbox或任何存储备份文件的地方。</p><p id="2962" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，这一步只针对初始部署，我们需要在Google Play中填写所有的应用程序信息(包括内容、评级、定价信息-只有在应用程序付费的情况下，应用程序的描述和一些预览截图)。</p><p id="5dab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成上述所有设置后，我们就可以发布初始版本了。现在就看你是想直接进入<strong class="ih hj"> <em class="km">量产</em> </strong>还是<strong class="ih hj"> <em class="km"> beta发布</em> </strong>还是<strong class="ih hj"> <em class="km">内测发布</em> </strong>还是<strong class="ih hj"> <em class="km"> alpha发布。</em>T15】</strong></p><h2 id="85c8" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated"><strong class="ak">现在让我们看看fastlane是如何简化上述流程的！</strong></h2><p id="4dbc" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">在完成初始阶段后，我们现在准备使用fastlane进行持续部署。</p><p id="f013" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">浪子有一个叫做lane的组件，它是一个ruby脚本。Lane包含一系列执行所需任务的命令。为此，我们有一个命令<strong class="ih hj">Gradle</strong>T20】(参考下图)。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lj"><img src="../Images/e959324e27a638e14b7a35aa59cbcf35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ekJnWRXke6Mc0BwgIM4sZQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">使用fastlane的手动与自动流程</figcaption></figure><p id="4969" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们运行它时，它从Android的角度自动设置。它会创建一个APK文件，自动获取我们的私钥，并为我们的应用程序进行代码签名。</p><p id="7578" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一个名为<strong class="ih hj"> supply、</strong>的命令，它主要是获取gradle生成的APK，并将它上传到<strong class="ih hj"> <em class="km">谷歌Play商店。</em> </strong></p><p id="812e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它包含两个参数— track: alpha，beta，production— apk:目录中我们的apk文件的位置。</p><p id="4b71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想在浪子为每个构建添加git commit，这也是可选的。</p><p id="06d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们不需要做所有的左侧操作<em class="km">(参考上图)</em>每次我们必须将更新推送到商店，我们只需要运行一个命令，它就会为我们完成所有的<em class="km">(构建、签名和上传)</em>过程，这对于基于生产的应用程序来说非常重要。</p><p id="9246" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，这就是如何优化可以做的android构建过程与浪子。现在进行设置，只需一个命令。:)</p></div></div>    
</body>
</html>