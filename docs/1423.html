<html>
<head>
<title>Pi Day Special : Estimating π Using The Monte Carlo Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">圆周率日特辑:使用蒙特卡罗方法估计π</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/pi-day-special-estimating-%CF%80-using-the-monte-carlo-method-2663edc9c01d?source=collection_archive---------4-----------------------#2021-03-18">https://medium.com/nerd-for-tech/pi-day-special-estimating-%CF%80-using-the-monte-carlo-method-2663edc9c01d?source=collection_archive---------4-----------------------#2021-03-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="629e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">大家π日快乐！来一个，来全部——收集“a轮”，因为我分享了如何使用蒙特卡罗模拟方法来估计π的值</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f0b65ff95197241b69e72c8f2ea96576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fk6vk1GdK9uUSxNMqPw2tQ.png"/></div></div></figure><div class="jj jk ez fb jl jm"><a href="https://en.wikipedia.org/wiki/Pi_Day" rel="noopener  ugc nofollow" target="_blank"><div class="jn ab dw"><div class="jo ab jp cl cj jq"><h2 class="bd hj fi z dy jr ea eb js ed ef hh bi translated">圆周率</h2><div class="jt l"><h3 class="bd b fi z dy jr ea eb js ed ef dx translated">圆周率日是一年一度庆祝数学常数的节日。圆周率日是在3月14日(3/14月/日…</h3></div><div class="ju l"><p class="bd b fp z dy jr ea eb js ed ef dx translated">en.wikipedia.org</p></div></div><div class="jv l"><div class="jw l jx jy jz jv ka jh jm"/></div></div></a></div><p id="6e70" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><em class="kx">*是的，我知道从技术上来说这是一个快乐的“迟来的”π日，因为它已经过了2021年3月14日，但我的借口是我以太低的迭代次数运行我的模拟:P，我懒得等待2021年7月22日(</em> <a class="ae ky" href="https://www.huffpost.com/entry/pi-approximation-day-_n_1693199" rel="noopener ugc nofollow" target="_blank"> <em class="kx">圆周率逼近日</em></a><em class="kx">——查一下——这是一个真实的事情)</em></p><p id="2952" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kd hj">公平的警告——这是一个有点怪的帖子，但我希望我的普通读者会原谅我的“<em class="kx">非理性的</em>”行为(Geddit？！抱歉更多糟糕的数学双关语来袭)</strong></p><p id="f511" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">因为我已经写了许多关于蒙特卡洛模拟的其他中型文章(<a class="ae ky" rel="noopener" href="/analytics-vidhya/building-a-probabilistic-risk-estimate-using-monte-carlo-simulations-cf904b1ab503">这里</a>、这里<a class="ae ky" rel="noopener" href="/analytics-vidhya/building-a-monte-carlo-method-stock-price-simulator-with-geometric-brownian-motion-and-bootstrap-e346ff464894">这里</a>和<a class="ae ky" rel="noopener" href="/analytics-vidhya/how-to-estimate-optimal-stock-portfolio-weights-using-monte-carlo-simulations-modern-portfolio-d27d534e8a1a">这里</a>)，为了庆祝π日，我分享一个基于Google Colab构建的简单python脚本(点击下面自行探索)，它使用蒙特卡洛模拟对π进行估计。</p><div class="jj jk ez fb jl jm"><a href="https://colab.research.google.com/drive/1uyZGCogD0evDim5rk0Hty7KD3eTpJdyx?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="jn ab dw"><div class="jo ab jp cl cj jq"><h2 class="bd hj fi z dy jr ea eb js ed ef hh bi translated">谷歌联合实验室</h2><div class="jt l"><h3 class="bd b fi z dy jr ea eb js ed ef dx translated">编辑描述</h3></div><div class="ju l"><p class="bd b fp z dy jr ea eb js ed ef dx translated">colab.research.google.com</p></div></div><div class="jv l"><div class="kz l jx jy jz jv ka jh jm"/></div></div></a></div><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="la lb l"/></div></figure><h1 id="90c6" class="lc ld hi bd le lf lg lh li lj lk ll lm io ln ip lo ir lp is lq iu lr iv ls lt bi translated">概述</h1><ol class=""><li id="6eee" class="lu lv hi kd b ke lw kh lx kk ly ko lz ks ma kw mb mc md me bi translated"><a class="ae ky" href="#7aed" rel="noopener ugc nofollow"> <strong class="kd hj">如何估算π的基本理论</strong> </a></li><li id="ce9d" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mb mc md me bi translated"><a class="ae ky" href="#71e8" rel="noopener ugc nofollow"> <strong class="kd hj">用Python代码实现</strong> </a></li><li id="671c" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mb mc md me bi translated"><a class="ae ky" href="#c326" rel="noopener ugc nofollow"> <strong class="kd hj">迭代次数变化的结果</strong> </a></li><li id="a53c" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mb mc md me bi translated"><a class="ae ky" href="#87bc" rel="noopener ugc nofollow"> <strong class="kd hj">通过改变(内部)子循环</strong> </a>的数量得到结果</li><li id="16d0" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mb mc md me bi translated"><a class="ae ky" href="#4e70" rel="noopener ugc nofollow"> <strong class="kd hj">结论</strong> </a></li></ol><h1 id="7aed" class="lc ld hi bd le lf lg lh li lj lk ll lm io ln ip lo ir lp is lq iu lr iv ls lt bi translated">1.如何估算<strong class="ak"> π </strong>的基本理论</h1><p id="ecd6" class="pw-post-body-paragraph kb kc hi kd b ke lw ij kg kh lx im kj kk mk km kn ko ml kq kr ks mm ku kv kw hb bi translated">基本理论如下:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/a532c5254bbe15b0ab1af89e444bfdfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2twlJMea0kLbj0Bb5hrPOg.jpeg"/></div></div></figure><ul class=""><li id="ca3e" class="lu lv hi kd b ke kf kh ki kk mo ko mp ks mq kw mr mc md me bi translated">考虑一个以原点(0，0)为圆心、半径为1.0的圆和一个从-1.0到1.0的正方形</li><li id="1023" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mr mc md me bi translated">正方形的面积= 2 x 2</li><li id="5a6a" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mr mc md me bi translated">圆的面积= <strong class="kd hj"> π </strong> x半径**2 = <strong class="kd hj"> π </strong> x 1 x 1</li><li id="13ae" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mr mc md me bi translated">如果我们绘制一组从-1.0到1.0的随机坐标，并“计数”圆内和圆外的点…</li><li id="2b9b" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mr mc md me bi translated">随着随机坐标的数量增加到一个大的数字；圆内的点/正方形内的点的比率将趋向于圆的面积/正方形的面积</li><li id="9d19" class="lu lv hi kd b ke mf kh mg kk mh ko mi ks mj kw mr mc md me bi translated"><strong class="kd hj">因此</strong> <strong class="kd hj"> π ~圆内点数/总点数×4</strong></li></ul><h1 id="71e8" class="lc ld hi bd le lf lg lh li lj lk ll lm io ln ip lo ir lp is lq iu lr iv ls lt bi translated">2.用Python代码实现</h1><p id="6a3f" class="pw-post-body-paragraph kb kc hi kd b ke lw ij kg kh lx im kj kk mk km kn ko ml kq kr ks mm ku kv kw hb bi translated">在Python代码中，它看起来有点像下面这样:</p><pre class="iy iz ja jb fd ms mt mu mv aw mw bi"><span id="6508" class="mx ld hi mt b fi my mz l na nb">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import random</span><span id="706b" class="mx ld hi mt b fi nc mz l na nb">N=100 # No of Monte Carlo Iterations</span><span id="2f97" class="mx ld hi mt b fi nc mz l na nb">#Function to estimate Pi based on no of iterations</span><span id="398d" class="mx ld hi mt b fi nc mz l na nb">def pi_estimate(N,typeOfRandDistribution,showChart=True):<br/>  x=[]<br/>  y=[]<br/>  inside_quadrant=0</span><span id="96fc" class="mx ld hi mt b fi nc mz l na nb">for i in range(0,N):<br/>    if typeOfRandDistribution=='random.uniform':<br/>      x_i=random.uniform(-1.00000, 1.00000)<br/>      y_i=random.uniform(-1.00000, 1.00000)<br/>    elif typeOfRandDistribution=='random.random':<br/>      x_i=random.random()*2+-1<br/>      y_i=random.random()*2+-1<br/>    x.append(x_i)<br/>    y.append(y_i)<br/>    if (x_i**2+y_i**2)&lt;=1:<br/>      inside_quadrant+=1</span><span id="82e3" class="mx ld hi mt b fi nc mz l na nb"># I've included as an option to select between random.uniform and random.random. The post below says they are similar...but apparently due to floating-point rounding you can sometimes hit the upper bound in random.uniform vs random.random</span><span id="1925" class="mx ld hi mt b fi nc mz l na nb"># Ref https://stackoverflow.com/questions/30030659/in-python-what-is-the-difference-between-random-uniform-and-random-random#:~:text=74-,random.,end%20up%20giving%20you%20b%20</span><span id="15cb" class="mx ld hi mt b fi nc mz l na nb">if showChart==True:<br/>    figure, axes = plt.subplots()<br/>    plt.scatter(x, y, c='blue')</span><span id="e19b" class="mx ld hi mt b fi nc mz l na nb">axes.set_aspect(1)<br/>    axes.add_artist(plt.Circle((0,0),1, color = 'k', fill = False))<br/>    plt.xlim(left=-1)<br/>    plt.xlim(right=1)<br/>    plt.ylim(bottom=-1)<br/>    plt.ylim(top=1)<br/>    pi_estimate= (inside_quadrant/N)*4<br/>    outside_quadrant=N-inside_quadrant<br/>    plt.title('Pi Estimate= '+str(pi_estimate)+', NoOfIterations='+str(N)+', Count Of Points Inside Circle='+str(inside_quadrant)+', Outside Circle='+str(outside_quadrant))<br/>    plt.show()<br/>  <br/>  if showChart==False:<br/>    pi_estimate= (inside_quadrant/N)*4<br/>    outside_quadrant=N-inside_quadrant</span><span id="87fa" class="mx ld hi mt b fi nc mz l na nb">return pi_estimate</span><span id="4ba0" class="mx ld hi mt b fi nc mz l na nb">pi_estimate(10,'random.random')</span></pre><h1 id="c326" class="lc ld hi bd le lf lg lh li lj lk ll lm io ln ip lo ir lp is lq iu lr iv ls lt bi translated">3.变化迭代次数的结果</h1><p id="e83e" class="pw-post-body-paragraph kb kc hi kd b ke lw ij kg kh lx im kj kk mk km kn ko ml kq kr ks mm ku kv kw hb bi translated">我们马上会将上述方法的结果与<strong class="kd hj"> π </strong>的“实际”值进行比较:</p><div class="jj jk ez fb jl jm"><a href="http://www.geom.uiuc.edu/~huberty/math5337/groupe/digits.html" rel="noopener  ugc nofollow" target="_blank"><div class="jn ab dw"><div class="jo ab jp cl cj jq"><h2 class="bd hj fi z dy jr ea eb js ed ef hh bi translated">100，000位数的圆周率</h2><div class="jt l"><h3 class="bd b fi z dy jr ea eb js ed ef dx">3.141592653589793238462643383279502884197169399375105820974944592307816406286…</h3></div><div class="ju l"><p class="bd b fp z dy jr ea eb js ed ef dx translated">www.geom.uiuc.edu</p></div></div><div class="jv l"><div class="nd l jx jy jz jv ka jh jm"/></div></div></a></div><p id="38c1" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">例如，如果我们仅使用100次迭代进行(粗略)近似，并运行四次，我们会得到类似下图的结果:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ne"><img src="../Images/c3b8d83e87f65f138782b5d1cb9a3c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6imfKqEmXWZe2_WNwN6Nhw.png"/></div></div></figure><p id="1fc5" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">这并不准确，因为这些都没有达到3.1415926的水平…..</p><p id="b8b7" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">然而，如果将迭代次数从100次增加到100万次，π的估计值会更接近一些(至少达到两位小数) :</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/d3625248d47f098e6eec21c9752d45a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yfrbaBiGlhSRQz5a-89uPw.png"/></div></div></figure><h1 id="87bc" class="lc ld hi bd le lf lg lh li lj lk ll lm io ln ip lo ir lp is lq iu lr iv ls lt bi translated">4.改变(内部)子循环数量的结果</h1><p id="50ae" class="pw-post-body-paragraph kb kc hi kd b ke lw ij kg kh lx im kj kk mk km kn ko ml kq kr ks mm ku kv kw hb bi translated">更有趣的是，我们可以做一个内循环和外循环，下面是使用10，000次内循环迭代的1，000次外循环迭代的π估计直方图，以及由此产生的π的中值和平均值估计</p><pre class="iy iz ja jb fd ms mt mu mv aw mw bi"><span id="659a" class="mx ld hi mt b fi my mz l na nb">#Example Of 100 Iterations Of 10Mil Sub-Iterations</span><span id="1391" class="mx ld hi mt b fi nc mz l na nb">Pi_Estimate_Array=[]</span><span id="d709" class="mx ld hi mt b fi nc mz l na nb">OuterLoopIterations=1000</span><span id="81b8" class="mx ld hi mt b fi nc mz l na nb">InnerLoopIterations=10000</span><span id="08c1" class="mx ld hi mt b fi nc mz l na nb">for i in range(0,OuterLoopIterations):</span><span id="81a1" class="mx ld hi mt b fi nc mz l na nb">Pi_Estimate_Array.append(pi_estimate(InnerLoopIterations,'random.random',showChart=False))</span><span id="656b" class="mx ld hi mt b fi nc mz l na nb">pd.DataFrame(Pi_Estimate_Array).hist(bins=100)</span><span id="13e7" class="mx ld hi mt b fi nc mz l na nb">plt.title("Histogram For Estimate Of Pi")</span><span id="1237" class="mx ld hi mt b fi nc mz l na nb">print("For "+str(OuterLoopIterations)+" Outer Loops Of "+str(InnerLoopIterations)+" Inner Loops")</span><span id="5aa1" class="mx ld hi mt b fi nc mz l na nb">print("P50 Estimate Of Pi = "+str(np.percentile(Pi_Estimate_Array,0.5)))</span><span id="ce67" class="mx ld hi mt b fi nc mz l na nb">print("Average Estimate Of Pi = "+str(np.average(Pi_Estimate_Array)))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ng"><img src="../Images/cecbbe6dc58c6f8c151eb4c00a3c6328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FA8Y25CA2PP63PvH6xqHoQ.png"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx translated">对于1000个外循环和10，000个内循环，π到四位数的平均估计值为3.1425…</figcaption></figure><p id="ba16" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">如果我们有点疯狂，并且不介意‘最大化’谷歌的免费分配——我们可以用<strong class="kd hj">100万(！)</strong>内部循环，用Google Colab的GPU模式重新运行(这有点像用一辆布加迪开到你街角的杂货店买牛奶)</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nl"><img src="../Images/df5004f660762eaaeb5107de4b34b591.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*7kB8BxLTAf3oonI0Rg-c6Q.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nm"><img src="../Images/53f8ba2f50a4e96f04edcf5c88f3e096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UAxJwa7kFm2Ly9Rgab7Oqw.png"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx translated">对于1000个外循环和100万个内循环，π到四位数的平均估计值是3.1416…(注意，即使在GPU上运行，这仍然需要大约9分钟)</figcaption></figure><h1 id="4e70" class="lc ld hi bd le lf lg lh li lj lk ll lm io ln ip lo ir lp is lq iu lr iv ls lt bi translated">4.结论</h1><p id="9704" class="pw-post-body-paragraph kb kc hi kd b ke lw ij kg kh lx im kj kk mk km kn ko ml kq kr ks mm ku kv kw hb bi translated">虽然这是一个有趣的练习，但我猜你们中的一些人可能会问，计算这么多位数的<strong class="kd hj"> π </strong>的值是否有任何实际用途…</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nn"><img src="../Images/c1fe66a09d43eeadd8d137c7cf482be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQmnx9AsTrbuTr3VAHu_ug.png"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx translated">左边的图片——一篇有趣的文章，一位<a class="ae ky" href="https://cloud.google.com/blog/products/compute/calculating-31-4-trillion-digits-of-archimedes-constant-on-google-cloud" rel="noopener ugc nofollow" target="_blank">谷歌云开发者计算出圆周率为31.4万亿(！)数字</a>通过96个虚拟CPU(内存为1.4万亿字节)和24个10TB固态硬盘阵列来存储对比结果，图像在右边<a class="ae ky" href="https://tvtropes.org/pmwiki/pmwiki.php/Recap/MyLittlePonyFriendshipIsMagicS7E23SecretsAndPies" rel="noopener ugc nofollow" target="_blank">我的小马S07 E23中非常特别的一集，其中Pinky Pie为Pies疯狂</a> …</figcaption></figure><p id="1bc4" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">虽然谷歌试图推动这一限制是有趣的…根据美国宇航局，15位数足以获得他们的太空任务轨迹计算的可接受误差。</p><div class="jj jk ez fb jl jm"><a href="https://www.jpl.nasa.gov/edu/news/2016/3/16/how-many-decimals-of-pi-do-we-really-need/" rel="noopener  ugc nofollow" target="_blank"><div class="jn ab dw"><div class="jo ab jp cl cj jq"><h2 class="bd hj fi z dy jr ea eb js ed ef hh bi translated">我们真正需要的圆周率的小数位数是多少？- Edu新闻|美国宇航局/JPL·edu</h2><div class="jt l"><h3 class="bd b fi z dy jr ea eb js ed ef dx translated">本周早些时候，我们收到了一位脸书迷的提问，他想知道数学中有多少位小数…</h3></div><div class="ju l"><p class="bd b fp z dy jr ea eb js ed ef dx translated">www.jpl.nasa.gov</p></div></div><div class="jv l"><div class="no l jx jy jz jv ka jh jm"/></div></div></a></div><div class="jj jk ez fb jl jm"><a href="https://blogs.scientificamerican.com/observations/how-much-pi-do-you-need/" rel="noopener  ugc nofollow" target="_blank"><div class="jn ab dw"><div class="jo ab jp cl cj jq"><h2 class="bd hj fi z dy jr ea eb js ed ef hh bi translated">你需要多少圆周率？</h2><div class="jt l"><h3 class="bd b fi z dy jr ea eb js ed ef dx translated">我希望你为明天的圆周率逼近日派对做好准备了。你可能在3月14日观察过圆周率日。它…</h3></div><div class="ju l"><p class="bd b fp z dy jr ea eb js ed ef dx translated">blogs.scientificamerican.com</p></div></div><div class="jv l"><div class="np l jx jy jz jv ka jh jm"/></div></div></a></div><p id="4683" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">不管怎样，尽管事实如此，希望这仍然是蒙特卡罗方法的一个有趣的应用。</p><p id="22ef" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">希望每个人都度过了美好的一天！</p><p id="416e" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">下次见！</p></div></div>    
</body>
</html>