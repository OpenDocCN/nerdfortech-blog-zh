<html>
<head>
<title>Writing unit tests in Golang Part 1: Introducing Testify</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Golang编写单元测试第1部分:引入证明</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/writing-unit-tests-in-golang-part-1-introducing-testify-c0d458442412?source=collection_archive---------2-----------------------#2021-06-27">https://medium.com/nerd-for-tech/writing-unit-tests-in-golang-part-1-introducing-testify-c0d458442412?source=collection_archive---------2-----------------------#2021-06-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/e979cf6c23d2e1f0e5dab69b6d46354b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_B_CYQs3auQOMGVLKoPYw.png"/></div></figure><p id="4f5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi jk translated"><span class="l jl jm jn bm jo jp jq jr js di"> U </span> nit测试是一种为程序的单个组件(也就是最小的部分)编写测试的方法。它的目的是验证任何一段代码总是按预期工作。</p><p id="b5df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此外，单元测试有很多优点，如提高代码质量，提供文档，代码可以单独测试，不需要另一个模块就可以工作，等等。</p><p id="eae5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我不打算解释什么是单元测试，因为这超出了本文的范围。在本文的最后，我会列出一些有用的资源，供你进一步阅读单元测试。</p><h1 id="5d15" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">为什么你总是要写单元测试？</h1><p id="9b62" class="pw-post-body-paragraph im in hi io b ip kr ir is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj hb bi translated">简单！以确保在修改代码时不会出错。单元测试确保一切按预期运行，还可以在bug进入生产之前防止或检测到它们。</p><p id="e6cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我见过很多不写测试尤其是单元测试的程序员。缺乏测试可能会在应用程序中引入错误，影响用户体验，甚至更糟，破坏应用程序…哎呀！</p><h1 id="8e3a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">一个叫做“作证”的包裹</h1><p id="1a46" class="pw-post-body-paragraph im in hi io b ip kr ir is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj hb bi translated">作证是…</p><blockquote class="kw kx ky"><p id="0e14" class="im in kz io b ip iq ir is it iu iv iw la iy iz ja lb jc jd je lc jg jh ji jj hb bi translated">Go code (golang)一组包，提供了许多工具来证明您的代码将如您所愿地运行。https://github.com/stretchr/testify<br/></p></blockquote><p id="ec7f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">哇，等一下。但是Go已经有了标准的<a class="ae ld" href="https://golang.org/pkg/testing/" rel="noopener ugc nofollow" target="_blank">测试包</a>！为什么我们需要另一个库来编写测试？</p><p id="3a8d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">好问题！Go标准测试包在测试方面做得不错，但是它仍然缺少一些有用的功能，比如断言、模拟和测试套件。evidence就像是Go标准测试包的扩展，可以完成我提到的所有事情(是的，为了使用evidence，您需要标准测试包)。</p><h1 id="0d3a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">例子</h1><p id="0271" class="pw-post-body-paragraph im in hi io b ip kr ir is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj hb bi translated">在这一节，我将展示一些用Go编写单元测试的例子。在我们开始之前，我会给你一些关于编写测试的提示。</p><h2 id="f4ee" class="le ju hi bd jv lf lg lh jz li lj lk kd ix ll lm kh jb ln lo kl jf lp lq kp lr bi translated">编写测试的技巧。</h2><ol class=""><li id="2ce8" class="ls lt hi io b ip kr it ks ix lu jb lv jf lw jj lx ly lz ma bi translated">将您的测试文件保存在与要测试的函数相同的目录中。</li><li id="4e5b" class="ls lt hi io b ip mb it mc ix md jb me jf mf jj lx ly lz ma bi translated">测试函数名应该以单词<strong class="io hj"> Test </strong>开头。</li></ol><h2 id="b91e" class="le ju hi bd jv lf lg lh jz li lj lk kd ix ll lm kh jb ln lo kl jf lp lq kp lr bi translated">单元测试示例(简单)</h2><p id="c188" class="pw-post-body-paragraph im in hi io b ip kr ir is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj hb bi translated">让我们从一个简单的<code class="du mg mh mi mj b">Add</code>函数开始。该函数接受两个参数，并返回它们的总和。</p><figure class="mk ml mm mn fd ij"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="acda" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">其测试功能如下所示。</p><figure class="mk ml mm mn fd ij"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="77ec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">仔细看第21行，您会看到我们调用了函数<code class="du mg mh mi mj b">assert.Equal</code>来断言实际结果和预期结果的值。如果它们相等，则测试通过。否则，测试失败。</p><h2 id="5b6f" class="le ju hi bd jv lf lg lh jz li lj lk kd ix ll lm kh jb ln lo kl jf lp lq kp lr bi translated">单元测试示例(测试表)</h2><p id="aed9" class="pw-post-body-paragraph im in hi io b ip kr ir is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj hb bi translated">在下一个例子中，我将向您展示如何为单元测试创建一个测试表。<br/>这里我们定义一个函数<code class="du mg mh mi mj b">IsAllLowerCase</code>。如果给定的输入只包含小写字符，它将返回<code class="du mg mh mi mj b">true</code>。否则，返回<code class="du mg mh mi mj b">false</code>。</p><figure class="mk ml mm mn fd ij"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="6332" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">其测试功能如下所示。</p><figure class="mk ml mm mn fd ij"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="b493" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，定义具有以下字段的<code class="du mg mh mi mj b">testCase</code>结构；<code class="du mg mh mi mj b">name</code>(作为测试用例名称)、<code class="du mg mh mi mj b">input</code>(作为函数输入)、<code class="du mg mh mi mj b">expectedResult</code>(作为测试的预期结果)、<code class="du mg mh mi mj b">hasError</code>(作为结果预期错误的标志)。</p><p id="57df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用<code class="du mg mh mi mj b">testCase</code>的切片定义一个测试表。您可以定义任意多的测试。它可能是你能想到的最简单或最离奇的事情。</p><p id="52d2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过for…循环测试表开始测试。在这个例子中，我们使用函数<code class="du mg mh mi mj b">assert.Nil</code>和<code class="du mg mh mi mj b">assert.NotNil</code>来分别断言当前的测试用例不期望或者期望一个错误。</p><p id="9037" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这就是本文的全部内容。还有更多我们没有讨论的话题，比如嘲讽和测试套件。在本系列的下一部分，我将向您展示更多关于它们的内容。再见，永远写测试！</p><h1 id="a7db" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">看我的其他文章</h1><div class="mq mr ez fb ms mt"><a href="https://siraphobk.medium.com/flutter-basics-the-differences-between-stateless-widget-and-stateful-widget-3f66cec639b0" rel="noopener follow" target="_blank"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">Flutter基础知识:无状态小部件和有状态小部件之间的区别</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">Flutter中的Widget是什么？理解有状态和无状态Wigets。</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">siraphobk.medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ik mt"/></div></div></a></div><div class="mq mr ez fb ms mt"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/flutter-2-null-safety-in-a-nutshell-f20aeb74772"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">扑2:简而言之，零安全</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">你的flutter应用程序听起来不安全！</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">medium.com</p></div></div><div class="nc l"><div class="ni l ne nf ng nc nh ik mt"/></div></div></a></div><h1 id="0fed" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考资料和进一步阅读</h1><ul class=""><li id="219d" class="ls lt hi io b ip kr it ks ix lu jb lv jf lw jj nj ly lz ma bi translated"><a class="ae ld" href="https://levelup.gitconnected.com/what-you-need-to-know-about-unit-testing-7b04004da8fe" rel="noopener ugc nofollow" target="_blank">关于艾迪森·亚伯拉德的单元测试，你需要知道什么</a></li><li id="17cb" class="ls lt hi io b ip mb it mc ix md jb me jf mf jj nj ly lz ma bi translated"><a class="ae ld" href="https://betterprogramming.pub/unit-testing-and-why-you-should-be-doing-it-ab61407c53ce" rel="noopener ugc nofollow" target="_blank">尼克·霍奇斯的《单元测试和为什么你应该这么做》</a></li></ul></div></div>    
</body>
</html>