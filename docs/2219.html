<html>
<head>
<title>Asynchronous Fruits with async and await JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用async和await JavaScript的异步结果</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/asynchronous-fruits-with-async-and-await-javascript-d8c4f2c91e8a?source=collection_archive---------22-----------------------#2021-04-26">https://medium.com/nerd-for-tech/asynchronous-fruits-with-async-and-await-javascript-d8c4f2c91e8a?source=collection_archive---------22-----------------------#2021-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c7b7d85f40efcd25e9f697d929d431f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SG5X-aYKkogzd-7S"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@reiseuhu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Reiseuhu </a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="808e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du jt ju jv jw b">async</code>和<code class="du jt ju jv jw b">await</code>是两个关键词，可以帮助异步代码读起来更像同步代码。这可以帮助代码看起来更整洁，同时保留异步代码的优点。异步意味着事情可以独立于主程序流发生。大多数程序都是异步的，在需要的时候才会暂停执行，让计算机同时执行其他事情。</p><p id="c252" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du jt ju jv jw b">async</code>和<code class="du jt ju jv jw b">await</code>是建立在承诺上的功能。一个承诺通常被定义为一个价值的代理，这个价值最终将变得可用。承诺是处理异步代码的一种方式。</p><h1 id="e1fa" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">承诺是如何起作用的？</h1><p id="a001" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">一个<code class="du jt ju jv jw b">Promise</code>是一个有状态和值的对象。一旦<code class="du jt ju jv jw b">Promise</code>被调用，它将在挂起状态下启动。调用函数继续执行，而<code class="du jt ju jv jw b">Promise</code>是挂起的，直到它被解决或拒绝，给调用函数任何被请求的数据。</p><p id="991e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建的<code class="du jt ju jv jw b">Promise</code>将最终以已解决状态或已拒绝状态结束。resolved状态意味着一切都按预期运行，而rejected状态意味着有错误。</p><h1 id="99fc" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">异步ˌ非同步(asynchronous)</h1><p id="3df6" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated"><code class="du jt ju jv jw b">async</code>关键字放在函数声明的前面，把它变成一个异步函数。当用<code class="du jt ju jv jw b">async</code>声明一个函数时，它会自动返回一个<code class="du jt ju jv jw b">Promise</code>。返回函数与解析<code class="du jt ju jv jw b">Promise</code>相同，同样，抛出错误的函数将拒绝<code class="du jt ju jv jw b">Promise</code>。</p><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="b9a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于关键字<code class="du jt ju jv jw b">async</code>，在<code class="du jt ju jv jw b">getFruit()</code>中返回的任何内容都将是该值的<code class="du jt ju jv jw b">Promise</code>。用户以水果的名称传入。该函数将从该对象解析出水果表情符号。为了实际使用<code class="du jt ju jv jw b">Promise</code>实现时返回的值，我们可以使用<code class="du jt ju jv jw b">.then()</code>块。</p><h1 id="f7a2" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">等待</h1><p id="631b" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">当您将<code class="du jt ju jv jw b">async</code>函数与<code class="du jt ju jv jw b">await</code>关键字结合起来暂停函数的执行时，它的真正威力就显现出来了。<code class="du jt ju jv jw b">await</code>关键字告诉JavaScript暂停异步函数，直到await值返回一个解析的<code class="du jt ju jv jw b">Promise</code>。不使用<code class="du jt ju jv jw b">.then()</code>回调，我们可以将一个变量赋给<code class="du jt ju jv jw b">await</code> <code class="du jt ju jv jw b">Promise</code>值来获得解析后的<code class="du jt ju jv jw b">Promise</code>的值。</p><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="b76b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du jt ju jv jw b">makeSmoothie()</code>函数将抓取多个水果，并将它们组合成一个数组。我们可以指定一个变量作为已解析的<code class="du jt ju jv jw b">Promise</code>的值。<code class="du jt ju jv jw b">await</code>将暂停<code class="du jt ju jv jw b">makeSmoothie()</code>，直到<code class="du jt ju jv jw b">getFruit()</code> <code class="du jt ju jv jw b">Promise</code>解析出一个值。我们可以将该值用作变量fruit1。我们可以再次做同样的事情来获得另一个水果并返回一个数组。</p><h1 id="e501" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">错误处理</h1><p id="5314" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">我们可以使用try/catch块来处理<code class="du jt ju jv jw b">async</code>函数中的错误。try块中的代码将正常运行，直到抛出错误。catch-block包含指定在try-block中引发异常时如何处理的语句。如果try块的任何部分抛出异常，它将转到catch块，承诺被拒绝。如果try块中没有抛出异常，则跳过catch块。</p><p id="eff5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以添加一个finally-block，它将始终在try-block和catch-block完成执行后执行。无论是否抛出异常，finally-block都会执行。如果抛出了异常，并且没有处理该异常的catch-block，finally-block中的语句仍会执行。</p><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="64d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们从fruit1和fruit2中为<code class="du jt ju jv jw b">Promise</code>创建了一个smoothie变量<code class="du jt ju jv jw b">await</code>,而不是在它们上面都有<code class="du jt ju jv jw b">await</code>关键字。这将告诉数组中的所有<code class="du jt ju jv jw b">Promises</code>同时运行。这将提高制作思慕雪的速度。我们在try-block内部有一个错误，这将导致<code class="du jt ju jv jw b">Promise</code>被拒绝并立即移动到catch-block。通过在catch块中抛出一个错误，它将破坏承诺链，并由catch回调处理。</p><h1 id="a40d" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">资源</h1><p id="b0e6" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">关于async和await的更多资源，我建议看看这些有用的链接。</p><p id="9e62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://nodejs.dev/learn/understanding-javascript-promises" rel="noopener ugc nofollow" target="_blank">https://nodejs.dev/learn/understanding-javascript-promises</a></p><p id="5fec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Async_await" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Learn/JavaScript/Asynchronous/Async _ await</a></p><p id="c5d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" rel="noopener" href="/@lydiahallie/javascript-visualized-promises-async-await-a3f1aad8a943">https://medium . com/@ lydiahallie/JavaScript-visualized-promises-async-await-a 3 f1 aad 8 a 943</a></p><p id="c95d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.theodinproject.com/paths/full-stack-javascript/courses/javascript/lessons/async-and-await" rel="noopener ugc nofollow" target="_blank">https://www . theodinproject . com/paths/full-stack-JavaScript/courses/JavaScript/lessons/async-and-await</a></p><p id="e67d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.youtube.com/watch?v=vn3tm0quoqE" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=vn3tm0quoqE</a></p></div></div>    
</body>
</html>