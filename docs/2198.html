<html>
<head>
<title>Handlebars: Partials, Helpers &amp; much more</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">车把:部分，助手和更多</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/handlebars-partials-registers-much-more-fca3f500d9e5?source=collection_archive---------1-----------------------#2021-04-26">https://medium.com/nerd-for-tech/handlebars-partials-registers-much-more-fca3f500d9e5?source=collection_archive---------1-----------------------#2021-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/8ac242201786308ac24c39e71fa87e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*rmqKZPJTvpZxLaRcTYkapQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">来源:车把官网</figcaption></figure><p id="8a8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Handlebars 是一种模板语言，用于呈现前端和后端的动态数据。HTML 的框架对于每个人来说都是固定的，作为 hbs 模板，在运行时动态数据将创建一个最终的 HTML 文件。只需输入{{}}，就可以多次使用同一个 HTML 模板文件。在运行期间，{{}}被实际数据替换。</p><p id="3a79" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Handlebars 是 Node.js 中使用的模板引擎之一，Node.js 生成的 HTML 文件称为“服务器端渲染(SSR)”。Handlebars 是对<a class="ae jo" href="https://mustache.github.io/" rel="noopener ugc nofollow" target="_blank"> Mustache </a>模板语言的扩展，它主要关注简单性和最小化模板。</p><p id="21c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在今天的帖子中，我们将讨论以下内容。</p><ol class=""><li id="8ab5" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">分音</li><li id="4f6c" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">助手</li><li id="f0b1" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">HBS 在线项目的实施</li></ol><p id="8483" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用两个文件 1。index.hbs &amp; 2。index.js 文件来显示示例。我将向你展示一些最受欢迎的内置助手。</p><h2 id="ad3a" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">分音:</h2><p id="4f78" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">车把中的部件是一些可重用的模板，可以从任何其他模板中访问。必须通过把手注册 Partial。</p><h2 id="4721" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">助手:</h2><p id="fc7c" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">手柄中的助手是在给定的输入上执行某个动作并返回输出的函数。一些内置的帮助器有#if、# until、#each、#with、log &amp; lookup。</p><h2 id="a26b" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">#除非:</h2><p id="5c73" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">这是一个内置的块助手，用于检查手柄中的条件语句。如果值为 false，则呈现 If 块中的内容。它是#if helper 的反义词。</p><p id="8785" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如:</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="ca9d" class="kd ke hi li b fi lm ln l lo lp">// Code in index.js<br/>{<br/>  fruits: {<br/>    "Apple": true,<br/>    "Cucumber": false,<br/>    "Banana": true,<br/>  },<br/>}</span><span id="ff92" class="kd ke hi li b fi lq ln l lo lp">// Code in index.hbs<br/>{{#unless fruits.Cucumber}}<br/>  &lt;li&gt;Cucumber is not fruit&lt;/li&gt;<br/>{{/unless}}</span></pre><h2 id="b498" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">#如果:</h2><p id="3b07" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">这是一个内置的块助手，用于检查手柄中的条件语句。如果值为 true，则呈现 If 块中的内容。不像 javascript 代码，不会做≥或===这样的比较。如果要执行这样的操作，要么在渲染前预处理数据，要么创建一个辅助函数。</p><p id="5b58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如:</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="9669" class="kd ke hi li b fi lm ln l lo lp">// Code in index.js<br/>{<br/>  fruits: {<br/>    "Apple": true,<br/>    "Cucumber": false,<br/>    "Banana": true,<br/>  },<br/>}</span><span id="5c86" class="kd ke hi li b fi lq ln l lo lp">// Code in index.hbs<br/>{{#if fruits.Apple}}<br/>  &lt;li&gt;Apple is fruit&lt;/li&gt;<br/>{{/if}}</span></pre><h2 id="0aa5" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">#每个:</h2><p id="6aa8" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">每个都是一个内置的块助手，在手柄中用来呈现数组输入。您可以通过这个从数组中出来来访问父对象../parentObject.property。如果数组包含对象，则可以通过调用对象的键来访问该值</p><p id="e045" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如:</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="9aef" class="kd ke hi li b fi lm ln l lo lp">// Code in index.js<br/>{<br/>  type: "Fruits List",<br/>  fruits: [<br/>    "Apple",<br/>    "Mango",<br/>    "Banana",<br/>  ],<br/>}</span><span id="0300" class="kd ke hi li b fi lq ln l lo lp">{<br/>  type: "Books List",<br/>  books: [{<br/>    autherName: "John Doe",<br/>    publishedOn: "1998",<br/>    bookName: "Magics of life"<br/>   }, {<br/>    autherName: "Smith Carl",<br/>    publishedOn: "2004",<br/>    bookName: "Black hole: Begining"<br/>   }],<br/>}</span><span id="8044" class="kd ke hi li b fi lq ln l lo lp">// Code in index.hbs<br/>&lt;ul class="fruits"&gt;<br/>  {{#each fruits}}<br/>    &lt;li&gt;{{this}} is part of {{../type}}&lt;/li&gt;<br/>  {{/each}}<br/>&lt;/ul&gt;</span><span id="0043" class="kd ke hi li b fi lq ln l lo lp">&lt;ul class="books"&gt;<br/>  {{#each books}}<br/>    &lt;li&gt;{{this.autherName}} published {{this.bookName}} on {{this.publishedOn}}&lt;/li&gt;<br/>  {{/each}}<br/>&lt;/ul&gt;</span></pre><h2 id="fc03" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">自定义助手:</h2><p id="50f8" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">为了在模板中使用它，您必须用手柄注册辅助对象。它有两个参数:助手名和函数参数</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="c990" class="kd ke hi li b fi lm ln l lo lp">// Code in index.js<br/>handlebars.registerHelper(‘calDiscountAmount’, (planValue, discountPer) =&gt; ((planValue * discountPer) / 100).toFixed(0))</span><span id="8286" class="kd ke hi li b fi lq ln l lo lp">// Code in index.hbs<br/>&lt;p&gt;<br/>Discount of Rs.{{calDiscountAmount 1000 20}}<br/>&lt;/p&gt;</span><span id="4071" class="kd ke hi li b fi lq ln l lo lp">// On execution it will show<br/>Discount of Rs.200</span></pre><p id="e990" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看一个完整的车把演示。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="cd59" class="kd ke hi li b fi lm ln l lo lp">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/> &lt;title&gt;{{title}}&lt;/title&gt;<br/> {{&gt; (whichPartial)}}<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/> {{&gt;nav}}<br/> &lt;section&gt;<br/>  {{#each products}}<br/>  &lt;div class="product"&gt;<br/>   &lt;img src="{{priductUrl}}" alt="{{productAltText}}" /&gt;<br/>   &lt;div class="description"&gt;<br/>    &lt;h3&gt;{{productName}}&lt;/h3&gt;<br/>    &lt;h5&gt;${{productPrice}}&lt;/h5&gt;<br/>    {{#if <!-- -->discountPer<!-- -->}}<br/>    &lt;span&gt;Discount of ${{calDiscountAmount productPrice      <!-- -->discountPer<!-- -->}}&lt;/span&gt;<br/>    {{#if}}<br/>    {{#if isInInventory}}<br/>    &lt;h4&gt;Qty: {{productQty}}&lt;/h4&gt;<br/>    {{else}}<br/>    &lt;h4&gt;Out of stock&lt;/h4&gt;<br/>    {{/if}}<br/>    &lt;/div&gt;<br/>   &lt;/div&gt;<br/>  {{/each}}<br/>  &lt;/section&gt;<br/> &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="dd51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">index.js 中的内容</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="159d" class="kd ke hi li b fi lm ln l lo lp">const Handlebars = require('handlebars')<br/>const nav = fs.readFileSync('./nav.hbs').toString()<br/>const suppFilesProd = fs.readFileSync('./suppFilesProd.hbs').toString()<br/>const suppFiles = fs.readFileSync('./suppFiles.hbs').toString()</span><span id="aaf1" class="kd ke hi li b fi lq ln l lo lp">const products = [{<br/> priductUrl: 'https://guesseu.scene7.com/is/image/1234',<br/> productAltText: 'Sneaker',<br/> productName: 'Gloria high logo sneaker',<br/> productPrice: 100,<br/> isInInventory: true,<br/> productQty: 200,<br/> discountPer: 20,<br/> }, {<br/> priductUrl: 'https://guesseu.scene7.com/is/image/4567',<br/> productAltText: 'Shirt',<br/> productName: 'Check print shirt',<br/> productPrice: 100,<br/> isInInventory: true,<br/> productQty: 20,<br/> discountPer: null,<br/> }, {<br/> priductUrl: 'https://guesseu.scene7.com/is/image/8756',<br/> productAltText: 'Bag',<br/> productName: 'Cate rigid bag',<br/> productPrice: 100,<br/> isInInventory: false,<br/> productQty: 35,<br/> discountPer: null,<br/>}]</span><span id="1c10" class="kd ke hi li b fi lq ln l lo lp">handlebars.registerHelper(‘calDiscountAmount’, (planValue, discountPer) =&gt; ((planValue * discountPer) / 100).toFixed(0))</span><span id="a9a5" class="kd ke hi li b fi lq ln l lo lp">handlebars.registerHelper('whichPartial', () =&gt; {<br/>  const returnPartial = process.env.NODE_ENV === 'production' ?   Handlebars.compile(suppFilesProd) : Handlebars.compile(suppFiles)<br/>  return returnPartial<br/>})</span><span id="3ee9" class="kd ke hi li b fi lq ln l lo lp">handlebars.registerHelper('complexDiscount', (...value) =&gt; {<br/> const data = value.filter((i) =&gt; isNumber(i))<br/> return data.length &gt; 0 ? data.reduce((a, b) =&gt; a -b) : 0<br/>})</span><span id="4a60" class="kd ke hi li b fi lq ln l lo lp">handlebars.registerPartial('nav', Handlebars.compile(nav))</span><span id="6edb" class="kd ke hi li b fi lq ln l lo lp">router.get('/products', (req, res) =&gt; {<br/> res.render('index', {<br/>  title: 'Buy cool new products',<br/>  products<br/> })<br/>})</span></pre><p id="1ba6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的代码中，nav partial 是所有网站页面通用的导航菜单代码文件。因此，我们将其注册为部分，并在所有 hbs 文件中使用。所以你不必在所有多余的页面上写同样的代码。</p><p id="1958" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">哪个部分用于根据节点环境动态决定将哪些数据注册为部分数据。当您需要分析或其他只在生产环境中需要的代码时，这很有用。</p><p id="d215" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当您想要向函数发送 n 个参数时，使用复杂的折扣寄存器。让我们举个例子，假设你给第一个人 1 个折扣，给另一个人 3 个不同的折扣。“…value”需要任意数量的参数。</p><h2 id="6236" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">结论:</h2><p id="0473" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">车把通过删除多余的代码、制作模板来简化您的生活。条件语法、循环、寄存器和部分使静态页面变成了动态页面。</p></div></div>    
</body>
</html>