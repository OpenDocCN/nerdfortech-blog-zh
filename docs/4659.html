<html>
<head>
<title>Get global variables in React JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">获取React JS中的全局变量</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/get-global-variables-in-react-js-490cf68f2a73?source=collection_archive---------0-----------------------#2021-08-01">https://medium.com/nerd-for-tech/get-global-variables-in-react-js-490cf68f2a73?source=collection_archive---------0-----------------------#2021-08-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/adb68863da1466636e89b15c38f3d335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rdvqHr6W1CMXDwye"/></div></div></figure><p id="93ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们假设你正在制作一个在<code class="du jo jp jq jr b">http://localhost:3000</code>向后端发出大量请求的应用程序。现在您转移到生产构建，在您使用的任何托管服务上托管它之后，URL被更改为<code class="du jo jp jq jr b">https://yasharyan.com</code>。想象一下，找到您使用过的每一行localhost URL并将其更改为新的URL是多么痛苦。如果你能聪明地编码并使用一个全局变量来输入这个:<br/> <code class="du jo jp jq jr b">${URL}/server-time-up/UTC/</code>不是很好吗</p><p id="1faa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有很多方法可以在React JS中创建全局变量，这些变量可以在web应用程序的每个组件中访问。我将告诉你最常见和最简单的方法。</p><p id="0da2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上下文提供了一种通过组件树传递数据的方式，而不必在每一层手动向下传递属性。它最好的一点是不需要安装外部依赖项。上下文与React捆绑在一起。它有一个简单的方法。假设你有许多组件想要使用一个公共变量。它可以很容易地从上下文中导入，而不是一直作为道具从父组件中传递。</p><h1 id="a517" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">怎么做？</h1><p id="79aa" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">为了便于阅读代码，最好在react应用程序的<code class="du jo jp jq jr b">src</code>文件夹中创建一个<code class="du jo jp jq jr b">context</code>目录。然后在该文件夹中创建一个<code class="du jo jp jq jr b">CONTEXT_NAMEContext.js</code>文件。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/cec1a6c8ec1a1ecb8971f45c65d3cc29.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/0*e7PPAL5DTIeTp6_m"/></div></figure><p id="94b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个项目中可以有多少个上下文没有限制。事实上，你可以为你的应用程序想要使用上下文的每一个功能提供一个专用的上下文。创建上下文的代码如下所示:</p><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="7ebc" class="le jt hi jr b fi lf lg l lh li">import React, { createContext, useState } from 'react'<br/>export const SampleContext = createContext()<br/>const SampleContextProvider = (props) =&gt; {<br/>    const [variableOne, setVariableOne] = useState('somethingRandom`)<br/>    const Url = "http://localhost:3000"<br/>    return (<br/>         &lt;SampleContext.Provider <br/>            value={{<br/>                variableOne,<br/>                Url<br/>             }}&gt;<br/>               {props.children}<br/>         &lt;/SampleContext.Provider&gt;<br/>    )<br/>}<br/>export default SampleContextProvider</span></pre><p id="b1b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意，所有需要全局化的变量(甚至是函数)在return语句中都被作为<code class="du jo jp jq jr b">values</code>传递。既然已经导出了上下文，那么是时候将其导入到组件中了。首先，转到App.js文件，包装所有想要访问上下文的组件。所有子组件将自动继承上下文。</p><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="7768" class="le jt hi jr b fi lf lg l lh li">import React, { Fragment } from 'react'<br/>   import Component_One from './Component_One'<br/>   import Component_Two from './Component_Two'<br/>   import Component_Three from './Component_Three'<br/>   import SampleContextProvider from '../contexts/SampleContext'<br/>   const mainComponent = () =&gt; {<br/>      return (<br/>        &lt;Fragment&gt;<br/>            &lt;h1&gt;This is a sample component&lt;/h1&gt;<br/>            &lt;SampleContextProvider&gt;<br/>                &lt;Component_One /&gt;<br/>                &lt;Component_Two /&gt;<br/>                &lt;Component_Three /&gt;<br/>            &lt;/SampleContextProvider&gt;<br/>        &lt;/Fragment&gt;<br/>      )<br/>   }</span></pre><p id="3308" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意所有导入的组件是如何用<code class="du jo jp jq jr b">&lt;SampleContextProvider&gt;</code>包装的？所有这些组件现在都可以访问上下文中的所有值。要访问(消费)它们，您必须执行以下操作:</p><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="becc" class="le jt hi jr b fi lf lg l lh li">import React, { Fragment, useState, useContext } from 'react'<br/>import SampleContext from '../contexts/SampleContext'<br/>import axios from 'axios'<br/>const Component_One = () =&gt; {<br/>    const { variableOne, Url } = useContext(SampleContext)<br/>    const [getServerTimeUp, setServerTimeUp ] = useState()<br/>    axios.get(`${Url}/server-time-up/UTC/`)<br/>    .then(res =&gt; {<br/>       setServerTimeUp(res.data.time)<br/>    }<br/>    return (<br/>        &lt;Fragment&gt;<br/>             &lt;h1&gt;This is the value of variableOne: {variableOne}&lt;/h1&gt;<br/>             &lt;p&gt;{getServerTimeUp}&lt;/p&gt;<br/>        &lt;/Fragment&gt;<br/>    )<br/>}</span></pre><p id="7a04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样，您可以在任何需要的组件中全局设置和获取变量。</p><h1 id="47cc" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">使用。环境文件</h1><p id="15d5" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">如果你用过NodeJS，你可能用过或者听说过<code class="du jo jp jq jr b">.env</code>文件。让我们在您的React应用程序上获得该功能。</p><h1 id="4d7d" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">案例1:使用创建-反应-应用程序</h1><p id="2d6d" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">如果你正在使用<code class="du jo jp jq jr b">create-react-app</code>来快速设置你的React应用，你添加一个<code class="du jo jp jq jr b">.env</code>文件的工作已经完成了一半。</p><ul class=""><li id="6b56" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">步骤1:在React应用程序的根目录下创建一个. env文件</li></ul><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/4d9e5ac5d3246c61291d6b0304e3887d.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/0*A0lkhbLm9ayx6jGO"/></div></figure><ul class=""><li id="c200" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">第2步:开始在<code class="du jo jp jq jr b">.env</code>文件中输入变量。请记住，您需要用一个<code class="du jo jp jq jr b">REACT_APP_</code>来开始每个变量，这样它才能工作；否则，您的变量不会被导入。</li></ul><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="070f" class="le jt hi jr b fi lf lg l lh li">REACT_APP_DATABASE=redis<br/>REACT_APP_FIRST_RELEASE=02Nov2019<br/>REACT_APP_LAST_UPDATE=07Dec2020</span></pre><ul class=""><li id="f649" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">第三步:使用<code class="du jo jp jq jr b">process.env.REACT_APP_</code>将它们导入你的组件</li></ul><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="814f" class="le jt hi jr b fi lf lg l lh li">render() {<br/>return (<br/>  &lt;div&gt;<br/>       &lt;h1&gt;<br/>          We are using {process.env.REACT_APP_DATABASE}<br/>       &lt;/h1&gt;<br/>  &lt;/div&gt;<br/>);<br/>}</span></pre><h1 id="3bf8" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">案例2:不使用create-react-app</h1><p id="a36b" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">如果你想对你的项目有更多的控制权，并自己编写webpack，你需要多做几个步骤来设置<code class="du jo jp jq jr b">.env</code>支持。</p><ul class=""><li id="f5ab" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">步骤1:使用<code class="du jo jp jq jr b">npm install dotenv</code>或<code class="du jo jp jq jr b">yarn install dotenv</code>在你的项目中安装dotenv包</li><li id="577e" class="lj lk hi is b it lt ix lu jb lv jf lw jj lx jn lo lp lq lr bi translated">步骤2:如果您需要所有组件的支持，或者如果您希望其他组件支持，只需要特定组件的支持，请将文件导入index.js文件。<code class="du jo jp jq jr b">require('dotenv').config()</code></li><li id="2dd1" class="lj lk hi is b it lt ix lu jb lv jf lw jj lx jn lo lp lq lr bi translated">步骤3:现在，您可以按照案例1中的相同过程来设置您的环境变量。如果你没有使用<code class="du jo jp jq jr b">create-react-app</code>，你不需要用<code class="du jo jp jq jr b">REACT_APP_</code>开始每个变量。</li></ul><h1 id="92d4" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">从. js文件手动导出</h1><p id="258b" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">这可能是拥有全局变量的最简单的方法。</p><ul class=""><li id="23c2" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">第一步:转到你的<code class="du jo jp jq jr b">src</code>文件夹，创建一个名为<code class="du jo jp jq jr b">constants</code>的新文件夹，或者你想给它起的名字。</li></ul><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/d3db6268a5eabca1eca40944064c07f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/0*1-98r95BxboG1rzv"/></div></figure><ul class=""><li id="ce60" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">第二步:像<code class="du jo jp jq jr b">global.js</code>一样在上述文件夹的一个新文件中创建多个变量，然后导出它们，以便它们可以导入到其他组件中。</li></ul><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="7db2" class="le jt hi jr b fi lf lg l lh li">const Url = 'http://localhost:5000'<br/>const themeDefault = 'dark'<br/>const namesOfModes = ['dark', 'moonlight', 'eclipse', 'light']<br/><br/>export { Url, themeDefault, namesOfModes }</span></pre><ul class=""><li id="59ed" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">步骤3:现在是时候将这些常量导入到组件中了</li></ul><pre class="kw kx ky kz fd la jr lb lc aw ld bi"><span id="92a4" class="le jt hi jr b fi lf lg l lh li">import React from 'react'<br/>import { Url, themeDefault, namesOfModes } from '../constants/global'<br/>const Component_Three = () =&gt; {<br/>  return (<br/>     &lt;div&gt;<br/>       &lt;h1&gt;Current Theme: {themeDefault}&lt;/h1&gt;<br/>       &lt;p&gt;Homepage: {Url}&lt;/p&gt;<br/>     &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="556c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:<em class="lz">你可能会说你可以使用像Redux和反冲JS这样的包，但是让我提醒你，它们是状态管理工具，它们不应该仅仅用来存储全局常量。</em></p></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><h1 id="89fd" class="js jt hi bd ju jv mh jx jy jz mi kb kc kd mj kf kg kh mk kj kk kl ml kn ko kp bi translated">谢谢</h1><p id="1f30" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">希望你发现这篇文章信息丰富，耐人寻味。如果它对你有帮助，就像🧡一样给它一个名字，并与可能会发现它有用的人分享。还可以查看我的<a class="ae mm" href="https://www.instagram.com/encodable/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>和<a class="ae mm" href="https://www.facebook.com/enc0dable" rel="noopener ugc nofollow" target="_blank">脸书</a>页面了解更多内容。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/1e7b8550ea41007ec2ac087400940ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/0*09bHb8Bu5F3QWvYQ.png"/></div></figure><p id="290e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑支持我。<a class="ae mm" href="https://buymeacoffee.com/yasharyan" rel="noopener ugc nofollow" target="_blank">https://buymeacoffee.com/yasharyan</a></p></div></div>    
</body>
</html>