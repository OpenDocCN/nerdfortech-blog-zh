<html>
<head>
<title>AWS Lambda + Serverless + Kotlin Waste share App Series — Intro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Lambda +无服务器+ Kotlin废物共享应用程序系列—简介</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/aws-lambda-serverless-kotlin-waste-share-app-series-intro-ef3adc8f0d57?source=collection_archive---------0-----------------------#2021-10-03">https://medium.com/nerd-for-tech/aws-lambda-serverless-kotlin-waste-share-app-series-intro-ef3adc8f0d57?source=collection_archive---------0-----------------------#2021-10-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cd4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在开始创建应用程序之前，我只是想让你们知道，我们正在使用这些技术栈实现这个应用程序的后端。对于前端应用程序，我希望使用React，这将是另一个系列。好了，这是我在开始教程之前需要做的主要声明。现在让我们深入到技术层面。</p><p id="3308" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">世界上许多公司现在都在使用AWS来托管他们的应用程序，因为现在这样更方便。你不必维护物理服务器，你只需要有一个AWS帐户，许多托管解决方案就在你家门口。作为软件工程师，我们应该想出具有成本效益的方法来托管这些应用程序。在这种情况下，AWS lambda是用于后端开发的一个很好的服务。以下是AWS给AWS lambda的定义。</p><p id="ba44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“AWS Lambda是一种无服务器计算服务，让您无需配置或管理服务器、创建工作负载感知集群扩展逻辑、维护事件集成或管理运行时即可运行代码。”</p><p id="b383" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Lambda自动精确地分配计算执行能力，并根据传入的请求或事件运行您的代码，适用于任何规模的流量。现在我们不需要ELB(弹性负载平衡器)、EC2服务器等来托管我们的应用程序。只有当我们的lambda函数被触发时，AWS才会充电。</p><p id="62be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们使用无服务器框架而不是直接将代码上传到AWS lambda的原因是，无服务器框架提供了AWS Lambda包和部署流程的简单有效的抽象。因此，我们可以在本地对配置进行编码，然后在AWS中使用命令应用程序。</p><p id="014b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么是Kotlin而不是Java？。Kotlin是一种静态类型的编程语言，运行在JVM上，也可以编译成JavaScript源代码以及使用LLVM编译器基础设施。它还通过实现解决方案解决了一些Java问题，如<strong class="ih hj">消除了这些空引用的危险</strong>、<strong class="ih hj">不变数组、函数类型、lambda表达式或匿名函数可以访问外部作用域中声明的变量等等。尽管这并不比Java好，但已经相当不错了，语法也很简单。现在你准备好开始了吗？如果没有，请再读一遍😜。</strong></p><p id="3eef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这个项目，我使用的是<strong class="ih hj"> Node 12.16.0，Java 11(OpeJDK)，Intellij 2021社区版(免费)。</strong></p><p id="6278" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先让我们在电脑上安装无服务器。我假设你们知道如何安装NodeJS。(我使用的是nvm，所以我可以有多个节点版本来了解它)。我们只需要打开一个CMD或者一个终端，输入这个。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="8807" class="jn jo hi jj b fi jp jq l jr js">npm install -g serverless</span></pre><p id="1039" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有其他方法可以做到这一点，但这是我更喜欢的。在那之后，我们还有一次工作要做。它的配置<strong class="ih hj">无服务器</strong>到我们的AWS账户。为此，我需要AWS帐户的访问密钥和秘密密钥。请访问此链接，了解如何找到该密钥。</p><div class="jt ju ez fb jv jw"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/aws-certified-solution-architect-iam-8930ce442515"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">AWS认证解决方案架构师— IAM</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">IAM的意思是身份和访问管理服务。当我们在之前的教程中创建AWS帐户时，我们…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk kl jw"/></div></div></a></div><p id="947b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获得密钥详细信息后，在终端中输入以下命令</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="155c" class="jn jo hi jj b fi jp jq l jr js"><strong class="jj hj">serverless</strong> config credentials <strong class="jj hj">--provider</strong> aws <strong class="jj hj">--key</strong> <strong class="jj hj"><em class="jd">AWSACCESSKEY </em>--secret</strong> <strong class="jj hj"><em class="jd">AWSSECRETKEY</em></strong></span></pre><p id="7e5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们使用下面的命令创建一个支持Kotlin和AWS的新项目。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="095e" class="jn jo hi jj b fi jp jq l jr js"><strong class="jj hj">serverless</strong> create --<strong class="jj hj">template</strong> aws-kotlin-jvm-gradle <strong class="jj hj">--path</strong> wasteShare</span></pre><p id="9845" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果创建成功，您应该在终端中得到这样的响应。</p><figure class="je jf jg jh fd kn er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es km"><img src="../Images/24465bf39052c3187cd3ef6402bcd24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3PnRNchLnuJcUssaREXXFg.png"/></div></div></figure><p id="5267" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将得到一个名为<strong class="ih hj"> wasteShare </strong>的文件夹，其中包含所需的代码。使用intellij打开它，你会得到一个类似这样的文件夹结构。</p><figure class="je jf jg jh fd kn er es paragraph-image"><div class="er es kt"><img src="../Images/65d882eb6406658ee12603f99c0ebdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*Y1guMvX4sbn_JyaaYr-8mw.png"/></div></figure><p id="f5ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在部署和测试这个项目之前，让我们更改并清理serverless.yml文件。最初有许多注释行，但我们真正需要的只是下面的代码。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="8c6a" class="jn jo hi jj b fi jp jq l jr js">service: wasteshare<br/>frameworkVersion: '2'<br/><br/>provider:<br/>  name: aws<br/>  runtime: java11<br/>  lambdaHashingVersion: 20201221<br/><br/>package:<br/>  artifact: build/libs/hello-dev-all.jar<br/><br/>functions:<br/>  hello:<br/>    handler: com.serverless.Handler<br/>    events:<br/>      - httpApi:<br/>          path: /users/create<br/>          method: get</span></pre><p id="6286" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个函数的作用是，当我们发出GET请求时，它会调用Handler.kt文件。在这个示例代码中，它打印一条带有响应数据的消息。负责人的代码kt。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="aef1" class="jn jo hi jj b fi jp jq l jr js">package com.serverless<br/><br/>import com.amazonaws.services.lambda.runtime.Context<br/>import com.amazonaws.services.lambda.runtime.RequestHandler<br/>import org.apache.logging.log4j.LogManager<br/><br/>class Handler:RequestHandler&lt;Map&lt;String, Any&gt;, ApiGatewayResponse&gt; {<br/>  override fun handleRequest(input:Map&lt;String, Any&gt;, context:Context):ApiGatewayResponse {<br/>    LOG.info("received: " + input.keys.toString())<br/><br/>    return ApiGatewayResponse.build <strong class="jj hj">{<br/>      </strong>statusCode = 200<br/>      objectBody = HelloResponse("Go Serverless v1.x! Your Kotlin function executed successfully!", input)<br/>      headers = <em class="jd">mapOf</em>("X-Powered-By" <em class="jd">to </em>"AWS Lambda &amp; serverless")<br/>    <strong class="jj hj">}<br/>  </strong>}<br/><br/>  companion object {<br/>    private val LOG = LogManager.getLogger(Handler::class.<em class="jd">java</em>)<br/>  }<br/>}</span></pre><p id="e05b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们构建和部署它。为此，我们必须输入以下命令。</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="1ac5" class="jn jo hi jj b fi jp jq l jr js">gradlew clean build (Windows) | ./gradlew clean build (Linux)</span><span id="929f" class="jn jo hi jj b fi ku jq l jr js">serverless deploy</span></pre><p id="1297" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，该功能将被上传到一个S3桶，功能将准备测试。部署后，我们将在终端中得到类似这样的响应。</p><figure class="je jf jg jh fd kn er es paragraph-image"><div class="er es kv"><img src="../Images/1b685973b8b88112b77637ecda267c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*uxcpPjzdWGAGnuSeldIT3Q.png"/></div></figure><p id="fc62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以看到在endpoint部分有一个URL，我们可以用它来测试我们的功能。点击链接，在浏览器中你会得到这样的回应。</p><figure class="je jf jg jh fd kn er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kw"><img src="../Images/61d80c1d7684eeb17ca1aed83bd16d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eb3pKjOPgK5dDK1ilIM8Ww.png"/></div></div></figure><p id="0b89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们的回应。让我给你看我们需要看到的放大版。</p><figure class="je jf jg jh fd kn er es paragraph-image"><div class="er es kx"><img src="../Images/c66a4b56ca78bb10fd677275ecada47f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*5fUC5rhDdTXlLBHJrY1MQA.png"/></div></figure><p id="399c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该消息值是从Handler.kt文件中设置的。现在让我们来研究代码。当我们向这个函数发出GET请求时，它将触发Handler.kt文件。那么handler将返回这个，</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="67bd" class="jn jo hi jj b fi jp jq l jr js">return ApiGatewayResponse.build <strong class="jj hj">{<br/>      </strong>statusCode = 200<br/>      objectBody = HelloResponse("Go Serverless v1.x! Your Kotlin function executed successfully!", input)<br/>      headers = <em class="jd">mapOf</em>("X-Powered-By" <em class="jd">to </em>"AWS Lambda &amp; serverless")<br/>    <strong class="jj hj">}</strong></span></pre><p id="41dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们发送statusCode = 200，然后在ApiGatewayResponse.kt文件中创建消息和其他细节。我想你已经对如何使用这三种技术有了基本的了解。然后将在我们的下一个教程开始真正的应用程序开发。在那之前，快乐的编码伙计们！！！😎</p></div></div>    
</body>
</html>