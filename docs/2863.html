<html>
<head>
<title>Chaos Engineering in Kubernetes using Chaos Mesh</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于混沌网格的Kubernetes混沌工程</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/chaos-engineering-in-kubernetes-using-chaos-mesh-431c1587ef0a?source=collection_archive---------2-----------------------#2021-05-22">https://medium.com/nerd-for-tech/chaos-engineering-in-kubernetes-using-chaos-mesh-431c1587ef0a?source=collection_archive---------2-----------------------#2021-05-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8772" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于混沌网格的Kubernetes混沌工程</p><p id="8fce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着您的应用程序被迁移到云中，架构变得非常复杂。对于云中如此复杂的应用程序架构，很难预测故障。应用程序中的任何此类故障都可能导致贵公司损失惨重。这些持续的不可预测的停机可能会损害公司的声誉，也可能会失去客户。公司必须探索一种方法来预测此类停机，而不是在下次停机时修复它们。混沌工程来拯救我们了。混沌工程是一种在故障导致停机之前识别故障的训练有素的方法。通过这种方法，我们故意破坏应用程序，以了解它们对失败的反应。这将帮助我们建立弹性系统。这是一个非常好的方法。Kubernetes生态系统中有这样的东西吗？是的，混沌网在这里帮助我们。混沌网格是一个云原生的混沌工程平台，在Kubernetes环境中编排混沌。它可以直接部署到Kubernetes集群，不需要任何特殊的依赖。混沌网格是一个CNCF沙盒项目，最近获得了巨大的人气。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/07931069606332b3869c4282486f6035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zb6oMTZb3kWXe5QykIBn8g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图片来源:<a class="ae jt" href="https://chaos-mesh.org/" rel="noopener ugc nofollow" target="_blank">混沌网</a></figcaption></figure><h1 id="98ae" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">整个故事是关于什么的？(TLDR)</h1><ol class=""><li id="c2ed" class="ks kt hi ih b ii ku im kv iq kw iu kx iy ky jc kz la lb lc bi translated">理解混沌网格的架构和概念。</li><li id="9730" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">在Kubernetes集群上运行混沌实验。</li></ol><h1 id="54ba" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">先决条件</h1><ol class=""><li id="e8e7" class="ks kt hi ih b ii ku im kv iq kw iu kx iy ky jc kz la lb lc bi translated">Kubernetes集群(可以是本地、AKS、EKS、GKE、Kind)。</li><li id="69a4" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">头盔，已安装kubectl。</li></ol><h1 id="5c4f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">故事资源</h1><ol class=""><li id="5442" class="ks kt hi ih b ii ku im kv iq kw iu kx iy ky jc kz la lb lc bi translated">GitHub链接:【https://github.com/pavan-kumar-99/medium-manifests T2】</li><li id="c190" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">GitHub分支:<a class="ae jt" href="https://github.com/pavan-kumar-99/medium-manifests/tree/chaos-mesh" rel="noopener ugc nofollow" target="_blank">混沌网</a></li></ol><p id="dc09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混沌网格的组件</strong></p><p id="e492" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混沌网格由以下组件组成</p><p id="60a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)混沌算子:这是混沌网格的核心组件。</p><p id="5e4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)混沌仪表板:这是一个用于设计、监控和管理混沌实验的Web用户界面。</p><p id="15b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混沌网的架构</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/599b948ddb30e087656c86799b0ce4c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-jzQ0Ow5Fk_zBbwIAux9lg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">混沌网状架构。演职员表<a class="ae jt" href="https://chaos-mesh.org/" rel="noopener ugc nofollow" target="_blank">混沌网</a></figcaption></figure><p id="1ad1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混沌网格作为守护进程集部署在Kubernetes中。chaos-daemon控制器作为daemon set pod部署在每个worker节点上。混沌网格使用库伯内特CRD的(自定义资源定义)来定义混沌对象。</p><p id="fe9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，让我们开始行动吧。我们将使用kOps创建一个GCE集群。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="60fc" class="lo jv hi lk b fi lp lq l lr ls">$ export KOPS_STATE_STORE=gs://thanos-prod-medium</span><span id="0094" class="lo jv hi lk b fi lt lq l lr ls">$ export KOPS_FEATURE_FLAGS=AlphaAllowGCE</span><span id="e20b" class="lo jv hi lk b fi lt lq l lr ls">$ kops create cluster \</span><span id="b3ef" class="lo jv hi lk b fi lt lq l lr ls">--node-count 1 \</span><span id="7f1d" class="lo jv hi lk b fi lt lq l lr ls">--zones us-central1-a,us-central1-b,us-central1-c \</span><span id="cd91" class="lo jv hi lk b fi lt lq l lr ls">--master-zones us-central1-a \</span><span id="9443" class="lo jv hi lk b fi lt lq l lr ls">--container-runtime docker \</span><span id="8b21" class="lo jv hi lk b fi lt lq l lr ls">medium.k8s.local</span><span id="6c92" class="lo jv hi lk b fi lt lq l lr ls">$ kops update cluster --name medium.k8s.local --yes --admin</span><span id="901e" class="lo jv hi lk b fi lt lq l lr ls">$ kops validate cluster --wait=10m</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/f44cc5b9cc710018c661e615b491e119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6Wuh8P4fVoX3HvmsvsYSg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">kOps集群已验证</figcaption></figure><p id="d744" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们在我们的Kubernetes集群中安装混沌网格<a class="ae jt" href="https://github.com/chaos-mesh/chaos-mesh/tree/master/helm/chaos-mesh" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="lv">头盔char </em> </strong> </a> <strong class="ih hj"> t </strong>。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="01e0" class="lo jv hi lk b fi lp lq l lr ls">$ helm repo add chaos-mesh <a class="ae jt" href="https://charts.chaos-mesh.org" rel="noopener ugc nofollow" target="_blank">https://charts.chaos-mesh.org</a></span><span id="279c" class="lo jv hi lk b fi lt lq l lr ls">$ helm repo update</span><span id="5237" class="lo jv hi lk b fi lt lq l lr ls">$ helm install chaos-mesh chaos-mesh/chaos-mesh --namespace=chaos-testing --create-namespace --set dashboard.create=true</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/f632f9b567923db93b34b3d6683907ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r8jCx5xbTqpO8YTflJ-OwQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">混沌网格</figcaption></figure><p id="05b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您应该可以找到所有创建的混沌网格组件，以及运行在每个工作节点上的混沌守护进程。混沌网格还创建了一个仪表板来可视化和管理所有的混沌实验。仪表板看起来会像这样。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/a5c58dcd7add0b67e554cabaf4e7627c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNNyCJLZ59S07EOIHWGnIg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">混沌网格仪表板</figcaption></figure><p id="962d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">啊，是的，我明白了！！仪表板看起来很酷，对吧？没有任何进一步的原因，让我们开始创建混沌实验。库伯内特有各种各样的混沌实验。让我们全部检查一下...</p><p id="6238" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> PodChaos实验</strong></p><p id="bf5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a) pod-failure:它将错误注入到pod中，并将导致pod创建暂时失败。选定的窗格在特定时间段内将不可用。</p><blockquote class="ly lz ma"><p id="9ba4" class="if ig lv ih b ii ij ik il im in io ip mb ir is it mc iv iw ix md iz ja jb jc hb bi translated">b)杀死荚果:杀死被选中的荚果，并不断重启/重生荚果。</p></blockquote><p id="3fd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">c)杀死容器:杀死目标舱中指定的容器。</p><p id="3323" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">网络混沌实验</strong></p><blockquote class="ly lz ma"><p id="c2d2" class="if ig lv ih b ii ij ik il im in io ip mb ir is it mc iv iw ix md iz ja jb jc hb bi translated">a)网络分区:这阻止了两个pod之间的通信。</p></blockquote><p id="222c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)网络仿真:操作涵盖常规网络故障，如网络延迟、复制、丢失和损坏。</p><p id="021d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">应激混沌实验</strong></p><p id="fbab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)内存压力:这将持续增加虚拟内存的压力。</p><p id="ac8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b) CPU压力:这种压力会持续使CPU不堪重负。</p><p id="2d04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">时间混沌实验</strong></p><p id="dbb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TimeChaos用于修改<code class="du me mf mg lk b">clock_gettime</code>的返回值</p><p id="f6d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> IOChaos实验</strong></p><p id="245a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">IOChaos允许您模拟文件系统故障，比如IO延迟和读/写错误。</p><p id="1905" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> KernelChaos实验</strong></p><p id="5fe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导致底层主机上的内核混乱。尽管它针对特定的pod，但可能会影响其他pod的性能。强烈建议不要在生产中运行它。</p><p id="31d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">dnschaus实验</strong></p><blockquote class="ly lz ma"><p id="962a" class="if ig lv ih b ii ij ik il im in io ip mb ir is it mc iv iw ix md iz ja jb jc hb bi translated">a) DNSChaos:这允许您在发送请求后模拟错误的DNS响应，如DNS错误或随机的IP地址。</p></blockquote><p id="6677" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> AWSChaos实验</strong></p><p id="3446" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这有助于将故障注入AWS实例，如ec2-stop、ec2-restart、detach-volume。</p><p id="e94e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑到本文的长度，我们将挑选几个混沌实验并在这里介绍它们。但是，如果你想让我介绍任何其他的实验，请随意评论。</p><p id="a8a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建用于测试的资源。</p><p id="590c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将创建几个示例部署来进行现场测试。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="e7b6" class="lo jv hi lk b fi lp lq l lr ls">$ kubectl create ns chaos-k8s </span><span id="2bc3" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl config set-context --current --namespace=chaos-k8s</span><span id="3a2b" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl create deploy httpd --image=httpd --replicas=2 </span><span id="5c05" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl expose deploy --port=80 </span><span id="3cd2" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl create deploy nginx --image=nginx --replicas=2</span></pre><p id="1bd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> PodChaos: Pod-Kill实验</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="26ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在应用之前，让我们先了解一下yaml文件。</p><ol class=""><li id="9de7" class="ks kt hi ih b ii ij im in iq mj iu mk iy ml jc kz la lb lc bi translated"><strong class="ih hj">规格</strong>:吊舱混乱<br/>的规格<strong class="ih hj">动作:</strong>要应用的吊舱混乱的种类。这可能是豆荚杀死(或)豆荚失败(或)容器杀死。<br/> <strong class="ih hj">模式:</strong>定义了混沌的模式。一个表示一次一个副本，所有表示所有副本，一个值表示固定百分比。<br/>持续时间:每次混沌实验的持续时间。<br/><strong class="ih hj">selector . label selectors:</strong>指定混沌注入的目标吊舱。<br/> <strong class="ih hj">调度器:</strong>定义了混沌实验运行时间的调度规则。</li></ol><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="6990" class="lo jv hi lk b fi lp lq l lr ls">$ git clone <a class="ae jt" href="https://github.com/pavan-kumar-99/medium-manifests" rel="noopener ugc nofollow" target="_blank">https://github.com/pavan-kumar-99/medium-manifests</a> \<br/>-b chaos-mesh</span><span id="2ad4" class="lo jv hi lk b fi lt lq l lr ls">$ cd medium-manifests </span><span id="cb20" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl apply -f pod-kill.yaml </span></pre><p id="36aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦应用了pod-kill清单，您应该可以在混沌仪表盘中看到它们。在实验选项卡中。它还包含上次执行时间。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/ee7d3c3baa64f520b1f6a8414d753da5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BKOToMlLo-pS6DAesICUdw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">杀荚实验</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/cd3206159bbba98540dae2fc3a1869c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzMQF-2QXsXbo4PwCAYS_g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">豆荚被杀死了。一次一个人</figcaption></figure><p id="8166" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在看到豆荚被我们的混乱守护进程杀死了。这些豆荚每两分钟就会被杀死一个。</p><p id="f245" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">网络混乱:网络分区示例</strong></p><p id="a591" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经创建了2个部署。</p><ol class=""><li id="26ff" class="ks kt hi ih b ii ij im in iq mj iu mk iy ml jc kz la lb lc bi translated">httpd部署。</li><li id="d46b" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">nginx部署。</li></ol><p id="2b3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经在ClusterIP类型的服务上公开了httpd部署。我们现在将尝试从nginx部署中访问httpd服务。在应用网络混乱之前，让我们检查一下这是否有效。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="da7d" class="lo jv hi lk b fi lp lq l lr ls">$ pod=$(kubectl get po -l app=nginx -o \     jsonpath='{.items[0].metadata.name}')</span><span id="8cc7" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl exec $pod -it -- /bin/sh -c "curl httpd"</span><span id="c3bd" class="lo jv hi lk b fi lt lq l lr ls">&lt;html&gt;&lt;body&gt;&lt;h1&gt;It works!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</span></pre><p id="ef0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在应该看到通信没有任何中断。现在让我们应用网络混沌实验。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="229a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个混沌实验将阻塞所有从标签为“app: nginx”的吊舱到所有标签为“app:httpd”的吊舱的通信，持续50秒。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="5832" class="lo jv hi lk b fi lp lq l lr ls">$ kubectl apply -f network_chaos_partition.yaml</span><span id="5853" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl exec $pod -it -- /bin/sh -c "curl httpd"</span><span id="f5ce" class="lo jv hi lk b fi lt lq l lr ls">curl: (7) Failed to connect to httpd port 80: Connection timed out</span></pre><p id="bae9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您现在应该看到请求正在超时。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/cc26c9517f5c893d437df568e01c2a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzSg7sBVEnPfNCzXw13mJg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">网络混沌的Pod实验</figcaption></figure><p id="f5fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> DNSChaos实验</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="4155" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们先睹为快。</p><ol class=""><li id="4752" class="ks kt hi ih b ii ij im in iq mj iu mk iy ml jc kz la lb lc bi translated"><strong class="ih hj">规格</strong>:DNSChaos<br/>规格<strong class="ih hj">动作:</strong>要应用的DNSChaos种类。它可能是错误的(或)随机的。发送DNS请求时抛出错误。发送DNS请求时随机发送一个IP。<br/> <strong class="ih hj">模式:</strong>域名对DNSChaos<br/><strong class="ih hj">selector . label selectors:</strong>指定混沌注入的目标pod。</li></ol><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="4f70" class="lo jv hi lk b fi lp lq l lr ls">$ pod=$(kubectl get po -l app=nginx -o \     jsonpath='{.items[0].metadata.name}')</span><span id="0825" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl exec -it $pod -- /bin/sh -c "apt-get update -y &amp;&amp; \<br/> apt-get install dnsutils -y" </span><span id="6b3d" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl apply -f dns_chaos.yaml </span><span id="6a8f" class="lo jv hi lk b fi lt lq l lr ls">$ kubectl exec -it $pod -- /bin/sh -c "nslookup google.com"</span><span id="4b29" class="lo jv hi lk b fi lt lq l lr ls"><strong class="lk hj">Server:  100.64.144.180<br/>Address: 100.64.144.180#53</strong></span><span id="39e5" class="lo jv hi lk b fi lt lq l lr ls"><strong class="lk hj">** server can't find google.com: SERVFAIL</strong></span><span id="77c8" class="lo jv hi lk b fi lt lq l lr ls"><strong class="lk hj">command terminated with exit code 1</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mp"><img src="../Images/806bad9489629520aee73ad4b58f06a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrW37uY2sKjLaUNH3VHDTA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">DNS混沌实验</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/30d038231b7ffdc35ba45216e0cc96b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_rX5LezuKDYGtEWt-Xpcw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">DNS混乱仪表板</figcaption></figure><h2 id="4ffc" class="lo jv hi bd jw mr ms mt ka mu mv mw ke iq mx my ki iu mz na km iy nb nc kq nd bi translated">打扫</h2><p id="ef3a" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq ne is it iu nf iw ix iy ng ja jb jc hb bi translated">好了，现在让我们删除整个集群。</p><blockquote class="ly lz ma"><p id="c1bd" class="if ig lv ih b ii ij ik il im in io ip mb ir is it mc iv iw ix md iz ja jb jc hb bi translated"><strong class="ih hj"> kops删除集群medium.k8s.local —是</strong></p></blockquote><h1 id="d2e7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="4422" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq ne is it iu nf iw ix iy ng ja jb jc hb bi translated">至此，我们已经理解了混沌工程将如何被用于构建弹性系统。混沌网格通过允许我们在Kubernetes中实现混沌工程来帮助我们实现这种训练有素的方法。如有任何新想法或问题，请随时联系我。另外，欢迎在评论区发表你的想法。</p><p id="691f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">直到下次……..</p><h1 id="fcdd" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">被推荐的</h1><div class="nh ni ez fb nj nk"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/deep-dive-into-thanos-part-i-f72ecba39f76"><div class="nl ab dw"><div class="nm ab nn cl cj no"><h2 class="bd hj fi z dy np ea eb nq ed ef hh bi translated">深入灭霸——第一部分</h2><div class="nr l"><h3 class="bd b fi z dy np ea eb nq ed ef dx translated">使用灭霸和普罗米修斯操作员监控Kubernetes的工作负载</h3></div><div class="ns l"><p class="bd b fp z dy np ea eb nq ed ef dx translated">medium.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny jn nk"/></div></div></a></div><div class="nh ni ez fb nj nk"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/deep-dive-into-thanos-part-ii-8f48b8bba132"><div class="nl ab dw"><div class="nm ab nn cl cj no"><h2 class="bd hj fi z dy np ea eb nq ed ef hh bi translated">深入灭霸——第二部分</h2><div class="nr l"><h3 class="bd b fi z dy np ea eb nq ed ef dx translated">使用灭霸和普罗米修斯操作员监控Kubernetes的工作负载</h3></div><div class="ns l"><p class="bd b fp z dy np ea eb nq ed ef dx translated">medium.com</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny jn nk"/></div></div></a></div><div class="nh ni ez fb nj nk"><a href="https://www.techmanyu.com/kubernetes-security-with-kube-bench-and-kube-hunter-6765bf44ebc6" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab dw"><div class="nm ab nn cl cj no"><h2 class="bd hj fi z dy np ea eb nq ed ef hh bi translated">Kubernetes安全与Kube-bench和Kube-hunter</h2><div class="nr l"><h3 class="bd b fi z dy np ea eb nq ed ef dx translated">使用Kube-bench和Kube-hunter在Kubernetes集群中进行安全检查</h3></div><div class="ns l"><p class="bd b fp z dy np ea eb nq ed ef dx translated">www.techmanyu.com</p></div></div><div class="nt l"><div class="oa l nv nw nx nt ny jn nk"/></div></div></a></div><div class="nh ni ez fb nj nk"><a href="https://www.techmanyu.com/creating-self-hosted-github-runners-in-a-kubernetes-cluster-fd05560de34a" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab dw"><div class="nm ab nn cl cj no"><h2 class="bd hj fi z dy np ea eb nq ed ef hh bi translated">在Kubernetes集群中创建自托管GitHub运行程序</h2><div class="nr l"><h3 class="bd b fi z dy np ea eb nq ed ef dx translated">在您自己的Kubernetes集群上运行GitHub操作</h3></div><div class="ns l"><p class="bd b fp z dy np ea eb nq ed ef dx translated">www.techmanyu.com</p></div></div><div class="nt l"><div class="ob l nv nw nx nt ny jn nk"/></div></div></a></div></div></div>    
</body>
</html>