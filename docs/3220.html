<html>
<head>
<title>Confusion Matrix and Cyber Security</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混淆矩阵与网络安全</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/confusion-matrix-and-cyber-security-62da9afb6eff?source=collection_archive---------4-----------------------#2021-06-02">https://medium.com/nerd-for-tech/confusion-matrix-and-cyber-security-62da9afb6eff?source=collection_archive---------4-----------------------#2021-06-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/58fa7cd5818c6c85a78e702ec1d0fb4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*lOT0SfRFZhZZAgM2Xsa1Uw.png"/></div></figure><p id="aa3a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">预测建模的完整生命周期包括数据清理、预处理和数据争论。现在到了我们尝试适应模型的阶段，最终目标是实现低偏差和低方差。最重要的步骤是模型创建后的模型评估。我们经常无法理解由此产生的绩效评估指标。</p><h1 id="e0c1" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">理解混淆矩阵</h1><p id="acf8" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">当我们得到数据，经过数据清洗、预处理和争论后，我们做的第一步是将它输入到一个优秀的模型中，当然，还要得到概率输出。但是我们如何衡量我们的模型的有效性呢？效果越好，性能越好，这就是我们想要的。这也是混淆矩阵引人注目的地方。混淆矩阵是机器学习分类的性能度量。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kn"><img src="../Images/3fe53294db02186c1e66d686267e2387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DitCx6HzuNx_AqpM.jpeg"/></div></div></figure><p id="c9a6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">有多种方法可以在机器学习模型中找到错误。平均绝对误差(误差/成本)函数通过尝试使实际值和预测值之间的距离为 0，来帮助模型在正确的方向上进行训练。我们通过“y — y^".”发现机器学习模型预测中的错误</p><p id="40c8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">均方误差(MSE):从数据集中取点，首先将它们平方，然后取平均值来克服误差。</p><p id="f1d6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在二元分类模型中，借助混淆矩阵来检测错误。</p><p id="a33c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">混淆矩阵是机器学习分类问题的性能度量，其中输出可以是两个或更多个类别。这是一个包含预测值和实际值的 4 种不同组合的表格。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/dbbea91ee986148b00adf8fe6735ea1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/0*tOZRT7unCsJa_ehz.png"/></div></figure><p id="384b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是非常有用的测量召回，精度，特异性，准确性，最重要的是 AUC-ROC 曲线。</p><h1 id="cf5e" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">混淆矩阵的四个结果</h1><p id="860b" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">混淆矩阵通过比较实际类别和预测类别来可视化分类器的准确性。二进制混淆矩阵由正方形组成:</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kx"><img src="../Images/6af7cada4080d9ceb456ec370b62188b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DEES8wz817C8qR_F.png"/></div></div></figure><ul class=""><li id="8f8c" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated">TP:真阳性:预测值被正确预测为实际阳性</li><li id="9b02" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">FP:预测值错误地预测了实际的正值。即负值被预测为正值。也被称为<strong class="io hj">类型 1 错误</strong></li><li id="5781" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">FN:假阴性:预测为阴性的正值。也被称为<strong class="io hj">2 型错误</strong></li><li id="b814" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">TN:真负值:预测值被正确预测为实际负值</li></ul><p id="51a5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">模型的精确度(通过混淆矩阵)使用下面给出的公式计算。</p><p id="1659" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">准确度= TN+TP / TN+FP+FN+TP</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lm"><img src="../Images/73beef576ce71b920c1008ce9b8dce82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qG6Iov3cbFP4UF_g.jpeg"/></div></div></figure><p id="fd31" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果用于不平衡的数据集，准确性可能会产生误导，因此有其他基于混淆矩阵的度量标准可用于评估性能。在 Python 中，混淆矩阵可以通过使用<em class="ln">“混淆 _ 矩阵</em>()<em class="ln">“</em>函数获得，该函数是<em class="ln">“sk learn”</em>库的一部分。这个函数可以使用 sk learn . metrics import confusion _ matrix 中的<em class="ln">导入到 Python 中。<em class="ln"/>为了获得混淆矩阵，用户需要向函数提供实际值和预测值。</em></p><h2 id="27c2" class="lo jl hi bd jm lp lq lr jq ls lt lu ju ix lv lw jy jb lx ly kc jf lz ma kg mb bi translated">以更简单的方式理解混淆矩阵:</h2><p id="6dce" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">让我们举个例子:</p><p id="d570" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们总共有<strong class="io hj"> 20 只猫和狗</strong>，我们的模型预测它是否是一只猫。</p><ul class=""><li id="71c7" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated">实际值= ['狗'、'猫'、'狗'、'猫'、'狗'、'猫'、'狗'、'狗'、'狗'、'狗'、'狗'、'猫'、'狗'、'狗'、'狗'、'猫'、'狗'、'猫']</li><li id="869c" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">预测值= ['狗'、'狗'、'狗'、'猫'、'狗'、'猫'、'猫'、'狗'、'狗'、'狗'、'猫'、'狗'、'狗'、'狗'、'猫'、'狗'、'狗'、'猫'、'狗']</li></ul><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mc"><img src="../Images/6cf9861769024de20359c13bb7d9f740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KzrP7383WpU54-dW.jpeg"/></div></div></figure><ul class=""><li id="1734" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><em class="ln">真阳性(TP) = 6 </em></li></ul><p id="5f07" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你预测是肯定的，这是真的。你预言一种动物是猫，它确实是。</p><ul class=""><li id="4cc5" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><em class="ln">真负值(TN) = 11 </em></li></ul><p id="0a40" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你预测是负面的，这是真的。你预测动物不是猫，它实际上也不是(它是一只狗)。</p><ul class=""><li id="5cc1" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><em class="ln">假阳性(1 型错误)(FP) = 2 </em></li></ul><p id="543f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你预测是积极的，但它是错误的。你预测动物是猫，但它实际上不是(它是狗)。</p><ul class=""><li id="d22e" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><em class="ln">假阴性(2 型错误)(FN) = 1 </em></li></ul><p id="e13d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你预测是负面的，这是错误的。你预测那种动物不是猫，但它实际上是。</p><ul class=""><li id="4921" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><strong class="io hj">阳性预测值(PVV): </strong>这非常接近精度。这两个术语之间的一个显著区别是，PVV 考虑的是患病率。在类别完全平衡的情况下，阳性预测值与精度相同。</li><li id="487e" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated"><strong class="io hj">空错误率:</strong>这个术语用来定义如果你能预测多数类，你的预测会错多少次。您可以将它视为比较分类器的基线度量。</li><li id="3881" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated"><strong class="io hj"> F-measure/F1-Score: </strong>精度低召回率高的两个模型很难比较或者反之。所以为了使它们具有可比性，我们使用 F-Score。F-score 有助于同时衡量查全率和查准率。它用调和平均值代替算术平均值，更多地惩罚极值。</li></ul><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es md"><img src="../Images/4fb39847e5b3877e42b9290c54d9bf8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/0*pOwiBpt5UF-vnVcv.png"/></div></figure><ul class=""><li id="1f43" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><strong class="io hj"> Roc 曲线:</strong> Roc 曲线显示不同切点的真阳性率对假阳性率。它还证明了敏感性(回忆和特异性或真正的阴性率)之间的权衡。</li><li id="2127" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated"><strong class="io hj">精度:</strong>精度度量显示了正类的精度。它衡量正类的预测正确的可能性。</li></ul><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es me"><img src="../Images/7eb6d017b556c320ea72586a2749ee34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/0*gFnPvuL2QWr3m0Ef.jpeg"/></div></figure><p id="e6be" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当分类器完美地将所有正值分类时，最高分是 1。精度本身并没有太大的帮助，因为它忽略了负类。该指标通常与召回指标成对出现。回忆也称为敏感度或真阳性率。</p><ul class=""><li id="7861" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated"><strong class="io hj">灵敏度</strong>:灵敏度计算正确检测到的阳性类别的比率。该度量给出了模型识别一个肯定类的好坏程度。</li></ul><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/68ed262373be4f43a9aadf3aae7c8a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/0*D0VIAQBb8YAnWkcr.jpeg"/></div></figure><h2 id="2150" class="lo jl hi bd jm lp lq lr jq ls lt lu ju ix lv lw jy jb lx ly kc jf lz ma kg mb bi translated">如果已经有了很高的准确率，还有必要检查召回(或)精度吗？</h2><p id="e70c" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">当类别不平衡时，我们不能依赖单一的分类精度值。例如，我们有一个 100 名患者的数据集，其中 5 名患有糖尿病，95 名健康。然而，如果我们的模型仅预测大多数类别，即所有 100 个人都是健康的，即使我们具有 95%的分类准确度。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/2e320dc0985f2d4724f2ccdcbc040314.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/0*ki3Oj6d3lA5BpjKx.jpg"/></div></figure><h2 id="efd7" class="lo jl hi bd jm lp lq lr jq ls lt lu ju ix lv lw jy jb lx ly kc jf lz ma kg mb bi translated">何时使用准确度/精确度/召回率/ F1 评分？</h2><ul class=""><li id="43d4" class="ky kz hi io b ip ki it kj ix mh jb mi jf mj jj ld le lf lg bi translated">当真阳性和真阴性更重要时，使用准确度。准确性是衡量平衡数据的更好标准。</li><li id="ef5e" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">当假阳性更重要时，使用精度。</li><li id="53a3" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">当假阴性更重要时，使用回忆。</li><li id="d39e" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">当假阴性和假阳性很重要时，使用 F1 分数。F1-Score 是不平衡数据的更好指标。</li></ul><h2 id="2c42" class="lo jl hi bd jm lp lq lr jq ls lt lu ju ix lv lw jy jb lx ly kc jf lz ma kg mb bi translated">为什么我们需要混淆矩阵？</h2><p id="7b25" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">以下是使用混淆矩阵的优点/好处。</p><ul class=""><li id="6887" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated">它显示了任何分类模型在进行预测时是如何被混淆的。</li><li id="476c" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">混淆矩阵不仅能让你洞察分类器所犯的错误，还能让你了解所犯错误的类型。</li><li id="d8ca" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">这个分类帮助你克服单独使用分类准确度的限制。</li><li id="1b13" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">混淆矩阵的每一列都代表该预测类的实例。</li><li id="ee87" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">混淆矩阵的每一行代表实际类的实例。</li><li id="e7a6" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">它不仅能洞察分类器产生的错误，还能洞察正在产生的错误。</li></ul><h1 id="ca96" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">基于并行支持向量机的网络攻击检测和分类</h1><p id="b9bc" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">网络攻击正在成为组织信息系统的一个关键问题。已经引入了许多网络攻击检测和分类方法，并取得了不同程度的成功，这些方法被用作保护数据完整性和系统可用性免受攻击的对策。计算机网络攻击的分类是网络安全领域中一个难以解决的问题。</p><p id="12c1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">计算机系统的连通性和可访问性的快速增长导致了网络攻击的频繁发生。对计算机基础设施的攻击正成为一个日益严重的问题。基本上，网络攻击检测是一个分类问题，其中我们从系统的异常模式(攻击)中分类出正常模式。子集选择决策融合方法在网络攻击检测中起着关键作用。已经表明，冗余和/或不相关的特征可能严重影响学习算法的准确性。SDF 是用于决策和分类问题的非常强大和流行的数据挖掘算法。它已经在许多实际应用中使用，如医疗诊断、雷达信号分类、天气预报、信用审批和欺诈检测等。</p><h2 id="dd4b" class="lo jl hi bd jm lp lq lr jq ls lt lu ju ix lv lw jy jb lx ly kc jf lz ma kg mb bi translated">KDD 杯’99 数据集描述</h2><p id="12aa" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">为了检验所提出的分布式网络攻击检测和分类算法的性能，我们可以使用 KDD 99 入侵检测数据集对其进行实际评估。在 KDD99 数据集中，这四种攻击类别(DoS、U2R、R2L 和 probe)被分为 22 种不同的攻击类别，如表 1 所示。1999 年 KDD 数据集被分为两部分:训练数据集和测试数据集。测试数据集不仅包含来自训练数据的已知攻击，还包含未知攻击。自 1999 年以来，KDD 99 数据集一直是评估异常检测方法最广泛使用的数据集。这个数据集是由 Stolfo 等人准备的，是基于 DARPA'98 IDS 评估计划中捕获的数据建立的。DARPA'98 大约是 7 周网络流量的 4 千兆字节压缩原始(二进制)tcpdump 数据，可以处理成大约 500 万条连接记录，每条大约 100 字节。对于每个 TCP/IP 连接，在 41 个特征、34 个特征(数字)和 7 个特征(符号)中提取 41 个不同的定量(连续数据类型)和定性(离散数据类型)特征。为了分析不同的结果，已经开发了用于评估网络入侵检测的标准度量。检测率(DR)和虚警率是已经使用的两个最著名的指标。DR 计算为正确检测到的攻击数与攻击总数的比率，而误报率计算为被错误分类为攻击的正常连接数与正常连接数的比率。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mk"><img src="../Images/6ae19a134f829abce0471e585c36ae84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSsuw4EaDmrvTyMKL5CoIg.png"/></div></div></figure><p id="69d2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在 KDD 杯 99 中，用于评估参与者条目的标准是使用混淆矩阵和给定的成本矩阵计算的每次测试的成本(CPT)。混淆矩阵(CM)是一个正方形矩阵，其中每一列对应于预测的类别，而行对应于实际的类别。第 I 行第 j 列的条目 CM (i，j)表示最初属于类别 I 的错误分类实例的数量，尽管被错误地标识为类别 j 的成员。主对角线的条目 CM (i，I)表示正确检测的实例的数量。成本矩阵也有类似的定义，条目 C (i，j)表示将属于类 I 的实例错误分类到类 j 的成本惩罚。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ml"><img src="../Images/d92ed6021920ec096fb4d42e3022bc1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P7sIN81TupyV9WIH996HrQ.png"/></div></div></figure><ul class=""><li id="9c26" class="ky kz hi io b ip iq it iu ix la jb lb jf lc jj ld le lf lg bi translated">真阳性(TP):实际攻击时检测到的攻击数量。</li><li id="bed2" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">真阴性(TN):实际正常时检测到的正常量。</li><li id="7e92" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">误报(FP):实际正常时检测到的攻击量(虚警)。</li><li id="42c6" class="ky kz hi io b ip lh it li ix lj jb lk jf ll jj ld le lf lg bi translated">假阴性(FN):当正常攻击时检测到的数量。</li></ul><p id="4fee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上面的混淆矩阵中，行对应预测类别，列对应实际类别。</p><p id="2369" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">混淆矩阵包含由分类器完成的实际和预测分类的信息。网络攻击检测系统的性能通常使用矩阵中的数据进行评估。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/7d50a0dbc43898c6ac487ac52b3b6233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*6W_e-qxQw3mb4ZmSZoPHBg.png"/></div></figure></div></div>    
</body>
</html>