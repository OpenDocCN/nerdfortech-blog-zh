<html>
<head>
<title>Converter Parameter Binding — How to Bind Complex Values at Xamarin(MAUI)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">转换器参数绑定—如何在 Xamarin(MAUI)绑定复数值</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/converter-parameter-binding-how-to-bind-complex-values-at-xamarin-maui-a23b6c45ab31?source=collection_archive---------1-----------------------#2022-10-19">https://medium.com/nerd-for-tech/converter-parameter-binding-how-to-bind-complex-values-at-xamarin-maui-a23b6c45ab31?source=collection_archive---------1-----------------------#2022-10-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/2fea779a3bfa2010f4773549815f86f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwhborpSvjHR33umv0PASA.png"/></div></div></figure><div class=""/><div class=""><h2 id="f7fb" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">如何在 Xamarin 或 MAUI 中解析 ConverterParameter 的绑定？对🥹转换器中的反射进行简短的深入研究</h2></div><p id="fda5" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">潜艇人员🤗，今天的故事会很短，但我希望很有帮助。我们写的或者用的都是一些预定义的转换器，绑定一些值。但是你有没有尝试过🧐？</p><p id="f290" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在深入探讨之前，让我们回顾一下如何将值绑定到转换器参数。</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ki"><img src="../Images/4e102c7a80b633a143ffaf66e9faf020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MTd3MnL4FuxoVNd39AgiGg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated"><code class="du ke kf kg kh b">IValueConverter</code>的简单实现</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kr"><img src="../Images/a904946d70a06bef5ae8b5d2889d8084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xct5YRS764TZ7YjeArXcA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">绑定 BindingContext 中的值</figcaption></figure><p id="d1fd" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这里我们从我们的<code class="du ke kf kg kh b">BindingContext</code>绑定了一个<code class="du ke kf kg kh b">object value</code>，这里我们的上下文就是我们的视图模型。我们的绑定被解析，并将自己传递给转换器<code class="du ke kf kg kh b">object</code>，转换器作为<code class="du ke kf kg kh b">StaticResource</code>从资源中被解析</p><blockquote class="ks kt ku"><p id="052d" class="ji jj kv jk b jl jm iu jn jo jp ix jq kw js jt ju kx jw jx jy ky ka kb kc kd hb bi translated">如果你也为你的父容器(比如 page)指定了数据类型，你可以从你的 IDE (Visual Studio 或 Rider)看到提示，以确保你不会在你的 XAML 代码中出错。</p></blockquote><pre class="kj kk kl km fd kz kh la lb aw lc bi"><span id="9092" class="ld le ht kh b fi lf lg l lh li">xmlns:viewModels="clr-namespace:ProjectNamespace.ViewModels"<br/>x:DataType="cviewModels:SpecifiedViewModel"</span></pre><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lj"><img src="../Images/494ea1a428492e417fa5d0bdc04a3fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rEVhjBquuWpew2OJIdDwkw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">从 XAML 中的另一个对象传递值</figcaption></figure><p id="ca97" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">此外，我们能够使用一些<code class="du ke kf kg kh b">Reference</code>来传递运行时可用内容的值，例如，其他控件的一些<code class="du ke kf kg kh b">Width</code>或来自外部上下文的内容，如命令，如果我们在具有不同<code class="du ke kf kg kh b">DataType</code>和<code class="du ke kf kg kh b">BindingContext</code>的列表元素中</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h1 id="428d" class="lr le ht bd ls lt lu lv lw lx ly lz ma iz mb ja mc jc md jd me jf mf jg mg mh bi translated">将简单数据传递给转换器</h1><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mi"><img src="../Images/36915123f5518abb45562b5799e279bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pi8mln_4GnF0MxHGky3kqA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">需要一些“double”作为参数</figcaption></figure><p id="8bfa" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">又没什么特别的，但是等一下。我们很快会再来🙃。</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mj"><img src="../Images/c249f1e1230d04e68f25b6960507d4fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5SYmTSZqWpomM78W9Par-g.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将静态“double”值作为转换器参数传递</figcaption></figure><p id="7d5f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">同样，我们可以传递一些文本或静态资源，它们都将按照我们的预期得到解析😊</p><div class="kj kk kl km fd ab cb"><figure class="mk hk ml mm mn mo mp paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><img src="../Images/786c07df7ced53930ff026e13aef025e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1514/format:webp/1*El3SvQ1hz9aESqAqeIzWWg.png"/></div></figure><figure class="mk hk mq mm mn mo mp paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><img src="../Images/7cef5525bb7bd8535cef5d6b2dbf7d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*X56la1ATa2a0pvJTqmbTwg.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx mr di ms mt translated">在 XAML 中定义布尔值，并将 StaticResources 作为转换器参数传递</figcaption></figure></div></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h1 id="e450" class="lr le ht bd ls lt lu lv lw lx ly lz ma iz mb ja mc jc md jd me jf mf jg mg mh bi translated">将值数组传递到转换器中</h1><p id="a35d" class="pw-post-body-paragraph ji jj ht jk b jl mu iu jn jo mv ix jq jr mw jt ju jv mx jx jy jz my kb kc kd hb bi translated">我知道，我知道，所有人都知道，但如果我开始了，我需要经历它们😝</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mz"><img src="../Images/f4ee6cb339cad50261c6e644378d42ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLgSRufxdzhngK1yEmx-Cw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将多个值(可以是不同的类型或不同的传递方式)传递到转换器中</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/de88d0325793389bb64540e074f4d196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zAQQVwL9hRTm7GON1e8oSQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">并期望它们(值)在转换器内部</figcaption></figure><p id="e065" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我只想提一下，我们可能有一个转换器列表，每个转换器都有一个参数列表😱</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nb"><img src="../Images/9a6095d39a9609995795dbb17659c5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_ZkFk_-fPLSM-1vP69qIA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">带有参数列表的转换器列表，用于将一个值链接到另一个值和最终可绑定属性。</figcaption></figure><div class="hh hi ez fb hj nc"><a href="https://learn.microsoft.com/en-us/xamarin/community-toolkit/converters/multiconverter" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hu fi z dy nh ea eb ni ed ef hs bi translated">Xamarin 社区工具包多转换器</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">MultiConverter 允许用户根据当前活动的安全区域在屏幕上偏移元素。</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">learn.microsoft.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq hp nc"/></div></div></a></div></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h1 id="df8b" class="lr le ht bd ls lt lu lv lw lx ly lz ma iz mb ja mc jc md jd me jf mf jg mg mh bi translated">Bing 通用的东西作为转换器参数🫣</h1><p id="b6bc" class="pw-post-body-paragraph ji jj ht jk b jl mu iu jn jo mv ix jq jr mw jt ju jv mx jx jy jz my kb kc kd hb bi translated">它来了😁...根据前面的例子，我们可能期望将<code class="du ke kf kg kh b">StaticResource</code>改为<code class="du ke kf kg kh b">Binding</code>将由引擎为我们解决。但是不，不，不，不，它绝不会传递一个绑定对象😳</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nr"><img src="../Images/bb8d7c9a5d9c4819bdac8553d4c3bd31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CcSr-_30Td3RmvXL6VpxLQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将视图模型中的可绑定值作为转换器参数传递</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ns"><img src="../Images/5492e5fb9b365a78bf931a053bb69464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7GGK_keljX3PLUvQ_Cd1w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">绑定对象仍然是绑定的，而不是绑定的值</figcaption></figure><p id="9be4" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">好吧，那么我们能做什么，如何解决这个问题？—我们可以检查它的类型，如果它是绑定的并且有一个源，我们可以通过使用反射从源逐部分获取值。</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nt"><img src="../Images/fc207280f027777d903577923c4c27bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3bn6QS2vQbv7YWLKui4DSQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">更新了转换器以检查参数是否为绑定</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nu"><img src="../Images/b56c016527b506dec2183e399fd4e37e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14BjzozfKkV4CbOnF_cK7w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">通过使用反射获取值的特殊工具</figcaption></figure><p id="c3e8" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">所以，我们在这里做的是🤔？我们检查<code class="du ke kf kg kh b">propertyName</code>是否包含任何<code class="du ke kf kg kh b">.</code>,因为这意味着我们需要从绑定上下文中解析某些属性的属性。原因如下:</p><pre class="kj kk kl km fd kz kh la lb aw lc bi"><span id="11de" class="ld le ht kh b fi lf lg l lh li">Binding Model -&gt; Means that in BindingContext(for example, ViewModel), we have some property named `Model`</span><span id="3c98" class="ld le ht kh b fi nv lg l lh li">Binding Model.InnerModel -&gt; Means that in BindingContext, we have some class or struct property named `Model` which contains public property named `InnerModel` </span></pre><p id="9baf" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">它可以根据需要进行深度递归。这就是为什么我们通过获取<code class="du ke kf kg kh b">.</code>的第一个索引来检查我们是否包含一些内部属性</p><p id="b5dd" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">如果我们包含任何内容，我们将获得 source(点的左边)和 property name(点的右边),并使用更新的 source 和 property name 递归调用方法<code class="du ke kf kg kh b">GetPropertyValue</code>。现在我们可以从我们的<code class="du ke kf kg kh b">BindingContext</code>绑定顶级属性，从更复杂的对象绑定一些内部公共属性😊。</p><p id="1c11" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">但是，如果你注意转换器内部，我们将<code class="du ke kf kg kh b">Source</code>传递到<code class="du ke kf kg kh b">GetPropertyValue</code>，它是一个<code class="du ke kf kg kh b">null</code>，即使我们确定我们在同一个<code class="du ke kf kg kh b">BindingContext</code>下。为了解决这个问题，我们需要将<code class="du ke kf kg kh b">Source</code>指定为父元素或其自身的<code class="du ke kf kg kh b">Reference</code>。</p><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nw"><img src="../Images/1e2a7362e7f54792bc2ab70460cf1a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*raJgDXNDvk3FcaXAd656wg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">通过 BindingContext 从源获取值</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nx"><img src="../Images/c7885ddb95ab6df33c52b347eba07729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyKVtzVErKcZh5ZC_vbwmw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">通过源传递 ConverterParameter</figcaption></figure><p id="ba8d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在，我们可以对它进行一些处理，并将值与转换器和转换器参数绑定，其中转换器参数具有可与其自身的转换器和自身的转换器参数绑定的值🤯</p><figure class="kj kk kl km fd hk er es paragraph-image"><div class="er es ny"><img src="../Images/89885e680aee1339388fbdcd11b63751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/0*Jp-IM5_HW2ZeTd-x.jpg"/></div></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nz"><img src="../Images/2688dd97b5e30fbc09c075a1316b3033.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scQOJJhPRnuTVSyknXtb5Q.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将简单转换器参数作为转换器参数传递给转换器😆</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es oa"><img src="../Images/6c42fc2711641871b54cb46a47350b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tSBfTXM15a_KzkHDAIwOQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">从绑定到下一个转换器逐步解析值</figcaption></figure><figure class="kj kk kl km fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ob"><img src="../Images/4d5addccc1ec3063f3d304869b165083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F8b5cm4tNN4jJG1KkSp6Lg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">将另一个内部绑定作为背景色绑定传递给转换器参数绑定🤯😱😱😱</figcaption></figure></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="bef0" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我希望在这篇博文之后，你会知道转换器可能期望比简单的值稍微多一点的值作为转换器参数，并且你将准备好在你的 C#代码中解析所有的绑定和内部转换器🙃 😉</p><p id="2422" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">请在 Twitter 上关注我，如果你喜欢这个博客，你可以为我买一杯啤酒来支持我😅</p><p id="1fbf" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae oc" href="https://www.buymeacoffee.com/bbenetskyy" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/bbenetskyy</a>T13<br/>https://twitter.com/bbenetskyy</p></div></div>    
</body>
</html>