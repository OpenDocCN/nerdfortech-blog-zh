<html>
<head>
<title>Machine Learning Model Inside a Container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">容器内的机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/machine-learning-model-inside-a-container-a52ecd95fc64?source=collection_archive---------35-----------------------#2021-05-29">https://medium.com/nerd-for-tech/machine-learning-model-inside-a-container-a52ecd95fc64?source=collection_archive---------35-----------------------#2021-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/2e46f6f73cc4ec2ca6e027bbbc9298ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfxcrsWu3hCBbDbD8WzxoQ.png"/></div></div></figure><div class=""/><div class=""><h2 id="73ae" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">在Docker容器内训练机器学习模型</h2></div><p id="bcf7" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">问候大家！！！现在我带着另一个博客回来了。</p><p id="55a6" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在这篇博客中，我们将讨论如何在Docker容器中创建一个机器学习模型，并使用该模型进行一些预测。对于这项任务，我们将创建一个基本的机器学习模型，它可以根据多年的经验预测工资。</p><p id="b82f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">所以让我们从博客开始吧！！！</p><h1 id="8caa" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated"><strong class="ak">实用</strong></h1><p id="a2fb" class="pw-post-body-paragraph ji jj ht jk b jl kw iu jn jo kx ix jq jr ky jt ju jv kz jx jy jz la kb kc kd hb bi translated">我们可以使用本地系统或AWS实例来完成这项任务。因此，无论我们对什么感到舒服，我们都可以使用它。</p><p id="acf7" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">首先，我们需要在Linux操作系统中安装Docker。这里我使用的是RedHat Linux，所以我们需要配置yum来安装docker。我们需要创造一个<strong class="jk hu">。回购</strong>文件在我们的<strong class="jk hu"> /etc/yum.repos.d/里面。</strong>我们创建了一个文件<strong class="jk hu"> docker.repo，</strong>，然后在该文件中，我们配置了repo。你可以看到同样的下图。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lb"><img src="../Images/b56c37d6dd2a34fd2eacd1684ae45cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQid9bIqbkvJQyciB3mI_g.png"/></div></div></figure><p id="c3a9" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在，我们可以使用以下命令安装docker:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="6407" class="ll kf ht lh b fi lm ln l lo lp">yum install docker-ce --nobest</span></pre><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lq"><img src="../Images/fbdb1a9b6a379119866d6a07fdc51981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZRW5cgjnxdL83nzBTRManA.png"/></div></div></figure><p id="94bb" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在检查是否安装了docker。我们可以使用命令:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="cc2f" class="ll kf ht lh b fi lm ln l lo lp">docker --version</span></pre><p id="a8ad" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">之后，应该会启动docker服务。我们可以使用命令<strong class="jk hu"> systemctl status docker </strong>来检查服务状态。如果它没有运行，我们可以使用<strong class="jk hu"> systemctl start docker </strong>来启动它，并使用<strong class="jk hu"> systemctl enable docker </strong>在每次启动时启用它。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lr"><img src="../Images/3f76475b3a95d385a83f60a37cd4d98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cn_pyCpg1g7-RcNVEyKhVA.png"/></div></div></figure><p id="5cf0" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们可以使用<strong class="jk hu">“docker PS”</strong>来查看所有正在运行的容器，使用<strong class="jk hu">“docker images”</strong>来查看我们系统中的所有映像，docker可以使用这些映像来构建容器。在下图中，我们可以看到我有相当多的图像，但没有容器运行。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ls"><img src="../Images/96e35e844f318cf67cf8f33d8b5816a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ke4eFeYErLNlpTaNTGAgTQ.png"/></div></div></figure><p id="115a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们将使用ubuntu镜像来启动我们的操作系统，并且我们将使用最新版本的ubuntu。</p><p id="d786" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们可以使用我在上面用过的命令:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="888b" class="ll kf ht lh b fi lm ln l lo lp">docker pull ubuntu:latest</span></pre><p id="f17e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">上面的命令帮助我们从任何存储库中提取映像，如果我们有映像，它将查看是否有任何更新，并提取最新版本的映像。</p><p id="e9e1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在我们有了ubuntu映像，我们可以使用该映像启动一个容器。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lt"><img src="../Images/c03a3d9fd5a65d606b20d9ace60a863a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XykK4c5xyLhFUOeSXlJPg.png"/></div></div></figure><p id="b7a3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在上图中，我们可以看到我们使用了</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="1fdb" class="ll kf ht lh b fi lm ln l lo lp">docker run -it --name=mlContainer ubuntu:latest</span></pre><p id="0a52" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">该命令意味着我们想要运行一个容器，这意味着我们需要一个容器的交互式终端，name是我们想要的容器的名称，最后是我们想要用来创建容器的图像。<strong class="jk hu">(左边)</strong></p><p id="152d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在右边，我打开了另一个终端，我们可以看到当我们使用<strong class="jk hu"> docker ps </strong>命令时，一个新的容器出现了，这是我们创建的。因此，我们的容器被创建，我们现在在容器内。正如您在右侧看到的，root@localhost已经更改为root@0d260d5…也就是容器id。</p><h1 id="426f" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">准备好环境</h1><p id="8f76" class="pw-post-body-paragraph ji jj ht jk b jl kw iu jn jo kx ix jq jr ky jt ju jv kz jx jy jz la kb kc kd hb bi translated">现在在这个容器中，我们将训练我们的模型。</p><p id="c147" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">首先，我们需要一些软件存在于容器中。我们需要Python和一些库来训练机器学习模型。我们还需要Windows系统中的数据集，并将它转移到Linux系统和容器中(我们将讨论这一点)。</p><p id="049d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">首先，让我们看看我们的系统中是否有Python，或者现在有。如下图所示，我们可以看到python不在我们的容器中，因此我们将使用以下命令安装它:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="ef2e" class="ll kf ht lh b fi lm ln l lo lp">$ apt-get update #first update apt-get<br/>$ apt-get install python3-pip -y</span></pre><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lu"><img src="../Images/9a8ed79b26b2dd43c09e45ea1f6c1e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5iJvRXGwjw-8_31I2uDtA.png"/></div></div></figure><p id="0e18" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们已经安装了python和pip，因为我们还需要安装其他库。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lv"><img src="../Images/4aaa95be4892d7657415bc9bae53a3c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5g8vWR_RSFmEVg5qna8Jw.png"/></div></div></figure><p id="aeab" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在我们可以看到Python已经安装并在下图中工作。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/218b522e0fd442f4f12e34257f12661a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cmGePo9Kub5d-5xs8RUOcg.png"/></div></div></figure><p id="6412" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">当我们使用机器学习时，我们需要获取或读取数据集文件，这可以通过<strong class="jk hu"> pandas库来完成。</strong>我们还需要<strong class="jk hu"> numpy，</strong>我们还需要<strong class="jk hu"> sklearn </strong>使用模型来训练我们的数据，所以我们已经使用pip安装了所有东西。</p><p id="d0df" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们可以使用命令检查每个模块是否都在。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="3af9" class="ll kf ht lh b fi lm ln l lo lp">$ pip list #shows all the modules available</span><span id="9412" class="ll kf ht lh b fi lx ln l lo lp">$ pip install pandas<br/>$ pip install sklearn</span></pre><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ly"><img src="../Images/658fc2bdda807c96f5b2af69c16947b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6R3f8xLldEJZFKYoDzOhg.png"/></div></div></figure><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lz"><img src="../Images/d2f6c909ed0f0cd0f9cfcad5780e223b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UdmNjiCgbaFtkEth8UgSrg.png"/></div></div></figure><h1 id="a345" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated"><strong class="ak">码头工人提示</strong></h1><p id="6da7" class="pw-post-body-paragraph ji jj ht jk b jl kw iu jn jo kx ix jq jr ky jt ju jv kz jx jy jz la kb kc kd hb bi translated">当我们在docker容器中时，我们可以使用"<strong class="jk hu"> $ exit </strong>"这将我们带到了容器之外。这意味着容器被停止。要再次启动容器，我们可以使用命令“$ docker start&lt;container name/id&gt;”现在再次进入容器内部，我们可以使用命令:" $ docker attach &lt;容器名称/id &gt;"</p><h1 id="26ff" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">模特培训</h1><p id="ddfd" class="pw-post-body-paragraph ji jj ht jk b jl kw iu jn jo kx ix jq jr ky jt ju jv kz jx jy jz la kb kc kd hb bi translated">现在我们需要数据集，我们首先需要在我们的系统中有数据集。这里我的数据集在windows系统中，所以我将首先把它带到我的Linux系统(RedHat)中。</p><p id="f324" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我将使用WinScp软件来完成这项工作。我们也可以直接在Linux系统中使用<strong class="jk hu"> wget </strong>从互联网上获取数据集。</p><p id="0fed" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们需要在Windows中打开软件，给出我们可以使用的Linux系统的IP地址用户名，然后通过work或key进行连接。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ma"><img src="../Images/ccc1427257460fc6a6fb7648a322264d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccOsZnVucXeIRQsc_z2fPA.png"/></div></div></figure><p id="4f3a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在上图中，我们可以看到我已经使用WinScp将“Salary_Data.csv”文件从我的windows(左侧)传输到我的Linux系统(右侧),我们可以看到在终端上有一个名为“task1WS”的文件夹来存储它。</p><blockquote class="mb mc md"><p id="140a" class="ji jj me jk b jl jm iu jn jo jp ix jq mf js jt ju mg jw jx jy mh ka kb kc kd hb bi translated">记住要让文件完全可读，否则我们可能会面临目录中的读写问题。我已经在上面的图片中展示了我们是如何做到的。</p></blockquote><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es mi"><img src="../Images/e174027b42e7443f6d765590bba67030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*-58hv2NctCgZzAHbMkB_EQ.png"/></div></figure><p id="09b0" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在，在文件“Salary_Data.csv”中，我们有我们的数据集，在文件“salaryModel.py”中，我们有我们的Python代码。</p><p id="b591" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">以下是数据集的链接:</p><div class="hh hi ez fb hj mj"><a href="https://www.kaggle.com/vihansp/salary-data?select=Salary_Data.csv" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hu fi z dy mo ea eb mp ed ef hs bi translated">薪资_数据</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">Kaggle是世界上最大的数据科学社区，拥有强大的工具和资源来帮助您实现您的数据…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">www.kaggle.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx hp mj"/></div></div></a></div><p id="0a51" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">下面是<strong class="jk hu"> salaryModel.py </strong>代码:</p><figure class="lc ld le lf fd hk"><div class="bz dy l di"><div class="my mz l"/></div></figure><p id="945e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">上面我已经导入了所有需要的库，然后我读取了数据集并将其存储在变量<strong class="jk hu"> data </strong>中，然后我将训练数据存储在<strong class="jk hu"> x </strong>中，然后将数据存储在<strong class="jk hu"> y </strong>中。我还对x数据进行了整形，然后将其转换为2D数组。然后，我使用模块LinearRegression()来训练我的数据。我已经用<strong class="jk hu"> model.fit(x，y) </strong>对数据进行了训练。</p><p id="00f5" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在，当我使用以下命令运行这个程序时:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="fb5e" class="ll kf ht lh b fi lm ln l lo lp">python3 salaryModel.py</span></pre><p id="18b9" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">它将我的经验作为输入，并以工资的形式给我答案，作为我多年经验输入的输出。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es na"><img src="../Images/4e3dfddd7325a13a75b1964a31224268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*Vxd-C0TozS8ftFky0MuLeg.png"/></div></figure><p id="3a0c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我们可以看到该模型正在工作，并且为了保存该模型，我们不需要再次运行或训练我们已经使用过的模型</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="78c4" class="ll kf ht lh b fi lm ln l lo lp">&gt;&gt; jb.dump(model, 'salaryPredictor.pk1')</span></pre><p id="afe0" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这有助于我们将模型存储在文件<strong class="jk hu">" salary predictor . pk1 "</strong>中，供以后使用。</p><h1 id="2955" class="ke kf ht bd kg kh ki kj kk kl km kn ko iz kp ja kq jc kr jd ks jf kt jg ku kv bi translated">结论</h1><p id="15e6" class="pw-post-body-paragraph ji jj ht jk b jl kw iu jn jo kx ix jq jr ky jt ju jv kz jx jy jz la kb kc kd hb bi translated">我们已经在docker容器中成功地创建了机器学习模型，并保存了该模型以备后用。我希望我已经解释了一切，如果你有任何疑问或建议，你可以在这个博客上评论或在我的LinkedIn上联系我。</p><div class="hh hi ez fb hj mj"><a href="https://www.linkedin.com/in/mishanregmi/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hu fi z dy mo ea eb mp ed ef hs bi translated">密山Regmi -研究实习生- SkillGeek | LinkedIn</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">在世界上最大的职业社区LinkedIn上查看米山·雷米的个人资料。密山有一个工作列在他们的…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">www.linkedin.com</p></div></div><div class="ms l"><div class="nb l mu mv mw ms mx hp mj"/></div></div></a></div><p id="3bdc" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><em class="me">谢谢你一直呆到博客结束，请给我一些改进的建议。你的建议真的会激励我。</em></p></div></div>    
</body>
</html>